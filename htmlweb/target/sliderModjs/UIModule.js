define(["sMods/TemplateModule","sMods/TooltipModulesto","sMods/HighLight","sMods/SliderModule","sMods/ButtonModule","sMods/DoughNutModule","sMods/ScorerModule","sMods/SliderModuleYN","sMods/Helper","tinysort"],function(e,t,s,a,o,l,n,r,i,u){"use strict";return function(){var d,h=[],c=[],m=[];return{init:function(e,a,o){"ie9"==document.getElementsByTagName("body")[0].getAttribute("browser")&&(document.getElementsByTagName("body")[0].className="cms-bootstrap ie9",this.ie9="ie9");var l=new t;this.setTooltip(l),this.highLight=new s,this.helper=new i,this.currentElement=0,this.elementWidth=105,this.windowWidth=$(window).width(),this.windowResizeBool=!1,this.bodyRemoveHighLight=!1,this.numberOfGreyOuts=a,this.elementLabels=["Arsenal","Chelsea","Liverpool","Portsmouth","Man United","Man City","Leeds","Bournemouth"],this.buttonLabels=["Manager","Goal Keeper & Defence","Midfield","League Position & Recent Form","Attack","Owner"],this.scorerValues=[],this.chartData=document.getElementById("jsonInput").value,this.chartData=JSON.parse(this.chartData),"ui3"==o?this.numberOfElements=a:this.numberOfElements=e,this.numberOfButtons=a,this.numberOfCharts=2,this.uiType=o,"ui1"==this.uiType?(document.getElementById("game-content").className="ui1",this.slider()):"ui2"==this.uiType?(document.getElementById("game-content").className="ui2",this.scorer()):(this.uiType="ui3")&&(document.getElementById("game-content").className="ui3",this.sliderYN()),$(".custom-col-md-4").mouseover(function(){l.disableTooltip()}),$(".custom-col-md-3").mouseover(function(){l.disableTooltip()}),document.getElementById("fixedHeader").addEventListener("mouseover",function(){l.disableTooltip()},!1),$("footer").mouseover(function(e){e.stopPropagation(),l.disableTooltip()}),$(".leftRightButton").on("mouseOver",function(e){e.stopPropagation(),l.disableTooltip()}),$(".sliderContainer").on("mouseover",function(e){e.stopPropagation(),l.tooltipActivate("",this.id)}),$(".sliderContainerYN").on("mouseover",function(e){e.stopPropagation(),l.tooltipActivate("",this.id)}),$("#modules").on("mouseout",function(e){e.stopPropagation(),l.disableTooltip("",this.id)}),this.windowWidth<=1100&&$(".sliderNavContainer1200").css("margin","0"),this.windowWidth>1100&&$(".sliderNavContainer1200").css("margin","0 auto"),this.windowWidth<=1200&&(document.getElementById("sliderLabel4").className=this.helper.addClass("sliderLabel4","hideVisibility"))},setTooltip:function(e){this.tooltip=e},getTooltip:function(){return this.tooltip},slider:function(){for(var t=new e,s=["Arsenal","Chelsea","Liverpool","Portsmouth","Man United","Man City","Leeds","Bournemouth"],n=0;n<this.numberOfElements;n++)$("#sliderNavWrapper").append('<li id="sliderLabel'+n+'" class="sliderLabelContainer">'+s[n]+"</li>");for(var n=0;n<this.numberOfButtons;n++)c[n]=new o,c[n].setButtonID(n),t.createButton(n,this.buttonLabels[n],this);for(var r=0;r<this.numberOfButtons;r++){for(var i=[],n=0;n<this.numberOfElements;n++){i[n]=new a;var u=r+"_"+n;i[n].setSliderID(u),t.createSlider(u,r,s[n],this.windowWidth,this)}h.push(i)}for(var n=0;n<this.numberOfElements;n++){m[n]=new l;var d=this.getOrdinalPosition(n+1);m[n].setDoughnutID(n,d,this.chartData),m[n].doughnutObject=t.createDoughnut(n,this.chartData,s[n],d)}if($("canvas").css({width:"100%",height:"100%"}),this.windowWidth<992)this.helper.updateClassNamesAdd("ui-slider-handle"," fa fa-minus-square fa-lg fa-rotate-90 handleStyle"),this.helper.updateClassNamesAdd("tooltip1"," top"),this.windowResizeBool=!0;else{this.helper.updateClassNamesAdd("ui-slider-handle"," fa fa-minus-square fa-2x handleStyle"),this.helper.updateClassNamesAdd("tooltip1"," right");var p=this.elementWidth*this.numberOfElements+30;$(".elementWrapper").css("width",p),$(".sliderNavWrapper").css("width",p)}this.updateChartPositions()},scorer:function(){for(var t=this,s=new e,a=0;a<this.numberOfElements;a++)$("#sliderNavWrapper").append('<li id="sliderLabel'+a+'" class="sliderLabelContainer">'+this.elementLabels[a]+"</li>");for(var r=[],a=0;a<this.numberOfElements;a++)r[a]=a+1;for(var a=0;a<this.numberOfButtons;a++)c[a]=new o,c[a].setButtonID(a),s.createButton(a,this.buttonLabels[a],this),this.scorerValues.push(r);for(var i=0;i<this.numberOfButtons;i++){for(var u=[],a=0;a<this.numberOfElements;a++){u[a]=new n;var d=i+"_"+a;u[a].setscorerID(d,this.numberOfElements),s.createScorer(d,i,this.elementLabels[a],this.windowWidth)}h.push(u)}for(var a=0;a<this.numberOfElements;a++){m[a]=new l;var p=this.getOrdinalPosition(a+1);m[a].setDoughnutID(a,p,this.chartData),m[a].doughnutObject=s.createDoughnut(a,this.chartData,this.elementLabels[a],p)}$(".scorer").on("click",function(){t.setScorerValue(this.id)}),$("canvas").css({width:"100%",height:"100%"});var f=this.elementWidth*this.numberOfElements+30;$(".elementWrapper").css("width",f),$(".sliderNavWrapper").css("width",f),this.updateChartPositions()},sliderYN:function(){var t=["No","Yes"],s=["Manager","Goal Keeper & Defence","Midfield","League Position & Recent Form","Attack","Owner"],a=new e;this.windowResizeBool=!0;for(var n=0;n<this.numberOfbuttons;n++)$("#sliderNavWrapper").append('<li class="sliderLabelContainer">'+sliderLabels[n]+"</li>");for(var n=0;n<this.numberOfButtons;n++)c[n]=new o,c[n].setButtonID(n),a.createButton(n,s[n],this),h[n]=new r,h[n].setSliderID(n),a.createSliderYN(n,this);for(var n=0;n<this.numberOfCharts;n++){m[n]=new l;var i=this.getOrdinalPosition(n+1);m[n].setDoughnutID(n,i,this.chartData),m[n].doughnutObject=a.createDoughnut(n,this.chartData,t[n],i)}$(".navButtonContainer").css("display","none"),$(".labelsBackground").css("display","none"),$("canvas").css({width:"100%",height:"100%"});for(var n=0;n<this.numberOfButtons;n++)document.getElementById("sliderID"+n).className=this.helper.addClass("sliderID"+n," overlaydiv overlayDiv1 handleStyle");this.windowWidth<992?this.helper.updateClassNamesAdd("ui-slider-handle"," fa fa-minus-square fa-lg fa-rotate-90 handleStyle"):this.helper.updateClassNamesAdd("ui-slider-handle"," fa fa-minus-square fa-2x fa-rotate-90 handleStyle"),this.updateChartPositions()},setButtonValue:function(e,t){var e=e.charAt(e.length-1),s=c[e];s.setButtonValue();for(var a=c[e].buttonValue,o=(this.helper.removeClass,this.helper.addClass,0);o<this.numberOfElements;o++)3==modules.baseURI.charAt(modules.baseURI.length-1)?h[e].setValues("",a):h[e][o].setValues("",a);1===c[e].buttonValue?$("#moduleButton"+e).children().removeClass("overlayDiv5"):$("#moduleButton"+e).children().removeClass("overlayDiv"+(c[e].buttonValue-1)),$("#moduleButton"+e).children().addClass("overlayDiv"+c[e].buttonValue),this.updateButtonValue(e)},setSliderValue:function(e,t,s){var a=t.charAt(t.length-1),o=t.charAt(t.length-3);t=[o,a],h[t[0]][t[1]].setValues(e,c[t[0]].buttonValue),this.updateTotal(t[[1]]);var l=m[t[1]].doughnutObject,n=c[t[0]].buttonUpdateID,r=2*parseInt(n),i=r+1,e=h[t[0]][t[1]].totalValue/10,u=10*c[t[0]].buttonValue-e;l.segments[r].value=u,l.segments[i].value=e,l.update()},updateButtonValue:function(e){if(null!==c[e].buttonUpdateID)for(var t=c[e].buttonUpdateID,s=2*parseInt(t),a=s+1,o=0;o<this.numberOfElements;o++){var l=m[o].doughnutObject;if(3==modules.baseURI.charAt(modules.baseURI.length-1))var n=h[o].totalValue/10;else var n=h[e][o].totalValue/10;var r=10*c[e].buttonValue-n;l.segments[s].value=r,l.segments[a].value=n,l.update()}else for(var o=0;o<this.numberOfElements;o++)var l=m[o].doughnutObject,n=0,r=0;this.updateChartPositions()},updateTotal:function(e){for(var t=0,s=0,a=0;a<this.numberOfButtons;a++)c[a].disabledBool||(t+=3==modules.baseURI.charAt(modules.baseURI.length-1)?h[a].totalValue:h[a][e].totalValue,s+=c[a].buttonValue);var o=Math.round(100*(t/(100*s)));m[e].totalScore=o,document.getElementById("sliderTotal"+e).innerHTML=o,document.getElementById("sliderTotalSmall"+e).innerHTML=o},removeChartSegment:function(e){for(var t=2*c[e].buttonUpdateID,s=0;s<m.length;s++)m[s].doughnutObject.removeData(t),m[s].doughnutObject.removeData(t)},addChartSegment:function(e){e=2*parseInt(e);for(var t=e+1,s=0;s<m.length;s++){var a=m[s].data;m[s].doughnutObject.addData({value:1,color:a[e].color},String(e)),m[s].doughnutObject.addData({value:0,color:a[t].color},t)}for(var s=0;s<m.length;s++)for(var o=m[s],l=0,n=1,r=0;r<this.numberOfButtons;r++){var i=2*r,u=i+1,d=r;c[d].disabledBool||(o.doughnutObject.segments[l].fillColor=o.data[i].color,o.doughnutObject.segments[l].highlightColor=o.data[i].color,o.doughnutObject.segments[n].fillColor=o.data[u].color,o.doughnutObject.segments[n].highlightColor=o.data[u].color,l+=2,n=l+1)}for(var s=0;s<m.length;s++)m[s].doughnutObject.update()},updateChartPositions:function(){d="ui3"==this.uiType?this.numberOfCharts:this.numberOfElements;for(var e=0;e<d;e++)document.getElementById("canvasContainer"+e).setAttribute("totalScore",m[e].totalScore);u("ul.results>li",{attr:"totalScore",order:"desc"}),$(".results").children("li").each(function(){this.className=""});var t=1,s=this;$(".results").children("li").each(function(){var e=s.getOrdinalPosition(t),a=this.id;switch(a=a.match(/[0-9]+/g),$("#ordianlPosition"+a[0]).text(e),document.getElementById("sliderTotalSmall"+a[0]).className="badge",t){case 1:"ui3"!==s.uiType&&$("#canvas"+a[0]).css("display","block"),document.getElementById("sliderTotalSmall"+a[0]).className=s.helper.addClass("sliderTotalSmall"+a[0],"goldBadge"),this.className="first";break;case 2:"ui3"!==s.uiType&&$("#canvas"+a[0]).css("display","none"),document.getElementById("sliderTotalSmall"+a[0]).className=s.helper.addClass("sliderTotalSmall"+a[0],"silverBadge"),this.className="defaultChartHeader";break;case 3:$("#canvas"+a[0]).css("display","none"),document.getElementById("sliderTotalSmall"+a[0]).className=s.helper.addClass("sliderTotalSmall"+a[0],"bronzeBadge"),this.className="defaultChartHeader";break;default:$("#canvas"+a[0]).css("display","none"),this.className="defaultChartHeader"}t+=1})},getOrdinalPosition:function(e){var t=["th","st","nd","rd"],s=e%100;return e+(t[(s-20)%10]||t[s]||t[0])},getElementArray:function(){return h},getChartArray:function(){return m},getButtonArray:function(){return c},setScorerValue:function(e){var e=e.match(/[0-9]+/g),t=h[e[0]][e[1]].opValue,s=[],a=null,o=this.scorerValues[e[0]][this.scorerValues[e[0]].length-1];if(0==t){for(var l=0;l<this.scorerValues[e[0]].length;l++)0==l?a=this.scorerValues[e[0]][l]:s.push(this.scorerValues[e[0]][l]);this.scorerValues[e[0]]=s,h[e[0]][e[1]].setScorerValue=this.numberOfElements-(a-1),h[e[0]][e[1]].opValue=a}else if(t>o||"undefined"==typeof o){a=0;for(var l=0;l<this.scorerValues[e[0]].length;l++)s.push(this.scorerValues[e[0]][l]);s.push(t),this.scorerValues[e[0]]=s,0!=a?h[e[0]][e[1]].setScorerValue=this.numberOfElements-(a-1):h[e[0]][e[1]].setScorerValue=0,h[e[0]][e[1]].opValue=a}else{for(var l=0;l<this.scorerValues[e[0]].length;l++)t<this.scorerValues[e[0]][l]&&null===a?(a=this.scorerValues[e[0]][l],s.push(t)):s.push(this.scorerValues[e[0]][l]);h[e[0]][e[1]].setScorerValue=this.numberOfElements-(a-1),h[e[0]][e[1]].opValue=a,this.scorerValues[e[0]]=s}h[e[0]][e[1]].setValues(p,c[e[0]].buttonValue);var n=this.getOrdinalPosition(a);0!==h[e[0]][e[1]].opValue?document.getElementById("scorerValue"+e[0]+"_"+e[1]).innerHTML=n:document.getElementById("scorerValue"+e[0]+"_"+e[1]).innerHTML="",this.updateTotalScorer(e[[1]]);var r=m[e[1]].doughnutObject,i=c[e[0]].buttonUpdateID,u=2*parseInt(i),d=u+1,p=h[e[0]][e[1]].totalValue/10,f=10*c[e[0]].buttonValue-p;r.segments[u].value=f,r.segments[d].value=p,r.update(),this.updateChartPositions()},updateTotalScorer:function(e){for(var t=0,s=0,a=0;a<this.numberOfButtons;a++)c[a].disabledBool||(t+=h[a][e].totalValue,s+=c[a].buttonValue);var o=Math.round(100*(t/(100*s)));m[e].totalScore=o,document.getElementById("sliderTotal"+e).innerHTML=o,document.getElementById("sliderTotalSmall"+e).innerHTML=o},setSliderYNValue:function(e,t){var s,a,t=t.charAt(t.length-1);h[t].setValues(e.value,c[t].buttonValue),h[t].isNegetiveBool?h[t].isNegetiveBool&&(s=0,a=1):(s=1,a=0);var o=m[s].doughnutObject,l=c[t[0]].buttonUpdateID,n=2*parseInt(l),r=n+1,e=h[t].totalValue/10,i=10*c[t].buttonValue-e;o.segments[n].value=i,o.segments[r].value=e,o.update();var u=m[a].doughnutObject,d=0,p=10*c[t].buttonValue-d;u.segments[n].value=p,u.segments[r].value=d,u.update(),this.updateTotalYN()},setButtonValueYN:function(e){var t=c[e];t.setButtonValue();for(var s=c[e].buttonValue,a=0;a<this.numberOfElements;a++)h[e].setValues("",s);1===c[e].buttonValue?$("#moduleButton"+e).children().this.helper.removeClass("overlayDiv5"):$("#moduleButton"+e).children().this.helper.removeClass("overlayDiv"+(c[e].buttonValue-1)),$("#moduleButton"+e).children().this.helper.addClass("overlayDiv"+c[e].buttonValue),this.updateButtonValueYN(e)},updateButtonValueYN:function(e){for(var t,s,a=e,s=0;s<this.numberOfCharts;s++){if(t=0,null!==c[e].buttonUpdateID){var o=c[e].buttonUpdateID,l=2*parseInt(o),n=l+1,r=m[s].doughnutObject;h[a].isNegetiveBool&&0==s&&(t=h[a].totalValue/10),h[a].isNegetiveBool||1!=s||(t=h[a].totalValue/10);var i=10*c[e].buttonValue-t;r.segments[l].value=i,r.segments[n].value=t,r.update(),this.updateTotalYN()}else this.updateTotalYN();this.updateChartPositions()}},updateTotalYN:function(){for(var e,t=0,s=0,e=0;e<this.numberOfCharts;e++){t=0,s=0;for(var a=0;a<this.numberOfButtons;a++)c[a].disabledBool||(h[a].isNegetiveBool&&0==e&&(t+=h[a].totalValue),h[a].isNegetiveBool||1!=e||(t+=h[a].totalValue),s+=c[a].buttonValue);var o=Math.round(100*(t/(100*s)));m[e].totalScore=o,document.getElementById("sliderTotal"+e).innerHTML=o,document.getElementById("sliderTotalSmall"+e).innerHTML=o}}}}});