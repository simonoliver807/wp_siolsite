/*!
 * jQuery JavaScript Library v2.1.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-18T15:11Z
 */

/*!
 * Sizzle CSS Selector Engine v2.2.0-pre
 * http://sizzlejs.com/
 *
 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-16
 */

/*! jQuery UI - v1.11.2 - 2014-10-16
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, draggable.js, droppable.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js, menu.js, progressbar.js, resizable.js, selectable.js, selectmenu.js, slider.js, sortable.js, spinner.js, tabs.js, tooltip.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */

/*!
 * jQuery UI Core 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */

/*!
 * jQuery UI Widget 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */

/*!
 * jQuery UI Mouse 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 */

/*!
 * jQuery UI Position 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */

/*!
 * jQuery UI Accordion 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/accordion/
 */

/*!
 * jQuery UI Menu 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/menu/
 */

/*!
 * jQuery UI Autocomplete 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/autocomplete/
 */

/*!
 * jQuery UI Button 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/button/
 */

/*!
 * jQuery UI Datepicker 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/datepicker/
 */

/*!
 * jQuery UI Draggable 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */

/*!
 * jQuery UI Resizable 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/resizable/
 */

/*!
 * jQuery UI Dialog 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/dialog/
 */

/*!
 * jQuery UI Droppable 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 */

/*!
 * jQuery UI Effects 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/effects-core/
 */

/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */

/*!
 * jQuery UI Effects Blind 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/blind-effect/
 */

/*!
 * jQuery UI Effects Bounce 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/bounce-effect/
 */

/*!
 * jQuery UI Effects Clip 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/clip-effect/
 */

/*!
 * jQuery UI Effects Drop 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/drop-effect/
 */

/*!
 * jQuery UI Effects Explode 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/explode-effect/
 */

/*!
 * jQuery UI Effects Fade 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/fade-effect/
 */

/*!
 * jQuery UI Effects Fold 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/fold-effect/
 */

/*!
 * jQuery UI Effects Highlight 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/highlight-effect/
 */

/*!
 * jQuery UI Effects Size 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/size-effect/
 */

/*!
 * jQuery UI Effects Scale 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/scale-effect/
 */

/*!
 * jQuery UI Effects Puff 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/puff-effect/
 */

/*!
 * jQuery UI Effects Pulsate 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/pulsate-effect/
 */

/*!
 * jQuery UI Effects Shake 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/shake-effect/
 */

/*!
 * jQuery UI Effects Slide 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slide-effect/
 */

/*!
 * jQuery UI Effects Transfer 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/transfer-effect/
 */

/*!
 * jQuery UI Progressbar 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/progressbar/
 */

/*!
 * jQuery UI Selectable 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/selectable/
 */

/*!
 * jQuery UI Selectmenu 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/selectmenu
 */

/*!
 * jQuery UI Slider 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slider/
 */

/*!
 * jQuery UI Sortable 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 */

/*!
 * jQuery UI Spinner 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/spinner/
 */

/*!
 * jQuery UI Tabs 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/tabs/
 */

/*!
 * jQuery UI Tooltip 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/tooltip/
 */

/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011�2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */

/**
 * TinySort is a small and simple script that will sort any nodeElment by it's text- or attribute value, or by that of one of it's children.
 * @summary A nodeElement sorting script.
 * @version 2.1.1
 * @license MIT/GPL
 * @author Ron Valstar (http://www.sjeiti.com/)
 * @copyright Ron Valstar <ron@ronvalstar.nl>
 * @namespace tinysort
 * @todo check place option
 */

/*!
 * Chart.js
 * http://chartjs.org/
 * Version: 1.0.1
 *
 * Copyright 2015 Nick Downie
 * Released under the MIT license
 * https://github.com/nnnick/Chart.js/blob/master/LICENSE.md
 */

/*!
 * Bootstrap v3.3.4 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */

/* ========================================================================
 * Bootstrap: transition.js v3.3.4
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: alert.js v3.3.4
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: button.js v3.3.4
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: carousel.js v3.3.4
 * http://getbootstrap.com/javascript/#carousel
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: collapse.js v3.3.4
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.3.4
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.3.4
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.3.4
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.3.4
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: scrollspy.js v3.3.4
 * http://getbootstrap.com/javascript/#scrollspy
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tab.js v3.3.4
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: affix.js v3.3.4
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

if(function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e=t.length,i=Q.type(t);return"function"!==i&&!Q.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t))}function n(t,e,i){if(Q.isFunction(e))return Q.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return Q.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(at.test(e))return Q.filter(e,t,i);e=Q.filter(e,t)}return Q.grep(t,function(t){return X.call(e,t)>=0!==i})}function s(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function r(t){var e=ft[t]={};return Q.each(t.match(pt)||[],function(t,i){e[i]=!0}),e}function o(){J.removeEventListener("DOMContentLoaded",o,!1),t.removeEventListener("load",o,!1),Q.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Q.expando+a.uid++}function h(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(bt,"-$1").toLowerCase(),i=t.getAttribute(n),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:xt.test(i)?Q.parseJSON(i):i)}catch(t){}yt.set(t,e,i)}else i=void 0;return i}function l(){return!0}function c(){return!1}function u(){try{return J.activeElement}catch(t){}}function d(t,e){return Q.nodeName(t,"table")&&Q.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function p(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function f(t){var e=Rt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function m(t,e){for(var i=0,n=t.length;i<n;i++)vt.set(t[i],"globalEval",!e||vt.get(e[i],"globalEval"))}function g(t,e){var i,n,s,r,o,a,h,l;if(1===e.nodeType){if(vt.hasData(t)&&(r=vt.access(t),o=vt.set(e,r),l=r.events)){delete o.handle,o.events={};for(s in l)for(i=0,n=l[s].length;i<n;i++)Q.event.add(e,s,l[s][i])}yt.hasData(t)&&(a=yt.access(t),h=Q.extend({},a),yt.set(e,h))}}function v(t,e){var i=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&Q.nodeName(t,e)?Q.merge([t],i):i}function y(t,e){var i=e.nodeName.toLowerCase();"input"===i&&Mt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function x(e,i){var n,s=Q(i.createElement(e)).appendTo(i.body),r=t.getDefaultComputedStyle&&(n=t.getDefaultComputedStyle(s[0]))?n.display:Q.css(s[0],"display");return s.detach(),r}function b(t){var e=J,i=Ut[t];return i||(i=x(t,e),"none"!==i&&i||(Ft=(Ft||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Ft[0].contentDocument,e.write(),e.close(),i=x(t,e),Ft.detach()),Ut[t]=i),i}function w(t,e,i){var n,s,r,o,a=t.style;return i=i||Wt(t),i&&(o=i.getPropertyValue(e)||i[e]),i&&(""!==o||Q.contains(t.ownerDocument,t)||(o=Q.style(t,e)),Ht.test(o)&&Vt.test(e)&&(n=a.width,s=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=n,a.minWidth=s,a.maxWidth=r)),void 0!==o?o+"":o}function _(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function S(t,e){if(e in t)return e;for(var i=e[0].toUpperCase()+e.slice(1),n=e,s=$t.length;s--;)if(e=$t[s]+i,e in t)return e;return n}function M(t,e,i){var n=Gt.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function T(t,e,i,n,s){for(var r=i===(n?"border":"content")?4:"width"===e?1:0,o=0;r<4;r+=2)"margin"===i&&(o+=Q.css(t,i+_t[r],!0,s)),n?("content"===i&&(o-=Q.css(t,"padding"+_t[r],!0,s)),"margin"!==i&&(o-=Q.css(t,"border"+_t[r]+"Width",!0,s))):(o+=Q.css(t,"padding"+_t[r],!0,s),"padding"!==i&&(o+=Q.css(t,"border"+_t[r]+"Width",!0,s)));return o}function E(t,e,i){var n=!0,s="width"===e?t.offsetWidth:t.offsetHeight,r=Wt(t),o="border-box"===Q.css(t,"boxSizing",!1,r);if(s<=0||null==s){if(s=w(t,e,r),(s<0||null==s)&&(s=t.style[e]),Ht.test(s))return s;n=o&&(Z.boxSizingReliable()||s===t.style[e]),s=parseFloat(s)||0}return s+T(t,e,i||(o?"border":"content"),n,r)+"px"}function C(t,e){for(var i,n,s,r=[],o=0,a=t.length;o<a;o++)n=t[o],n.style&&(r[o]=vt.get(n,"olddisplay"),i=n.style.display,e?(r[o]||"none"!==i||(n.style.display=""),""===n.style.display&&St(n)&&(r[o]=vt.access(n,"olddisplay",b(n.nodeName)))):(s=St(n),"none"===i&&s||vt.set(n,"olddisplay",s?i:Q.css(n,"display"))));for(o=0;o<a;o++)n=t[o],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[o]||"":"none"));return t}function A(t,e,i,n,s){return new A.prototype.init(t,e,i,n,s)}function N(){return setTimeout(function(){Zt=void 0}),Zt=Q.now()}function L(t,e){var i,n=0,s={height:t};for(e=e?1:0;n<4;n+=2-e)i=_t[n],s["margin"+i]=s["padding"+i]=t;return e&&(s.opacity=s.width=t),s}function P(t,e,i){for(var n,s=(ie[e]||[]).concat(ie["*"]),r=0,o=s.length;r<o;r++)if(n=s[r].call(i,e,t))return n}function k(t,e,i){var n,s,r,o,a,h,l,c,u=this,d={},p=t.style,f=t.nodeType&&St(t),m=vt.get(t,"fxshow");i.queue||(a=Q._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,h=a.empty.fire,a.empty.fire=function(){a.unqueued||h()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,Q.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],l=Q.css(t,"display"),c="none"===l?vt.get(t,"olddisplay")||b(t.nodeName):l,"inline"===c&&"none"===Q.css(t,"float")&&(p.display="inline-block")),i.overflow&&(p.overflow="hidden",u.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in e)if(s=e[n],Kt.exec(s)){if(delete e[n],r=r||"toggle"===s,s===(f?"hide":"show")){if("show"!==s||!m||void 0===m[n])continue;f=!0}d[n]=m&&m[n]||Q.style(t,n)}else l=void 0;if(Q.isEmptyObject(d))"inline"===("none"===l?b(t.nodeName):l)&&(p.display=l);else{m?"hidden"in m&&(f=m.hidden):m=vt.access(t,"fxshow",{}),r&&(m.hidden=!f),f?Q(t).show():u.done(function(){Q(t).hide()}),u.done(function(){var e;vt.remove(t,"fxshow");for(e in d)Q.style(t,e,d[e])});for(n in d)o=P(f?m[n]:0,n,u),n in m||(m[n]=o.start,f&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}}function I(t,e){var i,n,s,r,o;for(i in t)if(n=Q.camelCase(i),s=e[n],r=t[i],Q.isArray(r)&&(s=r[1],r=t[i]=r[0]),i!==n&&(t[n]=r,delete t[i]),o=Q.cssHooks[n],o&&"expand"in o){r=o.expand(r),delete t[n];for(i in r)i in t||(t[i]=r[i],e[i]=s)}else e[n]=s}function D(t,e,i){var n,s,r=0,o=ee.length,a=Q.Deferred().always(function(){delete h.elem}),h=function(){if(s)return!1;for(var e=Zt||N(),i=Math.max(0,l.startTime+l.duration-e),n=i/l.duration||0,r=1-n,o=0,h=l.tweens.length;o<h;o++)l.tweens[o].run(r);return a.notifyWith(t,[l,r,i]),r<1&&h?i:(a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:Q.extend({},e),opts:Q.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Zt||N(),duration:i.duration,tweens:[],createTween:function(e,i){var n=Q.Tween(t,l.opts,e,i,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var i=0,n=e?l.tweens.length:0;if(s)return this;for(s=!0;i<n;i++)l.tweens[i].run(1);return e?a.resolveWith(t,[l,e]):a.rejectWith(t,[l,e]),this}}),c=l.props;for(I(c,l.opts.specialEasing);r<o;r++)if(n=ee[r].call(l,t,c,l.opts))return n;return Q.map(c,P,l),Q.isFunction(l.opts.start)&&l.opts.start.call(t,l),Q.fx.timer(Q.extend(h,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function z(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,s=0,r=e.toLowerCase().match(pt)||[];if(Q.isFunction(i))for(;n=r[s++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function R(t,e,i,n){function s(a){var h;return r[a]=!0,Q.each(t[a]||[],function(t,a){var l=a(e,i,n);return"string"!=typeof l||o||r[l]?o?!(h=l):void 0:(e.dataTypes.unshift(l),s(l),!1)}),h}var r={},o=t===xe;return s(e.dataTypes[0])||!r["*"]&&s("*")}function O(t,e){var i,n,s=Q.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((s[i]?t:n||(n={}))[i]=e[i]);return n&&Q.extend(!0,t,n),t}function B(t,e,i){for(var n,s,r,o,a=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(s in a)if(a[s]&&a[s].test(n)){h.unshift(s);break}if(h[0]in i)r=h[0];else{for(s in i){if(!h[0]||t.converters[s+" "+h[0]]){r=s;break}o||(o=s)}r=r||o}if(r)return r!==h[0]&&h.unshift(r),i[r]}function F(t,e,i,n){var s,r,o,a,h,l={},c=t.dataTypes.slice();if(c[1])for(o in t.converters)l[o.toLowerCase()]=t.converters[o];for(r=c.shift();r;)if(t.responseFields[r]&&(i[t.responseFields[r]]=e),!h&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),h=r,r=c.shift())if("*"===r)r=h;else if("*"!==h&&h!==r){if(o=l[h+" "+r]||l["* "+r],!o)for(s in l)if(a=s.split(" "),a[1]===r&&(o=l[h+" "+a[0]]||l["* "+a[0]])){o===!0?o=l[s]:l[s]!==!0&&(r=a[0],c.unshift(a[1]));break}if(o!==!0)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+h+" to "+r}}}return{state:"success",data:e}}function U(t,e,i,n){var s;if(Q.isArray(e))Q.each(e,function(e,s){i||Me.test(t)?n(t,s):U(t+"["+("object"==typeof s?e:"")+"]",s,i,n)});else if(i||"object"!==Q.type(e))n(t,e);else for(s in e)U(t+"["+s+"]",e[s],i,n)}function V(t){return Q.isWindow(t)?t:9===t.nodeType&&t.defaultView}var H=[],W=H.slice,j=H.concat,G=H.push,X=H.indexOf,Y={},q=Y.toString,$=Y.hasOwnProperty,Z={},J=t.document,K="2.1.3",Q=function(t,e){return new Q.fn.init(t,e)},tt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,et=/^-ms-/,it=/-([\da-z])/gi,nt=function(t,e){return e.toUpperCase()};Q.fn=Q.prototype={jquery:K,constructor:Q,selector:"",length:0,toArray:function(){return W.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:W.call(this)},pushStack:function(t){var e=Q.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return Q.each(this,t,e)},map:function(t){return this.pushStack(Q.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(W.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:G,sort:H.sort,splice:H.splice},Q.extend=Q.fn.extend=function(){var t,e,i,n,s,r,o=arguments[0]||{},a=1,h=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||Q.isFunction(o)||(o={}),a===h&&(o=this,a--);a<h;a++)if(null!=(t=arguments[a]))for(e in t)i=o[e],n=t[e],o!==n&&(l&&n&&(Q.isPlainObject(n)||(s=Q.isArray(n)))?(s?(s=!1,r=i&&Q.isArray(i)?i:[]):r=i&&Q.isPlainObject(i)?i:{},o[e]=Q.extend(l,r,n)):void 0!==n&&(o[e]=n));return o},Q.extend({expando:"jQuery"+(K+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===Q.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!Q.isArray(t)&&t-parseFloat(t)+1>=0},isPlainObject:function(t){return"object"===Q.type(t)&&!t.nodeType&&!Q.isWindow(t)&&!(t.constructor&&!$.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?Y[q.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;t=Q.trim(t),t&&(1===t.indexOf("use strict")?(e=J.createElement("script"),e.text=t,J.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(et,"ms-").replace(it,nt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var s,r=0,o=t.length,a=i(t);if(n){if(a)for(;r<o&&(s=e.apply(t[r],n),s!==!1);r++);else for(r in t)if(s=e.apply(t[r],n),s===!1)break}else if(a)for(;r<o&&(s=e.call(t[r],r,t[r]),s!==!1);r++);else for(r in t)if(s=e.call(t[r],r,t[r]),s===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(tt,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?Q.merge(n,"string"==typeof t?[t]:t):G.call(n,t)),n},inArray:function(t,e,i){return null==e?-1:X.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,s=t.length;n<i;n++)t[s++]=e[n];return t.length=s,t},grep:function(t,e,i){for(var n,s=[],r=0,o=t.length,a=!i;r<o;r++)n=!e(t[r],r),n!==a&&s.push(t[r]);return s},map:function(t,e,n){var s,r=0,o=t.length,a=i(t),h=[];if(a)for(;r<o;r++)s=e(t[r],r,n),null!=s&&h.push(s);else for(r in t)s=e(t[r],r,n),null!=s&&h.push(s);return j.apply([],h)},guid:1,proxy:function(t,e){var i,n,s;if("string"==typeof e&&(i=t[e],e=t,t=i),Q.isFunction(t))return n=W.call(arguments,2),s=function(){return t.apply(e||this,n.concat(W.call(arguments)))},s.guid=t.guid=t.guid||Q.guid++,s},now:Date.now,support:Z}),Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Y["[object "+e+"]"]=e.toLowerCase()});var st=function(t){function e(t,e,i,n){var s,r,o,a,h,l,u,p,f,m;if((e?e.ownerDocument||e:U)!==k&&P(e),e=e||k,i=i||[],a=e.nodeType,"string"!=typeof t||!t||1!==a&&9!==a&&11!==a)return i;if(!n&&D){if(11!==a&&(s=yt.exec(t)))if(o=s[1]){if(9===a){if(r=e.getElementById(o),!r||!r.parentNode)return i;if(r.id===o)return i.push(r),i}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(o))&&B(e,r)&&r.id===o)return i.push(r),i}else{if(s[2])return K.apply(i,e.getElementsByTagName(t)),i;if((o=s[3])&&w.getElementsByClassName)return K.apply(i,e.getElementsByClassName(o)),i}if(w.qsa&&(!z||!z.test(t))){if(p=u=F,f=e,m=1!==a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(l=T(t),(u=e.getAttribute("id"))?p=u.replace(bt,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",h=l.length;h--;)l[h]=p+d(l[h]);f=xt.test(t)&&c(e.parentNode)||e,m=l.join(",")}if(m)try{return K.apply(i,f.querySelectorAll(m)),i}catch(t){}finally{u||e.removeAttribute("id")}}}return C(t.replace(ht,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>_.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[F]=!0,t}function s(t){var e=k.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function r(t,e){for(var i=t.split("|"),n=t.length;n--;)_.attrHandle[i[n]]=e}function o(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||Y)-(~t.sourceIndex||Y);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function h(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function l(t){return n(function(e){return e=+e,n(function(i,n){for(var s,r=t([],i.length,e),o=r.length;o--;)i[s=r[o]]&&(i[s]=!(n[s]=i[s]))})})}function c(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function u(){}function d(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function p(t,e,i){var n=e.dir,s=i&&"parentNode"===n,r=H++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,r)}:function(e,i,o){var a,h,l=[V,r];if(o){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,o))return!0}else for(;e=e[n];)if(1===e.nodeType||s){if(h=e[F]||(e[F]={}),(a=h[n])&&a[0]===V&&a[1]===r)return l[2]=a[2];if(h[n]=l,l[2]=t(e,i,o))return!0}}}function f(t){return t.length>1?function(e,i,n){for(var s=t.length;s--;)if(!t[s](e,i,n))return!1;return!0}:t[0]}function m(t,i,n){for(var s=0,r=i.length;s<r;s++)e(t,i[s],n);return n}function g(t,e,i,n,s){for(var r,o=[],a=0,h=t.length,l=null!=e;a<h;a++)(r=t[a])&&(i&&!i(r,n,s)||(o.push(r),l&&e.push(a)));return o}function v(t,e,i,s,r,o){return s&&!s[F]&&(s=v(s)),r&&!r[F]&&(r=v(r,o)),n(function(n,o,a,h){var l,c,u,d=[],p=[],f=o.length,v=n||m(e||"*",a.nodeType?[a]:a,[]),y=!t||!n&&e?v:g(v,d,t,a,h),x=i?r||(n?t:f||s)?[]:o:y;if(i&&i(y,x,a,h),s)for(l=g(x,p),s(l,[],a,h),c=l.length;c--;)(u=l[c])&&(x[p[c]]=!(y[p[c]]=u));if(n){if(r||t){if(r){for(l=[],c=x.length;c--;)(u=x[c])&&l.push(y[c]=u);r(null,x=[],l,h)}for(c=x.length;c--;)(u=x[c])&&(l=r?tt(n,u):d[c])>-1&&(n[l]=!(o[l]=u))}}else x=g(x===o?x.splice(f,x.length):x),r?r(null,o,x,h):K.apply(o,x)})}function y(t){for(var e,i,n,s=t.length,r=_.relative[t[0].type],o=r||_.relative[" "],a=r?1:0,h=p(function(t){return t===e},o,!0),l=p(function(t){return tt(e,t)>-1},o,!0),c=[function(t,i,n){var s=!r&&(n||i!==A)||((e=i).nodeType?h(t,i,n):l(t,i,n));return e=null,s}];a<s;a++)if(i=_.relative[t[a].type])c=[p(f(c),i)];else{if(i=_.filter[t[a].type].apply(null,t[a].matches),i[F]){for(n=++a;n<s&&!_.relative[t[n].type];n++);return v(a>1&&f(c),a>1&&d(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(ht,"$1"),i,a<n&&y(t.slice(a,n)),n<s&&y(t=t.slice(n)),n<s&&d(t))}c.push(i)}return f(c)}function x(t,i){var s=i.length>0,r=t.length>0,o=function(n,o,a,h,l){var c,u,d,p=0,f="0",m=n&&[],v=[],y=A,x=n||r&&_.find.TAG("*",l),b=V+=null==y?1:Math.random()||.1,w=x.length;for(l&&(A=o!==k&&o);f!==w&&null!=(c=x[f]);f++){if(r&&c){for(u=0;d=t[u++];)if(d(c,o,a)){h.push(c);break}l&&(V=b)}s&&((c=!d&&c)&&p--,n&&m.push(c))}if(p+=f,s&&f!==p){for(u=0;d=i[u++];)d(m,v,o,a);if(n){if(p>0)for(;f--;)m[f]||v[f]||(v[f]=Z.call(h));v=g(v)}K.apply(h,v),l&&!n&&v.length>0&&p+i.length>1&&e.uniqueSort(h)}return l&&(V=b,A=y),m};return s?n(o):o}var b,w,_,S,M,T,E,C,A,N,L,P,k,I,D,z,R,O,B,F="sizzle"+1*new Date,U=t.document,V=0,H=0,W=i(),j=i(),G=i(),X=function(t,e){return t===e&&(L=!0),0},Y=1<<31,q={}.hasOwnProperty,$=[],Z=$.pop,J=$.push,K=$.push,Q=$.slice,tt=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",nt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",st=nt.replace("w","w#"),rt="\\["+it+"*("+nt+")(?:"+it+"*([*^$|!~]?=)"+it+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+st+"))|)"+it+"*\\]",ot=":("+nt+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",at=new RegExp(it+"+","g"),ht=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),lt=new RegExp("^"+it+"*,"+it+"*"),ct=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),ut=new RegExp("="+it+"*([^\\]'\"]*?)"+it+"*\\]","g"),dt=new RegExp(ot),pt=new RegExp("^"+st+"$"),ft={ID:new RegExp("^#("+nt+")"),CLASS:new RegExp("^\\.("+nt+")"),TAG:new RegExp("^("+nt.replace("w","w*")+")"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+ot),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,xt=/[+~]/,bt=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),_t=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},St=function(){P()};try{K.apply($=Q.call(U.childNodes),U.childNodes),$[U.childNodes.length].nodeType}catch(t){K={apply:$.length?function(t,e){J.apply(t,Q.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}w=e.support={},M=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},P=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:U;return n!==k&&9===n.nodeType&&n.documentElement?(k=n,I=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",St,!1):i.attachEvent&&i.attachEvent("onunload",St)),D=!M(n),w.attributes=s(function(t){return t.className="i",!t.getAttribute("className")}),w.getElementsByTagName=s(function(t){return t.appendChild(n.createComment("")),!t.getElementsByTagName("*").length}),w.getElementsByClassName=vt.test(n.getElementsByClassName),w.getById=s(function(t){return I.appendChild(t).id=F,!n.getElementsByName||!n.getElementsByName(F).length}),w.getById?(_.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&D){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},_.filter.ID=function(t){var e=t.replace(wt,_t);return function(t){return t.getAttribute("id")===e}}):(delete _.find.ID,_.filter.ID=function(t){var e=t.replace(wt,_t);return function(t){var i="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),_.find.TAG=w.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):w.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],s=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[s++];)1===i.nodeType&&n.push(i);return n}return r},_.find.CLASS=w.getElementsByClassName&&function(t,e){if(D)return e.getElementsByClassName(t)},R=[],z=[],(w.qsa=vt.test(n.querySelectorAll))&&(s(function(t){I.appendChild(t).innerHTML="<a id='"+F+"'></a><select id='"+F+"-\f]' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&z.push("[*^$]="+it+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||z.push("\\["+it+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+F+"-]").length||z.push("~="),t.querySelectorAll(":checked").length||z.push(":checked"),t.querySelectorAll("a#"+F+"+*").length||z.push(".#.+[+~]")}),s(function(t){var e=n.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&z.push("name"+it+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||z.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),z.push(",.*:")})),(w.matchesSelector=vt.test(O=I.matches||I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector))&&s(function(t){w.disconnectedMatch=O.call(t,"div"),O.call(t,"[s!='']:x"),R.push("!=",ot)}),z=z.length&&new RegExp(z.join("|")),R=R.length&&new RegExp(R.join("|")),e=vt.test(I.compareDocumentPosition),B=e||vt.test(I.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},X=e?function(t,e){if(t===e)return L=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i?i:(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!w.sortDetached&&e.compareDocumentPosition(t)===i?t===n||t.ownerDocument===U&&B(U,t)?-1:e===n||e.ownerDocument===U&&B(U,e)?1:N?tt(N,t)-tt(N,e):0:4&i?-1:1)}:function(t,e){if(t===e)return L=!0,0;var i,s=0,r=t.parentNode,a=e.parentNode,h=[t],l=[e];if(!r||!a)return t===n?-1:e===n?1:r?-1:a?1:N?tt(N,t)-tt(N,e):0;if(r===a)return o(t,e);for(i=t;i=i.parentNode;)h.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;h[s]===l[s];)s++;return s?o(h[s],l[s]):h[s]===U?-1:l[s]===U?1:0},n):k},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==k&&P(t),i=i.replace(ut,"='$1']"),w.matchesSelector&&D&&(!R||!R.test(i))&&(!z||!z.test(i)))try{var n=O.call(t,i);if(n||w.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return e(i,k,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==k&&P(t),B(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==k&&P(t);var i=_.attrHandle[e.toLowerCase()],n=i&&q.call(_.attrHandle,e.toLowerCase())?i(t,e,!D):void 0;return void 0!==n?n:w.attributes||!D?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,s=0;if(L=!w.detectDuplicates,N=!w.sortStable&&t.slice(0),t.sort(X),L){for(;e=t[s++];)e===t[s]&&(n=i.push(s));for(;n--;)t.splice(i[n],1)}return N=null,t},S=e.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=S(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n++];)i+=S(e);return i},_=e.selectors={cacheLength:50,createPseudo:n,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(wt,_t),t[3]=(t[3]||t[4]||t[5]||"").replace(wt,_t),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return ft.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&dt.test(i)&&(e=T(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(wt,_t).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=W[t+" "];return e||(e=new RegExp("(^|"+it+")"+t+"("+it+"|$)"))&&W(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(s){var r=e.attr(s,t);return null==r?"!="===i:!i||(r+="","="===i?r===n:"!="===i?r!==n:"^="===i?n&&0===r.indexOf(n):"*="===i?n&&r.indexOf(n)>-1:"$="===i?n&&r.slice(-n.length)===n:"~="===i?(" "+r.replace(at," ")+" ").indexOf(n)>-1:"|="===i&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,s){var r="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===s?function(t){return!!t.parentNode}:function(e,i,h){var l,c,u,d,p,f,m=r!==o?"nextSibling":"previousSibling",g=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!h&&!a;if(g){if(r){for(;m;){for(u=e;u=u[m];)if(a?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&y){for(c=g[F]||(g[F]={}),l=c[t]||[],p=l[0]===V&&l[1],d=l[0]===V&&l[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(d=p=0)||f.pop();)if(1===u.nodeType&&++d&&u===e){c[t]=[V,p,d];break}}else if(y&&(l=(e[F]||(e[F]={}))[t])&&l[0]===V)d=l[1];else for(;(u=++p&&u&&u[m]||(d=p=0)||f.pop())&&((a?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++d||(y&&((u[F]||(u[F]={}))[t]=[V,d]),u!==e)););return d-=s,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(t,i){var s,r=_.pseudos[t]||_.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return r[F]?r(i):r.length>1?(s=[t,t,"",i],_.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,s=r(t,i),o=s.length;o--;)n=tt(t,s[o]),t[n]=!(e[n]=s[o])}):function(t){return r(t,0,s)}):r}},pseudos:{not:n(function(t){var e=[],i=[],s=E(t.replace(ht,"$1"));return s[F]?n(function(t,e,i,n){for(var r,o=s(t,null,n,[]),a=t.length;a--;)(r=o[a])&&(t[a]=!(e[a]=r))}):function(t,n,r){return e[0]=t,s(e,null,r,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(wt,_t),function(e){return(e.textContent||e.innerText||S(e)).indexOf(t)>-1}}),lang:n(function(t){return pt.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(wt,_t).toLowerCase(),function(e){var i;do if(i=D?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===I},focus:function(t){return t===k.activeElement&&(!k.hasFocus||k.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!_.pseudos.empty(t)},header:function(t){return gt.test(t.nodeName)},input:function(t){return mt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,i){return[i<0?i+e:i]}),even:l(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:l(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:l(function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t}),gt:l(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}},_.pseudos.nth=_.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[b]=a(b);for(b in{submit:!0,reset:!0})_.pseudos[b]=h(b);return u.prototype=_.filters=_.pseudos,_.setFilters=new u,T=e.tokenize=function(t,i){var n,s,r,o,a,h,l,c=j[t+" "];if(c)return i?0:c.slice(0);for(a=t,h=[],l=_.preFilter;a;){n&&!(s=lt.exec(a))||(s&&(a=a.slice(s[0].length)||a),h.push(r=[])),n=!1,(s=ct.exec(a))&&(n=s.shift(),r.push({value:n,type:s[0].replace(ht," ")}),a=a.slice(n.length));for(o in _.filter)!(s=ft[o].exec(a))||l[o]&&!(s=l[o](s))||(n=s.shift(),r.push({value:n,type:o,matches:s}),a=a.slice(n.length));if(!n)break}return i?a.length:a?e.error(t):j(t,h).slice(0)},E=e.compile=function(t,e){var i,n=[],s=[],r=G[t+" "];if(!r){for(e||(e=T(t)),i=e.length;i--;)r=y(e[i]),r[F]?n.push(r):s.push(r);r=G(t,x(s,n)),r.selector=t}return r},C=e.select=function(t,e,i,n){var s,r,o,a,h,l="function"==typeof t&&t,u=!n&&T(t=l.selector||t);if(i=i||[],1===u.length){if(r=u[0]=u[0].slice(0),r.length>2&&"ID"===(o=r[0]).type&&w.getById&&9===e.nodeType&&D&&_.relative[r[1].type]){if(e=(_.find.ID(o.matches[0].replace(wt,_t),e)||[])[0],!e)return i;l&&(e=e.parentNode),t=t.slice(r.shift().value.length)}for(s=ft.needsContext.test(t)?0:r.length;s--&&(o=r[s],!_.relative[a=o.type]);)if((h=_.find[a])&&(n=h(o.matches[0].replace(wt,_t),xt.test(r[0].type)&&c(e.parentNode)||e))){if(r.splice(s,1),t=n.length&&d(r),!t)return K.apply(i,n),i;break}}return(l||E(t,u))(n,e,!D,i,xt.test(t)&&c(e.parentNode)||e),i},w.sortStable=F.split("").sort(X).join("")===F,w.detectDuplicates=!!L,P(),w.sortDetached=s(function(t){return 1&t.compareDocumentPosition(k.createElement("div"))}),s(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||r("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),w.attributes&&s(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||r("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),s(function(t){return null==t.getAttribute("disabled")})||r(et,function(t,e,i){var n;if(!i)return t[e]===!0?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);Q.find=st,Q.expr=st.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=st.uniqueSort,Q.text=st.getText,Q.isXMLDoc=st.isXML,Q.contains=st.contains;var rt=Q.expr.match.needsContext,ot=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,at=/^.[^:#\[\.,]*$/;Q.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?Q.find.matchesSelector(n,t)?[n]:[]:Q.find.matches(t,Q.grep(e,function(t){return 1===t.nodeType}))},Q.fn.extend({find:function(t){var e,i=this.length,n=[],s=this;if("string"!=typeof t)return this.pushStack(Q(t).filter(function(){
for(e=0;e<i;e++)if(Q.contains(s[e],this))return!0}));for(e=0;e<i;e++)Q.find(t,s[e],n);return n=this.pushStack(i>1?Q.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(n(this,t||[],!1))},not:function(t){return this.pushStack(n(this,t||[],!0))},is:function(t){return!!n(this,"string"==typeof t&&rt.test(t)?Q(t):t||[],!1).length}});var ht,lt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ct=Q.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:lt.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||ht).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof Q?e[0]:e,Q.merge(this,Q.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:J,!0)),ot.test(i[1])&&Q.isPlainObject(e))for(i in e)Q.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return n=J.getElementById(i[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=J,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):Q.isFunction(t)?"undefined"!=typeof ht.ready?ht.ready(t):t(Q):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),Q.makeArray(t,this))};ct.prototype=Q.fn,ht=Q(J);var ut=/^(?:parents|prev(?:Until|All))/,dt={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(t,e,i){for(var n=[],s=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(s&&Q(t).is(i))break;n.push(t)}return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),Q.fn.extend({has:function(t){var e=Q(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(Q.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,n=0,s=this.length,r=[],o=rt.test(t)||"string"!=typeof t?Q(t,e||this.context):0;n<s;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&Q.find.matchesSelector(i,t))){r.push(i);break}return this.pushStack(r.length>1?Q.unique(r):r)},index:function(t){return t?"string"==typeof t?X.call(Q(t),this[0]):X.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(Q.unique(Q.merge(this.get(),Q(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),Q.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return Q.dir(t,"parentNode")},parentsUntil:function(t,e,i){return Q.dir(t,"parentNode",i)},next:function(t){return s(t,"nextSibling")},prev:function(t){return s(t,"previousSibling")},nextAll:function(t){return Q.dir(t,"nextSibling")},prevAll:function(t){return Q.dir(t,"previousSibling")},nextUntil:function(t,e,i){return Q.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return Q.dir(t,"previousSibling",i)},siblings:function(t){return Q.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return Q.sibling(t.firstChild)},contents:function(t){return t.contentDocument||Q.merge([],t.childNodes)}},function(t,e){Q.fn[t]=function(i,n){var s=Q.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=Q.filter(n,s)),this.length>1&&(dt[t]||Q.unique(s),ut.test(t)&&s.reverse()),this.pushStack(s)}});var pt=/\S+/g,ft={};Q.Callbacks=function(t){t="string"==typeof t?ft[t]||r(t):Q.extend({},t);var e,i,n,s,o,a,h=[],l=!t.once&&[],c=function(r){for(e=t.memory&&r,i=!0,a=s||0,s=0,o=h.length,n=!0;h&&a<o;a++)if(h[a].apply(r[0],r[1])===!1&&t.stopOnFalse){e=!1;break}n=!1,h&&(l?l.length&&c(l.shift()):e?h=[]:u.disable())},u={add:function(){if(h){var i=h.length;!function e(i){Q.each(i,function(i,n){var s=Q.type(n);"function"===s?t.unique&&u.has(n)||h.push(n):n&&n.length&&"string"!==s&&e(n)})}(arguments),n?o=h.length:e&&(s=i,c(e))}return this},remove:function(){return h&&Q.each(arguments,function(t,e){for(var i;(i=Q.inArray(e,h,i))>-1;)h.splice(i,1),n&&(i<=o&&o--,i<=a&&a--)}),this},has:function(t){return t?Q.inArray(t,h)>-1:!(!h||!h.length)},empty:function(){return h=[],o=0,this},disable:function(){return h=l=e=void 0,this},disabled:function(){return!h},lock:function(){return l=void 0,e||u.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!h||i&&!l||(e=e||[],e=[t,e.slice?e.slice():e],n?l.push(e):c(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},Q.extend({Deferred:function(t){var e=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var t=arguments;return Q.Deferred(function(i){Q.each(e,function(e,r){var o=Q.isFunction(t[e])&&t[e];s[r[1]](function(){var t=o&&o.apply(this,arguments);t&&Q.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r[0]+"With"](this===n?i.promise():this,o?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?Q.extend(t,n):n}},s={};return n.pipe=n.then,Q.each(e,function(t,r){var o=r[2],a=r[3];n[r[1]]=o.add,a&&o.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),s[r[0]]=function(){return s[r[0]+"With"](this===s?n:this,arguments),this},s[r[0]+"With"]=o.fireWith}),n.promise(s),t&&t.call(s,s),s},when:function(t){var e,i,n,s=0,r=W.call(arguments),o=r.length,a=1!==o||t&&Q.isFunction(t.promise)?o:0,h=1===a?t:Q.Deferred(),l=function(t,i,n){return function(s){i[t]=this,n[t]=arguments.length>1?W.call(arguments):s,n===e?h.notifyWith(i,n):--a||h.resolveWith(i,n)}};if(o>1)for(e=new Array(o),i=new Array(o),n=new Array(o);s<o;s++)r[s]&&Q.isFunction(r[s].promise)?r[s].promise().done(l(s,n,r)).fail(h.reject).progress(l(s,i,e)):--a;return a||h.resolveWith(n,r),h.promise()}});var mt;Q.fn.ready=function(t){return Q.ready.promise().done(t),this},Q.extend({isReady:!1,readyWait:1,holdReady:function(t){t?Q.readyWait++:Q.ready(!0)},ready:function(t){(t===!0?--Q.readyWait:Q.isReady)||(Q.isReady=!0,t!==!0&&--Q.readyWait>0||(mt.resolveWith(J,[Q]),Q.fn.triggerHandler&&(Q(J).triggerHandler("ready"),Q(J).off("ready"))))}}),Q.ready.promise=function(e){return mt||(mt=Q.Deferred(),"complete"===J.readyState?setTimeout(Q.ready):(J.addEventListener("DOMContentLoaded",o,!1),t.addEventListener("load",o,!1))),mt.promise(e)},Q.ready.promise();var gt=Q.access=function(t,e,i,n,s,r,o){var a=0,h=t.length,l=null==i;if("object"===Q.type(i)){s=!0;for(a in i)Q.access(t,e,a,i[a],!0,r,o)}else if(void 0!==n&&(s=!0,Q.isFunction(n)||(o=!0),l&&(o?(e.call(t,n),e=null):(l=e,e=function(t,e,i){return l.call(Q(t),i)})),e))for(;a<h;a++)e(t[a],i,o?n:n.call(t[a],a,e(t[a],i)));return s?t:l?e.call(t):h?e(t[0],i):r};Q.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},a.uid=1,a.accepts=Q.acceptData,a.prototype={key:function(t){if(!a.accepts(t))return 0;var e={},i=t[this.expando];if(!i){i=a.uid++;try{e[this.expando]={value:i},Object.defineProperties(t,e)}catch(n){e[this.expando]=i,Q.extend(t,e)}}return this.cache[i]||(this.cache[i]={}),i},set:function(t,e,i){var n,s=this.key(t),r=this.cache[s];if("string"==typeof e)r[e]=i;else if(Q.isEmptyObject(r))Q.extend(this.cache[s],e);else for(n in e)r[n]=e[n];return r},get:function(t,e){var i=this.cache[this.key(t)];return void 0===e?i:i[e]},access:function(t,e,i){var n;return void 0===e||e&&"string"==typeof e&&void 0===i?(n=this.get(t,e),void 0!==n?n:this.get(t,Q.camelCase(e))):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n,s,r=this.key(t),o=this.cache[r];if(void 0===e)this.cache[r]={};else{Q.isArray(e)?n=e.concat(e.map(Q.camelCase)):(s=Q.camelCase(e),e in o?n=[e,s]:(n=s,n=n in o?[n]:n.match(pt)||[])),i=n.length;for(;i--;)delete o[n[i]]}},hasData:function(t){return!Q.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var vt=new a,yt=new a,xt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,bt=/([A-Z])/g;Q.extend({hasData:function(t){return yt.hasData(t)||vt.hasData(t)},data:function(t,e,i){return yt.access(t,e,i)},removeData:function(t,e){yt.remove(t,e)},_data:function(t,e,i){return vt.access(t,e,i)},_removeData:function(t,e){vt.remove(t,e)}}),Q.fn.extend({data:function(t,e){var i,n,s,r=this[0],o=r&&r.attributes;if(void 0===t){if(this.length&&(s=yt.get(r),1===r.nodeType&&!vt.get(r,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&(n=o[i].name,0===n.indexOf("data-")&&(n=Q.camelCase(n.slice(5)),h(r,n,s[n])));vt.set(r,"hasDataAttrs",!0)}return s}return"object"==typeof t?this.each(function(){yt.set(this,t)}):gt(this,function(e){var i,n=Q.camelCase(t);if(r&&void 0===e){if(i=yt.get(r,t),void 0!==i)return i;if(i=yt.get(r,n),void 0!==i)return i;if(i=h(r,n,void 0),void 0!==i)return i}else this.each(function(){var i=yt.get(this,n);yt.set(this,n,e),t.indexOf("-")!==-1&&void 0!==i&&yt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){yt.remove(this,t)})}}),Q.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=vt.get(t,e),i&&(!n||Q.isArray(i)?n=vt.access(t,e,Q.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=Q.queue(t,e),n=i.length,s=i.shift(),r=Q._queueHooks(t,e),o=function(){Q.dequeue(t,e)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===e&&i.unshift("inprogress"),delete r.stop,s.call(t,o,r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return vt.get(t,i)||vt.access(t,i,{empty:Q.Callbacks("once memory").add(function(){vt.remove(t,[e+"queue",i])})})}}),Q.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?Q.queue(this[0],t):void 0===e?this:this.each(function(){var i=Q.queue(this,t,e);Q._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&Q.dequeue(this,t)})},dequeue:function(t){return this.each(function(){Q.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,s=Q.Deferred(),r=this,o=this.length,a=function(){--n||s.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)i=vt.get(r[o],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(a));return a(),s.promise(e)}});var wt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_t=["Top","Right","Bottom","Left"],St=function(t,e){return t=e||t,"none"===Q.css(t,"display")||!Q.contains(t.ownerDocument,t)},Mt=/^(?:checkbox|radio)$/i;!function(){var t=J.createDocumentFragment(),e=t.appendChild(J.createElement("div")),i=J.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),Z.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",Z.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Tt="undefined";Z.focusinBubbles="onfocusin"in t;var Et=/^key/,Ct=/^(?:mouse|pointer|contextmenu)|click/,At=/^(?:focusinfocus|focusoutblur)$/,Nt=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(t,e,i,n,s){var r,o,a,h,l,c,u,d,p,f,m,g=vt.get(t);if(g)for(i.handler&&(r=i,i=r.handler,s=r.selector),i.guid||(i.guid=Q.guid++),(h=g.events)||(h=g.events={}),(o=g.handle)||(o=g.handle=function(e){return typeof Q!==Tt&&Q.event.triggered!==e.type?Q.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(pt)||[""],l=e.length;l--;)a=Nt.exec(e[l])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p&&(u=Q.event.special[p]||{},p=(s?u.delegateType:u.bindType)||p,u=Q.event.special[p]||{},c=Q.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&Q.expr.match.needsContext.test(s),namespace:f.join(".")},r),(d=h[p])||(d=h[p]=[],d.delegateCount=0,u.setup&&u.setup.call(t,n,f,o)!==!1||t.addEventListener&&t.addEventListener(p,o,!1)),u.add&&(u.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),s?d.splice(d.delegateCount++,0,c):d.push(c),Q.event.global[p]=!0)},remove:function(t,e,i,n,s){var r,o,a,h,l,c,u,d,p,f,m,g=vt.hasData(t)&&vt.get(t);if(g&&(h=g.events)){for(e=(e||"").match(pt)||[""],l=e.length;l--;)if(a=Nt.exec(e[l])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p){for(u=Q.event.special[p]||{},p=(n?u.delegateType:u.bindType)||p,d=h[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=r=d.length;r--;)c=d[r],!s&&m!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(d.splice(r,1),c.selector&&d.delegateCount--,u.remove&&u.remove.call(t,c));o&&!d.length&&(u.teardown&&u.teardown.call(t,f,g.handle)!==!1||Q.removeEvent(t,p,g.handle),delete h[p])}else for(p in h)Q.event.remove(t,p+e[l],i,n,!0);Q.isEmptyObject(h)&&(delete g.handle,vt.remove(t,"events"))}},trigger:function(e,i,n,s){var r,o,a,h,l,c,u,d=[n||J],p=$.call(e,"type")?e.type:e,f=$.call(e,"namespace")?e.namespace.split("."):[];if(o=a=n=n||J,3!==n.nodeType&&8!==n.nodeType&&!At.test(p+Q.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),l=p.indexOf(":")<0&&"on"+p,e=e[Q.expando]?e:new Q.Event(p,"object"==typeof e&&e),e.isTrigger=s?2:3,e.namespace=f.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:Q.makeArray(i,[e]),u=Q.event.special[p]||{},s||!u.trigger||u.trigger.apply(n,i)!==!1)){if(!s&&!u.noBubble&&!Q.isWindow(n)){for(h=u.delegateType||p,At.test(h+p)||(o=o.parentNode);o;o=o.parentNode)d.push(o),a=o;a===(n.ownerDocument||J)&&d.push(a.defaultView||a.parentWindow||t)}for(r=0;(o=d[r++])&&!e.isPropagationStopped();)e.type=r>1?h:u.bindType||p,c=(vt.get(o,"events")||{})[e.type]&&vt.get(o,"handle"),c&&c.apply(o,i),c=l&&o[l],c&&c.apply&&Q.acceptData(o)&&(e.result=c.apply(o,i),e.result===!1&&e.preventDefault());return e.type=p,s||e.isDefaultPrevented()||u._default&&u._default.apply(d.pop(),i)!==!1||!Q.acceptData(n)||l&&Q.isFunction(n[p])&&!Q.isWindow(n)&&(a=n[l],a&&(n[l]=null),Q.event.triggered=p,n[p](),Q.event.triggered=void 0,a&&(n[l]=a)),e.result}},dispatch:function(t){t=Q.event.fix(t);var e,i,n,s,r,o=[],a=W.call(arguments),h=(vt.get(this,"events")||{})[t.type]||[],l=Q.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,t)!==!1){for(o=Q.event.handlers.call(this,t,h),e=0;(s=o[e++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,i=0;(r=s.handlers[i++])&&!t.isImmediatePropagationStopped();)t.namespace_re&&!t.namespace_re.test(r.namespace)||(t.handleObj=r,t.data=r.data,n=((Q.event.special[r.origType]||{}).handle||r.handler).apply(s.elem,a),void 0!==n&&(t.result=n)===!1&&(t.preventDefault(),t.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,s,r,o=[],a=e.delegateCount,h=t.target;if(a&&h.nodeType&&(!t.button||"click"!==t.type))for(;h!==this;h=h.parentNode||this)if(h.disabled!==!0||"click"!==t.type){for(n=[],i=0;i<a;i++)r=e[i],s=r.selector+" ",void 0===n[s]&&(n[s]=r.needsContext?Q(s,this).index(h)>=0:Q.find(s,this,null,[h]).length),n[s]&&n.push(r);n.length&&o.push({elem:h,handlers:n})}return a<e.length&&o.push({elem:this,handlers:e.slice(a)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,s,r=e.button;return null==t.pageX&&null!=e.clientX&&(i=t.target.ownerDocument||J,n=i.documentElement,s=i.body,t.pageX=e.clientX+(n&&n.scrollLeft||s&&s.scrollLeft||0)-(n&&n.clientLeft||s&&s.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||s&&s.scrollTop||0)-(n&&n.clientTop||s&&s.clientTop||0)),t.which||void 0===r||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[Q.expando])return t;var e,i,n,s=t.type,r=t,o=this.fixHooks[s];for(o||(this.fixHooks[s]=o=Ct.test(s)?this.mouseHooks:Et.test(s)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,t=new Q.Event(r),e=n.length;e--;)i=n[e],t[i]=r[i];return t.target||(t.target=J),3===t.target.nodeType&&(t.target=t.target.parentNode),o.filter?o.filter(t,r):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==u()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===u()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&Q.nodeName(this,"input"))return this.click(),!1},_default:function(t){return Q.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var s=Q.extend(new Q.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?Q.event.trigger(s,null,e):Q.event.dispatch.call(e,s),s.isDefaultPrevented()&&i.preventDefault()}},Q.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)},Q.Event=function(t,e){return this instanceof Q.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?l:c):this.type=t,e&&Q.extend(this,e),this.timeStamp=t&&t.timeStamp||Q.now(),void(this[Q.expando]=!0)):new Q.Event(t,e)},Q.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=l,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=l,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=l,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){Q.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,s=t.relatedTarget,r=t.handleObj;return s&&(s===n||Q.contains(n,s))||(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),Z.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){Q.event.simulate(e,t.target,Q.event.fix(t),!0)};Q.event.special[e]={setup:function(){var n=this.ownerDocument||this,s=vt.access(n,e);s||n.addEventListener(t,i,!0),vt.access(n,e,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this,s=vt.access(n,e)-1;s?vt.access(n,e,s):(n.removeEventListener(t,i,!0),vt.remove(n,e))}}}),Q.fn.extend({on:function(t,e,i,n,s){var r,o;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=void 0);for(o in t)this.on(o,e,i,t[o],s);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),n===!1)n=c;else if(!n)return this;return 1===s&&(r=n,n=function(t){return Q().off(t),r.apply(this,arguments)},n.guid=r.guid||(r.guid=Q.guid++)),this.each(function(){Q.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,s;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,Q(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(s in t)this.off(s,e,t[s]);return this}return e!==!1&&"function"!=typeof e||(i=e,e=void 0),i===!1&&(i=c),this.each(function(){Q.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){Q.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return Q.event.trigger(t,e,i,!0)}});var Lt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Pt=/<([\w:]+)/,kt=/<|&#?\w+;/,It=/<(?:script|style|link)/i,Dt=/checked\s*(?:[^=]|=\s*.checked.)/i,zt=/^$|\/(?:java|ecma)script/i,Rt=/^true\/(.*)/,Ot=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Bt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Bt.optgroup=Bt.option,Bt.tbody=Bt.tfoot=Bt.colgroup=Bt.caption=Bt.thead,Bt.th=Bt.td,Q.extend({clone:function(t,e,i){var n,s,r,o,a=t.cloneNode(!0),h=Q.contains(t.ownerDocument,t);if(!(Z.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||Q.isXMLDoc(t)))for(o=v(a),r=v(t),n=0,s=r.length;n<s;n++)y(r[n],o[n]);if(e)if(i)for(r=r||v(t),o=o||v(a),n=0,s=r.length;n<s;n++)g(r[n],o[n]);else g(t,a);return o=v(a,"script"),o.length>0&&m(o,!h&&v(t,"script")),a},buildFragment:function(t,e,i,n){for(var s,r,o,a,h,l,c=e.createDocumentFragment(),u=[],d=0,p=t.length;d<p;d++)if(s=t[d],s||0===s)if("object"===Q.type(s))Q.merge(u,s.nodeType?[s]:s);else if(kt.test(s)){for(r=r||c.appendChild(e.createElement("div")),o=(Pt.exec(s)||["",""])[1].toLowerCase(),a=Bt[o]||Bt._default,r.innerHTML=a[1]+s.replace(Lt,"<$1></$2>")+a[2],l=a[0];l--;)r=r.lastChild;Q.merge(u,r.childNodes),r=c.firstChild,r.textContent=""}else u.push(e.createTextNode(s));for(c.textContent="",d=0;s=u[d++];)if((!n||Q.inArray(s,n)===-1)&&(h=Q.contains(s.ownerDocument,s),r=v(c.appendChild(s),"script"),h&&m(r),i))for(l=0;s=r[l++];)zt.test(s.type||"")&&i.push(s);return c},cleanData:function(t){for(var e,i,n,s,r=Q.event.special,o=0;void 0!==(i=t[o]);o++){if(Q.acceptData(i)&&(s=i[vt.expando],s&&(e=vt.cache[s]))){if(e.events)for(n in e.events)r[n]?Q.event.remove(i,n):Q.removeEvent(i,n,e.handle);vt.cache[s]&&delete vt.cache[s]}delete yt.cache[i[yt.expando]]}}}),Q.fn.extend({text:function(t){return gt(this,function(t){return void 0===t?Q.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?Q.filter(t,this):this,s=0;null!=(i=n[s]);s++)e||1!==i.nodeType||Q.cleanData(v(i)),i.parentNode&&(e&&Q.contains(i.ownerDocument,i)&&m(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(Q.cleanData(v(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return Q.clone(this,t,e)})},html:function(t){return gt(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!It.test(t)&&!Bt[(Pt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Lt,"<$1></$2>");try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(Q.cleanData(v(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,Q.cleanData(v(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=j.apply([],t);var i,n,s,r,o,a,h=0,l=this.length,c=this,u=l-1,d=t[0],m=Q.isFunction(d);if(m||l>1&&"string"==typeof d&&!Z.checkClone&&Dt.test(d))return this.each(function(i){var n=c.eq(i);m&&(t[0]=d.call(this,i,n.html())),n.domManip(t,e)});if(l&&(i=Q.buildFragment(t,this[0].ownerDocument,!1,this),n=i.firstChild,1===i.childNodes.length&&(i=n),n)){for(s=Q.map(v(i,"script"),p),r=s.length;h<l;h++)o=i,h!==u&&(o=Q.clone(o,!0,!0),r&&Q.merge(s,v(o,"script"))),e.call(this[h],o,h);if(r)for(a=s[s.length-1].ownerDocument,Q.map(s,f),h=0;h<r;h++)o=s[h],zt.test(o.type||"")&&!vt.access(o,"globalEval")&&Q.contains(a,o)&&(o.src?Q._evalUrl&&Q._evalUrl(o.src):Q.globalEval(o.textContent.replace(Ot,"")))}return this}}),Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){Q.fn[t]=function(t){for(var i,n=[],s=Q(t),r=s.length-1,o=0;o<=r;o++)i=o===r?this:this.clone(!0),Q(s[o])[e](i),G.apply(n,i.get());return this.pushStack(n)}});var Ft,Ut={},Vt=/^margin/,Ht=new RegExp("^("+wt+")(?!px)[a-z%]+$","i"),Wt=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):t.getComputedStyle(e,null)};!function(){function e(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o.innerHTML="",s.appendChild(r);var e=t.getComputedStyle(o,null);i="1%"!==e.top,n="4px"===e.width,s.removeChild(r)}var i,n,s=J.documentElement,r=J.createElement("div"),o=J.createElement("div");o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===o.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(o),t.getComputedStyle&&Q.extend(Z,{pixelPosition:function(){return e(),i},boxSizingReliable:function(){return null==n&&e(),n},reliableMarginRight:function(){var e,i=o.appendChild(J.createElement("div"));return i.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",o.style.width="1px",s.appendChild(r),e=!parseFloat(t.getComputedStyle(i,null).marginRight),s.removeChild(r),o.removeChild(i),e}}))}(),Q.swap=function(t,e,i,n){var s,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];s=i.apply(t,n||[]);for(r in e)t.style[r]=o[r];return s};var jt=/^(none|table(?!-c[ea]).+)/,Gt=new RegExp("^("+wt+")(.*)$","i"),Xt=new RegExp("^([+-])=("+wt+")","i"),Yt={position:"absolute",visibility:"hidden",display:"block"},qt={letterSpacing:"0",fontWeight:"400"},$t=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=w(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,r,o,a=Q.camelCase(e),h=t.style;return e=Q.cssProps[a]||(Q.cssProps[a]=S(h,a)),o=Q.cssHooks[e]||Q.cssHooks[a],void 0===i?o&&"get"in o&&void 0!==(s=o.get(t,!1,n))?s:h[e]:(r=typeof i,"string"===r&&(s=Xt.exec(i))&&(i=(s[1]+1)*s[2]+parseFloat(Q.css(t,e)),r="number"),null!=i&&i===i&&("number"!==r||Q.cssNumber[a]||(i+="px"),Z.clearCloneStyle||""!==i||0!==e.indexOf("background")||(h[e]="inherit"),o&&"set"in o&&void 0===(i=o.set(t,i,n))||(h[e]=i)),void 0)}},css:function(t,e,i,n){var s,r,o,a=Q.camelCase(e);return e=Q.cssProps[a]||(Q.cssProps[a]=S(t.style,a)),o=Q.cssHooks[e]||Q.cssHooks[a],o&&"get"in o&&(s=o.get(t,!0,i)),void 0===s&&(s=w(t,e,n)),"normal"===s&&e in qt&&(s=qt[e]),""===i||i?(r=parseFloat(s),i===!0||Q.isNumeric(r)?r||0:s):s}}),Q.each(["height","width"],function(t,e){Q.cssHooks[e]={get:function(t,i,n){if(i)return jt.test(Q.css(t,"display"))&&0===t.offsetWidth?Q.swap(t,Yt,function(){return E(t,e,n)}):E(t,e,n)},set:function(t,i,n){var s=n&&Wt(t);return M(t,i,n?T(t,e,n,"border-box"===Q.css(t,"boxSizing",!1,s),s):0)}}}),Q.cssHooks.marginRight=_(Z.reliableMarginRight,function(t,e){if(e)return Q.swap(t,{display:"inline-block"},w,[t,"marginRight"])}),Q.each({margin:"",padding:"",border:"Width"},function(t,e){Q.cssHooks[t+e]={expand:function(i){for(var n=0,s={},r="string"==typeof i?i.split(" "):[i];n<4;n++)s[t+_t[n]+e]=r[n]||r[n-2]||r[0];return s}},Vt.test(t)||(Q.cssHooks[t+e].set=M)}),Q.fn.extend({css:function(t,e){return gt(this,function(t,e,i){var n,s,r={},o=0;if(Q.isArray(e)){for(n=Wt(t),s=e.length;o<s;o++)r[e[o]]=Q.css(t,e[o],!1,n);return r}return void 0!==i?Q.style(t,e,i):Q.css(t,e)},t,e,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){St(this)?Q(this).show():Q(this).hide()})}}),Q.Tween=A,A.prototype={constructor:A,init:function(t,e,i,n,s,r){this.elem=t,this.prop=i,this.easing=s||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(Q.cssNumber[i]?"":"px")},cur:function(){var t=A.propHooks[this.prop];return t&&t.get?t.get(this):A.propHooks._default.get(this)},run:function(t){var e,i=A.propHooks[this.prop];return this.options.duration?this.pos=e=Q.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=Q.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){Q.fx.step[t.prop]?Q.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[Q.cssProps[t.prop]]||Q.cssHooks[t.prop])?Q.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},Q.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},Q.fx=A.prototype.init,Q.fx.step={};var Zt,Jt,Kt=/^(?:toggle|show|hide)$/,Qt=new RegExp("^(?:([+-])=|)("+wt+")([a-z%]*)$","i"),te=/queueHooks$/,ee=[k],ie={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),s=Qt.exec(e),r=s&&s[3]||(Q.cssNumber[t]?"":"px"),o=(Q.cssNumber[t]||"px"!==r&&+n)&&Qt.exec(Q.css(i.elem,t)),a=1,h=20;if(o&&o[3]!==r){r=r||o[3],s=s||[],o=+n||1;do a=a||".5",o/=a,Q.style(i.elem,t,o+r);while(a!==(a=i.cur()/n)&&1!==a&&--h)}return s&&(o=i.start=+o||+n||0,i.unit=r,i.end=s[1]?o+(s[1]+1)*s[2]:+s[2]),i}]};Q.Animation=Q.extend(D,{tweener:function(t,e){Q.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,s=t.length;n<s;n++)i=t[n],ie[i]=ie[i]||[],ie[i].unshift(e)},prefilter:function(t,e){e?ee.unshift(t):ee.push(t)}}),Q.speed=function(t,e,i){var n=t&&"object"==typeof t?Q.extend({},t):{complete:i||!i&&e||Q.isFunction(t)&&t,duration:t,easing:i&&e||e&&!Q.isFunction(e)&&e};return n.duration=Q.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in Q.fx.speeds?Q.fx.speeds[n.duration]:Q.fx.speeds._default,null!=n.queue&&n.queue!==!0||(n.queue="fx"),n.old=n.complete,n.complete=function(){Q.isFunction(n.old)&&n.old.call(this),n.queue&&Q.dequeue(this,n.queue)},n},Q.fn.extend({fadeTo:function(t,e,i,n){return this.filter(St).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var s=Q.isEmptyObject(t),r=Q.speed(e,i,n),o=function(){var e=D(this,Q.extend({},t),r);(s||vt.get(this,"finish"))&&e.stop(!0)};return o.finish=o,s||r.queue===!1?this.each(o):this.queue(r.queue,o)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,s=null!=t&&t+"queueHooks",r=Q.timers,o=vt.get(this);if(s)o[s]&&o[s].stop&&n(o[s]);else for(s in o)o[s]&&o[s].stop&&te.test(s)&&n(o[s]);for(s=r.length;s--;)r[s].elem!==this||null!=t&&r[s].queue!==t||(r[s].anim.stop(i),e=!1,r.splice(s,1));!e&&i||Q.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=vt.get(this),n=i[t+"queue"],s=i[t+"queueHooks"],r=Q.timers,o=n?n.length:0;for(i.finish=!0,Q.queue(this,t,[]),s&&s.stop&&s.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));
for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),Q.each(["toggle","show","hide"],function(t,e){var i=Q.fn[e];Q.fn[e]=function(t,n,s){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(L(e,!0),t,n,s)}}),Q.each({slideDown:L("show"),slideUp:L("hide"),slideToggle:L("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){Q.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),Q.timers=[],Q.fx.tick=function(){var t,e=0,i=Q.timers;for(Zt=Q.now();e<i.length;e++)t=i[e],t()||i[e]!==t||i.splice(e--,1);i.length||Q.fx.stop(),Zt=void 0},Q.fx.timer=function(t){Q.timers.push(t),t()?Q.fx.start():Q.timers.pop()},Q.fx.interval=13,Q.fx.start=function(){Jt||(Jt=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.stop=function(){clearInterval(Jt),Jt=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fn.delay=function(t,e){return t=Q.fx?Q.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},function(){var t=J.createElement("input"),e=J.createElement("select"),i=e.appendChild(J.createElement("option"));t.type="checkbox",Z.checkOn=""!==t.value,Z.optSelected=i.selected,e.disabled=!0,Z.optDisabled=!i.disabled,t=J.createElement("input"),t.value="t",t.type="radio",Z.radioValue="t"===t.value}();var ne,se,re=Q.expr.attrHandle;Q.fn.extend({attr:function(t,e){return gt(this,Q.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){Q.removeAttr(this,t)})}}),Q.extend({attr:function(t,e,i){var n,s,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return typeof t.getAttribute===Tt?Q.prop(t,e,i):(1===r&&Q.isXMLDoc(t)||(e=e.toLowerCase(),n=Q.attrHooks[e]||(Q.expr.match.bool.test(e)?se:ne)),void 0===i?n&&"get"in n&&null!==(s=n.get(t,e))?s:(s=Q.find.attr(t,e),null==s?void 0:s):null!==i?n&&"set"in n&&void 0!==(s=n.set(t,i,e))?s:(t.setAttribute(e,i+""),i):void Q.removeAttr(t,e))},removeAttr:function(t,e){var i,n,s=0,r=e&&e.match(pt);if(r&&1===t.nodeType)for(;i=r[s++];)n=Q.propFix[i]||i,Q.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)},attrHooks:{type:{set:function(t,e){if(!Z.radioValue&&"radio"===e&&Q.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),se={set:function(t,e,i){return e===!1?Q.removeAttr(t,i):t.setAttribute(i,i),i}},Q.each(Q.expr.match.bool.source.match(/\w+/g),function(t,e){var i=re[e]||Q.find.attr;re[e]=function(t,e,n){var s,r;return n||(r=re[e],re[e]=s,s=null!=i(t,e,n)?e.toLowerCase():null,re[e]=r),s}});var oe=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(t,e){return gt(this,Q.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[Q.propFix[t]||t]})}}),Q.extend({propFix:{for:"htmlFor",class:"className"},prop:function(t,e,i){var n,s,r,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return r=1!==o||!Q.isXMLDoc(t),r&&(e=Q.propFix[e]||e,s=Q.propHooks[e]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(t,i,e))?n:t[e]=i:s&&"get"in s&&null!==(n=s.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||oe.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),Z.optSelected||(Q.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Q.propFix[this.toLowerCase()]=this});var ae=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(t){var e,i,n,s,r,o,a="string"==typeof t&&t,h=0,l=this.length;if(Q.isFunction(t))return this.each(function(e){Q(this).addClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(pt)||[];h<l;h++)if(i=this[h],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ae," "):" ")){for(r=0;s=e[r++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");o=Q.trim(n),i.className!==o&&(i.className=o)}return this},removeClass:function(t){var e,i,n,s,r,o,a=0===arguments.length||"string"==typeof t&&t,h=0,l=this.length;if(Q.isFunction(t))return this.each(function(e){Q(this).removeClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(pt)||[];h<l;h++)if(i=this[h],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ae," "):"")){for(r=0;s=e[r++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");o=t?Q.trim(n):"",i.className!==o&&(i.className=o)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):Q.isFunction(t)?this.each(function(i){Q(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var e,n=0,s=Q(this),r=t.match(pt)||[];e=r[n++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else i!==Tt&&"boolean"!==i||(this.className&&vt.set(this,"__className__",this.className),this.className=this.className||t===!1?"":vt.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(ae," ").indexOf(e)>=0)return!0;return!1}});var he=/\r/g;Q.fn.extend({val:function(t){var e,i,n,s=this[0];{if(arguments.length)return n=Q.isFunction(t),this.each(function(i){var s;1===this.nodeType&&(s=n?t.call(this,i,Q(this).val()):t,null==s?s="":"number"==typeof s?s+="":Q.isArray(s)&&(s=Q.map(s,function(t){return null==t?"":t+""})),e=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,s,"value")||(this.value=s))});if(s)return e=Q.valHooks[s.type]||Q.valHooks[s.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(s,"value"))?i:(i=s.value,"string"==typeof i?i.replace(he,""):null==i?"":i)}}}),Q.extend({valHooks:{option:{get:function(t){var e=Q.find.attr(t,"value");return null!=e?e:Q.trim(Q.text(t))}},select:{get:function(t){for(var e,i,n=t.options,s=t.selectedIndex,r="select-one"===t.type||s<0,o=r?null:[],a=r?s+1:n.length,h=s<0?a:r?s:0;h<a;h++)if(i=n[h],(i.selected||h===s)&&(Z.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!Q.nodeName(i.parentNode,"optgroup"))){if(e=Q(i).val(),r)return e;o.push(e)}return o},set:function(t,e){for(var i,n,s=t.options,r=Q.makeArray(e),o=s.length;o--;)n=s[o],(n.selected=Q.inArray(n.value,r)>=0)&&(i=!0);return i||(t.selectedIndex=-1),r}}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]={set:function(t,e){if(Q.isArray(e))return t.checked=Q.inArray(Q(t).val(),e)>=0}},Z.checkOn||(Q.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){Q.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),Q.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var le=Q.now(),ce=/\?/;Q.parseJSON=function(t){return JSON.parse(t+"")},Q.parseXML=function(t){var e,i;if(!t||"string"!=typeof t)return null;try{i=new DOMParser,e=i.parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||Q.error("Invalid XML: "+t),e};var ue=/#.*$/,de=/([?&])_=[^&]*/,pe=/^(.*?):[ \t]*([^\r\n]*)$/gm,fe=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,me=/^(?:GET|HEAD)$/,ge=/^\/\//,ve=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ye={},xe={},be="*/".concat("*"),we=t.location.href,_e=ve.exec(we.toLowerCase())||[];Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:we,type:"GET",isLocal:fe.test(_e[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":be,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?O(O(t,Q.ajaxSettings),e):O(Q.ajaxSettings,t)},ajaxPrefilter:z(ye),ajaxTransport:z(xe),ajax:function(t,e){function i(t,e,i,o){var h,c,v,y,b,_=e;2!==x&&(x=2,a&&clearTimeout(a),n=void 0,r=o||"",w.readyState=t>0?4:0,h=t>=200&&t<300||304===t,i&&(y=B(u,w,i)),y=F(u,y,w,h),h?(u.ifModified&&(b=w.getResponseHeader("Last-Modified"),b&&(Q.lastModified[s]=b),b=w.getResponseHeader("etag"),b&&(Q.etag[s]=b)),204===t||"HEAD"===u.type?_="nocontent":304===t?_="notmodified":(_=y.state,c=y.data,v=y.error,h=!v)):(v=_,!t&&_||(_="error",t<0&&(t=0))),w.status=t,w.statusText=(e||_)+"",h?f.resolveWith(d,[c,_,w]):f.rejectWith(d,[w,_,v]),w.statusCode(g),g=void 0,l&&p.trigger(h?"ajaxSuccess":"ajaxError",[w,u,h?c:v]),m.fireWith(d,[w,_]),l&&(p.trigger("ajaxComplete",[w,u]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,s,r,o,a,h,l,c,u=Q.ajaxSetup({},e),d=u.context||u,p=u.context&&(d.nodeType||d.jquery)?Q(d):Q.event,f=Q.Deferred(),m=Q.Callbacks("once memory"),g=u.statusCode||{},v={},y={},x=0,b="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===x){if(!o)for(o={};e=pe.exec(r);)o[e[1].toLowerCase()]=e[2];e=o[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===x?r:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return x||(t=y[i]=y[i]||t,v[t]=e),this},overrideMimeType:function(t){return x||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(x<2)for(e in t)g[e]=[g[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||b;return n&&n.abort(e),i(0,e),this}};if(f.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,u.url=((t||u.url||we)+"").replace(ue,"").replace(ge,_e[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=Q.trim(u.dataType||"*").toLowerCase().match(pt)||[""],null==u.crossDomain&&(h=ve.exec(u.url.toLowerCase()),u.crossDomain=!(!h||h[1]===_e[1]&&h[2]===_e[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(_e[3]||("http:"===_e[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=Q.param(u.data,u.traditional)),R(ye,u,e,w),2===x)return w;l=Q.event&&u.global,l&&0===Q.active++&&Q.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!me.test(u.type),s=u.url,u.hasContent||(u.data&&(s=u.url+=(ce.test(s)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=de.test(s)?s.replace(de,"$1_="+le++):s+(ce.test(s)?"&":"?")+"_="+le++)),u.ifModified&&(Q.lastModified[s]&&w.setRequestHeader("If-Modified-Since",Q.lastModified[s]),Q.etag[s]&&w.setRequestHeader("If-None-Match",Q.etag[s])),(u.data&&u.hasContent&&u.contentType!==!1||e.contentType)&&w.setRequestHeader("Content-Type",u.contentType),w.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+be+"; q=0.01":""):u.accepts["*"]);for(c in u.headers)w.setRequestHeader(c,u.headers[c]);if(u.beforeSend&&(u.beforeSend.call(d,w,u)===!1||2===x))return w.abort();b="abort";for(c in{success:1,error:1,complete:1})w[c](u[c]);if(n=R(xe,u,e,w)){w.readyState=1,l&&p.trigger("ajaxSend",[w,u]),u.async&&u.timeout>0&&(a=setTimeout(function(){w.abort("timeout")},u.timeout));try{x=1,n.send(v,i)}catch(t){if(!(x<2))throw t;i(-1,t)}}else i(-1,"No Transport");return w},getJSON:function(t,e,i){return Q.get(t,e,i,"json")},getScript:function(t,e){return Q.get(t,void 0,e,"script")}}),Q.each(["get","post"],function(t,e){Q[e]=function(t,i,n,s){return Q.isFunction(i)&&(s=s||n,n=i,i=void 0),Q.ajax({url:t,type:e,dataType:s,data:i,success:n})}}),Q._evalUrl=function(t){return Q.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},Q.fn.extend({wrapAll:function(t){var e;return Q.isFunction(t)?this.each(function(e){Q(this).wrapAll(t.call(this,e))}):(this[0]&&(e=Q(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return Q.isFunction(t)?this.each(function(e){Q(this).wrapInner(t.call(this,e))}):this.each(function(){var e=Q(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=Q.isFunction(t);return this.each(function(i){Q(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()}}),Q.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},Q.expr.filters.visible=function(t){return!Q.expr.filters.hidden(t)};var Se=/%20/g,Me=/\[\]$/,Te=/\r?\n/g,Ee=/^(?:submit|button|image|reset|file)$/i,Ce=/^(?:input|select|textarea|keygen)/i;Q.param=function(t,e){var i,n=[],s=function(t,e){e=Q.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(t)||t.jquery&&!Q.isPlainObject(t))Q.each(t,function(){s(this.name,this.value)});else for(i in t)U(i,t[i],e,s);return n.join("&").replace(Se,"+")},Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=Q.prop(this,"elements");return t?Q.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!Q(this).is(":disabled")&&Ce.test(this.nodeName)&&!Ee.test(t)&&(this.checked||!Mt.test(t))}).map(function(t,e){var i=Q(this).val();return null==i?null:Q.isArray(i)?Q.map(i,function(t){return{name:e.name,value:t.replace(Te,"\r\n")}}):{name:e.name,value:i.replace(Te,"\r\n")}}).get()}}),Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Ae=0,Ne={},Le={0:200,1223:204},Pe=Q.ajaxSettings.xhr();t.attachEvent&&t.attachEvent("onunload",function(){for(var t in Ne)Ne[t]()}),Z.cors=!!Pe&&"withCredentials"in Pe,Z.ajax=Pe=!!Pe,Q.ajaxTransport(function(t){var e;if(Z.cors||Pe&&!t.crossDomain)return{send:function(i,n){var s,r=t.xhr(),o=++Ae;if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)r[s]=t.xhrFields[s];t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)r.setRequestHeader(s,i[s]);e=function(t){return function(){e&&(delete Ne[o],e=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?n(r.status,r.statusText):n(Le[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=e(),r.onerror=e("error"),e=Ne[o]=e("abort");try{r.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return Q.globalEval(t),t}}}),Q.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),Q.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(n,s){e=Q("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&s("error"===t.type?404:200,t.type)}),J.head.appendChild(e[0])},abort:function(){i&&i()}}}});var ke=[],Ie=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ke.pop()||Q.expando+"_"+le++;return this[t]=!0,t}}),Q.ajaxPrefilter("json jsonp",function(e,i,n){var s,r,o,a=e.jsonp!==!1&&(Ie.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ie.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return s=e.jsonpCallback=Q.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ie,"$1"+s):e.jsonp!==!1&&(e.url+=(ce.test(e.url)?"&":"?")+e.jsonp+"="+s),e.converters["script json"]=function(){return o||Q.error(s+" was not called"),o[0]},e.dataTypes[0]="json",r=t[s],t[s]=function(){o=arguments},n.always(function(){t[s]=r,e[s]&&(e.jsonpCallback=i.jsonpCallback,ke.push(s)),o&&Q.isFunction(r)&&r(o[0]),o=r=void 0}),"script"}),Q.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||J;var n=ot.exec(t),s=!i&&[];return n?[e.createElement(n[1])]:(n=Q.buildFragment([t],e,s),s&&s.length&&Q(s).remove(),Q.merge([],n.childNodes))};var De=Q.fn.load;Q.fn.load=function(t,e,i){if("string"!=typeof t&&De)return De.apply(this,arguments);var n,s,r,o=this,a=t.indexOf(" ");return a>=0&&(n=Q.trim(t.slice(a)),t=t.slice(0,a)),Q.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(s="POST"),o.length>0&&Q.ajax({url:t,type:s,dataType:"html",data:e}).done(function(t){r=arguments,o.html(n?Q("<div>").append(Q.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){o.each(i,r||[t.responseText,e,t])}),this},Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){Q.fn[e]=function(t){return this.on(e,t)}}),Q.expr.filters.animated=function(t){return Q.grep(Q.timers,function(e){return t===e.elem}).length};var ze=t.document.documentElement;Q.offset={setOffset:function(t,e,i){var n,s,r,o,a,h,l,c=Q.css(t,"position"),u=Q(t),d={};"static"===c&&(t.style.position="relative"),a=u.offset(),r=Q.css(t,"top"),h=Q.css(t,"left"),l=("absolute"===c||"fixed"===c)&&(r+h).indexOf("auto")>-1,l?(n=u.position(),o=n.top,s=n.left):(o=parseFloat(r)||0,s=parseFloat(h)||0),Q.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(d.top=e.top-a.top+o),null!=e.left&&(d.left=e.left-a.left+s),"using"in e?e.using.call(t,d):u.css(d)}},Q.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){Q.offset.setOffset(this,t,e)});var e,i,n=this[0],s={top:0,left:0},r=n&&n.ownerDocument;if(r)return e=r.documentElement,Q.contains(e,n)?(typeof n.getBoundingClientRect!==Tt&&(s=n.getBoundingClientRect()),i=V(r),{top:s.top+i.pageYOffset-e.clientTop,left:s.left+i.pageXOffset-e.clientLeft}):s},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===Q.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),Q.nodeName(t[0],"html")||(n=t.offset()),n.top+=Q.css(t[0],"borderTopWidth",!0),n.left+=Q.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-Q.css(i,"marginTop",!0),left:e.left-n.left-Q.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||ze;t&&!Q.nodeName(t,"html")&&"static"===Q.css(t,"position");)t=t.offsetParent;return t||ze})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n="pageYOffset"===i;Q.fn[e]=function(s){return gt(this,function(e,s,r){var o=V(e);return void 0===r?o?o[i]:e[s]:void(o?o.scrollTo(n?t.pageXOffset:r,n?r:t.pageYOffset):e[s]=r)},e,s,arguments.length,null)}}),Q.each(["top","left"],function(t,e){Q.cssHooks[e]=_(Z.pixelPosition,function(t,i){if(i)return i=w(t,e),Ht.test(i)?Q(t).position()[e]+"px":i})}),Q.each({Height:"height",Width:"width"},function(t,e){Q.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){Q.fn[n]=function(n,s){var r=arguments.length&&(i||"boolean"!=typeof n),o=i||(n===!0||s===!0?"margin":"border");return gt(this,function(e,i,n){var s;return Q.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===n?Q.css(e,i,o):Q.style(e,i,n,o)},e,r?n:void 0,r,null)}})}),Q.fn.size=function(){return this.length},Q.fn.andSelf=Q.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Q});var Re=t.jQuery,Oe=t.$;return Q.noConflict=function(e){return t.$===Q&&(t.$=Oe),e&&t.jQuery===Q&&(t.jQuery=Re),Q},typeof e===Tt&&(t.jQuery=t.$=Q),Q}),define("wpFunc/functions",["jquery"],function(t){!function(t){function e(e){var i=t("<button />",{class:"dropdown-toggle","aria-expanded":!1}).append(t("<span />",{class:"screen-reader-text",text:screenReaderText.expand}));e.find(".menu-item-has-children > a").after(i),e.find(".current-menu-ancestor > button").addClass("toggled-on"),e.find(".current-menu-ancestor > .sub-menu").addClass("toggled-on"),e.find(".menu-item-has-children").attr("aria-haspopup","true"),e.find(".dropdown-toggle").click(function(e){var i=t(this),n=i.find(".screen-reader-text");e.preventDefault(),i.toggleClass("toggled-on"),i.next(".children, .sub-menu").toggleClass("toggled-on"),i.attr("aria-expanded","false"===i.attr("aria-expanded")?"true":"false"),n.text(n.text()===screenReaderText.expand?screenReaderText.collapse:screenReaderText.expand)})}function i(){window.innerWidth<910?(o.hasClass("toggled-on")?o.attr("aria-expanded","true"):o.attr("aria-expanded","false"),l.hasClass("toggled-on")?(a.attr("aria-expanded","true"),h.attr("aria-expanded","true")):(a.attr("aria-expanded","false"),h.attr("aria-expanded","false")),o.attr("aria-controls","site-navigation social-navigation")):(o.removeAttr("aria-expanded"),a.removeAttr("aria-expanded"),h.removeAttr("aria-expanded"),o.removeAttr("aria-controls"))}function n(e){s.hasClass("page")||s.hasClass("search")||s.hasClass("single-attachment")||s.hasClass("error404")||t(".entry-content").find(e).each(function(){var i,n=t(this),s=n.offset(),r=s.top,o=n.closest("article").find(".entry-footer"),a=o.offset(),h=a.top+(o.height()+28),l=n.closest("figure");r>h?"img.size-full"===e?(i=new Image,i.src=n.attr("src"),t(i).on("load.twentysixteen",function(){i.width>=840&&(n.addClass("below-entry-meta"),l.hasClass("wp-caption")&&(l.addClass("below-entry-meta"),l.removeAttr("style")))})):n.addClass("below-entry-meta"):(n.removeClass("below-entry-meta"),l.removeClass("below-entry-meta"))})}var s,r,o,a,h,l,c;e(t(".main-navigation")),r=t("#masthead"),o=r.find("#menu-toggle"),l=r.find("#site-header-menu"),a=r.find("#site-navigation"),h=r.find("#social-navigation"),function(){o.length&&(o.add(a).add(h).attr("aria-expanded","false"),o.on("click.twentysixteen",function(){t(this).add(l).toggleClass("toggled-on"),t(this).add(a).add(h).attr("aria-expanded","false"===t(this).add(a).add(h).attr("aria-expanded")?"true":"false")}))}(),function(){function e(){window.innerWidth>=910?(t(document.body).on("touchstart.twentysixteen",function(e){t(e.target).closest(".main-navigation li").length||t(".main-navigation li").removeClass("focus")}),a.find(".menu-item-has-children > a").on("touchstart.twentysixteen",function(e){var i=t(this).parent("li");i.hasClass("focus")||(e.preventDefault(),i.toggleClass("focus"),i.siblings(".focus").removeClass("focus"))})):a.find(".menu-item-has-children > a").unbind("touchstart.twentysixteen")}a.length&&a.children().length&&("ontouchstart"in window&&(t(window).on("resize.twentysixteen",e),e()),a.find("a").on("focus.twentysixteen blur.twentysixteen",function(){t(this).parents(".menu-item").toggleClass("focus")}))}(),t(document).ready(function(){s=t(document.body),t(window).on("load.twentysixteen",i).on("resize.twentysixteen",function(){clearTimeout(c),c=setTimeout(function(){n("img.size-full"),n("blockquote.alignleft, blockquote.alignright")},300),i()}),n("img.size-full"),n("blockquote.alignleft, blockquote.alignright")})}(t)}),define("game/oimo",[],function(){function t(t,e,i){return{a:t,b:e,c:i}}function e(t,e,i,n){var s=.5*(-i.y*n.x+e.y*(-i.x+n.x)+e.x*(i.y-n.y)+i.x*n.y),r=s<0?-1:1,o=(e.y*n.x-e.x*n.y+(n.y-e.y)*t.x+(e.x-n.x)*t.y)*r,a=(e.x*i.y-e.y*i.x+(e.y-i.y)*t.x+(i.x-e.x)*t.y)*r;return o>0&&a>0&&o+a<2*s*r}function i(t,e){return{x:t,y:e}}var n,s={REVISION:"1.2",nextID:0,proxyID:0,BR_NULL:0,BR_BRUTE_FORCE:1,BR_SWEEP_AND_PRUNE:2,BR_BOUNDING_VOLUME_TREE:3,BODY_NULL:0,BODY_DYNAMIC:1,BODY_STATIC:2,SHAPE_NULL:0,SHAPE_SPHERE:1,SHAPE_BOX:2,SHAPE_CYLINDER:3,SHAPE_TETRA:4,JOINT_NULL:0,JOINT_DISTANCE:1,JOINT_BALL_AND_SOCKET:2,JOINT_HINGE:3,JOINT_WHEEL:4,JOINT_SLIDER:5,JOINT_PRISMATIC:6,WORLD_SCALE:100,INV_SCALE:.01,AABB_PROX:.005,sqrt:Math.sqrt,abs:Math.abs,floor:Math.floor,cos:Math.cos,sin:Math.sin,acos:Math.acos,asin:Math.asin,atan2:Math.atan2,round:Math.round,pow:Math.pow,max:Math.max,min:Math.min,random:Math.random,lerp:function(t,e,i){return t+(e-t)*i},rand:function(t,e){return s.lerp(t,e,s.random())},randInt:function(t,e,i){return 1*s.lerp(t,e,s.random()).toFixed(i||0)},int:function(t){return~~t},fix:function(t,e){return t.toFixed(e||3,10)},clamp:function(t,e,i){return s.max(e,s.min(i,t))},degtorad:.017453292519943295,radtodeg:57.29577951308232,PI:3.141592653589793,TwoPI:6.283185307179586,PI90:1.570796326794896,PI270:4.712388980384689,CustomError:null,Error:function(t,e){null==s.CustomError?console.error(t,e):s.CustomError.innerHTML+=t+" - "+e+"<br>"}};n||(n="undefined"!=typeof Float32Array?Float32Array:Array);try{!function(t){var e,i=["now","webkitNow","msNow","mozNow"];if(t.performance)for(var n=0;n<i.length;++n){var r=i[n];if(t.performance[r]){e=function(){return t.performance[r]()};break}}e||(e=Date.now),s.now=e}(window)}catch(t){s.now=function(){return 0}}return s.World=function(t,e,i,n){switch(this.timeStep=t||.01666,this.numIterations=i||8,e||2){case 1:this.broadPhase=new s.BruteForceBroadPhase;break;case 2:default:this.broadPhase=new s.SAPBroadPhase;break;case 3:this.broadPhase=new s.DBVTBroadPhase}this.performance=null,this.isNoStat=n||!1,this.isNoStat||(this.performance=new s.Performance(this)),this.enableRandomizer=!0,this.rigidBodies=null,this.numRigidBodies=0,this.contacts=null,this.unusedContacts=null,this.numContacts=0,this.numContactPoints=0,this.joints=null,this.numJoints=0,this.numIslands=0,this.gravity=new s.Vec3(0,-9.80665,0);var r=5;this.detectors=[],this.detectors.length=r;for(var o=r;o--;)this.detectors[o]=[],this.detectors[o].length=r;this.detectors[s.SHAPE_SPHERE][s.SHAPE_SPHERE]=new s.SphereSphereCollisionDetector,this.detectors[s.SHAPE_SPHERE][s.SHAPE_BOX]=new s.SphereBoxCollisionDetector(!1),this.detectors[s.SHAPE_BOX][s.SHAPE_SPHERE]=new s.SphereBoxCollisionDetector(!0),this.detectors[s.SHAPE_BOX][s.SHAPE_BOX]=new s.BoxBoxCollisionDetector,this.detectors[s.SHAPE_CYLINDER][s.SHAPE_CYLINDER]=new s.CylinderCylinderCollisionDetector,this.detectors[s.SHAPE_CYLINDER][s.SHAPE_BOX]=new s.BoxCylinderCollisionDetector(!0),this.detectors[s.SHAPE_BOX][s.SHAPE_CYLINDER]=new s.BoxCylinderCollisionDetector(!1),this.detectors[s.SHAPE_CYLINDER][s.SHAPE_SPHERE]=new s.SphereCylinderCollisionDetector(!0),this.detectors[s.SHAPE_SPHERE][s.SHAPE_CYLINDER]=new s.SphereCylinderCollisionDetector(!1),this.detectors[s.SHAPE_TETRA][s.SHAPE_TETRA]=new s.TetraTetraCollisionDetector,this.randX=65535,this.randA=98765,this.randB=123456789,this.islandRigidBodies=[],this.islandStack=[],this.islandConstraints=[]},s.World.prototype={constructor:s.World,clear:function(){for(this.randX=65535;null!==this.joints;)this.removeJoint(this.joints);for(;null!==this.contacts;)this.removeContact(this.contacts);for(;null!==this.rigidBodies;)this.removeRigidBody(this.rigidBodies);s.nextID=0,s.proxyID=0},addRigidBody:function(t){t.parent&&s.Error("World","It is not possible to be added to more than one world one of the rigid body"),t.parent=this,t.awake();for(var e=t.shapes;null!==e;e=e.next)this.addShape(e);null!==this.rigidBodies&&((this.rigidBodies.prev=t).next=this.rigidBodies),this.rigidBodies=t,this.numRigidBodies++},removeRigidBody:function(t){var e=t;if(e.parent===this){e.awake();for(var i=e.jointLink;null!=i;){var n=i.joint;i=i.next,this.removeJoint(n)}for(var s=t.shapes;null!==s;s=s.next)this.removeShape(s);var r=e.prev,o=e.next;null!==r&&(r.next=o),null!==o&&(o.prev=r),this.rigidBodies==e&&(this.rigidBodies=o),e.prev=null,e.next=null,e.parent=null,this.numRigidBodies--}},getByName:function(t){for(var e=null,i=this.rigidBodies;null!==i;)" "!==i.name&&i.name===t&&(e=i),i=i.next;for(var n=this.joints;null!==n;)""!==n.name&&n.name===t&&(e=n),n=n.next;return e},addShape:function(t){t.parent&&t.parent.parent||s.Error("World","It is not possible to be added alone to shape world"),t.proxy=this.broadPhase.createProxy(t),t.updateProxy(),this.broadPhase.addProxy(t.proxy)},removeShape:function(t){this.broadPhase.removeProxy(t.proxy),t.proxy=null},addJoint:function(t){t.parent&&s.Error("World","It is not possible to be added to more than one world one of the joint"),null!=this.joints&&((this.joints.prev=t).next=this.joints),this.joints=t,t.parent=this,this.numJoints++,t.awake(),t.attach()},removeJoint:function(t){var e=t,i=e.prev,n=e.next;null!==i&&(i.next=n),null!==n&&(n.prev=i),this.joints==e&&(this.joints=n),e.prev=null,e.next=null,this.numJoints--,e.awake(),e.detach(),e.parent=null},worldscale:function(t){s.WORLD_SCALE=t||100,s.INV_SCALE=1/s.WORLD_SCALE},addContact:function(t,e){var i;null!==this.unusedContacts?(i=this.unusedContacts,this.unusedContacts=this.unusedContacts.next):i=new s.Contact,i.attach(t,e),i.detector=this.detectors[t.type][e.type],this.contacts&&((this.contacts.prev=i).next=this.contacts),this.contacts=i,this.numContacts++},removeContact:function(t){var e=t.prev,i=t.next;i&&(i.prev=e),e&&(e.next=i),this.contacts==t&&(this.contacts=i),t.prev=null,t.next=null,t.detach(),t.next=this.unusedContacts,this.unusedContacts=t,this.numContacts--},checkContact:function(t,e){for(var i,n,s=this.contacts;null!==s;){if(i=s.body1.name||" ",n=s.body2.name||" ",i==t&&n==e||n==t&&i==e)return!!s.touching;s=s.next}return!1},callSleep:function(t){return!(!t.allowSleep||t.linearVelocity.lengthSq()>.04||t.angularVelocity.lengthSq()>.25)},step:function(){var t,e,i,n,r=!this.isNoStat;r&&(t=s.now());for(var o=this.rigidBodies;null!==o;)o.addedToIsland=!1,o.sleeping&&(o.linearVelocity.testZero()||o.angularVelocity.testZero()||o.position.testDiff(o.sleepPosition)||o.orientation.testDiff(o.sleepOrientation))&&o.awake(),o=o.next;r&&(e=s.now()),this.broadPhase.detectPairs();for(var a=this.broadPhase.pairs,h=this.broadPhase.numPairs;h--;){var l,c,u=a[h];u.shape1.id<u.shape2.id?(l=u.shape1,c=u.shape2):(l=u.shape2,c=u.shape1);var d;d=l.numContacts<c.numContacts?l.contactLink:c.contactLink;for(var p=!1;d;){var f=d.contact;if(f.shape1==l&&f.shape2==c){f.persisting=!0,p=!0;break}d=d.next}p||this.addContact(l,c)}for(r&&(i=s.now(),this.performance.broadPhaseTime=i-e),this.numContactPoints=0,f=this.contacts;null!==f;)if(f.persisting||!f.shape1.aabb.intersectTest(f.shape2.aabb)){var m=f.body1,g=f.body2;(m.isDynamic&&!m.sleeping||g.isDynamic&&!g.sleeping)&&f.updateManifold(),this.numContactPoints+=f.manifold.numPoints,f.persisting=!1,f.constraint.addedToIsland=!1,f=f.next}else{var v=f.next;this.removeContact(f),f=v}r&&(n=s.now(),this.performance.narrowPhaseTime=n-i);var y,x,b=1/this.timeStep;for(y=this.joints;null!==y;y=y.next)y.addedToIsland=!1;this.islandRigidBodies=[],this.islandConstraints=[],this.islandStack=[],e=s.now(),this.numIslands=0;for(var w=this.rigidBodies;null!==w;w=w.next)if(!(w.addedToIsland||w.isStatic||w.sleeping))if(w.isLonely())w.isDynamic&&w.linearVelocity.addTime(this.gravity,this.timeStep),this.callSleep(w)?(w.sleepTime+=this.timeStep,w.sleepTime>.5?w.sleep():w.updatePosition(this.timeStep)):(w.sleepTime=0,w.updatePosition(this.timeStep)),this.numIslands++;else{var _=0,S=0,M=1;this.islandStack[0]=w,w.addedToIsland=!0;do if(o=this.islandStack[--M],this.islandStack[M]=null,o.sleeping=!1,this.islandRigidBodies[_++]=o,!o.isStatic){for(var T=o.contactLink;null!==T;T=T.next){var f=T.contact;if(x=f.constraint,!x.addedToIsland&&f.touching){this.islandConstraints[S++]=x,x.addedToIsland=!0;var v=T.body;v.addedToIsland||(this.islandStack[M++]=v,v.addedToIsland=!0)}}for(var E=o.jointLink;null!==E;E=E.next)x=E.joint,x.addedToIsland||(this.islandConstraints[S++]=x,x.addedToIsland=!0,v=E.body,!v.addedToIsland&&v.isDynamic&&(this.islandStack[M++]=v,v.addedToIsland=!0))}while(0!=M);for(var C=(new s.Vec3).addTime(this.gravity,this.timeStep),A=_;A--;)o=this.islandRigidBodies[A],
o.isDynamic&&o.linearVelocity.addEqual(C);if(this.enableRandomizer)for(A=S;A--;)if(0!==A){var N=(this.randX=this.randX*this.randA+this.randB&2147483647)/2147483648*A|0;x=this.islandConstraints[A],this.islandConstraints[A]=this.islandConstraints[N],this.islandConstraints[N]=x}for(A=S;A--;)this.islandConstraints[A].preSolve(this.timeStep,b);for(var L=this.numIterations;L--;)for(A=S;A--;)this.islandConstraints[A].solve();for(A=S;A--;)this.islandConstraints[A].postSolve(),this.islandConstraints[A]=null;var P=10;for(A=_;A--;)o=this.islandRigidBodies[A],this.callSleep(o)?(o.sleepTime+=this.timeStep,o.sleepTime<P&&(P=o.sleepTime)):(o.sleepTime=0,P=0);if(P>.5)for(A=_;A--;)this.islandRigidBodies[A].sleep(),this.islandRigidBodies[A]=null;else for(A=_;A--;)this.islandRigidBodies[A].updatePosition(this.timeStep),this.islandRigidBodies[A]=null;this.numIslands++}r&&(i=s.now(),this.performance.solvingTime=i-e,i=s.now(),this.performance.upfps(),this.performance.totalTime=i-t)}},s.RigidBody=function(t,e,i,n,r,o,a){this.name=" ",this.MAX_SHAPES=64,this.prev=null,this.next=null,this.type=s.BODY_NULL,this.massInfo=new s.MassInfo,this.position=new s.Vec3(t,e,i),this.orientation=this.rotationAxisToQuad(n||0,r||0,o||0,a||0),this.newPosition=new s.Vec3,this.controlPos=!1,this.newOrientation=new s.Quat,this.newRotation=new s.Vec3,this.currentRotation=new s.Vec3,this.controlRot=!1,this.controlRotInTime=!1,this.linearVelocity=new s.Vec3,this.angularVelocity=new s.Vec3,this.matrix=new s.Mat44,this.parent=null,this.contactLink=null,this.numContacts=0,this.shapes=null,this.numShapes=0,this.jointLink=null,this.numJoints=0,this.sleepPosition=new s.Vec3,this.sleepOrientation=new s.Quat,this.isStatic=!1,this.isDynamic=!1,this.rotation=new s.Mat33,this.mass=NaN,this.inverseMass=NaN,this.inverseInertia=new s.Mat33,this.localInertia=new s.Mat33,this.inverseLocalInertia=new s.Mat33,this.addedToIsland=!1,this.allowSleep=!0,this.sleepTime=0,this.sleeping=!1},s.RigidBody.prototype={constructor:s.RigidBody,addShape:function(t){t.parent&&s.Error("RigidBody","It is not possible that you add to the multi-rigid body the shape of one"),null!=this.shapes&&((this.shapes.prev=t).next=this.shapes),this.shapes=t,t.parent=this,this.parent&&this.parent.addShape(t),this.numShapes++},removeShape:function(t){var e=t;if(e.parent==this){var i=e.prev,n=e.next;null!=i&&(i.next=n),null!=n&&(n.prev=i),this.shapes==e&&(this.shapes=n),e.prev=null,e.next=null,e.parent=null,this.parent&&this.parent.removeShape(e),this.numShapes--}},remove:function(){this.dispose()},dispose:function(){this.parent.removeRigidBody(this)},checkContact:function(t){this.parent.checkContact(this.name,t)},setupMass:function(t,e){var i=void 0===e||e;this.type=t||s.BODY_DYNAMIC,this.isDynamic=this.type==s.BODY_DYNAMIC,this.isStatic=this.type==s.BODY_STATIC,this.mass=0,this.localInertia.set(0,0,0,0,0,0,0,0,0);for(var n=this.localInertia.elements,r=new s.Mat33,o=new s.Vec3,a=this.shapes;null!=a;a=a.next){a.calculateMassInfo(this.massInfo);var h=this.massInfo.mass,l=a.relativePosition.x,c=a.relativePosition.y,u=a.relativePosition.z;o.addScale(a.relativePosition,h),this.mass+=h,this.rotateInertia(a.relativeRotation,this.massInfo.inertia,r),this.localInertia.addEqual(r),n[0]+=h*(c*c+u*u),n[4]+=h*(l*l+u*u),n[8]+=h*(l*l+c*c);var d=h*l*c,p=h*c*u,f=h*u*l;n[1]-=d,n[3]-=d,n[2]-=p,n[6]-=p,n[5]-=f,n[7]-=f}if(this.inverseMass=1/this.mass,o.scaleEqual(this.inverseMass),i){for(this.position.addEqual(o),a=this.shapes;null!=a;a=a.next)a.relativePosition.subEqual(o);l=o.x,c=o.y,u=o.z,n[0]-=this.mass*(c*c+u*u),n[4]-=this.mass*(l*l+u*u),n[8]-=this.mass*(l*l+c*c),d=this.mass*l*c,p=this.mass*c*u,f=this.mass*u*l,n[1]+=d,n[3]+=d,n[2]+=p,n[6]+=p,n[5]+=f,n[7]+=f}this.inverseLocalInertia.invert(this.localInertia),this.type==s.BODY_STATIC&&(this.inverseMass=0,this.inverseLocalInertia.set(0,0,0,0,0,0,0,0,0)),this.syncShapes(),this.awake()},awake:function(){if(this.allowSleep&&this.sleeping){this.sleeping=!1,this.sleepTime=0;for(var t=this.contactLink;null!=t;)t.body.sleepTime=0,t.body.sleeping=!1,t=t.next;for(var e=this.jointLink;null!=e;)e.body.sleepTime=0,e.body.sleeping=!1,e=e.next;for(var i=this.shapes;null!=i;i=i.next)i.updateProxy()}},sleep:function(){if(this.allowSleep&&!this.sleeping){this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.sleepPosition.copy(this.position),this.sleepOrientation.copy(this.orientation),this.sleepTime=0,this.sleeping=!0;for(var t=this.shapes;null!=t;t=t.next)t.updateProxy()}},isLonely:function(){return 0==this.numJoints&&0==this.numContacts},updatePosition:function(t){switch(this.type){case s.BODY_STATIC:this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.controlPos&&(this.position.copy(this.newPosition),this.controlPos=!1),this.controlRot&&(this.orientation.copy(this.newOrientation),this.controlRot=!1);break;case s.BODY_DYNAMIC:this.controlPos&&(this.angularVelocity.set(0,0,0),this.linearVelocity.set(0,0,0),this.linearVelocity.x=(this.newPosition.x-this.position.x)/t,this.linearVelocity.y=(this.newPosition.y-this.position.y)/t,this.linearVelocity.z=(this.newPosition.z-this.position.z)/t,this.controlPos=!1),this.controlRot&&(this.angularVelocity.set(0,0,0),this.orientation.copy(this.newOrientation),this.controlRot=!1),this.position.addTime(this.linearVelocity,t),this.orientation.addTime(this.angularVelocity,t);break;default:s.Error("RigidBody","Invalid type.")}this.syncShapes()},rotateInertia:function(t,e,i){var n=t.elements,s=e.elements,r=n[0],o=n[3],a=n[6],h=n[1],l=n[4],c=n[7],u=n[2],d=n[5],p=n[8],f=s[0],m=s[3],g=s[6],v=s[1],y=s[4],x=s[7],b=s[2],w=s[5],_=s[8],S=r*f+h*m+u*g,M=r*v+h*y+u*x,T=r*b+h*w+u*_,E=o*f+l*m+d*g,C=o*v+l*y+d*x,A=o*b+l*w+d*_,N=a*f+c*m+p*g,L=a*v+c*y+p*x,P=a*b+c*w+p*_,k=i.elements;k[0]=S*r+M*h+T*u,k[1]=S*o+M*l+T*d,k[2]=S*a+M*c+T*p,k[3]=E*r+C*h+A*u,k[4]=E*o+C*l+A*d,k[5]=E*a+C*c+A*p,k[6]=N*r+L*h+P*u,k[7]=N*o+L*l+P*d,k[8]=N*a+L*c+P*p},syncShapes:function(){var t=this.orientation.s,e=this.orientation.x,i=this.orientation.y,n=this.orientation.z,s=2*e,r=2*i,o=2*n,a=e*s,h=i*r,l=n*o,c=e*r,u=i*o,d=e*o,p=t*s,f=t*r,m=t*o,g=this.rotation.elements;g[0]=1-h-l,g[1]=c-m,g[2]=d+f,g[3]=c+m,g[4]=1-a-l,g[5]=u-p,g[6]=d-f,g[7]=u+p,g[8]=1-a-h,this.rotateInertia(this.rotation,this.inverseLocalInertia,this.inverseInertia);for(var v=this.shapes;null!=v;v=v.next)v.position.mul(this.position,v.relativePosition,this.rotation),v.rotation.mul(this.rotation,v.relativeRotation),v.updateProxy()},applyImpulse:function(t,e){this.linearVelocity.addScale(e,this.inverseMass);var i=new s.Vec3;i.sub(t,this.position).cross(i,e).mulMat(this.inverseInertia,i),this.angularVelocity.addEqual(i)},rotationVectToQuad:function(t){var e=s.EulerToAxis(t.x*s.degtorad,t.y*s.degtorad,t.z*s.degtorad);return this.rotationAxisToQuad(e[0],e[1],e[2],e[3])},rotationAxisToQuad:function(t,e,i,n){var r=e*e+i*i+n*n;r>0&&(r=1/s.sqrt(r),e*=r,i*=r,n*=r);var o=s.sin(.5*t),a=s.cos(.5*t);return new s.Quat(a,o*e,o*i,o*n)},setPosition:function(t){this.newPosition.copy(t).multiplyScalar(s.INV_SCALE),this.controlPos=!0},setQuaternion:function(t){this.newOrientation.set(t.x,t.y,t.z,t.w),this.controlRot=!0},setRotation:function(t){this.newOrientation=this.rotationVectToQuad(t),this.controlRot=!0},resetPosition:function(t,e,i){this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.position.set(t,e,i).multiplyScalar(s.INV_SCALE),this.awake()},resetQuaternion:function(t){this.angularVelocity.set(0,0,0),this.orientation=new s.Quat(t.w,t.x,t.y,t.z),this.awake()},resetRotation:function(t,e,i){this.angularVelocity.set(0,0,0),this.orientation=this.rotationVectToQuad(new s.Vec3(t,e,i)),this.awake()},getPosition:function(){return(new s.Vec3).scale(this.position,s.WORLD_SCALE)},getRotation:function(){return(new s.Euler).setFromRotationMatrix(this.rotation)},getQuaternion:function(){return(new s.Quaternion).setFromRotationMatrix(this.rotation)},getMatrix:function(){var t,e,i=this.matrix.elements;return this.sleeping?i[15]=1:(t=this.rotation.elements,i[0]=t[0],i[1]=t[3],i[2]=t[6],i[3]=0,i[4]=t[1],i[5]=t[4],i[6]=t[7],i[7]=0,i[8]=t[2],i[9]=t[5],i[10]=t[8],i[11]=0,e=this.position,i[12]=e.x*s.WORLD_SCALE,i[13]=e.y*s.WORLD_SCALE,i[14]=e.z*s.WORLD_SCALE,i[15]=0),i}},s.Body=function(t){var e=t||{};e.world&&(void 0===e.type&&(e.type="box"),this.name=e.name||"",this.body=e.world.add(e))},s.Body.prototype={constructor:s.Body,setPosition:function(t){this.body.setPosition(t)},setQuaternion:function(t){this.body.setQuaternion(t)},setRotation:function(t){this.body.setRotation(t)},getPosition:function(){return this.body.getPosition()},getRotation:function(){return this.body.getRotation()},getQuaternion:function(){return this.body.getQuaternion()},getMatrix:function(){return this.body.getMatrix()},getSleep:function(){return this.body.sleeping},resetPosition:function(t,e,i){this.body.resetPosition(t,e,i)},resetRotation:function(t,e,i){this.body.resetRotation(t,e,i)},awake:function(){this.body.awake()},remove:function(){this.body.dispose()},checkContact:function(t){this.body.checkContact(t)}},s.Link=function(t){var e=t||{};e.world&&(void 0===e.type&&(e.type="jointHinge"),this.name=e.name||"",this.joint=e.world.add(e))},s.Link.prototype={constructor:s.Link,getPosition:function(){return this.joint.getPosition()},getMatrix:function(){return this.joint.getMatrix()},remove:function(){this.joint.dispose()},awake:function(){this.joint.awake()}},s.Dictionary=function(){this.data={},this.keys=[]},s.Dictionary.prototype={constructor:s.Dictionary,set:function(t){var e=t.id;this.get[e]||this.keys.push(e),this.data[e]=t},get:function(t){return this.data[t]},del:function(t){var e=this.keys,i=e.indexOf(t.id);i>-1&&(delete this.data[e[i]],e.splice(i,1))},reset:function(){for(var t,e=this.data,i=this.keys;i.length>0;)t=i.pop(),delete e[t]}},s.Performance=function(t){this.parent=t,this.infos=new n(13),this.f=[0,0,0],this.types=["None","BruteForce","Sweep & Prune","Bounding Volume Tree"],this.broadPhase=this.types[this.parent.broadPhase.types],this.version=s.REVISION,this.fps=0,this.broadPhaseTime=0,this.narrowPhaseTime=0,this.solvingTime=0,this.totalTime=0},s.Performance.prototype={upfps:function(){this.f[1]=Date.now(),this.f[1]-1e3>this.f[0]&&(this.f[0]=this.f[1],this.fps=this.f[2],this.f[2]=0),this.f[2]++},updatingTime:function(){return s.fix(this.totalTime-(this.broadPhaseTime+this.narrowPhaseTime+this.solvingTime))},show:function(){var t=["Oimo.js "+this.version+"<br>",this.broadPhase+"<br><br>","FPS: "+this.fps+" fps<br><br>","rigidbody "+this.parent.numRigidBodies+"<br>","contact &nbsp;&nbsp;"+this.parent.numContacts+"<br>","ct-point &nbsp;"+this.parent.numContactPoints+"<br>","paircheck "+this.parent.broadPhase.numPairChecks+"<br>","island &nbsp;&nbsp;&nbsp;"+this.parent.numIslands+"<br><br>","Time in milliseconde<br><br>","broad-phase &nbsp;"+s.fix(this.broadPhaseTime)+"<br>","narrow-phase "+s.fix(this.narrowPhaseTime)+"<br>","solving &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+s.fix(this.solvingTime)+"<br>","total &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+s.fix(this.totalTime)+"<br>","updating &nbsp;&nbsp;&nbsp;&nbsp;"+this.updatingTime()+"<br>"].join("\n");return t},toArray:function(){return this.infos[0]=this.parent.broadPhase.types,this.infos[1]=this.parent.numRigidBodies,this.infos[2]=this.parent.numContacts,this.infos[3]=this.parent.broadPhase.numPairChecks,this.infos[4]=this.parent.numContactPoints,this.infos[5]=this.parent.numIslands,this.infos[6]=this.broadPhaseTime,this.infos[7]=this.narrowPhaseTime,this.infos[8]=this.solvingTime,this.infos[9]=this.updatingTime(),this.infos[10]=this.totalTime,this.infos[11]=this.fps,this.infos}},s.Mat44=function(t,e,i,s,r,o,a,h,l,c,u,d,p,f,m,g){this.elements=new n(16);var v=this.elements;v[0]=void 0!==t?t:1,v[4]=e||0,v[8]=i||0,v[12]=s||0,v[1]=r||0,v[5]=void 0!==o?o:1,v[9]=a||0,v[13]=h||0,v[2]=l||0,v[6]=c||0,v[10]=void 0!==u?u:1,v[14]=d||0,v[3]=p||0,v[7]=f||0,v[11]=m||0,v[15]=void 0!==g?g:1},s.Mat44.prototype={constructor:s.Mat44,set:function(t,e,i,n,s,r,o,a,h,l,c,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=s,g[5]=r,g[9]=o,g[13]=a,g[2]=h,g[6]=l,g[10]=c,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}},s.Mat33=function(t,e,i,s,r,o,a,h,l){this.elements=new n(9),this.elements,this.init(void 0!==t?t:1,e||0,i||0,s||0,void 0!==r?r:1,o||0,a||0,h||0,void 0!==l?l:1)},s.Mat33.prototype={constructor:s.Mat33,set:function(t,e,i,n,s,r,o,a,h){var l=this.elements;return l[0]=t,l[1]=e,l[2]=i,l[3]=n,l[4]=s,l[5]=r,l[6]=o,l[7]=a,l[8]=h,this},init:function(t,e,i,n,s,r,o,a,h){var l=this.elements;return l[0]=t,l[1]=e,l[2]=i,l[3]=n,l[4]=s,l[5]=r,l[6]=o,l[7]=a,l[8]=h,this},multiply:function(t){var e=this.elements;return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,this},add:function(t,e){var i=this.elements,n=t.elements,s=e.elements;return i[0]=n[0]+s[0],i[1]=n[1]+s[1],i[2]=n[2]+s[2],i[3]=n[3]+s[3],i[4]=n[4]+s[4],i[5]=n[5]+s[5],i[6]=n[6]+s[6],i[7]=n[7]+s[7],i[8]=n[8]+s[8],this},addEqual:function(t){var e=this.elements,i=t.elements;return e[0]+=i[0],e[1]+=i[1],e[2]+=i[2],e[3]+=i[3],e[4]+=i[4],e[5]+=i[5],e[6]+=i[6],e[7]+=i[7],e[8]+=i[8],this},sub:function(t,e){var i=this.elements,n=t.elements,s=e.elements;return i[0]=n[0]-s[0],i[1]=n[1]-s[1],i[2]=n[2]-s[2],i[3]=n[3]-s[3],i[4]=n[4]-s[4],i[5]=n[5]-s[5],i[6]=n[6]-s[6],i[7]=n[7]-s[7],i[8]=n[8]-s[8],this},subEqual:function(t){var e=this.elements,i=t.elements;return e[0]-=i[0],e[1]-=i[1],e[2]-=i[2],e[3]-=i[3],e[4]-=i[4],e[5]-=i[5],e[6]-=i[6],e[7]-=i[7],e[8]-=i[8],this},scale:function(t,e){var i=this.elements,n=t.elements;return i[0]=n[0]*e,i[1]=n[1]*e,i[2]=n[2]*e,i[3]=n[3]*e,i[4]=n[4]*e,i[5]=n[5]*e,i[6]=n[6]*e,i[7]=n[7]*e,i[8]=n[8]*e,this},scaleEqual:function(t){var e=this.elements;return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,this},mul:function(t,e){var i=this.elements,n=t.elements,s=e.elements,r=n[0],o=n[3],a=n[6],h=n[1],l=n[4],c=n[7],u=n[2],d=n[5],p=n[8],f=s[0],m=s[3],g=s[6],v=s[1],y=s[4],x=s[7],b=s[2],w=s[5],_=s[8];return i[0]=r*f+h*m+u*g,i[1]=r*v+h*y+u*x,i[2]=r*b+h*w+u*_,i[3]=o*f+l*m+d*g,i[4]=o*v+l*y+d*x,i[5]=o*b+l*w+d*_,i[6]=a*f+c*m+p*g,i[7]=a*v+c*y+p*x,i[8]=a*b+c*w+p*_,this},mulScale:function(t,e,i,n,s){var r=s||!1,o=this.elements,a=t.elements;return r?(o[0]=e*a[0],o[1]=e*a[1],o[2]=e*a[2],o[3]=i*a[3],o[4]=i*a[4],o[5]=i*a[5],o[6]=n*a[6],o[7]=n*a[7],o[8]=n*a[8]):(o[0]=a[0]*e,o[1]=a[1]*i,o[2]=a[2]*n,o[3]=a[3]*e,o[4]=a[4]*i,o[5]=a[5]*n,o[6]=a[6]*e,o[7]=a[7]*i,o[8]=a[8]*n),this},mulRotate:function(t,e,i,n,r,o){var a=o||!1,h=s.sin(e),l=s.cos(e),c=1-l,u=i*i*c+l,d=i*n*c-r*h,p=i*r*c+n*h,f=n*i*c+r*h,m=n*n*c+l,g=n*r*c-i*h,v=r*i*c-n*h,y=r*n*c+i*h,x=r*r*c+l,b=t.elements,w=b[0],_=b[3],S=b[6],M=b[1],T=b[4],E=b[7],C=b[2],A=b[5],N=b[8],L=this.elements;return a?(L[0]=u*w+d*_+p*S,L[1]=u*M+d*T+p*E,L[2]=u*C+d*A+p*N,L[3]=f*w+m*_+g*S,L[4]=f*M+m*T+g*E,L[5]=f*C+m*A+g*N,L[6]=v*w+y*_+x*S,L[7]=v*M+y*T+x*E,L[8]=v*C+y*A+x*N):(L[0]=w*u+M*f+C*v,L[1]=w*d+M*m+C*y,L[2]=w*p+M*g+C*x,L[3]=_*u+T*f+A*v,L[4]=_*d+T*m+A*y,L[5]=_*p+T*g+A*x,L[6]=S*u+E*f+N*v,L[7]=S*d+E*m+N*y,L[8]=S*p+E*g+N*x),this},transpose:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this},setQuat:function(t){var e=this.elements,i=2*t.x,n=2*t.y,s=2*t.z,r=t.x*i,o=t.y*n,a=t.z*s,h=t.x*n,l=t.y*s,c=t.x*s,u=t.s*i,d=t.s*n,p=t.s*s;return e[0]=1-o-a,e[1]=h-p,e[2]=c+d,e[3]=h+p,e[4]=1-r-a,e[5]=l-u,e[6]=c-d,e[7]=l+u,e[8]=1-r-o,this},invert:function(t){var e=this.elements,i=t.elements,n=i[0],s=i[3],r=i[6],o=i[1],a=i[4],h=i[7],l=i[2],c=i[5],u=i[8],d=a*u-h*c,p=h*l-o*u,f=o*c-a*l,m=n*d+s*p+r*f;return 0!=m&&(m=1/m),e[0]=m*d,e[1]=m*p,e[2]=m*f,e[3]=m*(c*r-s*u),e[4]=m*(n*u-l*r),e[5]=m*(l*s-n*c),e[6]=m*(s*h-a*r),e[7]=m*(o*r-n*h),e[8]=m*(n*a-o*s),this},toEuler:function(){function t(t){return s.min(s.max(t,-1),1)}var e=this.elements,i=e[0],n=e[3],r=e[6],o=(e[1],e[4]),a=e[7],h=(e[2],e[5]),l=e[8],c=new s.Vec3;return new s.Quat,c.y=s.asin(t(r)),s.abs(r)<.99999?(c.x=s.atan2(-a,l),c.z=s.atan2(-n,i)):(c.x=s.atan2(h,o),c.z=0),c},toString:function(){var t=this.elements,e="Mat33|"+t[0].toFixed(4)+", "+t[1].toFixed(4)+", "+t[2].toFixed(4)+"|\n     |"+t[3].toFixed(4)+", "+t[4].toFixed(4)+", "+t[5].toFixed(4)+"|\n     |"+t[6].toFixed(4)+", "+t[7].toFixed(4)+", "+t[8].toFixed(4)+"|";return e},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}},s.Quat=function(t,e,i,n){this.s=void 0!==t?t:1,this.x=e||0,this.y=i||0,this.z=n||0},s.Quat.prototype={constructor:s.Quat,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.s=n,this},init:function(t,e,i,n){return this.s=void 0!==t?t:1,this.x=e||0,this.y=i||0,this.z=n||0,this},add:function(t,e){return this.s=t.s+e.s,this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addTime:function(t,e){var i=t.x,n=t.y,r=t.z,o=this.s,a=this.x,h=this.y,l=this.z;e*=.5;var c=(-i*a-n*h-r*l)*e,u=(i*o+n*l-r*h)*e,d=(-i*l+n*o+r*a)*e,p=(i*h-n*a+r*o)*e;o+=c,a+=u,h+=d,l+=p;var f=1/s.sqrt(o*o+a*a+h*h+l*l);return this.s=o*f,this.x=a*f,this.y=h*f,this.z=l*f,this},sub:function(t,e){return this.s=t.s-e.s,this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},scale:function(t,e){return this.s=t.s*e,this.x=t.x*e,this.y=t.y*e,this.z=t.z*e,this},mul:function(t,e){var i=t.x,n=t.y,s=t.z,r=t.s,o=e.x,a=e.y,h=e.z,l=e.s;return this.x=i*l+r*o+n*h-s*a,this.y=n*l+r*a+s*o-i*h,this.z=s*l+r*h+i*a-n*o,this.s=r*l-i*o-n*a-s*h,this},arc:function(t,e){var i=t.x,n=t.y,r=t.z,o=e.x,a=e.y,h=e.z,l=i*o+n*a+r*h;if(l==-1)return o=n*i-r*r,a=-r*n-i*i,h=i*r+n*n,l=1/s.sqrt(o*o+a*a+h*h),this.s=0,this.x=o*l,this.y=a*l,this.z=h*l,this;var c=n*h-r*a,u=r*o-i*h,d=i*a-n*o;return this.s=s.sqrt(.5*(1+l)),l=.5/this.s,this.x=c*l,this.y=u*l,this.z=d*l,this},normalize:function(t){var e=s.sqrt(t.s*t.s+t.x*t.x+t.y*t.y+t.z*t.z);return e>0&&(e=1/e),this.s=t.s*e,this.x=t.x*e,this.y=t.y*e,this.z=t.z*e,this},invert:function(t){return this.s=t.s,this.x=-t.x,this.y=-t.y,this.z=-t.z,this},length:function(){return s.sqrt(this.s*this.s+this.x*this.x+this.y*this.y+this.z*this.z)},copy:function(t){return this.s=t.s,this.x=t.x,this.y=t.y,this.z=t.z,this},testDiff:function(t){return this.s!==t.s||this.x!==t.x||this.y!==t.y||this.z!==t.z},clone:function(t){return new s.Quat(this.s,this.x,this.y,this.z)},toString:function(){return"Quat["+this.s.toFixed(4)+", ("+this.x.toFixed(4)+", "+this.y.toFixed(4)+", "+this.z.toFixed(4)+")]"}},s.Quaternion=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1},s.Quaternion.prototype={constructor:s.Quaternion,setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],r=i[1],o=i[2],a=i[3],h=i[4],l=i[5],c=i[6],u=i[7],d=i[8],p=n+h+d;return p>0?(e=.5/s.sqrt(p+1),this.w=.25/e,this.x=(u-l)*e,this.y=(o-c)*e,this.z=(a-r)*e):n>h&&n>d?(e=2*s.sqrt(1+n-h-d),this.w=(u-l)/e,this.x=.25*e,this.y=(r+a)/e,this.z=(o+c)/e):h>d?(e=2*s.sqrt(1+h-n-d),this.w=(o-c)/e,this.x=(r+a)/e,this.y=.25*e,this.z=(l+u)/e):(e=2*s.sqrt(1+d-n-h),this.w=(a-r)/e,this.x=(o+c)/e,this.y=(l+u)/e,this.z=.25*e),this}},s.Vec3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},s.Vec3.prototype={constructor:s.Vec3,init:function(t,e,i){return this.x=t||0,this.y=e||0,this.z=i||0,this},set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},add:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addEqual:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},addTime:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},subEqual:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},scale:function(t,e){return this.x=t.x*e,this.y=t.y*e,this.z=t.z*e,this},scaleEqual:function(t){return this.x*=t,this.y*=t,this.z*=t,this},cross:function(t,e){var i=t.x,n=t.y,s=t.z,r=e.x,o=e.y,a=e.z;return this.x=n*a-s*o,this.y=s*r-i*a,this.z=i*o-n*r,this},mul:function(t,e,i){var n=i.elements;return this.x=t.x+e.x*n[0]+e.y*n[1]+e.z*n[2],this.y=t.y+e.x*n[3]+e.y*n[4]+e.z*n[5],this.z=t.z+e.x*n[6]+e.y*n[7]+e.z*n[8],this},mulMat:function(t,e){var i=t.elements;return this.x=i[0]*e.x+i[1]*e.y+i[2]*e.z,this.y=i[3]*e.x+i[4]*e.y+i[5]*e.z,this.z=i[6]*e.x+i[7]*e.y+i[8]*e.z,this},normalize:function(t){var e=t.x,i=t.y,n=t.z,r=e*e+i*i+n*n;return r>0&&(r=1/s.sqrt(r),this.x=e*r,this.y=i*r,this.z=n*r),this},invert:function(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return s.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,o=t.z,a=t.s,h=a*e+r*n-o*i,l=a*i+o*e-s*n,c=a*n+s*i-r*e,u=-s*e-r*i-o*n;return this.x=h*a+u*-s+l*-o-c*-r,this.y=l*a+u*-r+c*-s-h*-o,this.z=c*a+u*-o+h*-r-l*-s,this},testZero:function(){return 0!==this.x||0!==this.y||0!==this.z},testDiff:function(t){return t.x!==this.x||t.y!==this.y||t.z!==this.z},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},clone:function(){return new this.constructor(this.x,this.y,this.z)},toString:function(){return"Vec3["+this.x.toFixed(4)+", "+this.y.toFixed(4)+", "+this.z.toFixed(4)+"]"},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divideScalar:function(t){return this.multiplyScalar(1/t)},norm:function(){return this.divideScalar(this.length())}},s.Euler=function(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||s.Euler.DefaultOrder},s.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],s.Euler.DefaultOrder="XYZ",s.clamp=function(t,e,i){return t<e?e:t>i?i:t},s.Euler.prototype={constructor:s.Euler,_x:0,_y:0,_z:0,_order:s.Euler.DefaultOrder,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e){var i=s.clamp,n=t.elements,r=n[0],o=n[1],a=n[2],h=n[3],l=n[4],c=n[5],u=n[6],d=n[7],p=n[8];return e=e||this._order,"XYZ"===e?(this._y=s.asin(i(a,-1,1)),s.abs(a)<.99999?(this._x=s.atan2(-c,p),this._z=s.atan2(-o,r)):(this._x=s.atan2(d,l),this._z=0)):"YXZ"===e?(this._x=s.asin(-i(c,-1,1)),s.abs(c)<.99999?(this._y=s.atan2(a,p),this._z=s.atan2(h,l)):(this._y=s.atan2(-u,r),this._z=0)):"ZXY"===e?(this._x=s.asin(i(d,-1,1)),s.abs(d)<.99999?(this._y=s.atan2(-u,p),this._z=s.atan2(-o,l)):(this._y=0,this._z=s.atan2(h,r))):"ZYX"===e?(this._y=s.asin(-i(u,-1,1)),s.abs(u)<.99999?(this._x=s.atan2(d,p),this._z=s.atan2(h,r)):(this._x=0,this._z=s.atan2(-o,l))):"YZX"===e?(this._z=s.asin(i(h,-1,1)),s.abs(h)<.99999?(this._x=s.atan2(-c,l),this._y=s.atan2(-u,r)):(this._x=0,this._y=s.atan2(a,p))):"XZY"===e?(this._z=s.asin(-i(o,-1,1)),s.abs(o)<.99999?(this._x=s.atan2(d,l),this._y=s.atan2(a,r)):(this._x=s.atan2(-c,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,this.onChangeCallback(),this},setFromQuaternion:function(t,e,i){var n=s.clamp,r=t.x*t.x,o=t.y*t.y,a=t.z*t.z,h=t.s*t.s;return e=e||this._order,"XYZ"===e?(this._x=s.atan2(2*(t.x*t.s-t.y*t.z),h-r-o+a),this._y=s.asin(n(2*(t.x*t.z+t.y*t.s),-1,1)),this._z=s.atan2(2*(t.z*t.s-t.x*t.y),h+r-o-a)):"YXZ"===e?(this._x=s.asin(n(2*(t.x*t.s-t.y*t.z),-1,1)),this._y=s.atan2(2*(t.x*t.z+t.y*t.s),h-r-o+a),this._z=s.atan2(2*(t.x*t.y+t.z*t.s),h-r+o-a)):"ZXY"===e?(this._x=s.asin(n(2*(t.x*t.s+t.y*t.z),-1,1)),this._y=s.atan2(2*(t.y*t.s-t.z*t.x),h-r-o+a),this._z=s.atan2(2*(t.z*t.s-t.x*t.y),h-r+o-a)):"ZYX"===e?(this._x=s.atan2(2*(t.x*t.s+t.z*t.y),h-r-o+a),this._y=s.asin(n(2*(t.y*t.s-t.x*t.z),-1,1)),this._z=s.atan2(2*(t.x*t.y+t.z*t.s),h+r-o-a)):"YZX"===e?(this._x=s.atan2(2*(t.x*t.s-t.z*t.y),h-r+o-a),this._y=s.atan2(2*(t.y*t.s-t.x*t.z),h+r-o-a),this._z=s.asin(n(2*(t.x*t.y+t.z*t.s),-1,1))):"XZY"===e?(this._x=s.atan2(2*(t.x*t.s+t.y*t.z),h-r+o-a),this._y=s.atan2(2*(t.x*t.z+t.y*t.s),h+r-o-a),this._z=s.asin(n(2*(t.z*t.s-t.x*t.y),-1,1))):console.warn("OIMO.Euler: .setFromQuaternion() given unsupported order: "+e),this._order=e,i!==!1&&this.onChangeCallback(),this},reorder:function(){var t=new s.Quat;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){},clone:function(){return new s.Euler(this._x,this._y,this._z,this._order)}},s.EulerToAxis=function(t,e,i){var n=s.cos(.5*e),r=s.sin(.5*e),o=s.cos(.5*i),a=s.sin(.5*i),h=s.cos(.5*t),l=s.sin(.5*t),c=n*o,u=r*a,d=c*h-u*l,p=c*l+u*h,f=r*o*h+n*a*l,m=n*a*h-r*o*l,g=2*s.acos(d),v=p*p+f*f+m*m;return v<.001?(p=1,f=m=0):(v=s.sqrt(v),p/=v,f/=v,m/=v),[g,p,f,m]},s.EulerToMatrix=function(t,e,i){var n=s.cos(e),r=s.sin(e),o=s.cos(i),a=s.sin(i),h=s.cos(t),l=s.sin(t),c=new s.Mat33,u=c.elements;return u[0]=n*o,u[1]=r*l-n*a*h,u[2]=n*a*l+r*h,u[3]=a,u[4]=o*h,u[5]=-o*l,u[6]=-r*o,u[7]=r*a*h+n*l,u[8]=-r*a*l+n*h,c},s.MatrixToEuler=function(t){var e,i,n,r=t.elements;return r[3]>.998?(i=s.atan2(r[2],r[8]),n=s.PI/2,e=0):r[3]<-.998?(i=s.atan2(r[2],r[8]),n=-s.PI/2,e=0):(i=s.atan2(-r[6],r[0]),e=s.atan2(-r[5],r[4]),n=s.asin(r[3])),[e,i,n]},s.unwrapDegrees=function(t){return t%=360,t>180&&(t-=360),t<-180&&(t+=360),t},s.unwrapRadian=function(t){return t%=s.TwoPI,t>s.PI&&(t-=s.TwoPI),t<-s.PI&&(t+=s.TwoPI),t},s.Distance3d=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return s.sqrt(i*i+n*n+r*r)},s.Constraint=function(){this.parent=null,this.body1=null,this.body2=null,this.addedToIsland=!1},s.Constraint.prototype={constructor:s.Constraint,preSolve:function(t,e){s.Error("Constraint","Inheritance error.")},solve:function(){s.Error("Constraint","Inheritance error.")},postSolve:function(){s.Error("Constraint","Inheritance error.")}},s.Joint=function(t){s.Constraint.call(this),this.name="",this.type=s.JOINT_NULL,this.prev=null,this.next=null,this.body1=t.body1,this.body2=t.body2,this.localAnchorPoint1=(new s.Vec3).copy(t.localAnchorPoint1),this.localAnchorPoint2=(new s.Vec3).copy(t.localAnchorPoint2),this.relativeAnchorPoint1=new s.Vec3,this.relativeAnchorPoint2=new s.Vec3,this.anchorPoint1=new s.Vec3,this.anchorPoint2=new s.Vec3,this.allowCollision=t.allowCollision,this.b1Link=new s.JointLink(this),this.b2Link=new s.JointLink(this),this.matrix=new s.Mat44},s.Joint.prototype=Object.create(s.Constraint.prototype),s.Joint.prototype.constructor=s.Joint,s.Joint.prototype.updateAnchorPoints=function(){this.relativeAnchorPoint1.mulMat(this.body1.rotation,this.localAnchorPoint1),this.relativeAnchorPoint2.mulMat(this.body2.rotation,this.localAnchorPoint2),this.anchorPoint1.add(this.relativeAnchorPoint1,this.body1.position),this.anchorPoint2.add(this.relativeAnchorPoint2,this.body2.position)},s.Joint.prototype.attach=function(){this.b1Link.body=this.body2,this.b2Link.body=this.body1,null!=this.body1.jointLink?(this.b1Link.next=this.body1.jointLink).prev=this.b1Link:this.b1Link.next=null,this.body1.jointLink=this.b1Link,this.body1.numJoints++,null!=this.body2.jointLink?(this.b2Link.next=this.body2.jointLink).prev=this.b2Link:this.b2Link.next=null,this.body2.jointLink=this.b2Link,this.body2.numJoints++},s.Joint.prototype.detach=function(){var t=this.b1Link.prev,e=this.b1Link.next;null!=t&&(t.next=e),null!=e&&(e.prev=t),this.body1.jointLink==this.b1Link&&(this.body1.jointLink=e),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.body=null,this.body1.numJoints--,t=this.b2Link.prev,e=this.b2Link.next,null!=t&&(t.next=e),null!=e&&(e.prev=t),this.body2.jointLink==this.b2Link&&(this.body2.jointLink=e),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.body=null,this.body2.numJoints--,this.b1Link.body=null,this.b2Link.body=null},s.Joint.prototype.awake=function(){this.body1.awake(),this.body2.awake()},s.Joint.prototype.preSolve=function(t,e){},s.Joint.prototype.solve=function(){},s.Joint.prototype.postSolve=function(){},s.Joint.prototype.remove=function(){this.dispose()},s.Joint.prototype.dispose=function(){this.parent.removeJoint(this)},s.Joint.prototype.getPosition=function(){var t=(new s.Vec3).scale(this.anchorPoint1,s.WORLD_SCALE),e=(new s.Vec3).scale(this.anchorPoint2,s.WORLD_SCALE);return[t,e]},s.Joint.prototype.getMatrix=function(){var t=this.matrix.elements,e=this.anchorPoint1,i=this.anchorPoint2;return t[0]=e.x*s.WORLD_SCALE,t[1]=e.y*s.WORLD_SCALE,t[2]=e.z*s.WORLD_SCALE,t[3]=0,t[4]=i.x*s.WORLD_SCALE,t[5]=i.y*s.WORLD_SCALE,t[6]=i.z*s.WORLD_SCALE,t[7]=0,t},s.JointConfig=function(){this.body1=null,this.body2=null,this.localAnchorPoint1=new s.Vec3,this.localAnchorPoint2=new s.Vec3,this.localAxis1=new s.Vec3,this.localAxis2=new s.Vec3,this.allowCollision=!1},s.JointLink=function(t){this.prev=null,this.next=null,this.body=null,this.joint=t},s.LimitMotor=function(t,e){e=e||!1,this.axis=t,this.angle=0,this.lowerLimit=e?0:1,this.upperLimit=0,this.motorSpeed=0,this.maxMotorForce=0,this.frequency=0,this.dampingRatio=0},s.LimitMotor.prototype={constructor:s.LimitMotor,setLimit:function(t,e){this.lowerLimit=t,this.upperLimit=e},setMotor:function(t,e){this.motorSpeed=t,this.maxMotorForce=e},setSpring:function(t,e){this.frequency=t,this.dampingRatio=e}},s.BallAndSocketJoint=function(t){s.Joint.call(this,t),this.type=s.JOINT_BALL_AND_SOCKET,this.lc=new s.LinearConstraint(this)},s.BallAndSocketJoint.prototype=Object.create(s.Joint.prototype),s.BallAndSocketJoint.prototype.constructor=s.BallAndSocketJoint,s.BallAndSocketJoint.prototype.preSolve=function(t,e){this.updateAnchorPoints(),this.lc.preSolve(t,e)},s.BallAndSocketJoint.prototype.solve=function(){this.lc.solve()},s.BallAndSocketJoint.prototype.postSolve=function(){},s.DistanceJoint=function(t,e,i){s.Joint.call(this,t),this.type=s.JOINT_DISTANCE,this.normal=new s.Vec3,this.nr=new s.Vec3,this.limitMotor=new s.LimitMotor(this.normal,!0),this.limitMotor.lowerLimit=e,this.limitMotor.upperLimit=i,this.t=new s.TranslationalConstraint(this,this.limitMotor)},s.DistanceJoint.prototype=Object.create(s.Joint.prototype),s.DistanceJoint.prototype.constructor=s.DistanceJoint,s.DistanceJoint.prototype.preSolve=function(t,e){this.updateAnchorPoints(),this.nr.sub(this.anchorPoint2,this.anchorPoint1),this.normal.normalize(this.nr),this.t.preSolve(t,e)},s.DistanceJoint.prototype.solve=function(){this.t.solve()},s.DistanceJoint.prototype.postSolve=function(){},s.HingeJoint=function(t,e,i){s.Joint.call(this,t),this.type=s.JOINT_HINGE,this.localAxis1=t.localAxis1.clone().norm(),this.localAxis2=t.localAxis2.clone().norm(),this.localAngle1=new s.Vec3(this.localAxis1.y*this.localAxis1.x-this.localAxis1.z*this.localAxis1.z,-this.localAxis1.z*this.localAxis1.y-this.localAxis1.x*this.localAxis1.x,this.localAxis1.x*this.localAxis1.z+this.localAxis1.y*this.localAxis1.y).norm();var n=(new s.Mat33).setQuat((new s.Quat).arc(this.localAxis1,this.localAxis2));this.localAngle2=(new s.Vec3).mulMat(n,this.localAngle1),
this.nor=new s.Vec3,this.tan=new s.Vec3,this.bin=new s.Vec3,this.ax1=new s.Vec3,this.ax2=new s.Vec3,this.an1=new s.Vec3,this.an2=new s.Vec3,this.limitMotor=new s.LimitMotor(this.nor,!1),this.limitMotor.lowerLimit=e,this.limitMotor.upperLimit=i,this.lc=new s.LinearConstraint(this),this.r3=new s.Rotational3Constraint(this,this.limitMotor,new s.LimitMotor(this.tan,!0),new s.LimitMotor(this.bin,!0))},s.HingeJoint.prototype=Object.create(s.Joint.prototype),s.HingeJoint.prototype.constructor=s.HingeJoint,s.HingeJoint.prototype.preSolve=function(t,e){var i,n,s,r;this.updateAnchorPoints(),this.ax1.mulMat(this.body1.rotation,this.localAxis1),this.ax2.mulMat(this.body2.rotation,this.localAxis2),this.an1.mulMat(this.body1.rotation,this.localAngle1),this.an2.mulMat(this.body2.rotation,this.localAngle2),this.nor.set(this.ax1.x*this.body2.inverseMass+this.ax2.x*this.body1.inverseMass,this.ax1.y*this.body2.inverseMass+this.ax2.y*this.body1.inverseMass,this.ax1.z*this.body2.inverseMass+this.ax2.z*this.body1.inverseMass).norm(),this.tan.set(this.nor.y*this.nor.x-this.nor.z*this.nor.z,-this.nor.z*this.nor.y-this.nor.x*this.nor.x,this.nor.x*this.nor.z+this.nor.y*this.nor.y).norm(),this.bin.set(this.nor.y*this.tan.z-this.nor.z*this.tan.y,this.nor.z*this.tan.x-this.nor.x*this.tan.z,this.nor.x*this.tan.y-this.nor.y*this.tan.x),r=this.acosClamp(this.an1.x*this.an2.x+this.an1.y*this.an2.y+this.an1.z*this.an2.z),this.nor.x*(this.an1.y*this.an2.z-this.an1.z*this.an2.y)+this.nor.y*(this.an1.z*this.an2.x-this.an1.x*this.an2.z)+this.nor.z*(this.an1.x*this.an2.y-this.an1.y*this.an2.x)<0?this.limitMotor.angle=-r:this.limitMotor.angle=r,i=this.ax1.y*this.ax2.z-this.ax1.z*this.ax2.y,n=this.ax1.z*this.ax2.x-this.ax1.x*this.ax2.z,s=this.ax1.x*this.ax2.y-this.ax1.y*this.ax2.x,this.r3.limitMotor2.angle=this.tan.x*i+this.tan.y*n+this.tan.z*s,this.r3.limitMotor3.angle=this.bin.x*i+this.bin.y*n+this.bin.z*s,this.r3.preSolve(t,e),this.lc.preSolve(t,e)},s.HingeJoint.prototype.solve=function(){this.r3.solve(),this.lc.solve()},s.HingeJoint.prototype.postSolve=function(){},s.HingeJoint.prototype.acosClamp=function(t){return t>1?0:t<-1?s.PI:s.acos(t)},s.PrismaticJoint=function(t,e,i){s.Joint.call(this,t),this.type=s.JOINT_PRISMATIC,this.localAxis1=(new s.Vec3).normalize(t.localAxis1),this.localAxis2=(new s.Vec3).normalize(t.localAxis2),this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z,this.nor=new s.Vec3,this.tan=new s.Vec3,this.bin=new s.Vec3,this.ac=new s.AngularConstraint(this,(new s.Quat).arc(this.localAxis1,this.localAxis2)),this.limitMotor=new s.LimitMotor(this.nor,!0),this.limitMotor.lowerLimit=e,this.limitMotor.upperLimit=i,this.t3=new s.Translational3Constraint(this,this.limitMotor,new s.LimitMotor(this.tan,!0),new s.LimitMotor(this.bin,!0))},s.PrismaticJoint.prototype=Object.create(s.Joint.prototype),s.PrismaticJoint.prototype.constructor=s.PrismaticJoint,s.PrismaticJoint.prototype.preSolve=function(t,e){var i,n;this.updateAnchorPoints(),i=this.body1.rotation.elements;var r=this.localAxis1X*i[0]+this.localAxis1Y*i[1]+this.localAxis1Z*i[2],o=this.localAxis1X*i[3]+this.localAxis1Y*i[4]+this.localAxis1Z*i[5],a=this.localAxis1X*i[6]+this.localAxis1Y*i[7]+this.localAxis1Z*i[8];i=this.body2.rotation.elements;var h=this.localAxis2X*i[0]+this.localAxis2Y*i[1]+this.localAxis2Z*i[2],l=this.localAxis2X*i[3]+this.localAxis2Y*i[4]+this.localAxis2Z*i[5],c=this.localAxis2X*i[6]+this.localAxis2Y*i[7]+this.localAxis2Z*i[8],u=r*this.body2.inverseMass+h*this.body1.inverseMass,d=o*this.body2.inverseMass+l*this.body1.inverseMass,p=a*this.body2.inverseMass+c*this.body1.inverseMass;n=s.sqrt(u*u+d*d+p*p),n>0&&(n=1/n),u*=n,d*=n,p*=n;var f=d*u-p*p,m=-p*d-u*u,g=u*p+d*d;n=1/s.sqrt(f*f+m*m+g*g),f*=n,m*=n,g*=n;var v=d*g-p*m,y=p*f-u*g,x=u*m-d*f;this.nor.init(u,d,p),this.tan.init(f,m,g),this.bin.init(v,y,x),this.ac.preSolve(t,e),this.t3.preSolve(t,e)},s.PrismaticJoint.prototype.solve=function(){this.ac.solve(),this.t3.solve()},s.PrismaticJoint.prototype.postSolve=function(){},s.SliderJoint=function(t,e,i){s.Joint.call(this,t),this.type=s.JOINT_SLIDER,this.localAxis1=(new s.Vec3).normalize(t.localAxis1),this.localAxis2=(new s.Vec3).normalize(t.localAxis2);var n;this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAngAxis1X=this.localAxis1Y*this.localAxis1X-this.localAxis1Z*this.localAxis1Z,this.localAngAxis1Y=-this.localAxis1Z*this.localAxis1Y-this.localAxis1X*this.localAxis1X,this.localAngAxis1Z=this.localAxis1X*this.localAxis1Z+this.localAxis1Y*this.localAxis1Y,n=1/s.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=n,this.localAngAxis1Y*=n,this.localAngAxis1Z*=n,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z;var r=(new s.Mat33).setQuat((new s.Quat).arc(this.localAxis1,this.localAxis2)),o=r.elements;this.localAngAxis2X=this.localAngAxis1X*o[0]+this.localAngAxis1Y*o[1]+this.localAngAxis1Z*o[2],this.localAngAxis2Y=this.localAngAxis1X*o[3]+this.localAngAxis1Y*o[4]+this.localAngAxis1Z*o[5],this.localAngAxis2Z=this.localAngAxis1X*o[6]+this.localAngAxis1Y*o[7]+this.localAngAxis1Z*o[8],this.nor=new s.Vec3,this.tan=new s.Vec3,this.bin=new s.Vec3,this.rotationalLimitMotor=new s.LimitMotor(this.nor,!1),this.r3=new s.Rotational3Constraint(this,this.rotationalLimitMotor,new s.LimitMotor(this.tan,!0),new s.LimitMotor(this.bin,!0)),this.translationalLimitMotor=new s.LimitMotor(this.nor,!0),this.translationalLimitMotor.lowerLimit=e,this.translationalLimitMotor.upperLimit=i,this.t3=new s.Translational3Constraint(this,this.translationalLimitMotor,new s.LimitMotor(this.tan,!0),new s.LimitMotor(this.bin,!0))},s.SliderJoint.prototype=Object.create(s.Joint.prototype),s.SliderJoint.prototype.constructor=s.SliderJoint,s.SliderJoint.prototype.preSolve=function(t,e){var i,n,r,o;this.updateAnchorPoints(),i=this.body1.rotation.elements;var a=this.localAxis1X*i[0]+this.localAxis1Y*i[1]+this.localAxis1Z*i[2],h=this.localAxis1X*i[3]+this.localAxis1Y*i[4]+this.localAxis1Z*i[5],l=this.localAxis1X*i[6]+this.localAxis1Y*i[7]+this.localAxis1Z*i[8],c=this.localAngAxis1X*i[0]+this.localAngAxis1Y*i[1]+this.localAngAxis1Z*i[2],u=this.localAngAxis1X*i[3]+this.localAngAxis1Y*i[4]+this.localAngAxis1Z*i[5],d=this.localAngAxis1X*i[6]+this.localAngAxis1Y*i[7]+this.localAngAxis1Z*i[8];i=this.body2.rotation.elements;var p=this.localAxis2X*i[0]+this.localAxis2Y*i[1]+this.localAxis2Z*i[2],f=this.localAxis2X*i[3]+this.localAxis2Y*i[4]+this.localAxis2Z*i[5],m=this.localAxis2X*i[6]+this.localAxis2Y*i[7]+this.localAxis2Z*i[8],g=this.localAngAxis2X*i[0]+this.localAngAxis2Y*i[1]+this.localAngAxis2Z*i[2],v=this.localAngAxis2X*i[3]+this.localAngAxis2Y*i[4]+this.localAngAxis2Z*i[5],y=this.localAngAxis2X*i[6]+this.localAngAxis2Y*i[7]+this.localAngAxis2Z*i[8],x=a*this.body2.inverseMass+p*this.body1.inverseMass,b=h*this.body2.inverseMass+f*this.body1.inverseMass,w=l*this.body2.inverseMass+m*this.body1.inverseMass;n=s.sqrt(x*x+b*b+w*w),n>0&&(n=1/n),x*=n,b*=n,w*=n;var _=b*x-w*w,S=-w*b-x*x,M=x*w+b*b;n=1/s.sqrt(_*_+S*S+M*M),_*=n,S*=n,M*=n;var T=b*M-w*S,E=w*_-x*M,C=x*S-b*_;this.nor.init(x,b,w),this.tan.init(_,S,M),this.bin.init(T,E,C),x*(u*y-d*v)+b*(d*g-c*y)+w*(c*v-u*g)<0?this.rotationalLimitMotor.angle=-this.acosClamp(c*g+u*v+d*y):this.rotationalLimitMotor.angle=this.acosClamp(c*g+u*v+d*y),n=h*m-l*f,r=l*p-a*m,o=a*f-h*p,this.r3.limitMotor2.angle=_*n+S*r+M*o,this.r3.limitMotor3.angle=T*n+E*r+C*o,this.r3.preSolve(t,e),this.t3.preSolve(t,e)},s.SliderJoint.prototype.solve=function(){this.r3.solve(),this.t3.solve()},s.SliderJoint.prototype.postSolve=function(){},s.SliderJoint.prototype.acosClamp=function(t){return t>1?0:t<-1?s.PI:s.acos(t)},s.WheelJoint=function(t){s.Joint.call(this,t),this.type=s.JOINT_WHEEL,this.localAxis1=(new s.Vec3).normalize(t.localAxis1),this.localAxis2=(new s.Vec3).normalize(t.localAxis2);var e;this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z;var i=this.localAxis1X*this.localAxis2X+this.localAxis1Y*this.localAxis2Y+this.localAxis1Z*this.localAxis2Z;if(i>-1&&i<1)this.localAngAxis1X=this.localAxis2X-i*this.localAxis1X,this.localAngAxis1Y=this.localAxis2Y-i*this.localAxis1Y,this.localAngAxis1Z=this.localAxis2Z-i*this.localAxis1Z,this.localAngAxis2X=this.localAxis1X-i*this.localAxis2X,this.localAngAxis2Y=this.localAxis1Y-i*this.localAxis2Y,this.localAngAxis2Z=this.localAxis1Z-i*this.localAxis2Z,e=1/s.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=e,this.localAngAxis1Y*=e,this.localAngAxis1Z*=e,e=1/s.sqrt(this.localAngAxis2X*this.localAngAxis2X+this.localAngAxis2Y*this.localAngAxis2Y+this.localAngAxis2Z*this.localAngAxis2Z),this.localAngAxis2X*=e,this.localAngAxis2Y*=e,this.localAngAxis2Z*=e;else{this.localAngAxis1X=this.localAxis1Y*this.localAxis1X-this.localAxis1Z*this.localAxis1Z,this.localAngAxis1Y=-this.localAxis1Z*this.localAxis1Y-this.localAxis1X*this.localAxis1X,this.localAngAxis1Z=this.localAxis1X*this.localAxis1Z+this.localAxis1Y*this.localAxis1Y,e=1/s.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=e,this.localAngAxis1Y*=e,this.localAngAxis1Z*=e;var n=(new s.Mat33).setQuat((new s.Quat).arc(this.localAxis1,this.localAxis2)),r=n.elements;this.localAngAxis2X=this.localAngAxis1X*r[0]+this.localAngAxis1Y*r[1]+this.localAngAxis1Z*r[2],this.localAngAxis2Y=this.localAngAxis1X*r[3]+this.localAngAxis1Y*r[4]+this.localAngAxis1Z*r[5],this.localAngAxis2Z=this.localAngAxis1X*r[6]+this.localAngAxis1Y*r[7]+this.localAngAxis1Z*r[8]}this.nor=new s.Vec3,this.tan=new s.Vec3,this.bin=new s.Vec3,this.translationalLimitMotor=new s.LimitMotor(this.tan,!0),this.translationalLimitMotor.frequency=8,this.translationalLimitMotor.dampingRatio=1,this.rotationalLimitMotor1=new s.LimitMotor(this.tan,!1),this.rotationalLimitMotor2=new s.LimitMotor(this.bin,!1),this.t3=new s.Translational3Constraint(this,new s.LimitMotor(this.nor,!0),this.translationalLimitMotor,new s.LimitMotor(this.bin,!0)),this.t3.weight=1,this.r3=new s.Rotational3Constraint(this,new s.LimitMotor(this.nor,!0),this.rotationalLimitMotor1,this.rotationalLimitMotor2)},s.WheelJoint.prototype=Object.create(s.Joint.prototype),s.WheelJoint.prototype.constructor=s.WheelJoint,s.WheelJoint.prototype.preSolve=function(t,e){var i,n;this.updateAnchorPoints(),i=this.body1.rotation.elements;var r=this.localAxis1X*i[0]+this.localAxis1Y*i[1]+this.localAxis1Z*i[2],o=this.localAxis1X*i[3]+this.localAxis1Y*i[4]+this.localAxis1Z*i[5],a=this.localAxis1X*i[6]+this.localAxis1Y*i[7]+this.localAxis1Z*i[8],h=this.localAngAxis1X*i[0]+this.localAngAxis1Y*i[1]+this.localAngAxis1Z*i[2],l=this.localAngAxis1X*i[3]+this.localAngAxis1Y*i[4]+this.localAngAxis1Z*i[5],c=this.localAngAxis1X*i[6]+this.localAngAxis1Y*i[7]+this.localAngAxis1Z*i[8];i=this.body2.rotation.elements;var u=this.localAxis2X*i[0]+this.localAxis2Y*i[1]+this.localAxis2Z*i[2],d=this.localAxis2X*i[3]+this.localAxis2Y*i[4]+this.localAxis2Z*i[5],p=this.localAxis2X*i[6]+this.localAxis2Y*i[7]+this.localAxis2Z*i[8],f=this.localAngAxis2X*i[0]+this.localAngAxis2Y*i[1]+this.localAngAxis2Z*i[2],m=this.localAngAxis2X*i[3]+this.localAngAxis2Y*i[4]+this.localAngAxis2Z*i[5],g=this.localAngAxis2X*i[6]+this.localAngAxis2Y*i[7]+this.localAngAxis2Z*i[8];this.r3.limitMotor1.angle=r*u+o*d+a*p,r*(l*p-c*d)+o*(c*u-h*p)+a*(h*d-l*u)<0?this.rotationalLimitMotor1.angle=-this.acosClamp(h*u+l*d+c*p):this.rotationalLimitMotor1.angle=this.acosClamp(h*u+l*d+c*p),u*(m*a-g*o)+d*(g*r-f*a)+p*(f*o-m*r)<0?this.rotationalLimitMotor2.angle=this.acosClamp(f*r+m*o+g*a):this.rotationalLimitMotor2.angle=-this.acosClamp(f*r+m*o+g*a);var v=d*a-p*o,y=p*r-u*a,x=u*o-d*r;n=s.sqrt(v*v+y*y+x*x),n>0&&(n=1/n),v*=n,y*=n,x*=n;var b=y*p-x*d,w=x*u-v*p,_=v*d-y*u;n=s.sqrt(b*b+w*w+_*_),n>0&&(n=1/n),b*=n,w*=n,_*=n;var S=o*x-a*y,M=a*v-r*x,T=r*y-o*v;n=s.sqrt(S*S+M*M+T*T),n>0&&(n=1/n),S*=n,M*=n,T*=n,this.nor.init(v,y,x),this.tan.init(b,w,_),this.bin.init(S,M,T),this.r3.preSolve(t,e),this.t3.preSolve(t,e)},s.WheelJoint.prototype.solve=function(){this.r3.solve(),this.t3.solve()},s.WheelJoint.prototype.postSolve=function(){},s.WheelJoint.prototype.acosClamp=function(t){return t>1?0:t<-1?s.PI:s.acos(t)},s.AngularConstraint=function(t,e){this.joint=t,this.targetOrientation=(new s.Quat).invert(e),this.relativeOrientation=new s.Quat,this.ii1=null,this.ii2=null,this.dd=null,this.vel=new s.Vec3,this.imp=new s.Vec3,this.rn0=new s.Vec3,this.rn1=new s.Vec3,this.rn2=new s.Vec3,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia},s.AngularConstraint.prototype={constructor:s.AngularConstraint,preSolve:function(t,e){var i,n,r;this.ii1=this.i1.clone(),this.ii2=this.i2.clone(),r=(new s.Mat33).add(this.ii1,this.ii2).elements,i=1/(r[0]*(r[4]*r[8]-r[7]*r[5])+r[3]*(r[7]*r[2]-r[1]*r[8])+r[6]*(r[1]*r[5]-r[4]*r[2])),this.dd=new s.Mat33(r[4]*r[8]-r[5]*r[7],r[2]*r[7]-r[1]*r[8],r[1]*r[5]-r[2]*r[4],r[5]*r[6]-r[3]*r[8],r[0]*r[8]-r[2]*r[6],r[2]*r[3]-r[0]*r[5],r[3]*r[7]-r[4]*r[6],r[1]*r[6]-r[0]*r[7],r[0]*r[4]-r[1]*r[3]).multiply(i),this.relativeOrientation.invert(this.b1.orientation),this.relativeOrientation.mul(this.targetOrientation,this.relativeOrientation),this.relativeOrientation.mul(this.b2.orientation,this.relativeOrientation),i=2*this.relativeOrientation.s,this.vel.scale(this.relativeOrientation,i),n=this.vel.length(),n>.02?(n=(.02-n)/n*e*.05,this.vel.scaleEqual(n)):this.vel.init(),this.rn1.mulMat(this.ii1,this.imp),this.rn2.mulMat(this.ii2,this.imp),this.a1.addEqual(this.rn1),this.a2.subEqual(this.rn2)},solve:function(){var t=this.a2.clone().subEqual(this.a1).subEqual(this.vel);this.rn0.mulMat(this.dd,t),this.rn1.mulMat(this.ii1,this.rn0),this.rn2.mulMat(this.ii2,this.rn0),this.imp.addEqual(this.rn0),this.a1.addEqual(this.rn1),this.a2.subEqual(this.rn2)}},s.LinearConstraint=function(t){this.m1=NaN,this.m2=NaN,this.ii1=null,this.ii2=null,this.dd=null,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.ax1x=NaN,this.ax1y=NaN,this.ax1z=NaN,this.ay1x=NaN,this.ay1y=NaN,this.ay1z=NaN,this.az1x=NaN,this.az1y=NaN,this.az1z=NaN,this.ax2x=NaN,this.ax2y=NaN,this.ax2z=NaN,this.ay2x=NaN,this.ay2y=NaN,this.ay2z=NaN,this.az2x=NaN,this.az2y=NaN,this.az2z=NaN,this.vel=NaN,this.velx=NaN,this.vely=NaN,this.velz=NaN,this.joint=t,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.b1=t.body1,this.b2=t.body2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.impx=0,this.impy=0,this.impz=0},s.LinearConstraint.prototype={constructor:s.LinearConstraint,preSolve:function(t,e){this.r1x=this.r1.x,this.r1y=this.r1.y,this.r1z=this.r1.z,this.r2x=this.r2.x,this.r2y=this.r2.y,this.r2z=this.r2.z,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass,this.ii1=this.i1.clone(),this.ii2=this.i2.clone();var i=this.ii1.elements,n=this.ii2.elements;this.ax1x=this.r1z*i[1]+-this.r1y*i[2],this.ax1y=this.r1z*i[4]+-this.r1y*i[5],this.ax1z=this.r1z*i[7]+-this.r1y*i[8],this.ay1x=-this.r1z*i[0]+this.r1x*i[2],this.ay1y=-this.r1z*i[3]+this.r1x*i[5],this.ay1z=-this.r1z*i[6]+this.r1x*i[8],this.az1x=this.r1y*i[0]+-this.r1x*i[1],this.az1y=this.r1y*i[3]+-this.r1x*i[4],this.az1z=this.r1y*i[6]+-this.r1x*i[7],this.ax2x=this.r2z*n[1]+-this.r2y*n[2],this.ax2y=this.r2z*n[4]+-this.r2y*n[5],this.ax2z=this.r2z*n[7]+-this.r2y*n[8],this.ay2x=-this.r2z*n[0]+this.r2x*n[2],this.ay2y=-this.r2z*n[3]+this.r2x*n[5],this.ay2z=-this.r2z*n[6]+this.r2x*n[8],this.az2x=this.r2y*n[0]+-this.r2x*n[1],this.az2y=this.r2y*n[3]+-this.r2x*n[4],this.az2z=this.r2y*n[6]+-this.r2x*n[7];var r=this.m1+this.m2,o=new s.Mat33(r,0,0,0,r,0,0,0,r),a=o.elements;a[0]+=i[4]*this.r1z*this.r1z-(i[7]+i[5])*this.r1y*this.r1z+i[8]*this.r1y*this.r1y,a[1]+=(i[6]*this.r1y+i[5]*this.r1x)*this.r1z-i[3]*this.r1z*this.r1z-i[8]*this.r1x*this.r1y,a[2]+=(i[3]*this.r1y-i[4]*this.r1x)*this.r1z-i[6]*this.r1y*this.r1y+i[7]*this.r1x*this.r1y,a[3]+=(i[2]*this.r1y+i[7]*this.r1x)*this.r1z-i[1]*this.r1z*this.r1z-i[8]*this.r1x*this.r1y,a[4]+=i[0]*this.r1z*this.r1z-(i[6]+i[2])*this.r1x*this.r1z+i[8]*this.r1x*this.r1x,a[5]+=(i[1]*this.r1x-i[0]*this.r1y)*this.r1z-i[7]*this.r1x*this.r1x+i[6]*this.r1x*this.r1y,a[6]+=(i[1]*this.r1y-i[4]*this.r1x)*this.r1z-i[2]*this.r1y*this.r1y+i[5]*this.r1x*this.r1y,a[7]+=(i[3]*this.r1x-i[0]*this.r1y)*this.r1z-i[5]*this.r1x*this.r1x+i[2]*this.r1x*this.r1y,a[8]+=i[0]*this.r1y*this.r1y-(i[3]+i[1])*this.r1x*this.r1y+i[4]*this.r1x*this.r1x,a[0]+=n[4]*this.r2z*this.r2z-(n[7]+n[5])*this.r2y*this.r2z+n[8]*this.r2y*this.r2y,a[1]+=(n[6]*this.r2y+n[5]*this.r2x)*this.r2z-n[3]*this.r2z*this.r2z-n[8]*this.r2x*this.r2y,a[2]+=(n[3]*this.r2y-n[4]*this.r2x)*this.r2z-n[6]*this.r2y*this.r2y+n[7]*this.r2x*this.r2y,a[3]+=(n[2]*this.r2y+n[7]*this.r2x)*this.r2z-n[1]*this.r2z*this.r2z-n[8]*this.r2x*this.r2y,a[4]+=n[0]*this.r2z*this.r2z-(n[6]+n[2])*this.r2x*this.r2z+n[8]*this.r2x*this.r2x,a[5]+=(n[1]*this.r2x-n[0]*this.r2y)*this.r2z-n[7]*this.r2x*this.r2x+n[6]*this.r2x*this.r2y,a[6]+=(n[1]*this.r2y-n[4]*this.r2x)*this.r2z-n[2]*this.r2y*this.r2y+n[5]*this.r2x*this.r2y,a[7]+=(n[3]*this.r2x-n[0]*this.r2y)*this.r2z-n[5]*this.r2x*this.r2x+n[2]*this.r2x*this.r2y,a[8]+=n[0]*this.r2y*this.r2y-(n[3]+n[1])*this.r2x*this.r2y+n[4]*this.r2x*this.r2x;var h=1/(a[0]*(a[4]*a[8]-a[7]*a[5])+a[3]*(a[7]*a[2]-a[1]*a[8])+a[6]*(a[1]*a[5]-a[4]*a[2]));this.dd=new s.Mat33(a[4]*a[8]-a[5]*a[7],a[2]*a[7]-a[1]*a[8],a[1]*a[5]-a[2]*a[4],a[5]*a[6]-a[3]*a[8],a[0]*a[8]-a[2]*a[6],a[2]*a[3]-a[0]*a[5],a[3]*a[7]-a[4]*a[6],a[1]*a[6]-a[0]*a[7],a[0]*a[4]-a[1]*a[3]).multiply(h),this.velx=this.p2.x-this.p1.x,this.vely=this.p2.y-this.p1.y,this.velz=this.p2.z-this.p1.z;var l=s.sqrt(this.velx*this.velx+this.vely*this.vely+this.velz*this.velz);l>.005?(l=(.005-l)/l*e*.05,this.velx*=l,this.vely*=l,this.velz*=l):(this.velx=0,this.vely=0,this.velz=0),this.impx*=.95,this.impy*=.95,this.impz*=.95,this.l1.x+=this.impx*this.m1,this.l1.y+=this.impy*this.m1,this.l1.z+=this.impz*this.m1,this.a1.x+=this.impx*this.ax1x+this.impy*this.ay1x+this.impz*this.az1x,this.a1.y+=this.impx*this.ax1y+this.impy*this.ay1y+this.impz*this.az1y,this.a1.z+=this.impx*this.ax1z+this.impy*this.ay1z+this.impz*this.az1z,this.l2.x-=this.impx*this.m2,this.l2.y-=this.impy*this.m2,this.l2.z-=this.impz*this.m2,this.a2.x-=this.impx*this.ax2x+this.impy*this.ay2x+this.impz*this.az2x,this.a2.y-=this.impx*this.ax2y+this.impy*this.ay2y+this.impz*this.az2y,this.a2.z-=this.impx*this.ax2z+this.impy*this.ay2z+this.impz*this.az2z},solve:function(){var t=this.dd.elements,e=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y-this.velx,i=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z-this.vely,n=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x-this.velz,s=e*t[0]+i*t[1]+n*t[2],r=e*t[3]+i*t[4]+n*t[5],o=e*t[6]+i*t[7]+n*t[8];this.impx+=s,this.impy+=r,this.impz+=o,this.l1.x+=s*this.m1,this.l1.y+=r*this.m1,this.l1.z+=o*this.m1,this.a1.x+=s*this.ax1x+r*this.ay1x+o*this.az1x,this.a1.y+=s*this.ax1y+r*this.ay1y+o*this.az1y,this.a1.z+=s*this.ax1z+r*this.ay1z+o*this.az1z,this.l2.x-=s*this.m2,this.l2.y-=r*this.m2,this.l2.z-=o*this.m2,this.a2.x-=s*this.ax2x+r*this.ay2x+o*this.az2x,this.a2.y-=s*this.ax2y+r*this.ay2y+o*this.az2y,this.a2.z-=s*this.ax2z+r*this.ay2z+o*this.az2z}},s.Rotational3Constraint=function(t,e,i,n){this.cfm1=NaN,this.cfm2=NaN,this.cfm3=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=e,this.limitMotor2=i,this.limitMotor3=n,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0},s.Rotational3Constraint.prototype={constructor:s.Rotational3Constraint,preSolve:function(t,e){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0;var i=this.i1.elements,n=this.i2.elements;this.i1e00=i[0],this.i1e01=i[1],this.i1e02=i[2],this.i1e10=i[3],this.i1e11=i[4],this.i1e12=i[5],this.i1e20=i[6],this.i1e21=i[7],this.i1e22=i[8],this.i2e00=n[0],this.i2e01=n[1],this.i2e02=n[2],this.i2e10=n[3],this.i2e11=n[4],this.i2e12=n[5],this.i2e20=n[6],this.i2e21=n[7],this.i2e22=n[8];var s=this.limitMotor1.frequency,r=this.limitMotor2.frequency,o=this.limitMotor3.frequency,a=s>0,h=r>0,l=o>0,c=this.lowerLimit1<=this.upperLimit1,u=this.lowerLimit2<=this.upperLimit2,d=this.lowerLimit3<=this.upperLimit3,p=this.limitMotor1.angle;c?(this.lowerLimit1==this.upperLimit1?(0!=this.limitState1&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-p):p<this.lowerLimit1?(this.limitState1!=-1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-p):p>this.upperLimit1?(1!=this.limitState1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-p):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),a||(this.limitVelocity1>.02?this.limitVelocity1-=.02:this.limitVelocity1<-.02?this.limitVelocity1+=.02:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0);var f=this.limitMotor2.angle;u?(this.lowerLimit2==this.upperLimit2?(0!=this.limitState2&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-f):f<this.lowerLimit2?(this.limitState2!=-1&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-f):f>this.upperLimit2?(1!=this.limitState2&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-f):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),h||(this.limitVelocity2>.02?this.limitVelocity2-=.02:this.limitVelocity2<-.02?this.limitVelocity2+=.02:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0);var m=this.limitMotor3.angle;if(d?(this.lowerLimit3==this.upperLimit3?(0!=this.limitState3&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-m):m<this.lowerLimit3?(this.limitState3!=-1&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-m):m>this.upperLimit3?(1!=this.limitState3&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-m):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),l||(this.limitVelocity3>.02?this.limitVelocity3-=.02:this.limitVelocity3<-.02?this.limitVelocity3+=.02:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(0!=this.limitState1||a)?this.maxMotorImpulse1=this.maxMotorForce1*t:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(0!=this.limitState2||h)?this.maxMotorImpulse2=this.maxMotorForce2*t:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(0!=this.limitState3||l)?this.maxMotorImpulse3=this.maxMotorForce3*t:(this.motorImpulse3=0,this.maxMotorImpulse3=0),this.a1x1=this.ax1*this.i1e00+this.ay1*this.i1e01+this.az1*this.i1e02,this.a1y1=this.ax1*this.i1e10+this.ay1*this.i1e11+this.az1*this.i1e12,this.a1z1=this.ax1*this.i1e20+this.ay1*this.i1e21+this.az1*this.i1e22,this.a2x1=this.ax1*this.i2e00+this.ay1*this.i2e01+this.az1*this.i2e02,this.a2y1=this.ax1*this.i2e10+this.ay1*this.i2e11+this.az1*this.i2e12,this.a2z1=this.ax1*this.i2e20+this.ay1*this.i2e21+this.az1*this.i2e22,this.a1x2=this.ax2*this.i1e00+this.ay2*this.i1e01+this.az2*this.i1e02,this.a1y2=this.ax2*this.i1e10+this.ay2*this.i1e11+this.az2*this.i1e12,this.a1z2=this.ax2*this.i1e20+this.ay2*this.i1e21+this.az2*this.i1e22,this.a2x2=this.ax2*this.i2e00+this.ay2*this.i2e01+this.az2*this.i2e02,this.a2y2=this.ax2*this.i2e10+this.ay2*this.i2e11+this.az2*this.i2e12,this.a2z2=this.ax2*this.i2e20+this.ay2*this.i2e21+this.az2*this.i2e22,this.a1x3=this.ax3*this.i1e00+this.ay3*this.i1e01+this.az3*this.i1e02,this.a1y3=this.ax3*this.i1e10+this.ay3*this.i1e11+this.az3*this.i1e12,this.a1z3=this.ax3*this.i1e20+this.ay3*this.i1e21+this.az3*this.i1e22,this.a2x3=this.ax3*this.i2e00+this.ay3*this.i2e01+this.az3*this.i2e02,this.a2y3=this.ax3*this.i2e10+this.ay3*this.i2e11+this.az3*this.i2e12,this.a2z3=this.ax3*this.i2e20+this.ay3*this.i2e21+this.az3*this.i2e22,this.k00=this.ax1*(this.a1x1+this.a2x1)+this.ay1*(this.a1y1+this.a2y1)+this.az1*(this.a1z1+this.a2z1),this.k01=this.ax1*(this.a1x2+this.a2x2)+this.ay1*(this.a1y2+this.a2y2)+this.az1*(this.a1z2+this.a2z2),this.k02=this.ax1*(this.a1x3+this.a2x3)+this.ay1*(this.a1y3+this.a2y3)+this.az1*(this.a1z3+this.a2z3),this.k10=this.ax2*(this.a1x1+this.a2x1)+this.ay2*(this.a1y1+this.a2y1)+this.az2*(this.a1z1+this.a2z1),this.k11=this.ax2*(this.a1x2+this.a2x2)+this.ay2*(this.a1y2+this.a2y2)+this.az2*(this.a1z2+this.a2z2),this.k12=this.ax2*(this.a1x3+this.a2x3)+this.ay2*(this.a1y3+this.a2y3)+this.az2*(this.a1z3+this.a2z3),this.k20=this.ax3*(this.a1x1+this.a2x1)+this.ay3*(this.a1y1+this.a2y1)+this.az3*(this.a1z1+this.a2z1),this.k21=this.ax3*(this.a1x2+this.a2x2)+this.ay3*(this.a1y2+this.a2y2)+this.az3*(this.a1z2+this.a2z2),this.k22=this.ax3*(this.a1x3+this.a2x3)+this.ay3*(this.a1y3+this.a2y3)+this.az3*(this.a1z3+this.a2z3),this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,a&&2!=this.limitState1){var g=6.2831853*s,v=g*g*t,y=e/(v+2*this.limitMotor1.dampingRatio*g);this.cfm1=this.kv00*y,this.limitVelocity1*=v*y}else this.cfm1=0,this.limitVelocity1*=.05*e;h&&2!=this.limitState2?(g=6.2831853*r,v=g*g*t,y=e/(v+2*this.limitMotor2.dampingRatio*g),this.cfm2=this.kv11*y,this.limitVelocity2*=v*y):(this.cfm2=0,this.limitVelocity2*=.05*e),l&&2!=this.limitState3?(g=6.2831853*o,v=g*g*t,y=e/(v+2*this.limitMotor3.dampingRatio*g),this.cfm3=this.kv22*y,this.limitVelocity3*=v*y):(this.cfm3=0,this.limitVelocity3*=.05*e),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var x=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*x,this.d01=(this.k02*this.k21-this.k01*this.k22)*x,this.d02=(this.k01*this.k12-this.k02*this.k11)*x,this.d10=(this.k12*this.k20-this.k10*this.k22)*x,this.d11=(this.k00*this.k22-this.k02*this.k20)*x,this.d12=(this.k02*this.k10-this.k00*this.k12)*x,this.d20=(this.k10*this.k21-this.k11*this.k20)*x,this.d21=(this.k01*this.k20-this.k00*this.k21)*x,this.d22=(this.k00*this.k11-this.k01*this.k10)*x,this.limitImpulse1*=.95,this.motorImpulse1*=.95,this.limitImpulse2*=.95,this.motorImpulse2*=.95,this.limitImpulse3*=.95,this.motorImpulse3*=.95;var b=this.limitImpulse1+this.motorImpulse1,w=this.limitImpulse2+this.motorImpulse2,_=this.limitImpulse3+this.motorImpulse3;this.a1.x+=b*this.a1x1+w*this.a1x2+_*this.a1x3,this.a1.y+=b*this.a1y1+w*this.a1y2+_*this.a1y3,this.a1.z+=b*this.a1z1+w*this.a1z2+_*this.a1z3,this.a2.x-=b*this.a2x1+w*this.a2x2+_*this.a2x3,this.a2.y-=b*this.a2y1+w*this.a2y2+_*this.a2y3,this.a2.z-=b*this.a2z1+w*this.a2z2+_*this.a2z3},solve_:function(){var t=this.a2.x-this.a1.x,e=this.a2.y-this.a1.y,i=this.a2.z-this.a1.z;this.limitVelocity3=30;var n=t*this.ax1+e*this.ay1+i*this.az1-this.limitVelocity1,s=t*this.ax2+e*this.ay2+i*this.az2-this.limitVelocity2,r=t*this.ax3+e*this.ay3+i*this.az3-this.limitVelocity3,o=n*this.d00+s*this.d01+r*this.d02,a=n*this.d10+s*this.d11+r*this.d12,h=n*this.d20+s*this.d21+r*this.d22;this.limitImpulse1+=o,this.limitImpulse2+=a,this.limitImpulse3+=h,this.a1.x+=o*this.a1x1+a*this.a1x2+h*this.a1x3,this.a1.y+=o*this.a1y1+a*this.a1y2+h*this.a1y3,this.a1.z+=o*this.a1z1+a*this.a1z2+h*this.a1z3,this.a2.x-=o*this.a2x1+a*this.a2x2+h*this.a2x3,this.a2.y-=o*this.a2y1+a*this.a2y2+h*this.a2y3,this.a2.z-=o*this.a2z1+a*this.a2z2+h*this.a2z3},solve:function(){var t=this.a2.x-this.a1.x,e=this.a2.y-this.a1.y,i=this.a2.z-this.a1.z,n=t*this.ax1+e*this.ay1+i*this.az1,s=t*this.ax2+e*this.ay2+i*this.az2,r=t*this.ax3+e*this.ay3+i*this.az3,o=this.motorImpulse1,a=this.motorImpulse2,h=this.motorImpulse3,l=0,c=0,u=0;this.enableMotor1&&(l=(n-this.motorSpeed1)*this.dv00,this.motorImpulse1+=l,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),l=this.motorImpulse1-o),this.enableMotor2&&(c=(s-this.motorSpeed2)*this.dv11,this.motorImpulse2+=c,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),c=this.motorImpulse2-a),this.enableMotor3&&(u=(r-this.motorSpeed3)*this.dv22,this.motorImpulse3+=u,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),u=this.motorImpulse3-h),n+=l*this.kv00+c*this.k01+u*this.k02,s+=l*this.k10+c*this.kv11+u*this.k12,r+=l*this.k20+c*this.k21+u*this.kv22,n-=this.limitVelocity1+this.limitImpulse1*this.cfm1,s-=this.limitVelocity2+this.limitImpulse2*this.cfm2,r-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var d=this.limitImpulse1,p=this.limitImpulse2,f=this.limitImpulse3,m=n*this.d00+s*this.d01+r*this.d02,g=n*this.d10+s*this.d11+r*this.d12,v=n*this.d20+s*this.d21+r*this.d22;
this.limitImpulse1+=m,this.limitImpulse2+=g,this.limitImpulse3+=v;var y=0;(2==this.limitState1||this.limitImpulse1*this.limitState1<0)&&(m=-d,s+=m*this.k10,r+=m*this.k20,y|=1),(2==this.limitState2||this.limitImpulse2*this.limitState2<0)&&(g=-p,n+=g*this.k01,r+=g*this.k21,y|=2),(2==this.limitState3||this.limitImpulse3*this.limitState3<0)&&(v=-f,n+=v*this.k02,s+=v*this.k12,y|=4);var x;switch(y){case 1:x=1/(this.k11*this.k22-this.k12*this.k21),g=(this.k22*s+-this.k12*r)*x,v=(-this.k21*s+this.k11*r)*x;break;case 2:x=1/(this.k00*this.k22-this.k02*this.k20),m=(this.k22*n+-this.k02*r)*x,v=(-this.k20*n+this.k00*r)*x;break;case 3:v=r/this.k22;break;case 4:x=1/(this.k00*this.k11-this.k01*this.k10),m=(this.k11*n+-this.k01*s)*x,g=(-this.k10*n+this.k00*s)*x;break;case 5:g=s/this.k11;break;case 6:m=n/this.k00}this.limitImpulse1=m+d,this.limitImpulse2=g+p,this.limitImpulse3=v+f;var b=l+m,w=c+g,_=u+v;this.a1.x+=b*this.a1x1+w*this.a1x2+_*this.a1x3,this.a1.y+=b*this.a1y1+w*this.a1y2+_*this.a1y3,this.a1.z+=b*this.a1z1+w*this.a1z2+_*this.a1z3,this.a2.x-=b*this.a2x1+w*this.a2x2+_*this.a2x3,this.a2.y-=b*this.a2y1+w*this.a2y2+_*this.a2y3,this.a2.z-=b*this.a2z1+w*this.a2z2+_*this.a2z3,t=this.a2.x-this.a1.x,e=this.a2.y-this.a1.y,i=this.a2.z-this.a1.z,s=t*this.ax2+e*this.ay2+i*this.az2}},s.RotationalConstraint=function(t,e){this.cfm=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.motorDenom=NaN,this.invMotorDenom=NaN,this.invDenom=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.a1x=NaN,this.a1y=NaN,this.a1z=NaN,this.a2x=NaN,this.a2y=NaN,this.a2z=NaN,this.enableLimit=!1,this.lowerLimit=NaN,this.upperLimit=NaN,this.limitVelocity=NaN,this.limitState=0,this.enableMotor=!1,this.motorSpeed=NaN,this.maxMotorForce=NaN,this.maxMotorImpulse=NaN,this.limitMotor=e,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse=0,this.motorImpulse=0},s.RotationalConstraint.prototype={constructor:s.RotationalConstraint,preSolve:function(t,e){this.ax=this.limitMotor.axis.x,this.ay=this.limitMotor.axis.y,this.az=this.limitMotor.axis.z,this.lowerLimit=this.limitMotor.lowerLimit,this.upperLimit=this.limitMotor.upperLimit,this.motorSpeed=this.limitMotor.motorSpeed,this.maxMotorForce=this.limitMotor.maxMotorForce,this.enableMotor=this.maxMotorForce>0;var i=this.i1.elements,n=this.i2.elements;this.i1e00=i[0],this.i1e01=i[1],this.i1e02=i[2],this.i1e10=i[3],this.i1e11=i[4],this.i1e12=i[5],this.i1e20=i[6],this.i1e21=i[7],this.i1e22=i[8],this.i2e00=n[0],this.i2e01=n[1],this.i2e02=n[2],this.i2e10=n[3],this.i2e11=n[4],this.i2e12=n[5],this.i2e20=n[6],this.i2e21=n[7],this.i2e22=n[8];var s=this.limitMotor.frequency,r=s>0,o=this.lowerLimit<=this.upperLimit,a=this.limitMotor.angle;if(o?(this.lowerLimit==this.upperLimit?(0!=this.limitState&&(this.limitState=0,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-a):a<this.lowerLimit?(this.limitState!=-1&&(this.limitState=-1,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-a):a>this.upperLimit?(1!=this.limitState&&(this.limitState=1,this.limitImpulse=0),this.limitVelocity=this.upperLimit-a):(this.limitState=2,this.limitImpulse=0,this.limitVelocity=0),r||(this.limitVelocity>.02?this.limitVelocity-=.02:this.limitVelocity<-.02?this.limitVelocity+=.02:this.limitVelocity=0)):(this.limitState=2,this.limitImpulse=0),this.enableMotor&&(0!=this.limitState||r)?this.maxMotorImpulse=this.maxMotorForce*t:(this.motorImpulse=0,this.maxMotorImpulse=0),this.a1x=this.ax*this.i1e00+this.ay*this.i1e01+this.az*this.i1e02,this.a1y=this.ax*this.i1e10+this.ay*this.i1e11+this.az*this.i1e12,this.a1z=this.ax*this.i1e20+this.ay*this.i1e21+this.az*this.i1e22,this.a2x=this.ax*this.i2e00+this.ay*this.i2e01+this.az*this.i2e02,this.a2y=this.ax*this.i2e10+this.ay*this.i2e11+this.az*this.i2e12,this.a2z=this.ax*this.i2e20+this.ay*this.i2e21+this.az*this.i2e22,this.motorDenom=this.ax*(this.a1x+this.a2x)+this.ay*(this.a1y+this.a2y)+this.az*(this.a1z+this.a2z),this.invMotorDenom=1/this.motorDenom,r&&2!=this.limitState){var h=6.2831853*s,l=h*h*t,c=e/(l+2*this.limitMotor.dampingRatio*h);this.cfm=this.motorDenom*c,this.limitVelocity*=l*c}else this.cfm=0,this.limitVelocity*=.05*e;this.invDenom=1/(this.motorDenom+this.cfm),this.limitImpulse*=.95,this.motorImpulse*=.95;var u=this.limitImpulse+this.motorImpulse;this.a1.x+=u*this.a1x,this.a1.y+=u*this.a1y,this.a1.z+=u*this.a1z,this.a2.x-=u*this.a2x,this.a2.y-=u*this.a2y,this.a2.z-=u*this.a2z},solve:function(){var t,e=this.ax*(this.a2.x-this.a1.x)+this.ay*(this.a2.y-this.a1.y)+this.az*(this.a2.z-this.a1.z);if(this.enableMotor){t=(e-this.motorSpeed)*this.invMotorDenom;var i=this.motorImpulse;this.motorImpulse+=t,this.motorImpulse>this.maxMotorImpulse?this.motorImpulse=this.maxMotorImpulse:this.motorImpulse<-this.maxMotorImpulse&&(this.motorImpulse=-this.maxMotorImpulse),t=this.motorImpulse-i,e-=t*this.motorDenom}else t=0;var n;if(2!=this.limitState){n=(e-this.limitVelocity-this.limitImpulse*this.cfm)*this.invDenom;var s=this.limitImpulse;this.limitImpulse+=n,this.limitImpulse*this.limitState<0&&(this.limitImpulse=0),n=this.limitImpulse-s}else n=0;var r=n+t;this.a1.x+=r*this.a1x,this.a1.y+=r*this.a1y,this.a1.z+=r*this.a1z,this.a2.x-=r*this.a2x,this.a2.y-=r*this.a2y,this.a2.z-=r*this.a2z}},s.Translational3Constraint=function(t,e,i,n){this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x1=NaN,this.t1y1=NaN,this.t1z1=NaN,this.t2x1=NaN,this.t2y1=NaN,this.t2z1=NaN,this.l1x1=NaN,this.l1y1=NaN,this.l1z1=NaN,this.l2x1=NaN,this.l2y1=NaN,this.l2z1=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.t1x2=NaN,this.t1y2=NaN,this.t1z2=NaN,this.t2x2=NaN,this.t2y2=NaN,this.t2z2=NaN,this.l1x2=NaN,this.l1y2=NaN,this.l1z2=NaN,this.l2x2=NaN,this.l2y2=NaN,this.l2z2=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.t1x3=NaN,this.t1y3=NaN,this.t1z3=NaN,this.t2x3=NaN,this.t2y3=NaN,this.t2z3=NaN,this.l1x3=NaN,this.l1y3=NaN,this.l1z3=NaN,this.l2x3=NaN,this.l2y3=NaN,this.l2z3=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=e,this.limitMotor2=i,this.limitMotor3=n,this.b1=t.body1,this.b2=t.body2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0,this.cfm1=0,this.cfm2=0,this.cfm3=0,this.weight=-1},s.Translational3Constraint.prototype={constructor:s.Translational3Constraint,preSolve:function(t,e){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var i=this.i1.elements,n=this.i2.elements;this.i1e00=i[0],this.i1e01=i[1],this.i1e02=i[2],this.i1e10=i[3],this.i1e11=i[4],this.i1e12=i[5],this.i1e20=i[6],this.i1e21=i[7],this.i1e22=i[8],this.i2e00=n[0],this.i2e01=n[1],this.i2e02=n[2],this.i2e10=n[3],this.i2e11=n[4],this.i2e12=n[5],this.i2e20=n[6],this.i2e21=n[7],this.i2e22=n[8];var s=this.p2.x-this.p1.x,r=this.p2.y-this.p1.y,o=this.p2.z-this.p1.z,a=s*this.ax1+r*this.ay1+o*this.az1,h=s*this.ax2+r*this.ay2+o*this.az2,l=s*this.ax3+r*this.ay3+o*this.az3,c=this.limitMotor1.frequency,u=this.limitMotor2.frequency,d=this.limitMotor3.frequency,p=c>0,f=u>0,m=d>0,g=this.lowerLimit1<=this.upperLimit1,v=this.lowerLimit2<=this.upperLimit2,y=this.lowerLimit3<=this.upperLimit3;(p&&a>20||a<-20)&&(p=!1),(f&&h>20||h<-20)&&(f=!1),(m&&l>20||l<-20)&&(m=!1),g?(this.lowerLimit1==this.upperLimit1?(0!=this.limitState1&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-a,p||(a=this.lowerLimit1)):a<this.lowerLimit1?(this.limitState1!=-1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-a,p||(a=this.lowerLimit1)):a>this.upperLimit1?(1!=this.limitState1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-a,p||(a=this.upperLimit1)):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),p||(this.limitVelocity1>.005?this.limitVelocity1-=.005:this.limitVelocity1<-.005?this.limitVelocity1+=.005:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0),v?(this.lowerLimit2==this.upperLimit2?(0!=this.limitState2&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-h,f||(h=this.lowerLimit2)):h<this.lowerLimit2?(this.limitState2!=-1&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-h,f||(h=this.lowerLimit2)):h>this.upperLimit2?(1!=this.limitState2&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-h,f||(h=this.upperLimit2)):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),f||(this.limitVelocity2>.005?this.limitVelocity2-=.005:this.limitVelocity2<-.005?this.limitVelocity2+=.005:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0),y?(this.lowerLimit3==this.upperLimit3?(0!=this.limitState3&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-l,m||(l=this.lowerLimit3)):l<this.lowerLimit3?(this.limitState3!=-1&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-l,m||(l=this.lowerLimit3)):l>this.upperLimit3?(1!=this.limitState3&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-l,m||(l=this.upperLimit3)):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),m||(this.limitVelocity3>.005?this.limitVelocity3-=.005:this.limitVelocity3<-.005?this.limitVelocity3+=.005:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(0!=this.limitState1||p)?this.maxMotorImpulse1=this.maxMotorForce1*t:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(0!=this.limitState2||f)?this.maxMotorImpulse2=this.maxMotorForce2*t:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(0!=this.limitState3||m)?this.maxMotorImpulse3=this.maxMotorForce3*t:(this.motorImpulse3=0,this.maxMotorImpulse3=0);var x=a*this.ax1+h*this.ax2+l*this.ax2,b=a*this.ay1+h*this.ay2+l*this.ay2,w=a*this.az1+h*this.az2+l*this.az2,_=this.m2/(this.m1+this.m2);this.weight>=0&&(_=this.weight);var S=1-_;this.r1x=this.r1.x+x*_,this.r1y=this.r1.y+b*_,this.r1z=this.r1.z+w*_,this.r2x=this.r2.x-x*S,this.r2y=this.r2.y-b*S,this.r2z=this.r2.z-w*S,this.t1x1=this.r1y*this.az1-this.r1z*this.ay1,this.t1y1=this.r1z*this.ax1-this.r1x*this.az1,this.t1z1=this.r1x*this.ay1-this.r1y*this.ax1,this.t2x1=this.r2y*this.az1-this.r2z*this.ay1,this.t2y1=this.r2z*this.ax1-this.r2x*this.az1,this.t2z1=this.r2x*this.ay1-this.r2y*this.ax1,this.l1x1=this.ax1*this.m1,this.l1y1=this.ay1*this.m1,this.l1z1=this.az1*this.m1,this.l2x1=this.ax1*this.m2,this.l2y1=this.ay1*this.m2,this.l2z1=this.az1*this.m2,this.a1x1=this.t1x1*this.i1e00+this.t1y1*this.i1e01+this.t1z1*this.i1e02,this.a1y1=this.t1x1*this.i1e10+this.t1y1*this.i1e11+this.t1z1*this.i1e12,this.a1z1=this.t1x1*this.i1e20+this.t1y1*this.i1e21+this.t1z1*this.i1e22,this.a2x1=this.t2x1*this.i2e00+this.t2y1*this.i2e01+this.t2z1*this.i2e02,this.a2y1=this.t2x1*this.i2e10+this.t2y1*this.i2e11+this.t2z1*this.i2e12,this.a2z1=this.t2x1*this.i2e20+this.t2y1*this.i2e21+this.t2z1*this.i2e22,this.t1x2=this.r1y*this.az2-this.r1z*this.ay2,this.t1y2=this.r1z*this.ax2-this.r1x*this.az2,this.t1z2=this.r1x*this.ay2-this.r1y*this.ax2,this.t2x2=this.r2y*this.az2-this.r2z*this.ay2,this.t2y2=this.r2z*this.ax2-this.r2x*this.az2,this.t2z2=this.r2x*this.ay2-this.r2y*this.ax2,this.l1x2=this.ax2*this.m1,this.l1y2=this.ay2*this.m1,this.l1z2=this.az2*this.m1,this.l2x2=this.ax2*this.m2,this.l2y2=this.ay2*this.m2,this.l2z2=this.az2*this.m2,this.a1x2=this.t1x2*this.i1e00+this.t1y2*this.i1e01+this.t1z2*this.i1e02,this.a1y2=this.t1x2*this.i1e10+this.t1y2*this.i1e11+this.t1z2*this.i1e12,this.a1z2=this.t1x2*this.i1e20+this.t1y2*this.i1e21+this.t1z2*this.i1e22,this.a2x2=this.t2x2*this.i2e00+this.t2y2*this.i2e01+this.t2z2*this.i2e02,this.a2y2=this.t2x2*this.i2e10+this.t2y2*this.i2e11+this.t2z2*this.i2e12,this.a2z2=this.t2x2*this.i2e20+this.t2y2*this.i2e21+this.t2z2*this.i2e22,this.t1x3=this.r1y*this.az3-this.r1z*this.ay3,this.t1y3=this.r1z*this.ax3-this.r1x*this.az3,this.t1z3=this.r1x*this.ay3-this.r1y*this.ax3,this.t2x3=this.r2y*this.az3-this.r2z*this.ay3,this.t2y3=this.r2z*this.ax3-this.r2x*this.az3,this.t2z3=this.r2x*this.ay3-this.r2y*this.ax3,this.l1x3=this.ax3*this.m1,this.l1y3=this.ay3*this.m1,this.l1z3=this.az3*this.m1,this.l2x3=this.ax3*this.m2,this.l2y3=this.ay3*this.m2,this.l2z3=this.az3*this.m2,this.a1x3=this.t1x3*this.i1e00+this.t1y3*this.i1e01+this.t1z3*this.i1e02,this.a1y3=this.t1x3*this.i1e10+this.t1y3*this.i1e11+this.t1z3*this.i1e12,this.a1z3=this.t1x3*this.i1e20+this.t1y3*this.i1e21+this.t1z3*this.i1e22,this.a2x3=this.t2x3*this.i2e00+this.t2y3*this.i2e01+this.t2z3*this.i2e02,this.a2y3=this.t2x3*this.i2e10+this.t2y3*this.i2e11+this.t2z3*this.i2e12,this.a2z3=this.t2x3*this.i2e20+this.t2y3*this.i2e21+this.t2z3*this.i2e22;var M=this.m1+this.m2;if(this.k00=(this.ax1*this.ax1+this.ay1*this.ay1+this.az1*this.az1)*M,this.k01=(this.ax1*this.ax2+this.ay1*this.ay2+this.az1*this.az2)*M,this.k02=(this.ax1*this.ax3+this.ay1*this.ay3+this.az1*this.az3)*M,this.k10=(this.ax2*this.ax1+this.ay2*this.ay1+this.az2*this.az1)*M,this.k11=(this.ax2*this.ax2+this.ay2*this.ay2+this.az2*this.az2)*M,this.k12=(this.ax2*this.ax3+this.ay2*this.ay3+this.az2*this.az3)*M,this.k20=(this.ax3*this.ax1+this.ay3*this.ay1+this.az3*this.az1)*M,this.k21=(this.ax3*this.ax2+this.ay3*this.ay2+this.az3*this.az2)*M,this.k22=(this.ax3*this.ax3+this.ay3*this.ay3+this.az3*this.az3)*M,this.k00+=this.t1x1*this.a1x1+this.t1y1*this.a1y1+this.t1z1*this.a1z1,this.k01+=this.t1x1*this.a1x2+this.t1y1*this.a1y2+this.t1z1*this.a1z2,this.k02+=this.t1x1*this.a1x3+this.t1y1*this.a1y3+this.t1z1*this.a1z3,this.k10+=this.t1x2*this.a1x1+this.t1y2*this.a1y1+this.t1z2*this.a1z1,this.k11+=this.t1x2*this.a1x2+this.t1y2*this.a1y2+this.t1z2*this.a1z2,this.k12+=this.t1x2*this.a1x3+this.t1y2*this.a1y3+this.t1z2*this.a1z3,this.k20+=this.t1x3*this.a1x1+this.t1y3*this.a1y1+this.t1z3*this.a1z1,this.k21+=this.t1x3*this.a1x2+this.t1y3*this.a1y2+this.t1z3*this.a1z2,this.k22+=this.t1x3*this.a1x3+this.t1y3*this.a1y3+this.t1z3*this.a1z3,this.k00+=this.t2x1*this.a2x1+this.t2y1*this.a2y1+this.t2z1*this.a2z1,this.k01+=this.t2x1*this.a2x2+this.t2y1*this.a2y2+this.t2z1*this.a2z2,this.k02+=this.t2x1*this.a2x3+this.t2y1*this.a2y3+this.t2z1*this.a2z3,this.k10+=this.t2x2*this.a2x1+this.t2y2*this.a2y1+this.t2z2*this.a2z1,this.k11+=this.t2x2*this.a2x2+this.t2y2*this.a2y2+this.t2z2*this.a2z2,this.k12+=this.t2x2*this.a2x3+this.t2y2*this.a2y3+this.t2z2*this.a2z3,this.k20+=this.t2x3*this.a2x1+this.t2y3*this.a2y1+this.t2z3*this.a2z1,this.k21+=this.t2x3*this.a2x2+this.t2y3*this.a2y2+this.t2z3*this.a2z2,this.k22+=this.t2x3*this.a2x3+this.t2y3*this.a2y3+this.t2z3*this.a2z3,this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,p&&2!=this.limitState1){var T=6.2831853*c,E=T*T*t,C=e/(E+2*this.limitMotor1.dampingRatio*T);this.cfm1=this.kv00*C,this.limitVelocity1*=E*C}else this.cfm1=0,this.limitVelocity1*=.05*e;f&&2!=this.limitState2?(T=6.2831853*u,E=T*T*t,C=e/(E+2*this.limitMotor2.dampingRatio*T),this.cfm2=this.kv11*C,this.limitVelocity2*=E*C):(this.cfm2=0,this.limitVelocity2*=.05*e),m&&2!=this.limitState3?(T=6.2831853*d,E=T*T*t,C=e/(E+2*this.limitMotor3.dampingRatio*T),this.cfm3=this.kv22*C,this.limitVelocity3*=E*C):(this.cfm3=0,this.limitVelocity3*=.05*e),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var A=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*A,this.d01=(this.k02*this.k21-this.k01*this.k22)*A,this.d02=(this.k01*this.k12-this.k02*this.k11)*A,this.d10=(this.k12*this.k20-this.k10*this.k22)*A,this.d11=(this.k00*this.k22-this.k02*this.k20)*A,this.d12=(this.k02*this.k10-this.k00*this.k12)*A,this.d20=(this.k10*this.k21-this.k11*this.k20)*A,this.d21=(this.k01*this.k20-this.k00*this.k21)*A,this.d22=(this.k00*this.k11-this.k01*this.k10)*A;var N=this.limitImpulse1+this.motorImpulse1,L=this.limitImpulse2+this.motorImpulse2,P=this.limitImpulse3+this.motorImpulse3;this.l1.x+=N*this.l1x1+L*this.l1x2+P*this.l1x3,this.l1.y+=N*this.l1y1+L*this.l1y2+P*this.l1y3,this.l1.z+=N*this.l1z1+L*this.l1z2+P*this.l1z3,this.a1.x+=N*this.a1x1+L*this.a1x2+P*this.a1x3,this.a1.y+=N*this.a1y1+L*this.a1y2+P*this.a1y3,this.a1.z+=N*this.a1z1+L*this.a1z2+P*this.a1z3,this.l2.x-=N*this.l2x1+L*this.l2x2+P*this.l2x3,this.l2.y-=N*this.l2y1+L*this.l2y2+P*this.l2y3,this.l2.z-=N*this.l2z1+L*this.l2z2+P*this.l2z3,this.a2.x-=N*this.a2x1+L*this.a2x2+P*this.a2x3,this.a2.y-=N*this.a2y1+L*this.a2y2+P*this.a2y3,this.a2.z-=N*this.a2z1+L*this.a2z2+P*this.a2z3},solve:function(){var t=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y,e=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z,i=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x,n=t*this.ax1+e*this.ay1+i*this.az1,s=t*this.ax2+e*this.ay2+i*this.az2,r=t*this.ax3+e*this.ay3+i*this.az3,o=this.motorImpulse1,a=this.motorImpulse2,h=this.motorImpulse3,l=0,c=0,u=0;this.enableMotor1&&(l=(n-this.motorSpeed1)*this.dv00,this.motorImpulse1+=l,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),l=this.motorImpulse1-o),this.enableMotor2&&(c=(s-this.motorSpeed2)*this.dv11,this.motorImpulse2+=c,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),c=this.motorImpulse2-a),this.enableMotor3&&(u=(r-this.motorSpeed3)*this.dv22,this.motorImpulse3+=u,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),u=this.motorImpulse3-h),n+=l*this.kv00+c*this.k01+u*this.k02,s+=l*this.k10+c*this.kv11+u*this.k12,r+=l*this.k20+c*this.k21+u*this.kv22,n-=this.limitVelocity1+this.limitImpulse1*this.cfm1,s-=this.limitVelocity2+this.limitImpulse2*this.cfm2,r-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var d=this.limitImpulse1,p=this.limitImpulse2,f=this.limitImpulse3,m=n*this.d00+s*this.d01+r*this.d02,g=n*this.d10+s*this.d11+r*this.d12,v=n*this.d20+s*this.d21+r*this.d22;this.limitImpulse1+=m,this.limitImpulse2+=g,this.limitImpulse3+=v;var y=0;(2==this.limitState1||this.limitImpulse1*this.limitState1<0)&&(m=-d,s+=m*this.k10,r+=m*this.k20,y|=1),(2==this.limitState2||this.limitImpulse2*this.limitState2<0)&&(g=-p,n+=g*this.k01,r+=g*this.k21,y|=2),(2==this.limitState3||this.limitImpulse3*this.limitState3<0)&&(v=-f,n+=v*this.k02,s+=v*this.k12,y|=4);var x;switch(y){case 1:x=1/(this.k11*this.k22-this.k12*this.k21),g=(this.k22*s+-this.k12*r)*x,v=(-this.k21*s+this.k11*r)*x;break;case 2:x=1/(this.k00*this.k22-this.k02*this.k20),m=(this.k22*n+-this.k02*r)*x,v=(-this.k20*n+this.k00*r)*x;break;case 3:v=r/this.k22;break;case 4:x=1/(this.k00*this.k11-this.k01*this.k10),m=(this.k11*n+-this.k01*s)*x,g=(-this.k10*n+this.k00*s)*x;break;case 5:g=s/this.k11;break;case 6:m=n/this.k00}this.limitImpulse1=d+m,this.limitImpulse2=p+g,this.limitImpulse3=f+v;var b=l+m,w=c+g,_=u+v;this.l1.x+=b*this.l1x1+w*this.l1x2+_*this.l1x3,this.l1.y+=b*this.l1y1+w*this.l1y2+_*this.l1y3,this.l1.z+=b*this.l1z1+w*this.l1z2+_*this.l1z3,this.a1.x+=b*this.a1x1+w*this.a1x2+_*this.a1x3,this.a1.y+=b*this.a1y1+w*this.a1y2+_*this.a1y3,this.a1.z+=b*this.a1z1+w*this.a1z2+_*this.a1z3,this.l2.x-=b*this.l2x1+w*this.l2x2+_*this.l2x3,this.l2.y-=b*this.l2y1+w*this.l2y2+_*this.l2y3,this.l2.z-=b*this.l2z1+w*this.l2z2+_*this.l2z3,this.a2.x-=b*this.a2x1+w*this.a2x2+_*this.a2x3,this.a2.y-=b*this.a2y1+w*this.a2y2+_*this.a2y3,this.a2.z-=b*this.a2z1+w*this.a2z2+_*this.a2z3}},s.TranslationalConstraint=function(t,e){this.cfm=NaN,this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.motorDenom=NaN,this.invMotorDenom=NaN,this.invDenom=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x=NaN,this.t1y=NaN,this.t1z=NaN,this.t2x=NaN,this.t2y=NaN,this.t2z=NaN,this.l1x=NaN,this.l1y=NaN,this.l1z=NaN,this.l2x=NaN,this.l2y=NaN,this.l2z=NaN,this.a1x=NaN,this.a1y=NaN,this.a1z=NaN,this.a2x=NaN,this.a2y=NaN,this.a2z=NaN,this.lowerLimit=NaN,this.upperLimit=NaN,this.limitVelocity=NaN,this.limitState=0,this.enableMotor=!1,this.motorSpeed=NaN,this.maxMotorForce=NaN,this.maxMotorImpulse=NaN,this.limitMotor=e,this.b1=t.body1,this.b2=t.body2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse=0,this.motorImpulse=0},s.TranslationalConstraint.prototype={constructor:s.TranslationalConstraint,preSolve:function(t,e){this.ax=this.limitMotor.axis.x,this.ay=this.limitMotor.axis.y,this.az=this.limitMotor.axis.z,this.lowerLimit=this.limitMotor.lowerLimit,this.upperLimit=this.limitMotor.upperLimit,this.motorSpeed=this.limitMotor.motorSpeed,this.maxMotorForce=this.limitMotor.maxMotorForce,this.enableMotor=this.maxMotorForce>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var i=this.i1.elements,n=this.i2.elements;this.i1e00=i[0],this.i1e01=i[1],this.i1e02=i[2],this.i1e10=i[3],this.i1e11=i[4],this.i1e12=i[5],this.i1e20=i[6],this.i1e21=i[7],this.i1e22=i[8],this.i2e00=n[0],this.i2e01=n[1],this.i2e02=n[2],this.i2e10=n[3],this.i2e11=n[4],this.i2e12=n[5],this.i2e20=n[6],this.i2e21=n[7],this.i2e22=n[8];var s=this.p2.x-this.p1.x,r=this.p2.y-this.p1.y,o=this.p2.z-this.p1.z,a=s*this.ax+r*this.ay+o*this.az,h=this.limitMotor.frequency,l=h>0,c=this.lowerLimit<=this.upperLimit;(l&&a>20||a<-20)&&(l=!1),c?(this.lowerLimit==this.upperLimit?(0!=this.limitState&&(this.limitState=0,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-a,l||(a=this.lowerLimit)):a<this.lowerLimit?(this.limitState!=-1&&(this.limitState=-1,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-a,l||(a=this.lowerLimit)):a>this.upperLimit?(1!=this.limitState&&(this.limitState=1,this.limitImpulse=0),this.limitVelocity=this.upperLimit-a,l||(a=this.upperLimit)):(this.limitState=2,this.limitImpulse=0,this.limitVelocity=0),l||(this.limitVelocity>.005?this.limitVelocity-=.005:this.limitVelocity<-.005?this.limitVelocity+=.005:this.limitVelocity=0)):(this.limitState=2,this.limitImpulse=0),this.enableMotor&&(0!=this.limitState||l)?this.maxMotorImpulse=this.maxMotorForce*t:(this.motorImpulse=0,this.maxMotorImpulse=0);var u=a*this.ax,d=a*this.ay,p=a*this.az,f=this.m1/(this.m1+this.m2),m=1-f;if(this.r1x=this.r1.x+u*f,this.r1y=this.r1.y+d*f,this.r1z=this.r1.z+p*f,this.r2x=this.r2.x-u*m,this.r2y=this.r2.y-d*m,this.r2z=this.r2.z-p*m,this.t1x=this.r1y*this.az-this.r1z*this.ay,this.t1y=this.r1z*this.ax-this.r1x*this.az,this.t1z=this.r1x*this.ay-this.r1y*this.ax,this.t2x=this.r2y*this.az-this.r2z*this.ay,this.t2y=this.r2z*this.ax-this.r2x*this.az,this.t2z=this.r2x*this.ay-this.r2y*this.ax,this.l1x=this.ax*this.m1,this.l1y=this.ay*this.m1,this.l1z=this.az*this.m1,this.l2x=this.ax*this.m2,this.l2y=this.ay*this.m2,this.l2z=this.az*this.m2,this.a1x=this.t1x*this.i1e00+this.t1y*this.i1e01+this.t1z*this.i1e02,this.a1y=this.t1x*this.i1e10+this.t1y*this.i1e11+this.t1z*this.i1e12,this.a1z=this.t1x*this.i1e20+this.t1y*this.i1e21+this.t1z*this.i1e22,this.a2x=this.t2x*this.i2e00+this.t2y*this.i2e01+this.t2z*this.i2e02,this.a2y=this.t2x*this.i2e10+this.t2y*this.i2e11+this.t2z*this.i2e12,this.a2z=this.t2x*this.i2e20+this.t2y*this.i2e21+this.t2z*this.i2e22,this.motorDenom=this.m1+this.m2+this.ax*(this.a1y*this.r1z-this.a1z*this.r1y+this.a2y*this.r2z-this.a2z*this.r2y)+this.ay*(this.a1z*this.r1x-this.a1x*this.r1z+this.a2z*this.r2x-this.a2x*this.r2z)+this.az*(this.a1x*this.r1y-this.a1y*this.r1x+this.a2x*this.r2y-this.a2y*this.r2x),this.invMotorDenom=1/this.motorDenom,l&&2!=this.limitState){var g=6.2831853*h,v=g*g*t,y=e/(v+2*this.limitMotor.dampingRatio*g);this.cfm=this.motorDenom*y,this.limitVelocity*=v*y}else this.cfm=0,this.limitVelocity*=.05*e;this.invDenom=1/(this.motorDenom+this.cfm);var x=this.limitImpulse+this.motorImpulse;this.l1.x+=x*this.l1x,this.l1.y+=x*this.l1y,this.l1.z+=x*this.l1z,this.a1.x+=x*this.a1x,this.a1.y+=x*this.a1y,this.a1.z+=x*this.a1z,this.l2.x-=x*this.l2x,this.l2.y-=x*this.l2y,this.l2.z-=x*this.l2z,this.a2.x-=x*this.a2x,this.a2.y-=x*this.a2y,this.a2.z-=x*this.a2z},solve:function(){var t,e=this.ax*(this.l2.x-this.l1.x)+this.ay*(this.l2.y-this.l1.y)+this.az*(this.l2.z-this.l1.z)+this.t2x*this.a2.x-this.t1x*this.a1.x+this.t2y*this.a2.y-this.t1y*this.a1.y+this.t2z*this.a2.z-this.t1z*this.a1.z;if(this.enableMotor){t=(e-this.motorSpeed)*this.invMotorDenom;var i=this.motorImpulse;this.motorImpulse+=t,this.motorImpulse>this.maxMotorImpulse?this.motorImpulse=this.maxMotorImpulse:this.motorImpulse<-this.maxMotorImpulse&&(this.motorImpulse=-this.maxMotorImpulse),t=this.motorImpulse-i,e-=t*this.motorDenom}else t=0;var n;if(2!=this.limitState){n=(e-this.limitVelocity-this.limitImpulse*this.cfm)*this.invDenom;var s=this.limitImpulse;this.limitImpulse+=n,this.limitImpulse*this.limitState<0&&(this.limitImpulse=0),n=this.limitImpulse-s}else n=0;var r=n+t;this.l1.x+=r*this.l1x,this.l1.y+=r*this.l1y,this.l1.z+=r*this.l1z,this.a1.x+=r*this.a1x,this.a1.y+=r*this.a1y,this.a1.z+=r*this.a1z,this.l2.x-=r*this.l2x,this.l2.y-=r*this.l2y,this.l2.z-=r*this.l2z,this.a2.x-=r*this.a2x,this.a2.y-=r*this.a2y,this.a2.z-=r*this.a2z}},s.Contact=function(){this.shape1=null,this.shape2=null,this.body1=null,this.body2=null,this.prev=null,this.next=null,this.persisting=!1,this.sleeping=!1,this.detector=null,this.constraint=null,this.touching=!1,this.b1Link=new s.ContactLink(this),this.b2Link=new s.ContactLink(this),this.s1Link=new s.ContactLink(this),this.s2Link=new s.ContactLink(this),this.manifold=new s.ContactManifold,this.buffer=[],this.buffer.length=4,this.buffer[0]=new s.ImpulseDataBuffer,this.buffer[1]=new s.ImpulseDataBuffer,this.buffer[2]=new s.ImpulseDataBuffer,this.buffer[3]=new s.ImpulseDataBuffer,this.points=this.manifold.points,this.constraint=new s.ContactConstraint(this.manifold)},s.Contact.prototype={constructor:s.Contact,mixRestitution:function(t,e){return s.sqrt(t*e)},mixFriction:function(t,e){return s.sqrt(t*e)},updateManifold:function(){this.constraint.restitution=this.mixRestitution(this.shape1.restitution,this.shape2.restitution),this.constraint.friction=this.mixFriction(this.shape1.friction,this.shape2.friction);for(var t=this.manifold.numPoints,e=t;e--;){var i=this.buffer[e],n=this.points[e];i.lp1X=n.localPoint1.x,i.lp1Y=n.localPoint1.y,i.lp1Z=n.localPoint1.z,i.lp2X=n.localPoint2.x,i.lp2Y=n.localPoint2.y,i.lp2Z=n.localPoint2.z,i.impulse=n.normalImpulse}this.manifold.numPoints=0,this.detector.detectCollision(this.shape1,this.shape2,this.manifold);var s=this.manifold.numPoints;if(0==s)return void(this.touching=!1);for(this.touching=!0,e=s;e--;){n=this.points[e];for(var r=n.localPoint1.x,o=n.localPoint1.y,a=n.localPoint1.z,h=n.localPoint2.x,l=n.localPoint2.y,c=n.localPoint2.z,u=-1,d=4e-4,p=t;p--;){i=this.buffer[p];var f=i.lp1X-r,m=i.lp1Y-o,g=i.lp1Z-a,v=f*f+m*m+g*g;f=i.lp2X-h,m=i.lp2Y-l,g=i.lp2Z-c;var y=f*f+m*m+g*g;v<y?v<d&&(d=v,u=p):y<d&&(d=y,u=p)}if(u!=-1){var x=this.buffer[u];this.buffer[u]=this.buffer[--t],this.buffer[t]=x,n.normalImpulse=x.impulse,n.warmStarted=!0}else n.normalImpulse=0,n.warmStarted=!1}},attach:function(t,e){this.shape1=t,this.shape2=e,this.body1=t.parent,this.body2=e.parent,this.manifold.body1=this.body1,this.manifold.body2=this.body2,this.constraint.body1=this.body1,this.constraint.body2=this.body2,this.constraint.attach(),this.s1Link.shape=e,this.s1Link.body=this.body2,this.s2Link.shape=t,this.s2Link.body=this.body1,null!=t.contactLink?(this.s1Link.next=t.contactLink).prev=this.s1Link:this.s1Link.next=null,t.contactLink=this.s1Link,t.numContacts++,null!=e.contactLink?(this.s2Link.next=e.contactLink).prev=this.s2Link:this.s2Link.next=null,e.contactLink=this.s2Link,e.numContacts++,this.b1Link.shape=e,this.b1Link.body=this.body2,this.b2Link.shape=t,this.b2Link.body=this.body1,null!=this.body1.contactLink?(this.b1Link.next=this.body1.contactLink).prev=this.b1Link:this.b1Link.next=null,this.body1.contactLink=this.b1Link,this.body1.numContacts++,null!=this.body2.contactLink?(this.b2Link.next=this.body2.contactLink).prev=this.b2Link:this.b2Link.next=null,this.body2.contactLink=this.b2Link,this.body2.numContacts++,this.prev=null,this.next=null,this.persisting=!0,this.sleeping=this.body1.sleeping&&this.body2.sleeping,this.manifold.numPoints=0},detach:function(){var t=this.s1Link.prev,e=this.s1Link.next;null!==t&&(t.next=e),null!==e&&(e.prev=t),this.shape1.contactLink==this.s1Link&&(this.shape1.contactLink=e),
this.s1Link.prev=null,this.s1Link.next=null,this.s1Link.shape=null,this.s1Link.body=null,this.shape1.numContacts--,t=this.s2Link.prev,e=this.s2Link.next,null!==t&&(t.next=e),null!==e&&(e.prev=t),this.shape2.contactLink==this.s2Link&&(this.shape2.contactLink=e),this.s2Link.prev=null,this.s2Link.next=null,this.s2Link.shape=null,this.s2Link.body=null,this.shape2.numContacts--,t=this.b1Link.prev,e=this.b1Link.next,null!==t&&(t.next=e),null!==e&&(e.prev=t),this.body1.contactLink==this.b1Link&&(this.body1.contactLink=e),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.shape=null,this.b1Link.body=null,this.body1.numContacts--,t=this.b2Link.prev,e=this.b2Link.next,null!==t&&(t.next=e),null!==e&&(e.prev=t),this.body2.contactLink==this.b2Link&&(this.body2.contactLink=e),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.shape=null,this.b2Link.body=null,this.body2.numContacts--,this.manifold.body1=null,this.manifold.body2=null,this.constraint.body1=null,this.constraint.body2=null,this.constraint.detach(),this.shape1=null,this.shape2=null,this.body1=null,this.body2=null}},s.ContactConstraint=function(t){s.Constraint.call(this),this.manifold=t,this.restitution=NaN,this.friction=NaN,this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null,this.ii1=null,this.ii2=null,this.m1=NaN,this.m2=NaN,this.num=0,this.ps=t.points,this.cs=new s.ContactPointDataBuffer,this.cs.next=new s.ContactPointDataBuffer,this.cs.next.next=new s.ContactPointDataBuffer,this.cs.next.next.next=new s.ContactPointDataBuffer},s.ContactConstraint.prototype=Object.create(s.Constraint.prototype),s.ContactConstraint.prototype.attach=function(){this.p1=this.body1.position,this.p2=this.body2.position,this.lv1=this.body1.linearVelocity,this.av1=this.body1.angularVelocity,this.lv2=this.body2.linearVelocity,this.av2=this.body2.angularVelocity,this.i1=this.body1.inverseInertia,this.i2=this.body2.inverseInertia},s.ContactConstraint.prototype.detach=function(){this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null},s.ContactConstraint.prototype.preSolve=function(t,e){this.m1=this.body1.inverseMass,this.m2=this.body2.inverseMass,this.ii1=this.i1.clone(),this.ii2=this.i2.clone();var i=this.ii1.elements,n=this.ii2.elements,r=this.p1.x,o=this.p1.y,a=this.p1.z,h=this.p2.x,l=this.p2.y,c=this.p2.z,u=this.m1+this.m2;this.num=this.manifold.numPoints;for(var d=this.cs,p=0;p<this.num;p++){var f,m,g,v,y,x,b=this.ps[p];f=b.position.x,m=b.position.y,g=b.position.z;var w=f-r,_=m-o,S=g-a,M=f-h,T=m-l,E=g-c;d.rp1X=w,d.rp1Y=_,d.rp1Z=S,d.rp2X=M,d.rp2Y=T,d.rp2Z=E,d.norImp=b.normalImpulse,d.tanImp=b.tangentImpulse,d.binImp=b.binormalImpulse;var C=b.normal.x,A=b.normal.y,N=b.normal.z,L=this.lv2.x+this.av2.y*E-this.av2.z*T-(this.lv1.x+this.av1.y*S-this.av1.z*_),P=this.lv2.y+this.av2.z*M-this.av2.x*E-(this.lv1.y+this.av1.z*w-this.av1.x*S),k=this.lv2.z+this.av2.x*T-this.av2.y*M-(this.lv1.z+this.av1.x*_-this.av1.y*w),I=C*L+A*P+N*k,D=L-I*C,z=P-I*A,R=k-I*N,O=D*D+z*z+R*R;O>.04?O=1/s.sqrt(O):(D=A*C-N*N,z=-N*A-C*C,R=C*N+A*A,O=1/s.sqrt(D*D+z*z+R*R)),D*=O,z*=O,R*=O;var B=A*R-N*z,F=N*D-C*R,U=C*z-A*D;d.norX=C,d.norY=A,d.norZ=N,d.tanX=D,d.tanY=z,d.tanZ=R,d.binX=B,d.binY=F,d.binZ=U,d.norU1X=C*this.m1,d.norU1Y=A*this.m1,d.norU1Z=N*this.m1,d.norU2X=C*this.m2,d.norU2Y=A*this.m2,d.norU2Z=N*this.m2,d.tanU1X=D*this.m1,d.tanU1Y=z*this.m1,d.tanU1Z=R*this.m1,d.tanU2X=D*this.m2,d.tanU2Y=z*this.m2,d.tanU2Z=R*this.m2,d.binU1X=B*this.m1,d.binU1Y=F*this.m1,d.binU1Z=U*this.m1,d.binU2X=B*this.m2,d.binU2Y=F*this.m2,d.binU2Z=U*this.m2;var V=_*N-S*A,H=S*C-w*N,W=w*A-_*C,j=T*N-E*A,G=E*C-M*N,X=M*A-T*C,Y=_*R-S*z,q=S*D-w*R,$=w*z-_*D,Z=T*R-E*z,J=E*D-M*R,K=M*z-T*D,Q=_*U-S*F,tt=S*B-w*U,et=w*F-_*B,it=T*U-E*F,nt=E*B-M*U,st=M*F-T*B,rt=V*i[0]+H*i[1]+W*i[2],ot=V*i[3]+H*i[4]+W*i[5],at=V*i[6]+H*i[7]+W*i[8],ht=j*n[0]+G*n[1]+X*n[2],lt=j*n[3]+G*n[4]+X*n[5],ct=j*n[6]+G*n[7]+X*n[8],ut=Y*i[0]+q*i[1]+$*i[2],dt=Y*i[3]+q*i[4]+$*i[5],pt=Y*i[6]+q*i[7]+$*i[8],ft=Z*n[0]+J*n[1]+K*n[2],mt=Z*n[3]+J*n[4]+K*n[5],gt=Z*n[6]+J*n[7]+K*n[8],vt=Q*i[0]+tt*i[1]+et*i[2],yt=Q*i[3]+tt*i[4]+et*i[5],xt=Q*i[6]+tt*i[7]+et*i[8],bt=it*n[0]+nt*n[1]+st*n[2],wt=it*n[3]+nt*n[4]+st*n[5],_t=it*n[6]+nt*n[7]+st*n[8];d.norT1X=V,d.norT1Y=H,d.norT1Z=W,d.tanT1X=Y,d.tanT1Y=q,d.tanT1Z=$,d.binT1X=Q,d.binT1Y=tt,d.binT1Z=et,d.norT2X=j,d.norT2Y=G,d.norT2Z=X,d.tanT2X=Z,d.tanT2Y=J,d.tanT2Z=K,d.binT2X=it,d.binT2Y=nt,d.binT2Z=st,d.norTU1X=rt,d.norTU1Y=ot,d.norTU1Z=at,d.tanTU1X=ut,d.tanTU1Y=dt,d.tanTU1Z=pt,d.binTU1X=vt,d.binTU1Y=yt,d.binTU1Z=xt,d.norTU2X=ht,d.norTU2Y=lt,d.norTU2Z=ct,d.tanTU2X=ft,d.tanTU2Y=mt,d.tanTU2Z=gt,d.binTU2X=bt,d.binTU2Y=wt,d.binTU2Z=_t,f=V*i[0]+H*i[1]+W*i[2],m=V*i[3]+H*i[4]+W*i[5],g=V*i[6]+H*i[7]+W*i[8],v=m*S-g*_,y=g*w-f*S,x=f*_-m*w,f=j*n[0]+G*n[1]+X*n[2],m=j*n[3]+G*n[4]+X*n[5],g=j*n[6]+G*n[7]+X*n[8],v+=m*E-g*T,y+=g*M-f*E,x+=f*T-m*M;var St=1/(u+C*v+A*y+N*x);f=Y*i[0]+q*i[1]+$*i[2],m=Y*i[3]+q*i[4]+$*i[5],g=Y*i[6]+q*i[7]+$*i[8],v=m*S-g*_,y=g*w-f*S,x=f*_-m*w,f=Z*n[0]+J*n[1]+K*n[2],m=Z*n[3]+J*n[4]+K*n[5],g=Z*n[6]+J*n[7]+K*n[8],v+=m*E-g*T,y+=g*M-f*E,x+=f*T-m*M;var Mt=1/(u+D*v+z*y+R*x);f=Q*i[0]+tt*i[1]+et*i[2],m=Q*i[3]+tt*i[4]+et*i[5],g=Q*i[6]+tt*i[7]+et*i[8],v=m*S-g*_,y=g*w-f*S,x=f*_-m*w,f=it*n[0]+nt*n[1]+st*n[2],m=it*n[3]+nt*n[4]+st*n[5],g=it*n[6]+nt*n[7]+st*n[8],v+=m*E-g*T,y+=g*M-f*E,x+=f*T-m*M;var Tt=1/(u+B*v+F*y+U*x);if(d.norDen=St,d.tanDen=Mt,d.binDen=Tt,b.warmStarted){var Et=b.normalImpulse;this.lv1.x+=d.norU1X*Et,this.lv1.y+=d.norU1Y*Et,this.lv1.z+=d.norU1Z*Et,this.av1.x+=rt*Et,this.av1.y+=ot*Et,this.av1.z+=at*Et,this.lv2.x-=d.norU2X*Et,this.lv2.y-=d.norU2Y*Et,this.lv2.z-=d.norU2Z*Et,this.av2.x-=ht*Et,this.av2.y-=lt*Et,this.av2.z-=ct*Et,d.norImp=Et,d.tanImp=0,d.binImp=0,I=0}else d.norImp=0,d.tanImp=0,d.binImp=0;I>-1&&(I=0);var Ct=this.restitution*-I,At=-(b.penetration+.005)*e*.05;Ct<At&&(Ct=At),d.norTar=Ct,d.last=p==this.num-1,d=d.next}},s.ContactConstraint.prototype.solve=function(){for(var t=this.lv1.x,e=this.lv1.y,i=this.lv1.z,n=this.lv2.x,r=this.lv2.y,o=this.lv2.z,a=this.av1.x,h=this.av1.y,l=this.av1.z,c=this.av2.x,u=this.av2.y,d=this.av2.z,p=this.cs;;){var f,m,g,v,y,x=p.norImp,b=p.tanImp,w=p.binImp,_=-x*this.friction,S=n-t,M=r-e,T=o-i;y=S*p.tanX+M*p.tanY+T*p.tanZ+c*p.tanT2X+u*p.tanT2Y+d*p.tanT2Z-a*p.tanT1X-h*p.tanT1Y-l*p.tanT1Z,f=b,m=y*p.tanDen,b+=m,y=S*p.binX+M*p.binY+T*p.binZ+c*p.binT2X+u*p.binT2Y+d*p.binT2Z-a*p.binT1X-h*p.binT1Y-l*p.binT1Z,g=w,v=y*p.binDen,w+=v;var E=b*b+w*w;if(E>_*_&&(E=_/s.sqrt(E),b*=E,w*=E),m=b-f,v=w-g,t+=p.tanU1X*m+p.binU1X*v,e+=p.tanU1Y*m+p.binU1Y*v,i+=p.tanU1Z*m+p.binU1Z*v,a+=p.tanTU1X*m+p.binTU1X*v,h+=p.tanTU1Y*m+p.binTU1Y*v,l+=p.tanTU1Z*m+p.binTU1Z*v,n-=p.tanU2X*m+p.binU2X*v,r-=p.tanU2Y*m+p.binU2Y*v,o-=p.tanU2Z*m+p.binU2Z*v,c-=p.tanTU2X*m+p.binTU2X*v,u-=p.tanTU2Y*m+p.binTU2Y*v,d-=p.tanTU2Z*m+p.binTU2Z*v,y=(n-t)*p.norX+(r-e)*p.norY+(o-i)*p.norZ+c*p.norT2X+u*p.norT2Y+d*p.norT2Z-a*p.norT1X-h*p.norT1Y-l*p.norT1Z,f=x,m=(y-p.norTar)*p.norDen,x+=m,x>0&&(x=0),m=x-f,t+=p.norU1X*m,e+=p.norU1Y*m,i+=p.norU1Z*m,a+=p.norTU1X*m,h+=p.norTU1Y*m,l+=p.norTU1Z*m,n-=p.norU2X*m,r-=p.norU2Y*m,o-=p.norU2Z*m,c-=p.norTU2X*m,u-=p.norTU2Y*m,d-=p.norTU2Z*m,p.norImp=x,p.tanImp=b,p.binImp=w,p.last)break;p=p.next}this.lv1.x=t,this.lv1.y=e,this.lv1.z=i,this.lv2.x=n,this.lv2.y=r,this.lv2.z=o,this.av1.x=a,this.av1.y=h,this.av1.z=l,this.av2.x=c,this.av2.y=u,this.av2.z=d},s.ContactConstraint.prototype.postSolve=function(){for(var t=this.cs,e=this.num;e--;){var i=this.ps[e];i.normal.x=t.norX,i.normal.y=t.norY,i.normal.z=t.norZ,i.tangent.x=t.tanX,i.tangent.y=t.tanY,i.tangent.z=t.tanZ,i.binormal.x=t.binX,i.binormal.y=t.binY,i.binormal.z=t.binZ,i.normalImpulse=t.norImp,i.tangentImpulse=t.tanImp,i.binormalImpulse=t.binImp,i.normalDenominator=t.norDen,i.tangentDenominator=t.tanDen,i.binormalDenominator=t.binDen,t=t.next}},s.ContactLink=function(t){this.prev=null,this.next=null,this.shape=null,this.body=null,this.contact=t},s.ContactManifold=function(){this.body1=null,this.body2=null,this.numPoints=0,this.points=[],this.points.length=4,this.points[0]=new s.ManifoldPoint,this.points[1]=new s.ManifoldPoint,this.points[2]=new s.ManifoldPoint,this.points[3]=new s.ManifoldPoint},s.ContactManifold.prototype={constructor:s.ContactManifold,reset:function(t,e){this.body1=t.parent,this.body2=e.parent,this.numPoints=0},addPoint:function(t,e,i,n,s,r,o,a){var h=this.points[this.numPoints++];h.position.x=t,h.position.y=e,h.position.z=i;var l=this.body1.rotation,c=t-this.body1.position.x,u=e-this.body1.position.y,d=i-this.body1.position.z,p=l.elements;h.localPoint1.x=c*p[0]+u*p[3]+d*p[6],h.localPoint1.y=c*p[1]+u*p[4]+d*p[7],h.localPoint1.z=c*p[2]+u*p[5]+d*p[8],l=this.body2.rotation,c=t-this.body2.position.x,u=e-this.body2.position.y,d=i-this.body2.position.z,h.localPoint2.x=c*p[0]+u*p[3]+d*p[6],h.localPoint2.y=c*p[1]+u*p[4]+d*p[7],h.localPoint2.z=c*p[2]+u*p[5]+d*p[8],h.normalImpulse=0,a?(h.normal.x=-n,h.normal.y=-s,h.normal.z=-r):(h.normal.x=n,h.normal.y=s,h.normal.z=r),h.penetration=o,h.warmStarted=!1}},s.ContactPointDataBuffer=function(){this.norX=NaN,this.norY=NaN,this.norZ=NaN,this.tanX=NaN,this.tanY=NaN,this.tanZ=NaN,this.binX=NaN,this.binY=NaN,this.binZ=NaN,this.rp1X=NaN,this.rp1Y=NaN,this.rp1Z=NaN,this.rp2X=NaN,this.rp2Y=NaN,this.rp2Z=NaN,this.norU1X=NaN,this.norU1Y=NaN,this.norU1Z=NaN,this.norU2X=NaN,this.norU2Y=NaN,this.norU2Z=NaN,this.tanU1X=NaN,this.tanU1Y=NaN,this.tanU1Z=NaN,this.tanU2X=NaN,this.tanU2Y=NaN,this.tanU2Z=NaN,this.binU1X=NaN,this.binU1Y=NaN,this.binU1Z=NaN,this.binU2X=NaN,this.binU2Y=NaN,this.binU2Z=NaN,this.norT1X=NaN,this.norT1Y=NaN,this.norT1Z=NaN,this.norT2X=NaN,this.norT2Y=NaN,this.norT2Z=NaN,this.tanT1X=NaN,this.tanT1Y=NaN,this.tanT1Z=NaN,this.tanT2X=NaN,this.tanT2Y=NaN,this.tanT2Z=NaN,this.binT1X=NaN,this.binT1Y=NaN,this.binT1Z=NaN,this.binT2X=NaN,this.binT2Y=NaN,this.binT2Z=NaN,this.norTU1X=NaN,this.norTU1Y=NaN,this.norTU1Z=NaN,this.norTU2X=NaN,this.norTU2Y=NaN,this.norTU2Z=NaN,this.tanTU1X=NaN,this.tanTU1Y=NaN,this.tanTU1Z=NaN,this.tanTU2X=NaN,this.tanTU2Y=NaN,this.tanTU2Z=NaN,this.binTU1X=NaN,this.binTU1Y=NaN,this.binTU1Z=NaN,this.binTU2X=NaN,this.binTU2Y=NaN,this.binTU2Z=NaN,this.norImp=NaN,this.tanImp=NaN,this.binImp=NaN,this.norDen=NaN,this.tanDen=NaN,this.binDen=NaN,this.norTar=NaN,this.next=null,this.last=!1},s.ImpulseDataBuffer=function(){this.lp1X=NaN,this.lp1Y=NaN,this.lp1Z=NaN,this.lp2X=NaN,this.lp2Y=NaN,this.lp2Z=NaN,this.impulse=NaN},s.ManifoldPoint=function(){this.warmStarted=!1,this.position=new s.Vec3,this.localPoint1=new s.Vec3,this.localPoint2=new s.Vec3,this.normal=new s.Vec3,this.tangent=new s.Vec3,this.binormal=new s.Vec3,this.normalImpulse=0,this.tangentImpulse=0,this.binormalImpulse=0,this.normalDenominator=0,this.tangentDenominator=0,this.binormalDenominator=0,this.penetration=0},s.MassInfo=function(){this.mass=0,this.inertia=new s.Mat33},s.Shape=function(t){this.type=s.SHAPE_NULL,this.id=s.nextID++,this.prev=null,this.next=null,this.proxy=null,this.parent=null,this.contactLink=null,this.numContacts=0,this.position=new s.Vec3,this.rotation=new s.Mat33,this.relativePosition=(new s.Vec3).copy(t.relativePosition),this.relativeRotation=(new s.Mat33).copy(t.relativeRotation),this.aabb=new s.AABB,this.density=t.density,this.friction=t.friction,this.restitution=t.restitution,this.belongsTo=t.belongsTo,this.collidesWith=t.collidesWith},s.Shape.prototype={constructor:s.Shape,calculateMassInfo:function(t){s.Error("Shape","Inheritance error.")},updateProxy:function(){s.Error("Shape","Inheritance error.")}},s.ShapeConfig=function(){this.relativePosition=new s.Vec3,this.relativeRotation=new s.Mat33,this.friction=.4,this.restitution=.2,this.density=1,this.belongsTo=1,this.collidesWith=4294967295},s.BoxShape=function(t,e,i,r){s.Shape.call(this,t),this.type=s.SHAPE_BOX,this.width=e,this.height=i,this.depth=r,this.halfWidth=.5*e,this.halfHeight=.5*i,this.halfDepth=.5*r,this.dimentions=new n(18),this.elements=new n(24)},s.BoxShape.prototype=Object.create(s.Shape.prototype),s.BoxShape.prototype.constructor=s.BoxShape,s.BoxShape.prototype.calculateMassInfo=function(t){var e=this.width*this.height*this.depth*this.density,i=1/12;t.mass=e,t.inertia.set(e*(this.height*this.height+this.depth*this.depth)*i,0,0,0,e*(this.width*this.width+this.depth*this.depth)*i,0,0,0,e*(this.width*this.width+this.height*this.height)*i)},s.BoxShape.prototype.updateProxy=function(){var t=this.rotation.elements,e=this.dimentions;e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e[9]=t[0]*this.halfWidth,e[10]=t[3]*this.halfWidth,e[11]=t[6]*this.halfWidth,e[12]=t[1]*this.halfHeight,e[13]=t[4]*this.halfHeight,e[14]=t[7]*this.halfHeight,e[15]=t[2]*this.halfDepth,e[16]=t[5]*this.halfDepth,e[17]=t[8]*this.halfDepth;var i=e[9],n=e[10],r=e[11],o=e[12],a=e[13],h=e[14],l=e[15],c=e[16],u=e[17],d=this.position.x,p=this.position.y,f=this.position.z,m=this.elements;m[0]=d+i+o+l,m[1]=p+n+a+c,m[2]=f+r+h+u,m[3]=d+i+o-l,m[4]=p+n+a-c,m[5]=f+r+h-u,m[6]=d+i-o+l,m[7]=p+n-a+c,m[8]=f+r-h+u,m[9]=d+i-o-l,m[10]=p+n-a-c,m[11]=f+r-h-u,m[12]=d-i+o+l,m[13]=p-n+a+c,m[14]=f-r+h+u,m[15]=d-i+o-l,m[16]=p-n+a-c,m[17]=f-r+h-u,m[18]=d-i-o+l,m[19]=p-n-a+c,m[20]=f-r-h+u,m[21]=d-i-o-l,m[22]=p-n-a-c,m[23]=f-r-h-u;var g=e[9]<0?-e[9]:e[9],v=e[10]<0?-e[10]:e[10],y=e[11]<0?-e[11]:e[11];g=e[12]<0?g-e[12]:g+e[12],v=e[13]<0?v-e[13]:v+e[13],y=e[14]<0?y-e[14]:y+e[14],g=e[15]<0?g-e[15]:g+e[15],v=e[16]<0?v-e[16]:v+e[16],y=e[17]<0?y-e[17]:y+e[17];var x=s.AABB_PROX;this.aabb.set(this.position.x-g-x,this.position.x+g+x,this.position.y-v-x,this.position.y+v+x,this.position.z-y-x,this.position.z+y+x),null!=this.proxy&&this.proxy.update()},s.SphereShape=function(t,e){s.Shape.call(this,t),this.type=s.SHAPE_SPHERE,this.radius=e},s.SphereShape.prototype=Object.create(s.Shape.prototype),s.SphereShape.prototype.constructor=s.SphereShape,s.SphereShape.prototype.calculateMassInfo=function(t){var e=1.333*s.PI*this.radius*this.radius*this.radius*this.density;t.mass=e;var i=e*this.radius*this.radius*.4;t.inertia.set(i,0,0,0,i,0,0,0,i)},s.SphereShape.prototype.updateProxy=function(){var t=s.AABB_PROX;this.aabb.set(this.position.x-this.radius-t,this.position.x+this.radius+t,this.position.y-this.radius-t,this.position.y+this.radius+t,this.position.z-this.radius-t,this.position.z+this.radius+t),null!=this.proxy&&this.proxy.update()},s.CylinderShape=function(t,e,i){s.Shape.call(this,t),this.type=s.SHAPE_CYLINDER,this.radius=e,this.height=i,this.halfHeight=.5*i,this.normalDirection=new s.Vec3,this.halfDirection=new s.Vec3},s.CylinderShape.prototype=Object.create(s.Shape.prototype),s.CylinderShape.prototype.constructor=s.CylinderShape,s.CylinderShape.prototype.calculateMassInfo=function(t){var e=this.radius*this.radius,i=s.PI*e*this.height*this.density,n=(.25*e+.0833*this.height*this.height)*i,r=.5*e;t.mass=i,t.inertia.set(n,0,0,0,r,0,0,0,n)},s.CylinderShape.prototype.updateProxy=function(){var t,e,i,n,r,o,a,h,l,c,u,d=this.rotation.elements;r=d[1]*d[1],o=d[4]*d[4],a=d[7]*d[7],this.normalDirection.set(d[1],d[4],d[7]),this.halfDirection.scale(this.normalDirection,this.halfHeight),e=1-r,t=s.sqrt(e*e+r*o+r*a),t>0&&(t=this.radius/t),e*=t,i=1-o,t=s.sqrt(o*r+i*i+o*a),t>0&&(t=this.radius/t),i*=t,n=1-a,t=s.sqrt(a*r+a*o+n*n),t>0&&(t=this.radius/t),n*=t,h=this.halfDirection.x<0?-this.halfDirection.x:this.halfDirection.x,l=this.halfDirection.y<0?-this.halfDirection.y:this.halfDirection.y,c=this.halfDirection.z<0?-this.halfDirection.z:this.halfDirection.z,h=e<0?h-e:h+e,l=i<0?l-i:l+i,c=n<0?c-n:c+n,u=s.AABB_PROX,this.aabb.set(this.position.x-h-u,this.position.x+h+u,this.position.y-l-u,this.position.y+l+u,this.position.z-c-u,this.position.z+c+u),null!=this.proxy&&this.proxy.update()},s.TetraShape=function(e,i,n,r,o){s.Shape.call(this,e),this.type=s.SHAPE_TETRA,this.verts=[i,n,r,o],this.faces=[t(0,1,2),t(1,2,3),t(2,3,4),t(4,0,1)]},s.TetraShape.prototype=Object.create(s.Shape.prototype),s.TetraShape.prototype.constructor=s.TetraShape,s.TetraShape.prototype.calculateMassInfo=function(){},s.TetraShape.prototype.updateProxy=function(){this.aabb.setFromPoints(this.verts),null!==this.proxy&&this.proxy.update()},s.CollisionDetector=function(){this.flip=!1},s.CollisionDetector.prototype={constructor:s.CollisionDetector,detectCollision:function(t,e,i){s.Error("CollisionDetector","Inheritance error.")}},s.BoxBoxCollisionDetector=function(){s.CollisionDetector.call(this),this.clipVertices1=new n(24),this.clipVertices2=new n(24),this.used=new n(8),this.INF=1/0},s.BoxBoxCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.BoxBoxCollisionDetector.prototype.constructor=s.BoxBoxCollisionDetector,s.BoxBoxCollisionDetector.prototype.detectCollision=function(t,e,i){var n,r;t.id<e.id?(n=t,r=e):(n=e,r=t);var o,a,h,l,c,u,d,p,f,m,g,v,y,x,b,w,_,S,M,T,E,C,A,N,L,P,k,I,D,z,R,O,B,F,U,V,H=n.elements,W=r.elements,j=n.dimentions,G=r.dimentions,X=n.position,Y=r.position,q=X.x,$=X.y,Z=X.z,J=Y.x,K=Y.y,Q=Y.z,tt=J-q,et=K-$,it=Q-Z,nt=n.halfWidth,st=n.halfHeight,rt=n.halfDepth,ot=r.halfWidth,at=r.halfHeight,ht=r.halfDepth,lt=j[0],ct=j[1],ut=j[2],dt=j[3],pt=j[4],ft=j[5],mt=j[6],gt=j[7],vt=j[8],yt=j[9],xt=j[10],bt=j[11],wt=j[12],_t=j[13],St=j[14],Mt=j[15],Tt=j[16],Et=j[17],Ct=G[0],At=G[1],Nt=G[2],Lt=G[3],Pt=G[4],kt=G[5],It=G[6],Dt=G[7],zt=G[8],Rt=G[9],Ot=G[10],Bt=G[11],Ft=G[12],Ut=G[13],Vt=G[14],Ht=G[15],Wt=G[16],jt=G[17],Gt=ct*Nt-ut*At,Xt=ut*Ct-lt*Nt,Yt=lt*At-ct*Ct,qt=ct*kt-ut*Pt,$t=ut*Lt-lt*kt,Zt=lt*Pt-ct*Lt,Jt=ct*zt-ut*Dt,Kt=ut*It-lt*zt,Qt=lt*Dt-ct*It,te=pt*Nt-ft*At,ee=ft*Ct-dt*Nt,ie=dt*At-pt*Ct,ne=pt*kt-ft*Pt,se=ft*Lt-dt*kt,re=dt*Pt-pt*Lt,oe=pt*zt-ft*Dt,ae=ft*It-dt*zt,he=dt*Dt-pt*It,le=gt*Nt-vt*At,ce=vt*Ct-mt*Nt,ue=mt*At-gt*Ct,de=gt*kt-vt*Pt,pe=vt*Lt-mt*kt,fe=mt*Pt-gt*Lt,me=gt*zt-vt*Dt,ge=vt*It-mt*zt,ve=mt*Dt-gt*It,ye=!1,xe=!1,be=!1,we=!1,_e=!1,Se=!1,Me=!1,Te=!1,Ee=!1;if(R=lt*tt+ct*et+ut*it,o=R>0,o||(R=-R),O=nt,F=lt*Ct+ct*At+ut*Nt,U=lt*Lt+ct*Pt+ut*kt,V=lt*It+ct*Dt+ut*zt,F<0&&(F=-F),U<0&&(U=-U),V<0&&(V=-V),B=F*ot+U*at+V*ht,w=R-O-B,!(w>0||(R=dt*tt+pt*et+ft*it,a=R>0,a||(R=-R),O=st,F=dt*Ct+pt*At+ft*Nt,U=dt*Lt+pt*Pt+ft*kt,V=dt*It+pt*Dt+ft*zt,F<0&&(F=-F),U<0&&(U=-U),V<0&&(V=-V),B=F*ot+U*at+V*ht,_=R-O-B,_>0||(R=mt*tt+gt*et+vt*it,h=R>0,h||(R=-R),O=rt,F=mt*Ct+gt*At+vt*Nt,U=mt*Lt+gt*Pt+vt*kt,V=mt*It+gt*Dt+vt*zt,F<0&&(F=-F),U<0&&(U=-U),V<0&&(V=-V),B=F*ot+U*at+V*ht,S=R-O-B,S>0||(R=Ct*tt+At*et+Nt*it,l=R>0,l||(R=-R),F=Ct*lt+At*ct+Nt*ut,U=Ct*dt+At*pt+Nt*ft,V=Ct*mt+At*gt+Nt*vt,F<0&&(F=-F),U<0&&(U=-U),V<0&&(V=-V),O=F*nt+U*st+V*rt,B=ot,M=1*(R-O-B),M>0||(R=Lt*tt+Pt*et+kt*it,c=R>0,c||(R=-R),F=Lt*lt+Pt*ct+kt*ut,U=Lt*dt+Pt*pt+kt*ft,V=Lt*mt+Pt*gt+kt*vt,F<0&&(F=-F),U<0&&(U=-U),V<0&&(V=-V),O=F*nt+U*st+V*rt,B=at,T=1*(R-O-B),T>0||(R=It*tt+Dt*et+zt*it,u=R>0,u||(R=-R),F=It*lt+Dt*ct+zt*ut,U=It*dt+Dt*pt+zt*ft,V=It*mt+Dt*gt+zt*vt,F<0&&(F=-F),U<0&&(U=-U),V<0&&(V=-V),O=F*nt+U*st+V*rt,B=ht,E=1*(R-O-B),E>0))))))){if(R=Gt*Gt+Xt*Xt+Yt*Yt,R>1e-5){if(R=1/s.sqrt(R),Gt*=R,Xt*=R,Yt*=R,R=Gt*tt+Xt*et+Yt*it,d=R>0,d||(R=-R),F=Gt*dt+Xt*pt+Yt*ft,U=Gt*mt+Xt*gt+Yt*vt,F<0&&(F=-F),U<0&&(U=-U),O=F*st+U*rt,F=Gt*Lt+Xt*Pt+Yt*kt,U=Gt*It+Xt*Dt+Yt*zt,F<0&&(F=-F),U<0&&(U=-U),B=F*at+U*ht,C=R-O-B,C>0)return}else d=!1,C=0,ye=!0;if(R=qt*qt+$t*$t+Zt*Zt,R>1e-5){if(R=1/s.sqrt(R),qt*=R,$t*=R,Zt*=R,R=qt*tt+$t*et+Zt*it,p=R>0,p||(R=-R),F=qt*dt+$t*pt+Zt*ft,U=qt*mt+$t*gt+Zt*vt,F<0&&(F=-F),U<0&&(U=-U),O=F*st+U*rt,F=qt*Ct+$t*At+Zt*Nt,U=qt*It+$t*Dt+Zt*zt,F<0&&(F=-F),U<0&&(U=-U),B=F*ot+U*ht,A=R-O-B,A>0)return}else p=!1,A=0,xe=!0;if(R=Jt*Jt+Kt*Kt+Qt*Qt,R>1e-5){if(R=1/s.sqrt(R),Jt*=R,Kt*=R,Qt*=R,R=Jt*tt+Kt*et+Qt*it,f=R>0,f||(R=-R),F=Jt*dt+Kt*pt+Qt*ft,U=Jt*mt+Kt*gt+Qt*vt,F<0&&(F=-F),U<0&&(U=-U),O=F*st+U*rt,F=Jt*Ct+Kt*At+Qt*Nt,U=Jt*Lt+Kt*Pt+Qt*kt,F<0&&(F=-F),U<0&&(U=-U),B=F*ot+U*at,N=R-O-B,N>0)return}else f=!1,N=0,be=!0;if(R=te*te+ee*ee+ie*ie,R>1e-5){if(R=1/s.sqrt(R),te*=R,ee*=R,ie*=R,R=te*tt+ee*et+ie*it,m=R>0,m||(R=-R),F=te*lt+ee*ct+ie*ut,U=te*mt+ee*gt+ie*vt,F<0&&(F=-F),U<0&&(U=-U),O=F*nt+U*rt,F=te*Lt+ee*Pt+ie*kt,U=te*It+ee*Dt+ie*zt,F<0&&(F=-F),U<0&&(U=-U),B=F*at+U*ht,L=R-O-B,L>0)return}else m=!1,L=0,we=!0;if(R=ne*ne+se*se+re*re,R>1e-5){if(R=1/s.sqrt(R),ne*=R,se*=R,re*=R,R=ne*tt+se*et+re*it,g=R>0,g||(R=-R),F=ne*lt+se*ct+re*ut,U=ne*mt+se*gt+re*vt,F<0&&(F=-F),U<0&&(U=-U),O=F*nt+U*rt,F=ne*Ct+se*At+re*Nt,U=ne*It+se*Dt+re*zt,F<0&&(F=-F),U<0&&(U=-U),B=F*ot+U*ht,P=R-O-B,P>0)return}else g=!1,P=0,_e=!0;if(R=oe*oe+ae*ae+he*he,R>1e-5){if(R=1/s.sqrt(R),oe*=R,ae*=R,he*=R,R=oe*tt+ae*et+he*it,v=R>0,v||(R=-R),F=oe*lt+ae*ct+he*ut,U=oe*mt+ae*gt+he*vt,F<0&&(F=-F),U<0&&(U=-U),O=F*nt+U*rt,F=oe*Ct+ae*At+he*Nt,U=oe*Lt+ae*Pt+he*kt,F<0&&(F=-F),U<0&&(U=-U),B=F*ot+U*at,k=R-O-B,k>0)return}else v=!1,k=0,Se=!0;if(R=le*le+ce*ce+ue*ue,R>1e-5){if(R=1/s.sqrt(R),le*=R,ce*=R,ue*=R,R=le*tt+ce*et+ue*it,y=R>0,y||(R=-R),F=le*lt+ce*ct+ue*ut,U=le*dt+ce*pt+ue*ft,F<0&&(F=-F),U<0&&(U=-U),O=F*nt+U*st,F=le*Lt+ce*Pt+ue*kt,U=le*It+ce*Dt+ue*zt,F<0&&(F=-F),U<0&&(U=-U),B=F*at+U*ht,I=R-O-B,I>0)return}else y=!1,I=0,Me=!0;if(R=de*de+pe*pe+fe*fe,R>1e-5){if(R=1/s.sqrt(R),de*=R,pe*=R,fe*=R,R=de*tt+pe*et+fe*it,x=R>0,x||(R=-R),F=de*lt+pe*ct+fe*ut,U=de*dt+pe*pt+fe*ft,F<0&&(F=-F),U<0&&(U=-U),O=F*nt+U*st,F=de*Ct+pe*At+fe*Nt,U=de*It+pe*Dt+fe*zt,F<0&&(F=-F),U<0&&(U=-U),B=F*ot+U*ht,D=R-O-B,D>0)return}else x=!1,D=0,Te=!0;if(R=me*me+ge*ge+ve*ve,R>1e-5){if(R=1/s.sqrt(R),me*=R,ge*=R,ve*=R,R=me*tt+ge*et+ve*it,b=R>0,b||(R=-R),F=me*lt+ge*ct+ve*ut,U=me*dt+ge*pt+ve*ft,F<0&&(F=-F),U<0&&(U=-U),O=F*nt+U*st,F=me*Ct+ge*At+ve*Nt,U=me*Lt+ge*Pt+ve*kt,F<0&&(F=-F),U<0&&(U=-U),B=F*ot+U*at,z=R-O-B,z>0)return}else b=!1,z=0,Ee=!0;var Ce=w,Ae=w,Ne=0,Le=o;_>Ae&&(Ce=_,Ae=_,Ne=1,Le=a),S>Ae&&(Ce=S,Ae=S,Ne=2,Le=h),M>Ae&&(Ce=M,Ae=M,Ne=3,Le=l),T>Ae&&(Ce=T,Ae=T,Ne=4,Le=c),E>Ae&&(Ce=E,Ae=E,Ne=5,Le=u),C-.01>Ae&&!ye&&(Ce=C,Ae=C-.01,Ne=6,Le=d),A-.01>Ae&&!xe&&(Ce=A,Ae=A-.01,Ne=7,Le=p),N-.01>Ae&&!be&&(Ce=N,Ae=N-.01,Ne=8,Le=f),L-.01>Ae&&!we&&(Ce=L,Ae=L-.01,Ne=9,Le=m),P-.01>Ae&&!_e&&(Ce=P,Ae=P-.01,Ne=10,Le=g),k-.01>Ae&&!Se&&(Ce=k,Ae=k-.01,Ne=11,Le=v),I-.01>Ae&&!Me&&(Ce=I,Ae=I-.01,Ne=12,Le=y),D-.01>Ae&&!Te&&(Ce=D,Ae=D-.01,Ne=13,Le=x),z-.01>Ae&&!Ee&&(Ce=z,Ne=14,Le=b);var Pe=0,ke=0,Ie=0,De=0,ze=0,Re=0,Oe=0,Be=0,Fe=0,Ue=0,Ve=0,He=0,We=0,je=0,Ge=0,Xe=0,Ye=0,qe=0,$e=!1;if(0==Ne?(Le?(Ue=q+yt,Ve=$+xt,He=Z+bt,Pe=lt,ke=ct,Ie=ut):(Ue=q-yt,Ve=$-xt,He=Z-bt,Pe=-lt,ke=-ct,Ie=-ut),We=wt,je=_t,Ge=St,De=-dt,ze=-pt,Re=-ft,Xe=Mt,Ye=Tt,qe=Et,Oe=-mt,Be=-gt,Fe=-vt):1==Ne?(Le?(Ue=q+wt,Ve=$+_t,He=Z+St,Pe=dt,ke=pt,Ie=ft):(Ue=q-wt,Ve=$-_t,He=Z-St,Pe=-dt,ke=-pt,Ie=-ft),We=yt,je=xt,Ge=bt,De=-lt,ze=-ct,Re=-ut,Xe=Mt,Ye=Tt,qe=Et,Oe=-mt,Be=-gt,Fe=-vt):2==Ne?(Le?(Ue=q+Mt,Ve=$+Tt,He=Z+Et,Pe=mt,ke=gt,Ie=vt):(Ue=q-Mt,Ve=$-Tt,He=Z-Et,Pe=-mt,ke=-gt,Ie=-vt),We=yt,je=xt,Ge=bt,De=-lt,ze=-ct,Re=-ut,Xe=wt,Ye=_t,qe=St,Oe=-dt,Be=-pt,Fe=-ft):3==Ne?($e=!0,Le?(Ue=J-Rt,Ve=K-Ot,He=Q-Bt,Pe=-Ct,ke=-At,Ie=-Nt):(Ue=J+Rt,Ve=K+Ot,He=Q+Bt,Pe=Ct,ke=At,Ie=Nt),We=Ft,je=Ut,Ge=Vt,De=-Lt,ze=-Pt,Re=-kt,Xe=Ht,Ye=Wt,qe=jt,Oe=-It,Be=-Dt,Fe=-zt):4==Ne?($e=!0,Le?(Ue=J-Ft,Ve=K-Ut,He=Q-Vt,Pe=-Lt,ke=-Pt,Ie=-kt):(Ue=J+Ft,Ve=K+Ut,He=Q+Vt,Pe=Lt,ke=Pt,Ie=kt),We=Rt,je=Ot,Ge=Bt,De=-Ct,ze=-At,Re=-Nt,Xe=Ht,Ye=Wt,qe=jt,Oe=-It,Be=-Dt,Fe=-zt):5==Ne?($e=!0,Le?(Ue=J-Ht,Ve=K-Wt,He=Q-jt,Pe=-It,ke=-Dt,Ie=-zt):(Ue=J+Ht,Ve=K+Wt,He=Q+jt,Pe=It,ke=Dt,Ie=zt),We=Rt,je=Ot,Ge=Bt,De=-Ct,ze=-At,Re=-Nt,Xe=Ft,Ye=Ut,qe=Vt,Oe=-Lt,Be=-Pt,Fe=-kt):6==Ne?(Pe=Gt,ke=Xt,Ie=Yt,De=lt,ze=ct,Re=ut,Oe=Ct,Be=At,Fe=Nt):7==Ne?(Pe=qt,ke=$t,Ie=Zt,De=lt,ze=ct,Re=ut,Oe=Lt,Be=Pt,Fe=kt):8==Ne?(Pe=Jt,ke=Kt,Ie=Qt,De=lt,ze=ct,Re=ut,Oe=It,Be=Dt,Fe=zt):9==Ne?(Pe=te,ke=ee,Ie=ie,De=dt,ze=pt,Re=ft,Oe=Ct,Be=At,Fe=Nt):10==Ne?(Pe=ne,ke=se,Ie=re,De=dt,ze=pt,Re=ft,Oe=Lt,Be=Pt,Fe=kt):11==Ne?(Pe=oe,ke=ae,Ie=he,De=dt,ze=pt,Re=ft,Oe=It,Be=Dt,Fe=zt):12==Ne?(Pe=le,ke=ce,Ie=ue,De=mt,ze=gt,Re=vt,Oe=Ct,Be=At,Fe=Nt):13==Ne?(Pe=de,ke=pe,Ie=fe,De=mt,ze=gt,Re=vt,Oe=Lt,Be=Pt,Fe=kt):14==Ne&&(Pe=me,ke=ge,Ie=ve,De=mt,ze=gt,Re=vt,Oe=It,Be=Dt,Fe=zt),Ne>5){Le||(Pe=-Pe,ke=-ke,Ie=-Ie);var Ze,Je,Ke,Qe,ti,ei,ii,ni,si,ri,oi;ei=H[0],ii=H[1],ni=H[2],Je=Pe*ei+ke*ii+Ie*ni,Ke=H[3],Qe=H[4],ti=H[5],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze>Je&&(Je=Ze,ei=Ke,ii=Qe,ni=ti),Ke=H[6],Qe=H[7],ti=H[8],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze>Je&&(Je=Ze,ei=Ke,ii=Qe,ni=ti),Ke=H[9],Qe=H[10],ti=H[11],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze>Je&&(Je=Ze,ei=Ke,ii=Qe,ni=ti),Ke=H[12],Qe=H[13],ti=H[14],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze>Je&&(Je=Ze,ei=Ke,ii=Qe,ni=ti),Ke=H[15],Qe=H[16],ti=H[17],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze>Je&&(Je=Ze,ei=Ke,ii=Qe,ni=ti),Ke=H[18],Qe=H[19],ti=H[20],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze>Je&&(Je=Ze,ei=Ke,ii=Qe,ni=ti),Ke=H[21],Qe=H[22],ti=H[23],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze>Je&&(Je=Ze,ei=Ke,ii=Qe,ni=ti),si=W[0],ri=W[1],oi=W[2],Je=Pe*si+ke*ri+Ie*oi,Ke=W[3],Qe=W[4],ti=W[5],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze<Je&&(Je=Ze,si=Ke,ri=Qe,oi=ti),Ke=W[6],Qe=W[7],ti=W[8],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze<Je&&(Je=Ze,si=Ke,ri=Qe,oi=ti),Ke=W[9],Qe=W[10],ti=W[11],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze<Je&&(Je=Ze,si=Ke,ri=Qe,oi=ti),Ke=W[12],Qe=W[13],ti=W[14],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze<Je&&(Je=Ze,si=Ke,ri=Qe,oi=ti),Ke=W[15],Qe=W[16],ti=W[17],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze<Je&&(Je=Ze,si=Ke,ri=Qe,oi=ti),Ke=W[18],Qe=W[19],ti=W[20],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze<Je&&(Je=Ze,si=Ke,ri=Qe,oi=ti),Ke=W[21],Qe=W[22],ti=W[23],Ze=Pe*Ke+ke*Qe+Ie*ti,Ze<Je&&(Je=Ze,si=Ke,ri=Qe,oi=ti),Ke=si-ei,Qe=ri-ii,ti=oi-ni,F=De*Oe+ze*Be+Re*Fe;var ai=(Ke*(De-Oe*F)+Qe*(ze-Be*F)+ti*(Re-Fe*F))/(1-F*F);return void i.addPoint(ei+De*ai+Pe*Ce*.5,ii+ze*ai+ke*Ce*.5,ni+Re*ai+Ie*Ce*.5,Pe,ke,Ie,Ce,!1)}var hi,li,ci,ui,di,pi,fi,mi,gi,vi,yi,xi,bi=1,wi=0,_i=0;$e?(wi=lt*Pe+ct*ke+ut*Ie,wi<bi&&(bi=wi,_i=0),-wi<bi&&(bi=-wi,_i=1),wi=dt*Pe+pt*ke+ft*Ie,wi<bi&&(bi=wi,_i=2),-wi<bi&&(bi=-wi,_i=3),wi=mt*Pe+gt*ke+vt*Ie,wi<bi&&(bi=wi,_i=4),-wi<bi&&(bi=-wi,_i=5),0==_i?(hi=H[0],li=H[1],ci=H[2],ui=H[6],di=H[7],pi=H[8],fi=H[9],mi=H[10],gi=H[11],vi=H[3],yi=H[4],xi=H[5]):1==_i?(hi=H[15],li=H[16],ci=H[17],ui=H[21],di=H[22],pi=H[23],fi=H[18],mi=H[19],gi=H[20],vi=H[12],yi=H[13],xi=H[14]):2==_i?(hi=H[12],li=H[13],ci=H[14],ui=H[0],di=H[1],pi=H[2],fi=H[3],mi=H[4],gi=H[5],vi=H[15],yi=H[16],xi=H[17]):3==_i?(hi=H[21],li=H[22],ci=H[23],ui=H[9],di=H[10],pi=H[11],fi=H[6],mi=H[7],gi=H[8],vi=H[18],yi=H[19],xi=H[20]):4==_i?(hi=H[12],li=H[13],ci=H[14],ui=H[18],di=H[19],pi=H[20],fi=H[6],mi=H[7],gi=H[8],vi=H[0],yi=H[1],xi=H[2]):5==_i&&(hi=H[3],li=H[4],ci=H[5],ui=H[6],di=H[7],pi=H[8],fi=H[21],mi=H[22],gi=H[23],vi=H[15],yi=H[16],xi=H[17])):(wi=Ct*Pe+At*ke+Nt*Ie,wi<bi&&(bi=wi,_i=0),-wi<bi&&(bi=-wi,_i=1),wi=Lt*Pe+Pt*ke+kt*Ie,wi<bi&&(bi=wi,_i=2),-wi<bi&&(bi=-wi,_i=3),wi=It*Pe+Dt*ke+zt*Ie,wi<bi&&(bi=wi,_i=4),-wi<bi&&(bi=-wi,_i=5),0==_i?(hi=W[0],li=W[1],ci=W[2],ui=W[6],di=W[7],pi=W[8],fi=W[9],mi=W[10],gi=W[11],vi=W[3],yi=W[4],xi=W[5]):1==_i?(hi=W[15],li=W[16],ci=W[17],ui=W[21],di=W[22],pi=W[23],fi=W[18],mi=W[19],gi=W[20],vi=W[12],yi=W[13],xi=W[14]):2==_i?(hi=W[12],li=W[13],ci=W[14],ui=W[0],di=W[1],pi=W[2],fi=W[3],mi=W[4],gi=W[5],vi=W[15],yi=W[16],xi=W[17]):3==_i?(hi=W[21],li=W[22],ci=W[23],ui=W[9],di=W[10],pi=W[11],fi=W[6],mi=W[7],gi=W[8],vi=W[18],yi=W[19],xi=W[20]):4==_i?(hi=W[12],li=W[13],ci=W[14],ui=W[18],di=W[19],pi=W[20],fi=W[6],mi=W[7],gi=W[8],vi=W[0],yi=W[1],xi=W[2]):5==_i&&(hi=W[3],li=W[4],ci=W[5],ui=W[9],di=W[10],pi=W[11],fi=W[21],mi=W[22],gi=W[23],vi=W[15],yi=W[16],xi=W[17]));var Si,Mi,Ti,Ei,Ci,Ai,Ni,Li,Pi;this.clipVertices1[0]=hi,this.clipVertices1[1]=li,this.clipVertices1[2]=ci,this.clipVertices1[3]=ui,this.clipVertices1[4]=di,this.clipVertices1[5]=pi,this.clipVertices1[6]=fi,this.clipVertices1[7]=mi,this.clipVertices1[8]=gi,this.clipVertices1[9]=vi,this.clipVertices1[10]=yi,this.clipVertices1[11]=xi,Mi=0,Ei=this.clipVertices1[9],Ci=this.clipVertices1[10],Ai=this.clipVertices1[11],F=(Ei-Ue-We)*De+(Ci-Ve-je)*ze+(Ai-He-Ge)*Re;for(var ki=0;ki<4;ki++)Ti=3*ki,Ni=this.clipVertices1[Ti],Li=this.clipVertices1[Ti+1],Pi=this.clipVertices1[Ti+2],U=(Ni-Ue-We)*De+(Li-Ve-je)*ze+(Pi-He-Ge)*Re,F>0?U>0?(Ti=3*Mi,Mi++,this.clipVertices2[Ti]=Ni,this.clipVertices2[Ti+1]=Li,this.clipVertices2[Ti+2]=Pi):(Ti=3*Mi,Mi++,ai=F/(F-U),this.clipVertices2[Ti]=Ei+(Ni-Ei)*ai,this.clipVertices2[Ti+1]=Ci+(Li-Ci)*ai,this.clipVertices2[Ti+2]=Ai+(Pi-Ai)*ai):U>0&&(Ti=3*Mi,Mi++,ai=F/(F-U),this.clipVertices2[Ti]=Ei+(Ni-Ei)*ai,this.clipVertices2[Ti+1]=Ci+(Li-Ci)*ai,this.clipVertices2[Ti+2]=Ai+(Pi-Ai)*ai,Ti=3*Mi,Mi++,this.clipVertices2[Ti]=Ni,this.clipVertices2[Ti+1]=Li,this.clipVertices2[Ti+2]=Pi),Ei=Ni,Ci=Li,Ai=Pi,F=U;if(Si=Mi,0!=Si){for(Mi=0,Ti=3*(Si-1),Ei=this.clipVertices2[Ti],Ci=this.clipVertices2[Ti+1],Ai=this.clipVertices2[Ti+2],F=(Ei-Ue-Xe)*Oe+(Ci-Ve-Ye)*Be+(Ai-He-qe)*Fe,ki=0;ki<Si;ki++)Ti=3*ki,Ni=this.clipVertices2[Ti],Li=this.clipVertices2[Ti+1],Pi=this.clipVertices2[Ti+2],U=(Ni-Ue-Xe)*Oe+(Li-Ve-Ye)*Be+(Pi-He-qe)*Fe,F>0?U>0?(Ti=3*Mi,Mi++,this.clipVertices1[Ti]=Ni,this.clipVertices1[Ti+1]=Li,this.clipVertices1[Ti+2]=Pi):(Ti=3*Mi,Mi++,ai=F/(F-U),this.clipVertices1[Ti]=Ei+(Ni-Ei)*ai,this.clipVertices1[Ti+1]=Ci+(Li-Ci)*ai,this.clipVertices1[Ti+2]=Ai+(Pi-Ai)*ai):U>0&&(Ti=3*Mi,Mi++,ai=F/(F-U),this.clipVertices1[Ti]=Ei+(Ni-Ei)*ai,this.clipVertices1[Ti+1]=Ci+(Li-Ci)*ai,this.clipVertices1[Ti+2]=Ai+(Pi-Ai)*ai,Ti=3*Mi,Mi++,this.clipVertices1[Ti]=Ni,this.clipVertices1[Ti+1]=Li,this.clipVertices1[Ti+2]=Pi),Ei=Ni,Ci=Li,Ai=Pi,F=U;if(Si=Mi,0!=Si){for(Mi=0,Ti=3*(Si-1),Ei=this.clipVertices1[Ti],Ci=this.clipVertices1[Ti+1],Ai=this.clipVertices1[Ti+2],F=(Ei-Ue+We)*-De+(Ci-Ve+je)*-ze+(Ai-He+Ge)*-Re,ki=0;ki<Si;ki++)Ti=3*ki,Ni=this.clipVertices1[Ti],Li=this.clipVertices1[Ti+1],Pi=this.clipVertices1[Ti+2],U=(Ni-Ue+We)*-De+(Li-Ve+je)*-ze+(Pi-He+Ge)*-Re,F>0?U>0?(Ti=3*Mi,Mi++,this.clipVertices2[Ti]=Ni,this.clipVertices2[Ti+1]=Li,this.clipVertices2[Ti+2]=Pi):(Ti=3*Mi,Mi++,ai=F/(F-U),this.clipVertices2[Ti]=Ei+(Ni-Ei)*ai,this.clipVertices2[Ti+1]=Ci+(Li-Ci)*ai,this.clipVertices2[Ti+2]=Ai+(Pi-Ai)*ai):U>0&&(Ti=3*Mi,Mi++,ai=F/(F-U),this.clipVertices2[Ti]=Ei+(Ni-Ei)*ai,this.clipVertices2[Ti+1]=Ci+(Li-Ci)*ai,this.clipVertices2[Ti+2]=Ai+(Pi-Ai)*ai,Ti=3*Mi,Mi++,this.clipVertices2[Ti]=Ni,this.clipVertices2[Ti+1]=Li,this.clipVertices2[Ti+2]=Pi),Ei=Ni,Ci=Li,Ai=Pi,F=U;if(Si=Mi,0!=Si){for(Mi=0,Ti=3*(Si-1),Ei=this.clipVertices2[Ti],Ci=this.clipVertices2[Ti+1],Ai=this.clipVertices2[Ti+2],F=(Ei-Ue+Xe)*-Oe+(Ci-Ve+Ye)*-Be+(Ai-He+qe)*-Fe,ki=0;ki<Si;ki++)Ti=3*ki,Ni=this.clipVertices2[Ti],Li=this.clipVertices2[Ti+1],Pi=this.clipVertices2[Ti+2],U=(Ni-Ue+Xe)*-Oe+(Li-Ve+Ye)*-Be+(Pi-He+qe)*-Fe,F>0?U>0?(Ti=3*Mi,Mi++,this.clipVertices1[Ti]=Ni,this.clipVertices1[Ti+1]=Li,this.clipVertices1[Ti+2]=Pi):(Ti=3*Mi,Mi++,ai=F/(F-U),this.clipVertices1[Ti]=Ei+(Ni-Ei)*ai,this.clipVertices1[Ti+1]=Ci+(Li-Ci)*ai,this.clipVertices1[Ti+2]=Ai+(Pi-Ai)*ai):U>0&&(Ti=3*Mi,Mi++,ai=F/(F-U),this.clipVertices1[Ti]=Ei+(Ni-Ei)*ai,this.clipVertices1[Ti+1]=Ci+(Li-Ci)*ai,this.clipVertices1[Ti+2]=Ai+(Pi-Ai)*ai,Ti=3*Mi,Mi++,this.clipVertices1[Ti]=Ni,this.clipVertices1[Ti+1]=Li,this.clipVertices1[Ti+2]=Pi),Ei=Ni,Ci=Li,Ai=Pi,F=U;if(Si=Mi,$e){var Ii=n;n=r,r=Ii}if(0!=Si){var Di=n!=t;if(Si>4){Ei=.25*(hi+ui+fi+vi),Ci=.25*(li+di+mi+yi),Ai=.25*(ci+pi+gi+xi),De=hi-Ei,ze=li-Ci,Re=ci-Ai,Oe=ui-Ei,Be=di-Ci,Fe=pi-Ai;var zi=0,Ri=0,Oi=0,Bi=0,Fi=-this.INF;for(bi=this.INF,ki=0;ki<Si;ki++)this.used[ki]=!1,Ti=3*ki,Ei=this.clipVertices1[Ti],Ci=this.clipVertices1[Ti+1],Ai=this.clipVertices1[Ti+2],wi=Ei*De+Ci*ze+Ai*Re,wi<bi&&(bi=wi,zi=ki),wi>Fi&&(Fi=wi,Oi=ki);for(this.used[zi]=!0,this.used[Oi]=!0,Fi=-this.INF,bi=this.INF,ki=0;ki<Si;ki++)this.used[ki]||(Ti=3*ki,Ei=this.clipVertices1[Ti],Ci=this.clipVertices1[Ti+1],Ai=this.clipVertices1[Ti+2],wi=Ei*Oe+Ci*Be+Ai*Fe,wi<bi&&(bi=wi,Ri=ki),wi>Fi&&(Fi=wi,Bi=ki));Ti=3*zi,Ei=this.clipVertices1[Ti],Ci=this.clipVertices1[Ti+1],Ai=this.clipVertices1[Ti+2],wi=(Ei-Ue)*Pe+(Ci-Ve)*ke+(Ai-He)*Ie,wi<0&&i.addPoint(Ei,Ci,Ai,Pe,ke,Ie,wi,Di),Ti=3*Ri,Ei=this.clipVertices1[Ti],Ci=this.clipVertices1[Ti+1],Ai=this.clipVertices1[Ti+2],wi=(Ei-Ue)*Pe+(Ci-Ve)*ke+(Ai-He)*Ie,wi<0&&i.addPoint(Ei,Ci,Ai,Pe,ke,Ie,wi,Di),Ti=3*Oi,Ei=this.clipVertices1[Ti],Ci=this.clipVertices1[Ti+1],Ai=this.clipVertices1[Ti+2],wi=(Ei-Ue)*Pe+(Ci-Ve)*ke+(Ai-He)*Ie,wi<0&&i.addPoint(Ei,Ci,Ai,Pe,ke,Ie,wi,Di),Ti=3*Bi,Ei=this.clipVertices1[Ti],Ci=this.clipVertices1[Ti+1],Ai=this.clipVertices1[Ti+2],wi=(Ei-Ue)*Pe+(Ci-Ve)*ke+(Ai-He)*Ie,wi<0&&i.addPoint(Ei,Ci,Ai,Pe,ke,Ie,wi,Di)}else for(ki=0;ki<Si;ki++)Ti=3*ki,Ei=this.clipVertices1[Ti],Ci=this.clipVertices1[Ti+1],
Ai=this.clipVertices1[Ti+2],wi=(Ei-Ue)*Pe+(Ci-Ve)*ke+(Ai-He)*Ie,wi<0&&i.addPoint(Ei,Ci,Ai,Pe,ke,Ie,wi,Di)}}}}}},s.SphereBoxCollisionDetector=function(t){s.CollisionDetector.call(this),this.flip=t},s.SphereBoxCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.SphereBoxCollisionDetector.prototype.constructor=s.SphereBoxCollisionDetector,s.SphereBoxCollisionDetector.prototype.detectCollision=function(t,e,i){var n,r;this.flip?(n=e,r=t):(n=t,r=e);var o,a,h,l,c,u=r.dimentions,d=n.position,p=d.x,f=d.y,m=d.z,g=r.position,v=g.x,y=g.y,x=g.z,b=n.radius,w=r.halfWidth,_=r.halfHeight,S=r.halfDepth,M=p-v,T=f-y,E=m-x,C=u[0]*M+u[1]*T+u[2]*E,A=u[3]*M+u[4]*T+u[5]*E,N=u[6]*M+u[7]*T+u[8]*E,L=0;C>w?C=w:C<-w?C=-w:L=1,A>_?A=_:A<-_?A=-_:L|=2,N>S?N=S:N<-S?N=-S:L|=4,7==L?(M=C<0?w+C:w-C,T=A<0?_+A:_-A,E=N<0?S+N:S-N,M<T?M<E?(l=M-w,C<0?(C=-w,M=u[0],T=u[1],E=u[2]):(C=w,M=-u[0],T=-u[1],E=-u[2])):(l=E-S,N<0?(N=-S,M=u[6],T=u[7],E=u[8]):(N=S,M=-u[6],T=-u[7],E=-u[8])):T<E?(l=T-_,A<0?(A=-_,M=u[3],T=u[4],E=u[5]):(A=_,M=-u[3],T=-u[4],E=-u[5])):(l=E-S,N<0?(N=-S,M=u[6],T=u[7],E=u[8]):(N=S,M=-u[6],T=-u[7],E=-u[8])),o=v+C*u[0]+A*u[3]+N*u[6],a=y+C*u[1]+A*u[4]+N*u[7],h=x+C*u[2]+A*u[5]+N*u[8],i.addPoint(p+b*M,f+b*T,m+b*E,M,T,E,l-b,this.flip)):(o=v+C*u[0]+A*u[3]+N*u[6],a=y+C*u[1]+A*u[4]+N*u[7],h=x+C*u[2]+A*u[5]+N*u[8],M=o-d.x,T=a-d.y,E=h-d.z,l=M*M+T*T+E*E,l>0&&l<b*b&&(l=s.sqrt(l),c=1/l,M*=c,T*=c,E*=c,i.addPoint(p+b*M,f+b*T,m+b*E,M,T,E,l-b,this.flip)))},s.SphereSphereCollisionDetector=function(){s.CollisionDetector.call(this)},s.SphereSphereCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.SphereSphereCollisionDetector.prototype.constructor=s.SphereSphereCollisionDetector,s.SphereSphereCollisionDetector.prototype.detectCollision=function(t,e,i){var n=t,r=e,o=n.position,a=r.position,h=a.x-o.x,l=a.y-o.y,c=a.z-o.z,u=h*h+l*l+c*c,d=n.radius,p=r.radius,f=d+p;if(u>0&&u<f*f){u=s.sqrt(u);var m=1/u;h*=m,l*=m,c*=m,i.addPoint(o.x+h*d,o.y+l*d,o.z+c*d,h,l,c,u-f,!1)}},s.BoxCylinderCollisionDetector=function(t){s.CollisionDetector.call(this),this.flip=t},s.BoxCylinderCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.BoxCylinderCollisionDetector.prototype.constructor=s.BoxCylinderCollisionDetector,s.BoxCylinderCollisionDetector.prototype.getSep=function(t,e,i,n,r){var o,a,h,l,c,u,d,p,f,m,g,v,y,x=new s.Vec3,b=t.position.x,w=t.position.y,_=t.position.z,S=e.position.x,M=e.position.y,T=e.position.z,E=S-b,C=M-w,A=T-_;E*E+C*C+A*A==0&&(C=.001);var N=-E,L=-C,P=-A;this.supportPointB(t,-N,-L,-P,x);var k=x.x,I=x.y,D=x.z;this.supportPointC(e,N,L,P,x);var z=x.x,R=x.y,O=x.z,B=z-k,F=R-I,U=O-D;if(B*N+F*L+U*P<=0)return!1;if(N=F*A-U*C,L=U*E-B*A,P=B*C-F*E,N*N+L*L+P*P==0)return i.init(B-E,F-C,U-A),i.normalize(i),n.init(.5*(k+z),.5*(I+R),.5*(D+O)),!0;this.supportPointB(t,-N,-L,-P,x);var V=x.x,H=x.y,W=x.z;this.supportPointC(e,N,L,P,x);var j=x.x,G=x.y,X=x.z,Y=j-V,q=G-H,$=X-W;if(Y*N+q*L+$*P<=0)return!1;o=B-E,a=F-C,h=U-A,l=Y-E,c=q-C,u=$-A,N=a*u-h*c,L=h*l-o*u,P=o*c-a*l,N*E+L*C+P*A>0&&(o=B,a=F,h=U,B=Y,F=q,U=$,Y=o,q=a,$=h,o=k,a=I,h=D,k=V,I=H,D=W,V=o,H=a,W=h,o=z,a=R,h=O,z=j,R=G,O=X,j=o,G=a,X=h,N=-N,L=-L,P=-P);for(var Z=0;;){if(++Z>100)return!1;this.supportPointB(t,-N,-L,-P,x);var J=x.x,K=x.y,Q=x.z;this.supportPointC(e,N,L,P,x);var tt=x.x,et=x.y,it=x.z,nt=tt-J,st=et-K,rt=it-Q;if(nt*N+st*L+rt*P<=0)return!1;if((F*rt-U*st)*E+(U*nt-B*rt)*C+(B*st-F*nt)*A<0)Y=nt,q=st,$=rt,V=J,H=K,W=Q,j=tt,G=et,X=it,o=B-E,a=F-C,h=U-A,l=nt-E,c=st-C,u=rt-A,N=a*u-h*c,L=h*l-o*u,P=o*c-a*l;else if((st*$-rt*q)*E+(rt*Y-nt*$)*C+(nt*q-st*Y)*A<0)B=nt,F=st,U=rt,k=J,I=K,D=Q,z=tt,R=et,O=it,o=nt-E,a=st-C,h=rt-A,l=Y-E,c=q-C,u=$-A,N=a*u-h*c,L=h*l-o*u,P=o*c-a*l;else for(var ot=!1;;){if(o=Y-B,a=q-F,h=$-U,l=nt-B,c=st-F,u=rt-U,N=a*u-h*c,L=h*l-o*u,P=o*c-a*l,d=1/s.sqrt(N*N+L*L+P*P),N*=d,L*=d,P*=d,N*B+L*F+P*U>=0&&!ot){var at=(F*$-U*q)*nt+(U*Y-B*$)*st+(B*q-F*Y)*rt,ht=(st*$-rt*q)*E+(rt*Y-nt*$)*C+(nt*q-st*Y)*A,lt=(C*U-A*F)*nt+(A*B-E*U)*st+(E*F-C*B)*rt,ct=(q*U-$*F)*E+($*B-Y*U)*C+(Y*F-q*B)*A,ut=at+ht+lt+ct;ut<=0&&(at=0,ht=(q*rt-$*st)*N+($*nt-Y*rt)*L+(Y*st-q*nt)*P,lt=(st*$-rt*q)*N+(rt*Y-nt*$)*L+(nt*q-st*Y)*P,ct=(F*$-U*q)*N+(U*Y-B*$)*L+(B*q-F*Y)*P,ut=ht+lt+ct);var dt=1/ut;p=(b*at+k*ht+V*lt+J*ct)*dt,f=(w*at+I*ht+H*lt+K*ct)*dt,m=(_*at+D*ht+W*lt+Q*ct)*dt,g=(S*at+z*ht+j*lt+tt*ct)*dt,v=(M*at+R*ht+G*lt+et*ct)*dt,y=(T*at+O*ht+X*lt+it*ct)*dt,ot=!0}this.supportPointB(t,-N,-L,-P,x);var pt=x.x,ft=x.y,mt=x.z;this.supportPointC(e,N,L,P,x);var gt=x.x,vt=x.y,yt=x.z,xt=gt-pt,bt=vt-ft,wt=yt-mt,_t=-(xt*N+bt*L+wt*P);if((xt-nt)*N+(bt-st)*L+(wt-rt)*P<=.01||_t>=0)return!!ot&&(i.init(-N,-L,-P),n.init(.5*(p+g),.5*(f+v),.5*(m+y)),r.x=_t,!0);(bt*U-wt*F)*E+(wt*B-xt*U)*C+(xt*F-bt*B)*A<0?(bt*$-wt*q)*E+(wt*Y-xt*$)*C+(xt*q-bt*Y)*A<0?(B=xt,F=bt,U=wt,k=pt,I=ft,D=mt,z=gt,R=vt,O=yt):(nt=xt,st=bt,rt=wt,J=pt,K=ft,Q=mt,tt=gt,et=vt,it=yt):(bt*rt-wt*st)*E+(wt*nt-xt*rt)*C+(xt*st-bt*nt)*A<0?(Y=xt,q=bt,$=wt,V=pt,H=ft,W=mt,j=gt,G=vt,X=yt):(B=xt,F=bt,U=wt,k=pt,I=ft,D=mt,z=gt,R=vt,O=yt)}}},s.BoxCylinderCollisionDetector.prototype.supportPointB=function(t,e,i,n,s){var r,o,a,h=t.rotation.elements,l=h[0]*e+h[3]*i+h[6]*n,c=h[1]*e+h[4]*i+h[7]*n,u=h[2]*e+h[5]*i+h[8]*n,d=t.halfWidth,p=t.halfHeight,f=t.halfDepth;r=l<0?-d:d,o=c<0?-p:p,a=u<0?-f:f,l=h[0]*r+h[1]*o+h[2]*a+t.position.x,c=h[3]*r+h[4]*o+h[5]*a+t.position.y,u=h[6]*r+h[7]*o+h[8]*a+t.position.z,s.init(l,c,u)},s.BoxCylinderCollisionDetector.prototype.supportPointC=function(t,e,i,n,r){var o,a,h,l=t.rotation.elements,c=l[0]*e+l[3]*i+l[6]*n,u=l[1]*e+l[4]*i+l[7]*n,d=l[2]*e+l[5]*i+l[8]*n,p=c,f=d,m=p*p+f*f,g=t.radius,v=t.halfHeight;0==m?u<0?(o=g,a=-v,h=0):(o=g,a=v,h=0):(m=t.radius/s.sqrt(m),u<0?(o=p*m,a=-v,h=f*m):(o=p*m,a=v,h=f*m)),c=l[0]*o+l[1]*a+l[2]*h+t.position.x,u=l[3]*o+l[4]*a+l[5]*h+t.position.y,d=l[6]*o+l[7]*a+l[8]*h+t.position.z,r.init(c,u,d)},s.BoxCylinderCollisionDetector.prototype.detectCollision=function(t,e,i){var n,r;this.flip?(n=e,r=t):(n=t,r=e);var o=new s.Vec3,a=new s.Vec3,h=new s.Vec3;if(this.getSep(n,r,o,a,h)){var l=n.position.x,c=n.position.y,u=n.position.z,d=r.position.x,p=r.position.y,f=r.position.z,m=n.halfWidth,g=n.halfHeight,v=n.halfDepth,y=r.halfHeight,x=r.radius,b=n.dimentions,w=b[0],_=b[1],S=b[2],M=b[3],T=b[4],E=b[5],C=b[6],A=b[7],N=b[8],L=b[9],P=b[10],k=b[11],I=b[12],D=b[13],z=b[14],R=b[15],O=b[16],B=b[17],F=r.normalDirection.x,U=r.normalDirection.y,V=r.normalDirection.z,H=r.halfDirection.x,W=r.halfDirection.y,j=r.halfDirection.z,G=o.x,X=o.y,Y=o.z,q=G*w+X*_+Y*S,$=G*M+X*T+Y*E,Z=G*C+X*A+Y*N,J=G*F+X*U+Y*V,K=q>0,Q=$>0,tt=Z>0,et=J>0;K||(q=-q),Q||($=-$),tt||(Z=-Z),et||(J=-J);var it=0;J>.999?it=q>.999?q>J?1:4:$>.999?$>J?2:4:Z>.999&&Z>J?3:4:q>.999?it=1:$>.999?it=2:Z>.999&&(it=3);var nt,st,rt,ot,at,ht,lt,ct,ut,dt,pt,ft,mt,gt,vt,yt,xt,bt,wt,_t,St,Mt,Tt,Et,Ct,At,Nt,Lt,Pt,kt,It,Dt,zt,Rt,Ot,Bt,Ft,Ut,Vt,Ht,Wt,jt,Gt,Xt,Yt,qt,$t,Zt,Jt,Kt,Qt,te,ee;if(0==it)i.addPoint(a.x,a.y,a.z,G,X,Y,h.x,this.flip);else if(4==it){et?(ot=d-H,at=p-W,ht=f-j,G=-F,X=-U,Y=-V):(ot=d+H,at=p+W,ht=f+j,G=F,X=U,Y=V);var ie,ne,se,re,oe,ae,he,le,ce,ue,de,pe;_t=1,it=0,Gt=w*G+_*X+S*Y,Gt<_t&&(_t=Gt,it=0),-Gt<_t&&(_t=-Gt,it=1),Gt=M*G+T*X+E*Y,Gt<_t&&(_t=Gt,it=2),-Gt<_t&&(_t=-Gt,it=3),Gt=C*G+A*X+N*Y,Gt<_t&&(_t=Gt,it=4),-Gt<_t&&(_t=-Gt,it=5);var fe=n.elements;switch(it){case 0:ie=fe[0],ne=fe[1],se=fe[2],re=fe[6],oe=fe[7],ae=fe[8],he=fe[9],le=fe[10],ce=fe[11],ue=fe[3],de=fe[4],pe=fe[5];break;case 1:ie=fe[15],ne=fe[16],se=fe[17],re=fe[21],oe=fe[22],ae=fe[23],he=fe[18],le=fe[19],ce=fe[20],ue=fe[12],de=fe[13],pe=fe[14];break;case 2:ie=fe[12],ne=fe[13],se=fe[14],re=fe[0],oe=fe[1],ae=fe[2],he=fe[3],le=fe[4],ce=fe[5],ue=fe[15],de=fe[16],pe=fe[17];break;case 3:ie=fe[21],ne=fe[22],se=fe[23],re=fe[9],oe=fe[10],ae=fe[11],he=fe[6],le=fe[7],ce=fe[8],ue=fe[18],de=fe[19],pe=fe[20];break;case 4:ie=fe[12],ne=fe[13],se=fe[14],re=fe[18],oe=fe[19],ae=fe[20],he=fe[6],le=fe[7],ce=fe[8],ue=fe[0],de=fe[1],pe=fe[2];break;case 5:ie=fe[3],ne=fe[4],se=fe[5],re=fe[9],oe=fe[10],ae=fe[11],he=fe[21],le=fe[22],ce=fe[23],ue=fe[15],de=fe[16],pe=fe[17]}wt=G*(ie-ot)+X*(ne-at)+Y*(se-ht),wt<=0&&i.addPoint(ie,ne,se,-G,-X,-Y,wt,this.flip),wt=G*(re-ot)+X*(oe-at)+Y*(ae-ht),wt<=0&&i.addPoint(re,oe,ae,-G,-X,-Y,wt,this.flip),wt=G*(he-ot)+X*(le-at)+Y*(ce-ht),wt<=0&&i.addPoint(he,le,ce,-G,-X,-Y,wt,this.flip),wt=G*(ue-ot)+X*(de-at)+Y*(pe-ht),wt<=0&&i.addPoint(ue,de,pe,-G,-X,-Y,wt,this.flip)}else{switch(it){case 1:K?(nt=l+L,st=c+P,rt=u+k,G=w,X=_,Y=S):(nt=l-L,st=c-P,rt=u-k,G=-w,X=-_,Y=-S),qt=M,$t=T,Zt=E,te=g,Jt=C,Kt=A,Qt=N,ee=v;break;case 2:Q?(nt=l+I,st=c+D,rt=u+z,G=M,X=T,Y=E):(nt=l-I,st=c-D,rt=u-z,G=-M,X=-T,Y=-E),qt=w,$t=_,Zt=S,te=m,Jt=C,Kt=A,Qt=N,ee=v;break;case 3:tt?(nt=l+R,st=c+O,rt=u+B,G=C,X=A,Y=N):(nt=l-R,st=c-O,rt=u-B,G=-C,X=-A,Y=-N),qt=w,$t=_,Zt=S,te=m,Jt=M,Kt=T,Qt=E,ee=g}if(_t=G*F+X*U+Y*V,St=_t<0?y:-y,ot=d+St*F,at=p+St*U,ht=f+St*V,J>=.999999?(Mt=-X,Tt=Y,Et=G):(Mt=G,Tt=X,Et=Y),St=Mt*F+Tt*U+Et*V,At=St*F-Mt,Nt=St*U-Tt,Lt=St*V-Et,St=s.sqrt(At*At+Nt*Nt+Lt*Lt),0==St)return;if(St=x/St,At*=St,Nt*=St,Lt*=St,Mt=ot+At,Tt=at+Nt,Et=ht+Lt,_t<-.96||_t>.96)lt=F*F*1.5-.5,ct=F*U*1.5-.866025403*V,ut=F*V*1.5+.866025403*U,dt=U*F*1.5+.866025403*V,pt=U*U*1.5-.5,ft=U*V*1.5-.866025403*F,mt=V*F*1.5-.866025403*U,gt=V*U*1.5+.866025403*F,vt=V*V*1.5-.5,yt=Mt,xt=Tt,bt=Et,wt=G*(yt-nt)+X*(xt-st)+Y*(bt-rt),Mt=yt-wt*G-nt,Tt=xt-wt*X-st,Et=bt-wt*Y-rt,Ut=qt*Mt+$t*Tt+Zt*Et,jt=Jt*Mt+Kt*Tt+Qt*Et,Ut<-te?Ut=-te:Ut>te&&(Ut=te),jt<-ee?jt=-ee:jt>ee&&(jt=ee),Mt=Ut*qt+jt*Jt,Tt=Ut*$t+jt*Kt,Et=Ut*Zt+jt*Qt,yt=nt+Mt,xt=st+Tt,bt=rt+Et,i.addPoint(yt,xt,bt,G,X,Y,wt,this.flip),yt=At*lt+Nt*ct+Lt*ut,xt=At*dt+Nt*pt+Lt*ft,bt=At*mt+Nt*gt+Lt*vt,yt=(At=yt)+ot,xt=(Nt=xt)+at,bt=(Lt=bt)+ht,wt=G*(yt-nt)+X*(xt-st)+Y*(bt-rt),wt<=0&&(Mt=yt-wt*G-nt,Tt=xt-wt*X-st,Et=bt-wt*Y-rt,Ut=qt*Mt+$t*Tt+Zt*Et,jt=Jt*Mt+Kt*Tt+Qt*Et,Ut<-te?Ut=-te:Ut>te&&(Ut=te),jt<-ee?jt=-ee:jt>ee&&(jt=ee),Mt=Ut*qt+jt*Jt,Tt=Ut*$t+jt*Kt,Et=Ut*Zt+jt*Qt,yt=nt+Mt,xt=st+Tt,bt=rt+Et,i.addPoint(yt,xt,bt,G,X,Y,wt,this.flip)),yt=At*lt+Nt*ct+Lt*ut,xt=At*dt+Nt*pt+Lt*ft,bt=At*mt+Nt*gt+Lt*vt,yt=(At=yt)+ot,xt=(Nt=xt)+at,bt=(Lt=bt)+ht,wt=G*(yt-nt)+X*(xt-st)+Y*(bt-rt),wt<=0&&(Mt=yt-wt*G-nt,Tt=xt-wt*X-st,Et=bt-wt*Y-rt,Ut=qt*Mt+$t*Tt+Zt*Et,jt=Jt*Mt+Kt*Tt+Qt*Et,Ut<-te?Ut=-te:Ut>te&&(Ut=te),jt<-ee?jt=-ee:jt>ee&&(jt=ee),Mt=Ut*qt+jt*Jt,Tt=Ut*$t+jt*Kt,Et=Ut*Zt+jt*Qt,yt=nt+Mt,xt=st+Tt,bt=rt+Et,i.addPoint(yt,xt,bt,G,X,Y,wt,this.flip));else{if(Ot=Mt,Bt=Tt,Ft=Et,Ut=G*(Ot-nt)+X*(Bt-st)+Y*(Ft-rt),Ot-=Ut*G,Bt-=Ut*X,Ft-=Ut*Y,_t>0?(Vt=Mt+2*H,Ht=Tt+2*W,Wt=Et+2*j):(Vt=Mt-2*H,Ht=Tt-2*W,Wt=Et-2*j),jt=G*(Vt-nt)+X*(Ht-st)+Y*(Wt-rt),Vt-=jt*G,Ht-=jt*X,Wt-=jt*Y,Pt=Ot-nt,kt=Bt-st,It=Ft-rt,Dt=Vt-nt,zt=Ht-st,Rt=Wt-rt,Mt=Vt-Ot,Tt=Ht-Bt,Et=Wt-Ft,Ct=jt-Ut,q=Pt*qt+kt*$t+It*Zt,$=Dt*qt+zt*$t+Rt*Zt,Gt=q-te,Xt=$-te,Gt>0){if(Xt>0)return;Yt=Gt/(Gt-Xt),Ot+=Mt*Yt,Bt+=Tt*Yt,Ft+=Et*Yt,Ut+=Ct*Yt,Pt=Ot-nt,kt=Bt-st,It=Ft-rt,q=Pt*qt+kt*$t+It*Zt,Mt=Vt-Ot,Tt=Ht-Bt,Et=Wt-Ft,Ct=jt-Ut}else Xt>0&&(Yt=Gt/(Gt-Xt),Vt=Ot+Mt*Yt,Ht=Bt+Tt*Yt,Wt=Ft+Et*Yt,jt=Ut+Ct*Yt,Dt=Vt-nt,zt=Ht-st,Rt=Wt-rt,$=Dt*qt+zt*$t+Rt*Zt,Mt=Vt-Ot,Tt=Ht-Bt,Et=Wt-Ft,Ct=jt-Ut);if(Gt=q+te,Xt=$+te,Gt<0){if(Xt<0)return;Yt=Gt/(Gt-Xt),Ot+=Mt*Yt,Bt+=Tt*Yt,Ft+=Et*Yt,Ut+=Ct*Yt,Pt=Ot-nt,kt=Bt-st,It=Ft-rt,Mt=Vt-Ot,Tt=Ht-Bt,Et=Wt-Ft,Ct=jt-Ut}else Xt<0&&(Yt=Gt/(Gt-Xt),Vt=Ot+Mt*Yt,Ht=Bt+Tt*Yt,Wt=Ft+Et*Yt,jt=Ut+Ct*Yt,Dt=Vt-nt,zt=Ht-st,Rt=Wt-rt,Mt=Vt-Ot,Tt=Ht-Bt,Et=Wt-Ft,Ct=jt-Ut);if(q=Pt*Jt+kt*Kt+It*Qt,$=Dt*Jt+zt*Kt+Rt*Qt,Gt=q-ee,Xt=$-ee,Gt>0){if(Xt>0)return;Yt=Gt/(Gt-Xt),Ot+=Mt*Yt,Bt+=Tt*Yt,Ft+=Et*Yt,Ut+=Ct*Yt,Pt=Ot-nt,kt=Bt-st,It=Ft-rt,q=Pt*Jt+kt*Kt+It*Qt,Mt=Vt-Ot,Tt=Ht-Bt,Et=Wt-Ft,Ct=jt-Ut}else Xt>0&&(Yt=Gt/(Gt-Xt),Vt=Ot+Mt*Yt,Ht=Bt+Tt*Yt,Wt=Ft+Et*Yt,jt=Ut+Ct*Yt,Dt=Vt-nt,zt=Ht-st,Rt=Wt-rt,$=Dt*Jt+zt*Kt+Rt*Qt,Mt=Vt-Ot,Tt=Ht-Bt,Et=Wt-Ft,Ct=jt-Ut);if(Gt=q+ee,Xt=$+ee,Gt<0){if(Xt<0)return;Yt=Gt/(Gt-Xt),Ot+=Mt*Yt,Bt+=Tt*Yt,Ft+=Et*Yt,Ut+=Ct*Yt}else Xt<0&&(Yt=Gt/(Gt-Xt),Vt=Ot+Mt*Yt,Ht=Bt+Tt*Yt,Wt=Ft+Et*Yt,jt=Ut+Ct*Yt);Ut<0&&i.addPoint(Ot,Bt,Ft,G,X,Y,Ut,this.flip),jt<0&&i.addPoint(Vt,Ht,Wt,G,X,Y,jt,this.flip)}}}},s.CylinderCylinderCollisionDetector=function(){s.CollisionDetector.call(this)},s.CylinderCylinderCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.CylinderCylinderCollisionDetector.prototype.constructor=s.CylinderCylinderCollisionDetector,s.CylinderCylinderCollisionDetector.prototype.getSep=function(t,e,i,n,r){var o,a,h,l,c,u,d,p,f,m,g,v,y,x=new s.Vec3,b=t.position.x,w=t.position.y,_=t.position.z,S=e.position.x,M=e.position.y,T=e.position.z,E=S-b,C=M-w,A=T-_;E*E+C*C+A*A==0&&(C=.001);var N=-E,L=-C,P=-A;this.supportPoint(t,-N,-L,-P,x);var k=x.x,I=x.y,D=x.z;this.supportPoint(e,N,L,P,x);var z=x.x,R=x.y,O=x.z,B=z-k,F=R-I,U=O-D;if(B*N+F*L+U*P<=0)return!1;if(N=F*A-U*C,L=U*E-B*A,P=B*C-F*E,N*N+L*L+P*P==0)return i.init(B-E,F-C,U-A),i.normalize(i),n.init(.5*(k+z),.5*(I+R),.5*(D+O)),!0;this.supportPoint(t,-N,-L,-P,x);var V=x.x,H=x.y,W=x.z;this.supportPoint(e,N,L,P,x);var j=x.x,G=x.y,X=x.z,Y=j-V,q=G-H,$=X-W;if(Y*N+q*L+$*P<=0)return!1;o=B-E,a=F-C,h=U-A,l=Y-E,c=q-C,u=$-A,N=a*u-h*c,L=h*l-o*u,P=o*c-a*l,N*E+L*C+P*A>0&&(o=B,a=F,h=U,B=Y,F=q,U=$,Y=o,q=a,$=h,o=k,a=I,h=D,k=V,I=H,D=W,V=o,H=a,W=h,o=z,a=R,h=O,z=j,R=G,O=X,j=o,G=a,X=h,N=-N,L=-L,P=-P);for(var Z=0;;){if(++Z>100)return!1;this.supportPoint(t,-N,-L,-P,x);var J=x.x,K=x.y,Q=x.z;this.supportPoint(e,N,L,P,x);var tt=x.x,et=x.y,it=x.z,nt=tt-J,st=et-K,rt=it-Q;if(nt*N+st*L+rt*P<=0)return!1;if((F*rt-U*st)*E+(U*nt-B*rt)*C+(B*st-F*nt)*A<0)Y=nt,q=st,$=rt,V=J,H=K,W=Q,j=tt,G=et,X=it,o=B-E,a=F-C,h=U-A,l=nt-E,c=st-C,u=rt-A,N=a*u-h*c,L=h*l-o*u,P=o*c-a*l;else if((st*$-rt*q)*E+(rt*Y-nt*$)*C+(nt*q-st*Y)*A<0)B=nt,F=st,U=rt,k=J,I=K,D=Q,z=tt,R=et,O=it,o=nt-E,a=st-C,h=rt-A,l=Y-E,c=q-C,u=$-A,N=a*u-h*c,L=h*l-o*u,P=o*c-a*l;else for(var ot=!1;;){if(o=Y-B,a=q-F,h=$-U,l=nt-B,c=st-F,u=rt-U,N=a*u-h*c,L=h*l-o*u,P=o*c-a*l,d=1/s.sqrt(N*N+L*L+P*P),N*=d,L*=d,P*=d,N*B+L*F+P*U>=0&&!ot){var at=(F*$-U*q)*nt+(U*Y-B*$)*st+(B*q-F*Y)*rt,ht=(st*$-rt*q)*E+(rt*Y-nt*$)*C+(nt*q-st*Y)*A,lt=(C*U-A*F)*nt+(A*B-E*U)*st+(E*F-C*B)*rt,ct=(q*U-$*F)*E+($*B-Y*U)*C+(Y*F-q*B)*A,ut=at+ht+lt+ct;ut<=0&&(at=0,ht=(q*rt-$*st)*N+($*nt-Y*rt)*L+(Y*st-q*nt)*P,lt=(st*$-rt*q)*N+(rt*Y-nt*$)*L+(nt*q-st*Y)*P,ct=(F*$-U*q)*N+(U*Y-B*$)*L+(B*q-F*Y)*P,ut=ht+lt+ct);var dt=1/ut;p=(b*at+k*ht+V*lt+J*ct)*dt,f=(w*at+I*ht+H*lt+K*ct)*dt,m=(_*at+D*ht+W*lt+Q*ct)*dt,g=(S*at+z*ht+j*lt+tt*ct)*dt,v=(M*at+R*ht+G*lt+et*ct)*dt,y=(T*at+O*ht+X*lt+it*ct)*dt,ot=!0}this.supportPoint(t,-N,-L,-P,x);var pt=x.x,ft=x.y,mt=x.z;this.supportPoint(e,N,L,P,x);var gt=x.x,vt=x.y,yt=x.z,xt=gt-pt,bt=vt-ft,wt=yt-mt,_t=-(xt*N+bt*L+wt*P);if((xt-nt)*N+(bt-st)*L+(wt-rt)*P<=.01||_t>=0)return!!ot&&(i.init(-N,-L,-P),n.init(.5*(p+g),.5*(f+v),.5*(m+y)),r.x=_t,!0);(bt*U-wt*F)*E+(wt*B-xt*U)*C+(xt*F-bt*B)*A<0?(bt*$-wt*q)*E+(wt*Y-xt*$)*C+(xt*q-bt*Y)*A<0?(B=xt,F=bt,U=wt,k=pt,I=ft,D=mt,z=gt,R=vt,O=yt):(nt=xt,st=bt,rt=wt,J=pt,K=ft,Q=mt,tt=gt,et=vt,it=yt):(bt*rt-wt*st)*E+(wt*nt-xt*rt)*C+(xt*st-bt*nt)*A<0?(Y=xt,q=bt,$=wt,V=pt,H=ft,W=mt,j=gt,G=vt,X=yt):(B=xt,F=bt,U=wt,k=pt,I=ft,D=mt,z=gt,R=vt,O=yt)}}},s.CylinderCylinderCollisionDetector.prototype.supportPoint=function(t,e,i,n,r){var o,a,h,l=t.rotation.elements,c=l[0]*e+l[3]*i+l[6]*n,u=l[1]*e+l[4]*i+l[7]*n,d=l[2]*e+l[5]*i+l[8]*n,p=c,f=d,m=p*p+f*f,g=t.radius,v=t.halfHeight;0==m?u<0?(o=g,a=-v,h=0):(o=g,a=v,h=0):(m=t.radius/s.sqrt(m),u<0?(o=p*m,a=-v,h=f*m):(o=p*m,a=v,h=f*m)),c=l[0]*o+l[1]*a+l[2]*h+t.position.x,u=l[3]*o+l[4]*a+l[5]*h+t.position.y,d=l[6]*o+l[7]*a+l[8]*h+t.position.z,r.init(c,u,d)},s.CylinderCylinderCollisionDetector.prototype.detectCollision=function(t,e,i){var n,r;t.id<e.id?(n=t,r=e):(n=e,r=t);var o,a,h,l,c,u,d,p,f,m,g,v,y,x,b,w,_,S,M,T,E,C=n.position,A=r.position,N=C.x,L=C.y,P=C.z,k=A.x,I=A.y,D=A.z,z=n.halfHeight,R=r.halfHeight,O=n.normalDirection,B=r.normalDirection,F=n.halfDirection,U=r.halfDirection,V=n.radius,H=r.radius,W=O.x,j=O.y,G=O.z,X=B.x,Y=B.y,q=B.z,$=F.x,Z=F.y,J=F.z,K=U.x,Q=U.y,tt=U.z,et=N-k,it=L-I,nt=P-D,st=new s.Vec3,rt=new s.Vec3,ot=new s.Vec3;if(this.getSep(n,r,st,rt,ot)){var at=st.x*W+st.y*j+st.z*G,ht=st.x*X+st.y*Y+st.z*q,lt=at>0,ct=ht>0;lt||(at=-at),ct||(ht=-ht);var ut=0;(at>.999||ht>.999)&&(ut=at>ht?1:2);var dt,pt,ft,mt,gt,vt,yt,xt,bt,wt,_t,St,Mt,Tt,Et,Ct,At,Nt,Lt,Pt,kt=ot.x;switch(dt=st.x,pt=st.y,ft=st.z,ut){case 0:i.addPoint(rt.x,rt.y,rt.z,dt,pt,ft,kt,!1);break;case 1:if(lt?(a=N+$,h=L+Z,l=P+J,dt=W,pt=j,ft=G):(a=N-$,h=L-Z,l=P-J,dt=-W,pt=-j,ft=-G),M=dt*X+pt*Y+ft*q,o=M<0?R:-R,c=k+o*X,u=I+o*Y,d=D+o*q,ht>=.999999?(p=-pt,f=ft,m=dt):(p=dt,f=pt,m=ft),o=p*X+f*Y+m*q,et=o*X-p,it=o*Y-f,nt=o*q-m,o=s.sqrt(et*et+it*it+nt*nt),0==o)break;if(o=H/o,et*=o,it*=o,nt*=o,p=c+et,f=u+it,m=d+nt,M<-.96||M>.96)mt=X*X*1.5-.5,gt=X*Y*1.5-.866025403*q,vt=X*q*1.5+.866025403*Y,yt=Y*X*1.5+.866025403*q,xt=Y*Y*1.5-.5,bt=Y*q*1.5-.866025403*X,wt=q*X*1.5-.866025403*Y,_t=q*Y*1.5+.866025403*X,St=q*q*1.5-.5,Mt=p,Tt=f,Et=m,Ct=dt*(Mt-a)+pt*(Tt-h)+ft*(Et-l),p=Mt-Ct*dt-a,f=Tt-Ct*pt-h,m=Et-Ct*ft-l,o=p*p+f*f+m*m,o>V*V&&(o=V/s.sqrt(o),p*=o,f*=o,m*=o),Mt=a+p,Tt=h+f,Et=l+m,i.addPoint(Mt,Tt,Et,dt,pt,ft,Ct,!1),Mt=et*mt+it*gt+nt*vt,Tt=et*yt+it*xt+nt*bt,Et=et*wt+it*_t+nt*St,Mt=(et=Mt)+c,Tt=(it=Tt)+u,Et=(nt=Et)+d,Ct=dt*(Mt-a)+pt*(Tt-h)+ft*(Et-l),Ct<=0&&(p=Mt-Ct*dt-a,f=Tt-Ct*pt-h,m=Et-Ct*ft-l,o=p*p+f*f+m*m,o>V*V&&(o=V/s.sqrt(o),p*=o,f*=o,m*=o),Mt=a+p,Tt=h+f,Et=l+m,i.addPoint(Mt,Tt,Et,dt,pt,ft,Ct,!1)),Mt=et*mt+it*gt+nt*vt,Tt=et*yt+it*xt+nt*bt,Et=et*wt+it*_t+nt*St,Mt=(et=Mt)+c,Tt=(it=Tt)+u,Et=(nt=Et)+d,Ct=dt*(Mt-a)+pt*(Tt-h)+ft*(Et-l),Ct<=0&&(p=Mt-Ct*dt-a,f=Tt-Ct*pt-h,m=Et-Ct*ft-l,o=p*p+f*f+m*m,o>V*V&&(o=V/s.sqrt(o),p*=o,f*=o,m*=o),Mt=a+p,Tt=h+f,Et=l+m,i.addPoint(Mt,Tt,Et,dt,pt,ft,Ct,!1));else{if(g=p,v=f,y=m,_=dt*(g-a)+pt*(v-h)+ft*(y-l),g-=_*dt,v-=_*pt,y-=_*ft,M>0?(x=p+X*R*2,b=f+Y*R*2,w=m+q*R*2):(x=p-X*R*2,b=f-Y*R*2,w=m-q*R*2),S=dt*(x-a)+pt*(b-h)+ft*(w-l),x-=S*dt,b-=S*pt,w-=S*ft,et=a-g,it=h-v,nt=l-y,p=x-g,f=b-v,m=w-y,At=et*et+it*it+nt*nt,Nt=et*p+it*f+nt*m,Lt=p*p+f*f+m*m,Pt=Nt*Nt-Lt*(At-V*V),Pt<0)break;Pt=s.sqrt(Pt),T=(Nt+Pt)/Lt,E=(Nt-Pt)/Lt,E<T&&(o=T,T=E,E=o),E>1&&(E=1),T<0&&(T=0),p=g+(x-g)*T,f=v+(b-v)*T,m=y+(w-y)*T,x=g+(x-g)*E,b=v+(b-v)*E,w=y+(w-y)*E,g=p,v=f,y=m,o=_+(S-_)*T,S=_+(S-_)*E,_=o,_<0&&i.addPoint(g,v,y,dt,pt,ft,Ct,!1),S<0&&i.addPoint(x,b,w,dt,pt,ft,Ct,!1)}break;case 2:if(ct?(c=k-K,u=I-Q,d=D-tt,dt=-X,pt=-Y,ft=-q):(c=k+K,u=I+Q,d=D+tt,dt=X,pt=Y,ft=q),M=dt*W+pt*j+ft*G,o=M<0?z:-z,a=N+o*W,h=L+o*j,l=P+o*G,at>=.999999?(p=-pt,f=ft,m=dt):(p=dt,f=pt,m=ft),o=p*W+f*j+m*G,et=o*W-p,it=o*j-f,nt=o*G-m,o=s.sqrt(et*et+it*it+nt*nt),0==o)break;if(o=V/o,et*=o,it*=o,nt*=o,p=a+et,f=h+it,m=l+nt,M<-.96||M>.96)mt=W*W*1.5-.5,gt=W*j*1.5-.866025403*G,vt=W*G*1.5+.866025403*j,yt=j*W*1.5+.866025403*G,xt=j*j*1.5-.5,bt=j*G*1.5-.866025403*W,wt=G*W*1.5-.866025403*j,_t=G*j*1.5+.866025403*W,St=G*G*1.5-.5,Mt=p,Tt=f,Et=m,Ct=dt*(Mt-c)+pt*(Tt-u)+ft*(Et-d),p=Mt-Ct*dt-c,f=Tt-Ct*pt-u,m=Et-Ct*ft-d,o=p*p+f*f+m*m,o>H*H&&(o=H/s.sqrt(o),p*=o,f*=o,m*=o),Mt=c+p,Tt=u+f,Et=d+m,i.addPoint(Mt,Tt,Et,-dt,-pt,-ft,Ct,!1),Mt=et*mt+it*gt+nt*vt,Tt=et*yt+it*xt+nt*bt,Et=et*wt+it*_t+nt*St,Mt=(et=Mt)+a,Tt=(it=Tt)+h,Et=(nt=Et)+l,Ct=dt*(Mt-c)+pt*(Tt-u)+ft*(Et-d),Ct<=0&&(p=Mt-Ct*dt-c,f=Tt-Ct*pt-u,m=Et-Ct*ft-d,o=p*p+f*f+m*m,o>H*H&&(o=H/s.sqrt(o),p*=o,f*=o,m*=o),Mt=c+p,Tt=u+f,Et=d+m,i.addPoint(Mt,Tt,Et,-dt,-pt,-ft,Ct,!1)),Mt=et*mt+it*gt+nt*vt,Tt=et*yt+it*xt+nt*bt,Et=et*wt+it*_t+nt*St,Mt=(et=Mt)+a,Tt=(it=Tt)+h,Et=(nt=Et)+l,Ct=dt*(Mt-c)+pt*(Tt-u)+ft*(Et-d),Ct<=0&&(p=Mt-Ct*dt-c,f=Tt-Ct*pt-u,m=Et-Ct*ft-d,o=p*p+f*f+m*m,o>H*H&&(o=H/s.sqrt(o),p*=o,f*=o,m*=o),Mt=c+p,Tt=u+f,Et=d+m,i.addPoint(Mt,Tt,Et,-dt,-pt,-ft,Ct,!1));else{if(g=p,v=f,y=m,_=dt*(g-c)+pt*(v-u)+ft*(y-d),g-=_*dt,v-=_*pt,y-=_*ft,M>0?(x=p+W*z*2,b=f+j*z*2,w=m+G*z*2):(x=p-W*z*2,b=f-j*z*2,w=m-G*z*2),S=dt*(x-c)+pt*(b-u)+ft*(w-d),x-=S*dt,b-=S*pt,w-=S*ft,et=c-g,it=u-v,nt=d-y,p=x-g,f=b-v,m=w-y,At=et*et+it*it+nt*nt,Nt=et*p+it*f+nt*m,Lt=p*p+f*f+m*m,Pt=Nt*Nt-Lt*(At-H*H),Pt<0)break;Pt=s.sqrt(Pt),T=(Nt+Pt)/Lt,E=(Nt-Pt)/Lt,E<T&&(o=T,T=E,E=o),E>1&&(E=1),T<0&&(T=0),p=g+(x-g)*T,f=v+(b-v)*T,m=y+(w-y)*T,x=g+(x-g)*E,b=v+(b-v)*E,w=y+(w-y)*E,g=p,v=f,y=m,o=_+(S-_)*T,S=_+(S-_)*E,_=o,_<0&&i.addPoint(g,v,y,-dt,-pt,-ft,_,!1),S<0&&i.addPoint(x,b,w,-dt,-pt,-ft,S,!1)}}}},s.SphereCylinderCollisionDetector=function(t){s.CollisionDetector.call(this),this.flip=t},s.SphereCylinderCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.SphereCylinderCollisionDetector.prototype.constructor=s.SphereCylinderCollisionDetector,s.SphereCylinderCollisionDetector.prototype.detectCollision=function(t,e,i){var n,r;this.flip?(n=e,r=t):(n=t,r=e);var o=n.position,a=o.x,h=o.y,l=o.z,c=r.position,u=c.x,d=c.y,p=c.z,f=r.normalDirection.x,m=r.normalDirection.y,g=r.normalDirection.z,v=n.radius,y=r.radius,x=v+y,b=r.halfHeight,w=a-u,_=h-d,S=l-p,M=w*f+_*m+S*g;if(!(M<-b-v||M>b+v)){var T=u+M*f,E=d+M*m,C=p+M*g,A=a-T,N=h-E,L=l-C,P=A*A+N*N+L*L;if(!(P>x*x)){P>y*y&&(P=y/s.sqrt(P),A*=P,N*=P,L*=P),M<-b?M=-b:M>b&&(M=b),T=u+M*f+A,E=d+M*m+N,C=p+M*g+L,w=T-a,_=E-h,S=C-l,P=w*w+_*_+S*S;var k;P>0&&P<v*v&&(P=s.sqrt(P),k=1/P,w*=k,_*=k,S*=k,i.addPoint(a+w*v,h+_*v,l+S*v,w,_,S,P-v,this.flip))}}},s.TetraTetraCollisionDetector=function(){s.CollisionDetector.call(this)},s.TetraTetraCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.TetraTetraCollisionDetector.prototype.constructor=s.TetraTetraCollisionDetector,s.TetraTetraCollisionDetector.prototype.detectCollision=function(t,n,s){var r,o,a,h,l,c,u=t.faces,d=t.verts,p=(n.faces,n.verts),f=0,m=u;for(r=0;r<4;r++)for(a=d[r],o=0;o<4;o++)h=p[m[r].a],l=p[m[r].b],c=p[m[r].c],e(i(a.x,a.y),i(h.x,h.y),i(l.x,l.y),i(c.x,c.y))&&e(i(a.x,a.z),i(h.x,h.z),i(l.x,l.z),i(c.x,c.z))&&e(i(a.z,a.y),i(h.z,h.y),i(l.z,l.y),i(c.z,c.y))&&f++,4===f&&s.addPoint(a)},s.AABB=function(t,e,i,s,r,o){this.elements=new n(6);var a=this.elements;a[0]=t||0,a[1]=i||0,a[2]=r||0,a[3]=e||0,a[4]=s||0,a[5]=o||0},s.AABB.prototype={constructor:s.AABB,set:function(t,e,i,n,s,r){var o=this.elements;return o[0]=t,o[3]=e,o[1]=i,o[4]=n,o[2]=s,o[5]=r,this},intersectTest:function(t){var e=this.elements,i=t.elements;return e[0]>i[3]||e[1]>i[4]||e[2]>i[5]||e[3]<i[0]||e[4]<i[1]||e[5]<i[2]},intersectTestTwo:function(t){var e=this.elements,i=t.elements;return e[0]<i[0]||e[1]<i[1]||e[2]<i[2]||e[3]>i[3]||e[4]>i[4]||e[5]>i[5]},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t,e){var i=e||0,n=t.elements;return this.set(n[0]-i,n[3]+i,n[1]-i,n[4]+i,n[2]-i,n[5]+i),this},fromArray:function(t){return this.elements.set(t),this},combine:function(t,e){var i=t.elements,n=e.elements,s=this.elements;return s[0]=i[0]<n[0]?i[0]:n[0],s[1]=i[1]<n[1]?i[1]:n[1],s[2]=i[2]<n[2]?i[2]:n[2],s[3]=i[3]>n[3]?i[3]:n[3],s[4]=i[4]>n[4]?i[4]:n[4],s[5]=i[5]>n[5]?i[5]:n[5],this},surfaceArea:function(){var t=this.elements,e=t[3]-t[0],i=t[4]-t[1],n=t[5]-t[2];return 2*(e*(i+n)+i*n)},intersectsWithPoint:function(t,e,i){var n=this.elements;return t>=n[0]&&t<=n[3]&&e>=n[1]&&e<=n[4]&&i>=n[2]&&i<=n[5]},setFromPoints:function(t){this.makeEmpty();for(var e=0;e<t.length;e++)this.expandByPoint(t[e])},makeEmpty:function(){this.set(-(1/0),-(1/0),-(1/0),1/0,1/0,1/0)},expandByPoint:function(t){var e=this.elements;this.set(s.min(e[0],t.x),s.min(e[1],t.y),s.min(e[2],t.z),s.max(e[3],t.x),s.max(e[4],t.y),s.max(e[5],t.z))}},s.Proxy=function(t){this.shape=t,this.aabb=t.aabb},s.Proxy.prototype={constructor:s.Proxy,update:function(){s.Error("Proxy","Inheritance error.")}},s.BasicProxy=function(t){s.Proxy.call(this,t),this.id=s.proxyID++},s.BasicProxy.prototype=Object.create(s.Proxy.prototype),s.BasicProxy.prototype.constructor=s.BasicProxy,s.BasicProxy.prototype.update=function(){},s.BroadPhase=function(){this.types=s.BR_NULL,this.numPairChecks=0,this.numPairs=0,this.pairs=[]},s.BroadPhase.prototype={constructor:s.BroadPhase,createProxy:function(t){s.Error("BroadPhase","Inheritance error.")},addProxy:function(t){s.Error("BroadPhase","Inheritance error.")},removeProxy:function(t){s.Error("BroadPhase","Inheritance error.")},isAvailablePair:function(t,e){var i=t.parent,n=e.parent;if(i==n||!i.isDynamic&&!n.isDynamic||0==(t.belongsTo&e.collidesWith)||0==(e.belongsTo&t.collidesWith))return!1;var s;for(s=i.numJoints<n.numJoints?i.jointLink:n.jointLink;null!==s;){var r=s.joint;if(!r.allowCollision&&(r.body1==i&&r.body2==n||r.body1==n&&r.body2==i))return!1;s=s.next}return!0},detectPairs:function(){this.pairs=[],this.numPairs=0,this.numPairChecks=0,this.collectPairs()},collectPairs:function(){s.Error("BroadPhase","Inheritance error.")},addPair:function(t,e){var i=new s.Pair(t,e);this.pairs.push(i),this.numPairs++}},s.BruteForceBroadPhase=function(){s.BroadPhase.call(this),this.types=s.BR_BRUTE_FORCE,this.proxies=[]},s.BruteForceBroadPhase.prototype=Object.create(s.BroadPhase.prototype),s.BruteForceBroadPhase.prototype.constructor=s.BruteForceBroadPhase,s.BruteForceBroadPhase.prototype.createProxy=function(t){return new s.BasicProxy(t)},s.BruteForceBroadPhase.prototype.addProxy=function(t){this.proxies.push(t)},s.BruteForceBroadPhase.prototype.removeProxy=function(t){var e=this.proxies.indexOf(t);e>-1&&this.proxies.splice(e,1)},s.BruteForceBroadPhase.prototype.collectPairs=function(){var t,e,i,n=0,s=this.proxies,r=s.length;for(this.numPairChecks=r*(r-1)>>1;n<r;)for(e=s[n++],t=n+1;t<r;)i=s[t++],!e.aabb.intersectTest(i.aabb)&&this.isAvailablePair(e.shape,i.shape)&&this.addPair(e.shape,i.shape)},s.Pair=function(t,e){this.shape1=t||null,this.shape2=e||null},s.SAPAxis=function(){this.numElements=0,this.bufferSize=256,this.elements=[],this.elements.length=this.bufferSize,this.stack=new n(64)},s.SAPAxis.prototype={constructor:s.SAPAxis,addElements:function(t,e){if(this.numElements+2>=this.bufferSize){this.bufferSize*=2;for(var i=[],n=this.numElements;n--;)i[n]=this.elements[n]}this.elements[this.numElements++]=t,this.elements[this.numElements++]=e},removeElements:function(t,e){for(var i=-1,n=-1,s=0,r=this.numElements;s<r;s++){var o=this.elements[s];if(o==t||o==e){if(i!=-1){n=s;break}i=s}}for(s=i+1,r=n;s<r;s++)this.elements[s-1]=this.elements[s];for(s=n+1,r=this.numElements;s<r;s++)this.elements[s-2]=this.elements[s];this.elements[--this.numElements]=null,this.elements[--this.numElements]=null},sort:function(){for(var t=0,e=1;this.numElements>>e!=0;)e++;e=e*this.numElements>>2,t=0;for(var i=!1,n=this.elements,r=1,o=this.numElements;r<o;r++){var a=n[r],h=a.value,l=n[r-1];if(l.value>h){var c=r;do{if(n[c]=l,0==--c)break;l=n[c-1]}while(l.value>h);if(n[c]=a,t+=r-c,t>e){i=!0;break}}}if(i){t=2;var u=this.stack;for(u[0]=0,u[1]=this.numElements-1;t>0;){var d=u[--t],p=u[--t],f=d-p;if(f>16){var m=p+s.floor(.5*f);for(a=n[m],n[m]=n[d],n[d]=a,h=a.value,r=p-1,c=d;;){var g,v;do g=n[++r];while(g.value<h);do v=n[--c];while(h<v.value&&c!=p);if(r>=c)break;n[r]=v,n[c]=g}n[d]=n[r],n[r]=a,r-p>d-r?(u[t++]=p,u[t++]=r-1,u[t++]=r+1,u[t++]=d):(u[t++]=r+1,u[t++]=d,u[t++]=p,u[t++]=r-1)}else for(r=p+1;r<=d;r++)if(a=n[r],h=a.value,l=n[r-1],l.value>h){c=r;do{if(n[c]=l,0==--c)break;l=n[c-1]}while(l.value>h);n[c]=a}}}},calculateTestCount:function(){for(var t=1,e=0,i=1,n=this.numElements;i<n;i++)this.elements[i].max?t--:(e+=t,t++);return e}},s.SAPBroadPhase=function(){s.BroadPhase.call(this),this.types=s.BR_SWEEP_AND_PRUNE,this.numElementsD=0,this.numElementsS=0,this.axesD=[new s.SAPAxis,new s.SAPAxis,new s.SAPAxis],this.axesS=[new s.SAPAxis,new s.SAPAxis,new s.SAPAxis],this.index1=0,this.index2=1},s.SAPBroadPhase.prototype=Object.create(s.BroadPhase.prototype),s.SAPBroadPhase.prototype.constructor=s.SAPBroadPhase,s.SAPBroadPhase.prototype.createProxy=function(t){return new s.SAPProxy(this,t)},s.SAPBroadPhase.prototype.addProxy=function(t){var e=t;e.isDynamic()?(this.axesD[0].addElements(e.min[0],e.max[0]),this.axesD[1].addElements(e.min[1],e.max[1]),this.axesD[2].addElements(e.min[2],e.max[2]),e.belongsTo=1,this.numElementsD+=2):(this.axesS[0].addElements(e.min[0],e.max[0]),this.axesS[1].addElements(e.min[1],e.max[1]),this.axesS[2].addElements(e.min[2],e.max[2]),e.belongsTo=2,this.numElementsS+=2)},s.SAPBroadPhase.prototype.removeProxy=function(t){var e=t;if(0!=e.belongsTo){switch(e.belongsTo){case 1:this.axesD[0].removeElements(e.min[0],e.max[0]),this.axesD[1].removeElements(e.min[1],e.max[1]),this.axesD[2].removeElements(e.min[2],e.max[2]),this.numElementsD-=2;break;case 2:this.axesS[0].removeElements(e.min[0],e.max[0]),this.axesS[1].removeElements(e.min[1],e.max[1]),this.axesS[2].removeElements(e.min[2],e.max[2]),this.numElementsS-=2}e.belongsTo=0}},s.SAPBroadPhase.prototype.collectPairs=function(){if(0!=this.numElementsD){var t=this.axesD[this.index1],e=this.axesD[this.index2];t.sort(),e.sort();var i,n,s=t.calculateTestCount(),r=e.calculateTestCount();s<=r?(e=this.axesS[this.index1],e.sort(),i=t.elements,n=e.elements):(t=this.axesS[this.index2],t.sort(),i=e.elements,n=t.elements,this.index1^=this.index2,this.index2^=this.index1,this.index1^=this.index2);for(var o,a,h=0,l=0;h<this.numElementsD;){var c,u;if(l==this.numElementsS)c=i[h],u=!0,h++;else{var d=i[h],p=n[l];d.value<p.value?(c=d,u=!0,h++):(c=p,u=!1,l++)}if(c.max){var f=c.pair;if(u){if(f==o){o=o.pair;continue}c=o}else{if(f==a){a=a.pair;continue}c=a}do{if(b=c.pair,b==f){c.pair=b.pair;break}c=b}while(null!=c)}else{for(var m=c.proxy.shape,g=c.min1.value,v=c.max1.value,y=c.min2.value,x=c.max2.value,b=o;null!=b;b=b.pair){var w=b.proxy.shape;this.numPairChecks++,g>b.max1.value||v<b.min1.value||y>b.max2.value||x<b.min2.value||!this.isAvailablePair(m,w)||this.addPair(m,w)}if(u){for(b=a;null!=b;b=b.pair)w=b.proxy.shape,this.numPairChecks++,g>b.max1.value||v<b.min1.value||y>b.max2.value||x<b.min2.value||!this.isAvailablePair(m,w)||this.addPair(m,w);c.pair=o,o=c}else c.pair=a,a=c}}this.index2=3^(this.index1|this.index2)}},s.SAPElement=function(t,e){this.proxy=t,this.pair=null,this.min1=null,this.max1=null,this.min2=null,this.max2=null,this.max=e,this.value=0},s.SAPProxy=function(t,e){s.Proxy.call(this,e),this.belongsTo=0,this.max=[],this.min=[],this.sap=t,this.min[0]=new s.SAPElement(this,!1),this.max[0]=new s.SAPElement(this,!0),this.min[1]=new s.SAPElement(this,!1),this.max[1]=new s.SAPElement(this,!0),this.min[2]=new s.SAPElement(this,!1),this.max[2]=new s.SAPElement(this,!0),this.max[0].pair=this.min[0],this.max[1].pair=this.min[1],this.max[2].pair=this.min[2],this.min[0].min1=this.min[1],this.min[0].max1=this.max[1],this.min[0].min2=this.min[2],this.min[0].max2=this.max[2],this.min[1].min1=this.min[0],this.min[1].max1=this.max[0],this.min[1].min2=this.min[2],this.min[1].max2=this.max[2],this.min[2].min1=this.min[0],this.min[2].max1=this.max[0],this.min[2].min2=this.min[1],this.min[2].max2=this.max[1]},s.SAPProxy.prototype=Object.create(s.Proxy.prototype),s.SAPProxy.prototype.constructor=s.SAPProxy,s.SAPProxy.prototype.isDynamic=function(){var t=this.shape.parent;return t.isDynamic&&!t.sleeping},s.SAPProxy.prototype.update=function(){var t=this.aabb.elements;this.min[0].value=t[0],this.min[1].value=t[1],this.min[2].value=t[2],this.max[0].value=t[3],this.max[1].value=t[4],this.max[2].value=t[5],(1==this.belongsTo&&!this.isDynamic()||2==this.belongsTo&&this.isDynamic())&&(this.sap.removeProxy(this),this.sap.addProxy(this))},s.DBVT=function(){this.root=null,this.freeNodes=[],this.freeNodes.length=16384,this.numFreeNodes=0,this.aabb=new s.AABB},s.DBVT.prototype={constructor:s.DBVT,moveLeaf:function(t){this.deleteLeaf(t),this.insertLeaf(t)},insertLeaf:function(t){if(null==this.root)return void(this.root=t);for(var e,i,n=t.aabb,r=this.root;null==r.proxy;){var o=r.child1,a=r.child2,h=r.aabb,l=o.aabb,c=a.aabb;e=h.surfaceArea(),this.aabb.combine(n,h),i=this.aabb.surfaceArea();var u=2*i,d=2*(i-e),p=d;this.aabb.combine(n,l),p+=null!=o.proxy?this.aabb.surfaceArea():this.aabb.surfaceArea()-l.surfaceArea();var f=d;if(this.aabb.combine(n,c),f+=null!=a.proxy?this.aabb.surfaceArea():this.aabb.surfaceArea()-c.surfaceArea(),p<f){if(u<p)break;r=o}else{if(u<f)break;r=a}}var m,g=r.parent;m=this.numFreeNodes>0?this.freeNodes[--this.numFreeNodes]:new s.DBVTNode,m.parent=g,m.child1=t,m.child2=r,m.aabb.combine(t.aabb,r.aabb),m.height=r.height+1,r.parent=m,t.parent=m,r==this.root?this.root=m:g.child1==r?g.child1=m:g.child2=m;do m=this.balance(m),this.fix(m),m=m.parent;while(null!=m)},getBalance:function(t){return null!=t.proxy?0:t.child1.height-t.child2.height},deleteLeaf:function(t){if(t==this.root)return void(this.root=null);
var e,i=t.parent;if(e=i.child1==t?i.child2:i.child1,i==this.root)return this.root=e,void(e.parent=null);var n=i.parent;e.parent=n,n.child1==i?n.child1=e:n.child2=e,this.numFreeNodes<16384&&(this.freeNodes[this.numFreeNodes++]=i);do n=this.balance(n),this.fix(n),n=n.parent;while(null!=n)},balance:function(t){var e=t.height;if(e<2)return t;var i,n=t.parent,s=t.child1,r=t.child2,o=s.height,a=r.height,h=o-a;if(h>1){var l=s.child1,c=s.child2,u=l.height,d=c.height;return u>d?(s.child2=t,t.parent=s,t.child1=c,c.parent=t,t.aabb.combine(c.aabb,r.aabb),i=d-a,t.height=d-(i&i>>31)+1,s.aabb.combine(l.aabb,t.aabb),i=u-e,s.height=u-(i&i>>31)+1):(s.child1=t,t.parent=s,t.child1=l,l.parent=t,t.aabb.combine(l.aabb,r.aabb),i=u-a,t.height=u-(i&i>>31)+1,s.aabb.combine(t.aabb,c.aabb),i=e-d,s.height=e-(i&i>>31)+1),null!=n?n.child1==t?n.child1=s:n.child2=s:this.root=s,s.parent=n,s}if(h<-1){var p=r.child1,f=r.child2,m=p.height,g=f.height;return m>g?(r.child2=t,t.parent=r,t.child2=f,f.parent=t,t.aabb.combine(s.aabb,f.aabb),i=o-g,t.height=o-(i&i>>31)+1,r.aabb.combine(p.aabb,t.aabb),i=m-e,r.height=m-(i&i>>31)+1):(r.child1=t,t.parent=r,t.child2=p,p.parent=t,t.aabb.combine(s.aabb,p.aabb),i=o-m,t.height=o-(i&i>>31)+1,r.aabb.combine(t.aabb,f.aabb),i=e-g,r.height=e-(i&i>>31)+1),null!=n?n.child1==t?n.child1=r:n.child2=r:this.root=r,r.parent=n,r}return t},fix:function(t){var e=t.child1,i=t.child2;t.aabb.combine(e.aabb,i.aabb),t.height=e.height<i.height?i.height+1:e.height+1}},s.DBVTBroadPhase=function(){s.BroadPhase.call(this),this.types=s.BR_BOUNDING_VOLUME_TREE,this.tree=new s.DBVT,this.stack=[],this.leaves=[],this.numLeaves=0},s.DBVTBroadPhase.prototype=Object.create(s.BroadPhase.prototype),s.DBVTBroadPhase.prototype.constructor=s.DBVTBroadPhase,s.DBVTBroadPhase.prototype.createProxy=function(t){return new s.DBVTProxy(t)},s.DBVTBroadPhase.prototype.addProxy=function(t){this.tree.insertLeaf(t.leaf),this.leaves.push(t.leaf),this.numLeaves++},s.DBVTBroadPhase.prototype.removeProxy=function(t){this.tree.deleteLeaf(t.leaf);var e=this.leaves.indexOf(t.leaf);e>-1&&(this.leaves.splice(e,1),this.numLeaves--)},s.DBVTBroadPhase.prototype.collectPairs=function(){if(!(this.numLeaves<2))for(var t,e=.1,i=this.numLeaves;i--;)t=this.leaves[i],t.proxy.aabb.intersectTestTwo(t.aabb)&&(t.aabb.copy(t.proxy.aabb,e),this.tree.deleteLeaf(t),this.tree.insertLeaf(t),this.collide(t,this.tree.root))},s.DBVTBroadPhase.prototype.collide=function(t,e){var i,n,s,r,o,a,h=2;for(this.stack[0]=t,this.stack[1]=e;h>0;)if(s=this.stack[--h],r=this.stack[--h],o=null!=s.proxy,a=null!=r.proxy,this.numPairChecks++,o&&a){if(i=s.proxy.shape,n=r.proxy.shape,i==n||i.aabb.intersectTest(n.aabb)||!this.isAvailablePair(i,n))continue;this.addPair(i,n)}else{if(s.aabb.intersectTest(r.aabb))continue;a||!o&&s.aabb.surfaceArea()>r.aabb.surfaceArea()?(this.stack[h++]=s.child1,this.stack[h++]=r,this.stack[h++]=s.child2,this.stack[h++]=r):(this.stack[h++]=s,this.stack[h++]=r.child1,this.stack[h++]=s,this.stack[h++]=r.child2)}},s.DBVTNode=function(){this.child1=null,this.child2=null,this.parent=null,this.proxy=null,this.height=0,this.aabb=new s.AABB},s.DBVTProxy=function(t){s.Proxy.call(this,t),this.leaf=new s.DBVTNode,this.leaf.proxy=this},s.DBVTProxy.prototype=Object.create(s.Proxy.prototype),s.DBVTProxy.prototype.constructor=s.DBVTProxy,s.DBVTProxy.prototype.update=function(){},s.World.prototype.add=function(t){t=t||{};var e=t.type||"box";if("string"==typeof e&&(e=[e]),"joint"==e[0].substring(0,5)){"joint"===e[0]&&(e[0]="jointHinge");var i=t.axe1||[1,0,0],n=t.axe2||[1,0,0],r=t.pos1||[0,0,0],o=t.pos2||[0,0,0];r=r.map(function(t){return t*s.INV_SCALE}),o=o.map(function(t){return t*s.INV_SCALE});var a,h;"jointDistance"===e[0]?(a=t.min||0,h=t.max||10,a*=s.INV_SCALE,h*=s.INV_SCALE):(a=t.min||57.29578,h=t.max||0,a*=s.degtorad,h*=s.degtorad);var l=t.limit||null,c=t.spring||null,u=t.motor||null,d=new s.JointConfig;d.allowCollision=t.collision||!1,d.localAxis1.init(i[0],i[1],i[2]),d.localAxis2.init(n[0],n[1],n[2]),d.localAnchorPoint1.init(r[0],r[1],r[2]),d.localAnchorPoint2.init(o[0],o[1],o[2]),("string"==typeof t.body1||t.body1 instanceof String)&&(t.body1=this.getByName(t.body1)),("string"==typeof t.body2||t.body2 instanceof String)&&(t.body2=this.getByName(t.body2)),d.body1=t.body1,d.body2=t.body2;var p;switch(e[0]){case"jointDistance":p=new s.DistanceJoint(d,a,h),null!==c&&p.limitMotor.setSpring(c[0],c[1]),null!==u&&p.limitMotor.setSpring(u[0],u[1]);break;case"jointHinge":p=new s.HingeJoint(d,a,h),null!==c&&p.limitMotor.setSpring(c[0],c[1]),null!==u&&p.limitMotor.setSpring(u[0],u[1]);break;case"jointPrisme":p=new s.PrismaticJoint(d,a,h);break;case"jointSlide":p=new s.SliderJoint(d,a,h);break;case"jointBall":p=new s.BallAndSocketJoint(d);break;case"jointWheel":p=new s.WheelJoint(d),null!==l&&p.rotationalLimitMotor1.setLimit(l[0],l[1]),null!==c&&p.rotationalLimitMotor1.setSpring(c[0],c[1]),null!==u&&p.rotationalLimitMotor1.setSpring(u[0],u[1])}return p.name=t.name||"",this.addJoint(p),p}var f=t.move||!1,m=t.noSleep||!1,g=t.pos||[0,0,0];g=g.map(function(t){return t*s.INV_SCALE});var v=t.size||[1,1,1];v=v.map(function(t){return t*s.INV_SCALE});var y=t.rot||[0,0,0];y=y.map(function(t){return t*s.degtorad});for(var x=[],b=0;b<y.length/3;b++){var w=s.EulerToAxis(y[b+0],y[b+1],y[b+2]);x.push(w[0]),x.push(w[1]),x.push(w[2]),x.push(w[3])}var _=new s.ShapeConfig;void 0!==t.sc&&(_=t.sc),t.config&&(_.density=void 0===t.config[0]?1:t.config[0],_.friction=void 0===t.config[1]?.4:t.config[1],_.restitution=void 0===t.config[2]?.2:t.config[2],_.belongsTo=t.config[3]||1,_.collidesWith=t.config[4]||4294967295),void 0!==t.density&&(_.density=t.density),void 0!==t.friction&&(_.friction=t.friction),void 0!==t.restitution&&(_.restitution=t.restitution),void 0!==t.belongsTo&&(_.belongsTo=t.belongsTo),void 0!==t.collidesWith&&(_.collidesWith=t.collidesWith),t.massPos&&(t.massPos=t.massPos.map(function(t){return t*s.INV_SCALE}),_.relativePosition.init(t.massPos[0],t.massPos[1],t.massPos[2])),t.massRot&&(t.massRot=t.massRot.map(function(t){return t*s.degtorad}),_.relativeRotation=s.EulerToMatrix(t.massRot[0],t.massRot[1],t.massRot[2]));for(var S,M,T=new s.RigidBody(g[0],g[1],g[2],x[0],x[1],x[2],x[3]),E=[],b=0;b<e.length;b++){switch(S=3*b,M=4*b,e[b]){case"sphere":E[b]=new s.SphereShape(_,v[S]);break;case"cylinder":E[b]=new s.CylinderShape(_,v[S],v[S+1]);break;case"box":E[b]=new s.BoxShape(_,v[S],v[S+1],v[S+2])}T.addShape(E[b]),b>0&&(E[b].relativePosition=new s.Vec3(g[S],g[S+1],g[S+2]),x[M+0]&&(E[b].relativeRotation=[x[M],x[M+1],x[M+2],x[M+3]]))}return f?(t.massPos||t.massRot?T.setupMass(1,!1):T.setupMass(1,!0),m?T.allowSleep=!1:T.allowSleep=!0):T.setupMass(2),T.name=t.name||" ",this.addRigidBody(T),T},s}),!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define("game/three",["exports"],e):e(t.THREE=t.THREE||{})}(this,function(t){"use strict";function e(){}function i(t,e){this.x=t||0,this.y=e||0}function n(e,r,o,a,h,l,c,u,d,p){Object.defineProperty(this,"id",{value:s()}),this.uuid=t.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==e?e:n.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==r?r:n.DEFAULT_MAPPING,this.wrapS=void 0!==o?o:As,this.wrapT=void 0!==a?a:As,this.magFilter=void 0!==h?h:Is,this.minFilter=void 0!==l?l:zs,this.anisotropy=void 0!==d?d:1,this.format=void 0!==c?c:Zs,this.type=void 0!==u?u:Rs,this.offset=new i(0,0),this.repeat=new i(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==p?p:Sr,this.version=0,this.onUpdate=null}function s(){return Ir++}function r(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function o(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}function a(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function h(t,e){function i(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),e=new Uint16Array([0,1,2,0,2,3]);h=f.createBuffer(),l=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,h),f.bufferData(f.ARRAY_BUFFER,t,f.STATIC_DRAW),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),f.bufferData(f.ELEMENT_ARRAY_BUFFER,e,f.STATIC_DRAW),c=s(),u={position:f.getAttribLocation(c,"position"),uv:f.getAttribLocation(c,"uv")},d={uvOffset:f.getUniformLocation(c,"uvOffset"),uvScale:f.getUniformLocation(c,"uvScale"),rotation:f.getUniformLocation(c,"rotation"),scale:f.getUniformLocation(c,"scale"),color:f.getUniformLocation(c,"color"),map:f.getUniformLocation(c,"map"),opacity:f.getUniformLocation(c,"opacity"),modelViewMatrix:f.getUniformLocation(c,"modelViewMatrix"),projectionMatrix:f.getUniformLocation(c,"projectionMatrix"),fogType:f.getUniformLocation(c,"fogType"),fogDensity:f.getUniformLocation(c,"fogDensity"),fogNear:f.getUniformLocation(c,"fogNear"),fogFar:f.getUniformLocation(c,"fogFar"),fogColor:f.getUniformLocation(c,"fogColor"),alphaTest:f.getUniformLocation(c,"alphaTest")};var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=8,i.height=8;var r=i.getContext("2d");r.fillStyle="white",r.fillRect(0,0,8,8),p=new n(i),p.needsUpdate=!0}function s(){var e=f.createProgram(),i=f.createShader(f.VERTEX_SHADER),n=f.createShader(f.FRAGMENT_SHADER);return f.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),f.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),f.compileShader(i),f.compileShader(n),f.attachShader(e,i),f.attachShader(e,n),f.linkProgram(e),e}function r(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var h,l,c,u,d,p,f=t.context,m=t.state,g=new a,v=new o,y=new a;this.render=function(n,s){if(0!==e.length){void 0===c&&i(),f.useProgram(c),m.initAttributes(),m.enableAttribute(u.position),m.enableAttribute(u.uv),m.disableUnusedAttributes(),m.disable(f.CULL_FACE),m.enable(f.BLEND),f.bindBuffer(f.ARRAY_BUFFER,h),f.vertexAttribPointer(u.position,2,f.FLOAT,!1,16,0),f.vertexAttribPointer(u.uv,2,f.FLOAT,!1,16,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),f.uniformMatrix4fv(d.projectionMatrix,!1,s.projectionMatrix.elements),m.activeTexture(f.TEXTURE0),f.uniform1i(d.map,0);var o=0,a=0,x=n.fog;x?(f.uniform3f(d.fogColor,x.color.r,x.color.g,x.color.b),x&&x.isFog?(f.uniform1f(d.fogNear,x.near),f.uniform1f(d.fogFar,x.far),f.uniform1i(d.fogType,1),o=1,a=1):x&&x.isFogExp2&&(f.uniform1f(d.fogDensity,x.density),f.uniform1i(d.fogType,2),o=2,a=2)):(f.uniform1i(d.fogType,0),o=0,a=0);for(var b=0,w=e.length;b<w;b++){var _=e[b];_.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,_.matrixWorld),_.z=-_.modelViewMatrix.elements[14]}e.sort(r);for(var S=[],b=0,w=e.length;b<w;b++){var _=e[b],M=_.material;if(M.visible!==!1){f.uniform1f(d.alphaTest,M.alphaTest),f.uniformMatrix4fv(d.modelViewMatrix,!1,_.modelViewMatrix.elements),_.matrixWorld.decompose(g,v,y),S[0]=y.x,S[1]=y.y;var T=0;n.fog&&M.fog&&(T=a),o!==T&&(f.uniform1i(d.fogType,T),o=T),null!==M.map?(f.uniform2f(d.uvOffset,M.map.offset.x,M.map.offset.y),f.uniform2f(d.uvScale,M.map.repeat.x,M.map.repeat.y)):(f.uniform2f(d.uvOffset,0,0),f.uniform2f(d.uvScale,1,1)),f.uniform1f(d.opacity,M.opacity),f.uniform3f(d.color,M.color.r,M.color.g,M.color.b),f.uniform1f(d.rotation,M.rotation),f.uniform2fv(d.scale,S),m.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst),m.setDepthTest(M.depthTest),m.setDepthWrite(M.depthWrite),M.map?t.setTexture2D(M.map,0):t.setTexture2D(p,0),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0)}}m.enable(f.CULL_FACE),t.resetGLState()}}}function l(t,e){this.min=void 0!==t?t:new i(+(1/0),+(1/0)),this.max=void 0!==e?e:new i(-(1/0),-(1/0))}function c(t,e){function n(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),e=new Uint16Array([0,1,2,0,2,3]);r=m.createBuffer(),o=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,r),m.bufferData(m.ARRAY_BUFFER,t,m.STATIC_DRAW),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,o),m.bufferData(m.ELEMENT_ARRAY_BUFFER,e,m.STATIC_DRAW),p=m.createTexture(),f=m.createTexture(),g.bindTexture(m.TEXTURE_2D,p),m.texImage2D(m.TEXTURE_2D,0,m.RGB,16,16,0,m.RGB,m.UNSIGNED_BYTE,null),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),g.bindTexture(m.TEXTURE_2D,f),m.texImage2D(m.TEXTURE_2D,0,m.RGBA,16,16,0,m.RGBA,m.UNSIGNED_BYTE,null),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),h={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},c=s(h),u={vertex:m.getAttribLocation(c,"position"),uv:m.getAttribLocation(c,"uv")},d={renderType:m.getUniformLocation(c,"renderType"),map:m.getUniformLocation(c,"map"),occlusionMap:m.getUniformLocation(c,"occlusionMap"),opacity:m.getUniformLocation(c,"opacity"),color:m.getUniformLocation(c,"color"),scale:m.getUniformLocation(c,"scale"),rotation:m.getUniformLocation(c,"rotation"),screenPosition:m.getUniformLocation(c,"screenPosition")}}function s(e){var i=m.createProgram(),n=m.createShader(m.FRAGMENT_SHADER),s=m.createShader(m.VERTEX_SHADER),r="precision "+t.getPrecision()+" float;\n";return m.shaderSource(n,r+e.fragmentShader),m.shaderSource(s,r+e.vertexShader),m.compileShader(n),m.compileShader(s),m.attachShader(i,n),m.attachShader(i,s),m.linkProgram(i),i}var r,o,h,c,u,d,p,f,m=t.context,g=t.state;this.render=function(s,h,v){if(0!==e.length){var y=new a,x=v.w/v.z,b=.5*v.z,w=.5*v.w,_=16/v.w,S=new i(_*x,_),M=new a(1,1,0),T=new i(1,1),E=new l;E.min.set(0,0),E.max.set(v.z-16,v.w-16),void 0===c&&n(),m.useProgram(c),g.initAttributes(),g.enableAttribute(u.vertex),g.enableAttribute(u.uv),g.disableUnusedAttributes(),m.uniform1i(d.occlusionMap,0),m.uniform1i(d.map,1),m.bindBuffer(m.ARRAY_BUFFER,r),m.vertexAttribPointer(u.vertex,2,m.FLOAT,!1,16,0),m.vertexAttribPointer(u.uv,2,m.FLOAT,!1,16,8),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,o),g.disable(m.CULL_FACE),g.setDepthWrite(!1);for(var C=0,A=e.length;C<A;C++){_=16/v.w,S.set(_*x,_);var N=e[C];if(y.set(N.matrixWorld.elements[12],N.matrixWorld.elements[13],N.matrixWorld.elements[14]),y.applyMatrix4(h.matrixWorldInverse),y.applyProjection(h.projectionMatrix),M.copy(y),T.x=v.x+M.x*b+b-8,T.y=v.y+M.y*w+w-8,E.containsPoint(T)===!0){g.activeTexture(m.TEXTURE0),g.bindTexture(m.TEXTURE_2D,null),g.activeTexture(m.TEXTURE1),g.bindTexture(m.TEXTURE_2D,p),m.copyTexImage2D(m.TEXTURE_2D,0,m.RGB,T.x,T.y,16,16,0),m.uniform1i(d.renderType,0),m.uniform2f(d.scale,S.x,S.y),m.uniform3f(d.screenPosition,M.x,M.y,M.z),g.disable(m.BLEND),g.enable(m.DEPTH_TEST),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0),g.activeTexture(m.TEXTURE0),g.bindTexture(m.TEXTURE_2D,f),m.copyTexImage2D(m.TEXTURE_2D,0,m.RGBA,T.x,T.y,16,16,0),m.uniform1i(d.renderType,1),g.disable(m.DEPTH_TEST),g.activeTexture(m.TEXTURE1),g.bindTexture(m.TEXTURE_2D,p),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0),N.positionScreen.copy(M),N.customUpdateCallback?N.customUpdateCallback(N):N.updateLensFlares(),m.uniform1i(d.renderType,2),g.enable(m.BLEND);for(var L=0,P=N.lensFlares.length;L<P;L++){var k=N.lensFlares[L];k.opacity>.001&&k.scale>.001&&(M.x=k.x,M.y=k.y,M.z=k.z,_=k.size*k.scale/v.w,S.x=_*x,S.y=_,m.uniform3f(d.screenPosition,M.x,M.y,M.z),m.uniform2f(d.scale,S.x,S.y),m.uniform1f(d.rotation,k.rotation),m.uniform1f(d.opacity,k.opacity),m.uniform3f(d.color,k.color.r,k.color.g,k.color.b),g.setBlending(k.blending,k.blendEquation,k.blendSrc,k.blendDst),t.setTexture2D(k.texture,1),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0))}}}g.enable(m.CULL_FACE),g.enable(m.DEPTH_TEST),g.setDepthWrite(!0),t.resetGLState()}}}function u(t,e,i,s,r,o,a,h,l,c){t=void 0!==t?t:[],e=void 0!==e?e:bs,n.call(this,t,e,i,s,r,o,a,h,l,c),this.flipY=!1}function d(e,i,n,s,r,o,a){function h(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=Math.floor(t.width*i),n.height=Math.floor(t.height*i);var s=n.getContext("2d");return s.drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height,t),n}return t}function l(e){return t.Math.isPowerOfTwo(e.width)&&t.Math.isPowerOfTwo(e.height)}function c(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=t.Math.nearestPowerOfTwo(e.width),i.height=t.Math.nearestPowerOfTwo(e.height);var n=i.getContext("2d");return n.drawImage(e,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+i.width+"x"+i.height,e),i}return e}function u(t){return t.wrapS!==As||t.wrapT!==As||t.minFilter!==Ls&&t.minFilter!==Is}function d(t){return t===Ls||t===Ps||t===ks?e.NEAREST:e.LINEAR}function p(t){var e=t.target;e.removeEventListener("dispose",p),m(e),A.textures--}function f(t){var e=t.target;e.removeEventListener("dispose",f),g(e),A.textures--}function m(t){var i=s.get(t);if(t.image&&i.__image__webglTextureCube)e.deleteTexture(i.__image__webglTextureCube);else{if(void 0===i.__webglInit)return;e.deleteTexture(i.__webglTexture)}s.delete(t)}function g(t){var i=s.get(t),n=s.get(t.texture);if(t){if(void 0!==n.__webglTexture&&e.deleteTexture(n.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t&&t.isWebGLRenderTargetCube)for(var r=0;r<6;r++)e.deleteFramebuffer(i.__webglFramebuffer[r]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[r]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer);s.delete(t.texture),s.delete(t)}}function v(t,i){var r=s.get(t);if(t.version>0&&r.__version!==t.version){var o=t.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(o.complete!==!1)return void w(r,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}}n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_2D,r.__webglTexture)}function y(t,i){var a=s.get(t);if(6===t.image.length)if(t.version>0&&a.__version!==t.version){a.__image__webglTextureCube||(t.addEventListener("dispose",p),a.__image__webglTextureCube=e.createTexture(),A.textures++),n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,a.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var c=t&&t.isCompressedTexture,u=t.image[0]&&t.image[0].isDataTexture,d=[],f=0;f<6;f++)c||u?d[f]=u?t.image[f].image:t.image[f]:d[f]=h(t.image[f],r.maxCubemapSize);var m=d[0],g=l(m),v=o(t.format),y=o(t.type);b(e.TEXTURE_CUBE_MAP,t,g);for(var f=0;f<6;f++)if(c)for(var x,w=d[f].mipmaps,_=0,S=w.length;_<S;_++)x=w[_],t.format!==Zs&&t.format!==$s?n.getCompressedTextureFormats().indexOf(v)>-1?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,_,v,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,_,v,x.width,x.height,0,v,y,x.data);else u?n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,v,d[f].width,d[f].height,0,v,y,d[f].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,v,v,y,d[f]);t.generateMipmaps&&g&&e.generateMipmap(e.TEXTURE_CUBE_MAP),a.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,a.__image__webglTextureCube)}function x(t,i){n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,s.get(t).__webglTexture)}function b(t,n,a){var h;if(a?(e.texParameteri(t,e.TEXTURE_WRAP_S,o(n.wrapS)),e.texParameteri(t,e.TEXTURE_WRAP_T,o(n.wrapT)),e.texParameteri(t,e.TEXTURE_MAG_FILTER,o(n.magFilter)),e.texParameteri(t,e.TEXTURE_MIN_FILTER,o(n.minFilter))):(e.texParameteri(t,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(t,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n.wrapS===As&&n.wrapT===As||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",n),e.texParameteri(t,e.TEXTURE_MAG_FILTER,d(n.magFilter)),e.texParameteri(t,e.TEXTURE_MIN_FILTER,d(n.minFilter)),n.minFilter!==Ls&&n.minFilter!==Is&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",n)),h=i.get("EXT_texture_filter_anisotropic")){if(n.type===Hs&&null===i.get("OES_texture_float_linear"))return;if(n.type===Ws&&null===i.get("OES_texture_half_float_linear"))return;(n.anisotropy>1||s.get(n).__currentAnisotropy)&&(e.texParameterf(t,h.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n.anisotropy,r.getMaxAnisotropy())),s.get(n).__currentAnisotropy=n.anisotropy)}}function w(t,i,s){void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",p),t.__webglTexture=e.createTexture(),A.textures++),n.activeTexture(e.TEXTURE0+s),n.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment);var a=h(i.image,r.maxTextureSize);u(i)&&l(a)===!1&&(a=c(a));var d=l(a),f=o(i.format),m=o(i.type);b(e.TEXTURE_2D,i,d);var g,v=i.mipmaps;if(i&&i.isDepthTexture){var y=e.DEPTH_COMPONENT;if(i.type===Hs){if(!N)throw new Error("Float Depth Texture only supported in WebGL2.0");y=e.DEPTH_COMPONENT32F}else N&&(y=e.DEPTH_COMPONENT16);i.format===er&&(y=e.DEPTH_STENCIL),n.texImage2D(e.TEXTURE_2D,0,y,a.width,a.height,0,f,m,null)}else if(i&&i.isDataTexture)if(v.length>0&&d){for(var x=0,w=v.length;x<w;x++)g=v[x],n.texImage2D(e.TEXTURE_2D,x,f,g.width,g.height,0,f,m,g.data);i.generateMipmaps=!1}else n.texImage2D(e.TEXTURE_2D,0,f,a.width,a.height,0,f,m,a.data);else if(i&&i.isCompressedTexture)for(var x=0,w=v.length;x<w;x++)g=v[x],i.format!==Zs&&i.format!==$s?n.getCompressedTextureFormats().indexOf(f)>-1?n.compressedTexImage2D(e.TEXTURE_2D,x,f,g.width,g.height,0,g.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,x,f,g.width,g.height,0,f,m,g.data);else if(v.length>0&&d){for(var x=0,w=v.length;x<w;x++)g=v[x],n.texImage2D(e.TEXTURE_2D,x,f,f,m,g);i.generateMipmaps=!1}else n.texImage2D(e.TEXTURE_2D,0,f,f,m,a);i.generateMipmaps&&d&&e.generateMipmap(e.TEXTURE_2D),t.__version=i.version,i.onUpdate&&i.onUpdate(i)}function _(t,i,r,a){var h=o(i.texture.format),l=o(i.texture.type);n.texImage2D(a,0,h,i.width,i.height,0,h,l,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,r,a,s.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function S(t,i){e.bindRenderbuffer(e.RENDERBUFFER,t),i.depthBuffer&&!i.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,i.width,i.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):i.depthBuffer&&i.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,i.width,i.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,i.width,i.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function M(t,i){var n=i&&i.isWebGLRenderTargetCube;if(n)throw new Error("Depth Texture with cube render targets is not supported!");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");s.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),v(i.depthTexture,0);var r=s.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===tr)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,r,0);else{if(i.depthTexture.format!==er)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,r,0)}}function T(t){var i=s.get(t),n=t&&t.isWebGLRenderTargetCube;if(t.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");M(i.__webglFramebuffer,t)}else if(n){i.__webglDepthbuffer=[];for(var r=0;r<6;r++)e.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=e.createRenderbuffer(),S(i.__webglDepthbuffer[r],t)}else e.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),S(i.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}function E(t){var i=s.get(t),r=s.get(t.texture);t.addEventListener("dispose",f),r.__webglTexture=e.createTexture(),A.textures++;var o=t&&t.isWebGLRenderTargetCube,a=l(t);if(o){i.__webglFramebuffer=[];for(var h=0;h<6;h++)i.__webglFramebuffer[h]=e.createFramebuffer()}else i.__webglFramebuffer=e.createFramebuffer();if(o){n.bindTexture(e.TEXTURE_CUBE_MAP,r.__webglTexture),b(e.TEXTURE_CUBE_MAP,t.texture,a);for(var h=0;h<6;h++)_(i.__webglFramebuffer[h],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+h);t.texture.generateMipmaps&&a&&e.generateMipmap(e.TEXTURE_CUBE_MAP),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else n.bindTexture(e.TEXTURE_2D,r.__webglTexture),b(e.TEXTURE_2D,t.texture,a),_(i.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),t.texture.generateMipmaps&&a&&e.generateMipmap(e.TEXTURE_2D),n.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&T(t)}function C(t){var i=t.texture;if(i.generateMipmaps&&l(t)&&i.minFilter!==Ls&&i.minFilter!==Is){var r=t&&t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,o=s.get(i).__webglTexture;n.bindTexture(r,o),e.generateMipmap(r),n.bindTexture(r,null)}}var A=a.memory,N="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;this.setTexture2D=v,this.setTextureCube=y,this.setTextureCubeDynamic=x,this.setupRenderTarget=E,this.updateRenderTargetMipmap=C}function p(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1}function f(t,e,i){function n(e,i,n){var s=new Uint8Array(4),r=t.createTexture();t.bindTexture(e,r),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var o=0;o<n;o++)t.texImage2D(i+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,s);return r}var s=this;this.buffers={color:new m(t,this),depth:new g(t,this),stencil:new v(t,this)};var r=t.getParameter(t.MAX_VERTEX_ATTRIBS),o=new Uint8Array(r),a=new Uint8Array(r),h=new Uint8Array(r),l={},c=null,u=null,d=null,f=null,y=null,x=null,b=null,w=null,_=!1,S=null,M=null,T=null,E=null,C=null,A=null,N=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),L=null,P={},k=new p,I=new p,D={};D[t.TEXTURE_2D]=n(t.TEXTURE_2D,t.TEXTURE_2D,1),D[t.TEXTURE_CUBE_MAP]=n(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(t.DEPTH_TEST),this.setDepthFunc(os),this.setFlipSided(!1),this.setCullFace(xn),this.enable(t.CULL_FACE),this.enable(t.BLEND),this.setBlending(Rn)},this.initAttributes=function(){for(var t=0,e=o.length;t<e;t++)o[t]=0},this.enableAttribute=function(i){if(o[i]=1,0===a[i]&&(t.enableVertexAttribArray(i),a[i]=1),0!==h[i]){var n=e.get("ANGLE_instanced_arrays");n.vertexAttribDivisorANGLE(i,0),h[i]=0}},this.enableAttributeAndDivisor=function(e,i,n){o[e]=1,0===a[e]&&(t.enableVertexAttribArray(e),a[e]=1),h[e]!==i&&(n.vertexAttribDivisorANGLE(e,i),h[e]=i)},this.disableUnusedAttributes=function(){for(var e=0,i=a.length;e!==i;++e)a[e]!==o[e]&&(t.disableVertexAttribArray(e),a[e]=0)},this.enable=function(e){l[e]!==!0&&(t.enable(e),l[e]=!0)},this.disable=function(e){l[e]!==!1&&(t.disable(e),l[e]=!1)},this.getCompressedTextureFormats=function(){if(null===c&&(c=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)c.push(i[n]);return c},this.setBlending=function(e,n,s,r,o,a,h,l){return e===zn?(this.disable(t.BLEND),void(u=e)):(this.enable(t.BLEND),e===u&&l===_||(e===On?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===Bn?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),
t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===Fn?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),u=e,_=l),void(e===Un?(o=o||n,a=a||s,h=h||r,n===d&&o===x||(t.blendEquationSeparate(i(n),i(o)),d=n,x=o),s===f&&r===y&&a===b&&h===w||(t.blendFuncSeparate(i(s),i(r),i(a),i(h)),f=s,y=r,b=a,w=h)):(d=null,f=null,y=null,x=null,b=null,w=null)))},this.setColorWrite=function(t){this.buffers.color.setMask(t)},this.setDepthTest=function(t){this.buffers.depth.setTest(t)},this.setDepthWrite=function(t){this.buffers.depth.setMask(t)},this.setDepthFunc=function(t){this.buffers.depth.setFunc(t)},this.setStencilTest=function(t){this.buffers.stencil.setTest(t)},this.setStencilWrite=function(t){this.buffers.stencil.setMask(t)},this.setStencilFunc=function(t,e,i){this.buffers.stencil.setFunc(t,e,i)},this.setStencilOp=function(t,e,i){this.buffers.stencil.setOp(t,e,i)},this.setFlipSided=function(e){S!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),S=e)},this.setCullFace=function(e){e!==yn?(this.enable(t.CULL_FACE),e!==M&&(e===xn?t.cullFace(t.BACK):e===bn?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),M=e},this.setLineWidth=function(e){e!==T&&(t.lineWidth(e),T=e)},this.setPolygonOffset=function(e,i,n){e?(this.enable(t.POLYGON_OFFSET_FILL),E===i&&C===n||(t.polygonOffset(i,n),E=i,C=n)):this.disable(t.POLYGON_OFFSET_FILL)},this.getScissorTest=function(){return A},this.setScissorTest=function(e){A=e,e?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)},this.activeTexture=function(e){void 0===e&&(e=t.TEXTURE0+N-1),L!==e&&(t.activeTexture(e),L=e)},this.bindTexture=function(e,i){null===L&&s.activeTexture();var n=P[L];void 0===n&&(n={type:void 0,texture:void 0},P[L]=n),n.type===e&&n.texture===i||(t.bindTexture(e,i||D[e]),n.type=e,n.texture=i)},this.compressedTexImage2D=function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}},this.texImage2D=function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}},this.clearColor=function(t,e,i,n){this.buffers.color.setClear(t,e,i,n)},this.clearDepth=function(t){this.buffers.depth.setClear(t)},this.clearStencil=function(t){this.buffers.stencil.setClear(t)},this.scissor=function(e){k.equals(e)===!1&&(t.scissor(e.x,e.y,e.z,e.w),k.copy(e))},this.viewport=function(e){I.equals(e)===!1&&(t.viewport(e.x,e.y,e.z,e.w),I.copy(e))},this.reset=function(){for(var e=0;e<a.length;e++)1===a[e]&&(t.disableVertexAttribArray(e),a[e]=0);l={},c=null,L=null,P={},u=null,S=null,M=null,this.buffers.color.reset(),this.buffers.depth.reset(),this.buffers.stencil.reset()}}function m(t,e){var i=!1,n=new p,s=null,r=new p;this.setMask=function(e){s===e||i||(t.colorMask(e,e,e,e),s=e)},this.setLocked=function(t){i=t},this.setClear=function(e,i,s,o){n.set(e,i,s,o),r.equals(n)===!1&&(t.clearColor(e,i,s,o),r.copy(n))},this.reset=function(){i=!1,s=null,r=new p}}function g(t,e){var i=!1,n=null,s=null,r=null;this.setTest=function(i){i?e.enable(t.DEPTH_TEST):e.disable(t.DEPTH_TEST)},this.setMask=function(e){n===e||i||(t.depthMask(e),n=e)},this.setFunc=function(e){if(s!==e){if(e)switch(e){case ns:t.depthFunc(t.NEVER);break;case ss:t.depthFunc(t.ALWAYS);break;case rs:t.depthFunc(t.LESS);break;case os:t.depthFunc(t.LEQUAL);break;case as:t.depthFunc(t.EQUAL);break;case hs:t.depthFunc(t.GEQUAL);break;case ls:t.depthFunc(t.GREATER);break;case cs:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);s=e}},this.setLocked=function(t){i=t},this.setClear=function(e){r!==e&&(t.clearDepth(e),r=e)},this.reset=function(){i=!1,n=null,s=null,r=null}}function v(t,e){var i=!1,n=null,s=null,r=null,o=null,a=null,h=null,l=null,c=null;this.setTest=function(i){i?e.enable(t.STENCIL_TEST):e.disable(t.STENCIL_TEST)},this.setMask=function(e){n===e||i||(t.stencilMask(e),n=e)},this.setFunc=function(e,i,n){s===e&&r===i&&o===n||(t.stencilFunc(e,i,n),s=e,r=i,o=n)},this.setOp=function(e,i,n){a===e&&h===i&&l===n||(t.stencilOp(e,i,n),a=e,h=i,l=n)},this.setLocked=function(t){i=t},this.setClear=function(e){c!==e&&(t.clearStencil(e),c=e)},this.reset=function(){i=!1,n=null,s=null,r=null,o=null,a=null,h=null,l=null,c=null}}function y(e,i,s){this.uuid=t.Math.generateUUID(),this.width=e,this.height=i,this.scissor=new p(0,0,e,i),this.scissorTest=!1,this.viewport=new p(0,0,e,i),s=s||{},void 0===s.minFilter&&(s.minFilter=Is),this.texture=new n(void 0,void 0,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.encoding),this.depthBuffer=void 0===s.depthBuffer||s.depthBuffer,this.stencilBuffer=void 0===s.stencilBuffer||s.stencilBuffer,this.depthTexture=void 0!==s.depthTexture?s.depthTexture:null}function x(){Object.defineProperty(this,"id",{value:b()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=Rn,this.side=Cn,this.shading=Pn,this.vertexColors=kn,this.opacity=1,this.transparent=!1,this.blendSrc=Zn,this.blendDst=Jn,this.blendEquation=Vn,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=os,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0}function b(){return Dr++}function w(t){x.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function _(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}function S(t){x.call(this),this.type="MeshDepthMaterial",this.depthPacking=Pr,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function M(t,e){this.min=void 0!==t?t:new a(+(1/0),+(1/0),+(1/0)),this.max=void 0!==e?e:new a(-(1/0),-(1/0),-(1/0))}function T(t,e){this.center=void 0!==t?t:new a,this.radius=void 0!==e?e:0}function E(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function C(t,e){this.normal=void 0!==t?t:new a(1,0,0),this.constant=void 0!==e?e:0}function A(t,e,i,n,s,r){this.planes=[void 0!==t?t:new C,void 0!==e?e:new C,void 0!==i?i:new C,void 0!==n?n:new C,void 0!==s?s:new C,void 0!==r?r:new C]}function N(e,n,s,o){function h(t,i,n,s){var r=t.geometry,o=null,a=C,h=t.customDepthMaterial;if(n&&(a=N,h=t.customDistanceMaterial),h)o=h;else{var l=!1;i.morphTargets&&(r&&r.isBufferGeometry?l=r.morphAttributes&&r.morphAttributes.position&&r.morphAttributes.position.length>0:r&&r.isGeometry&&(l=r.morphTargets&&r.morphTargets.length>0));var c=t.isSkinnedMesh&&i.skinning,u=0;l&&(u|=M),c&&(u|=T),o=a[u]}if(e.localClippingEnabled&&i.clipShadows===!0&&0!==i.clippingPlanes.length){var d=o.uuid,p=i.uuid,f=L[d];void 0===f&&(f={},L[d]=f);var m=f[p];void 0===m&&(m=o.clone(),f[p]=m),o=m}o.visible=i.visible,o.wireframe=i.wireframe;var g=i.side;return H.renderSingleSided&&g==Nn&&(g=Cn),H.renderReverseSided&&(g===Cn?g=An:g===An&&(g=Cn)),o.side=g,o.clipShadows=i.clipShadows,o.clippingPlanes=i.clippingPlanes,o.wireframeLinewidth=i.wireframeLinewidth,o.linewidth=i.linewidth,n&&void 0!==o.uniforms.lightPos&&o.uniforms.lightPos.value.copy(s),o}function l(t,e,i){if(t.visible!==!1){var n=0!==(t.layers.mask&e.layers.mask);if(n&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(t.frustumCulled===!1||d.intersectsObject(t)===!0)){var s=t.material;s.visible===!0&&(t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),_.push(t))}for(var r=t.children,o=0,a=r.length;o<a;o++)l(r[o],e,i)}}var c=e.context,u=e.state,d=new A,f=new r,m=n.shadows,g=new i,v=new i(o.maxTextureSize,o.maxTextureSize),x=new a,b=new a,_=[],M=1,T=2,E=(M|T)+1,C=new Array(E),N=new Array(E),L={},P=[new a(1,0,0),new a(-1,0,0),new a(0,0,1),new a(0,0,-1),new a(0,1,0),new a(0,-1,0)],k=[new a(0,1,0),new a(0,1,0),new a(0,1,0),new a(0,1,0),new a(0,0,1),new a(0,0,-1)],I=[new p,new p,new p,new p,new p,new p],D=new S;D.depthPacking=kr,D.clipping=!0;for(var z=t.ShaderLib.distanceRGBA,R=t.UniformsUtils.clone(z.uniforms),O=0;O!==E;++O){var B=0!==(O&M),F=0!==(O&T),U=D.clone();U.morphTargets=B,U.skinning=F,C[O]=U;var V=new w({defines:{USE_SHADOWMAP:""},uniforms:R,vertexShader:z.vertexShader,fragmentShader:z.fragmentShader,morphTargets:B,skinning:F,clipping:!0});N[O]=V}var H=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Tn,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(t,i){if(H.enabled!==!1&&(H.autoUpdate!==!1||H.needsUpdate!==!1)&&0!==m.length){u.clearColor(1,1,1,1),u.disable(c.BLEND),u.setDepthTest(!0),u.setScissorTest(!1);for(var n,r,o=0,a=m.length;o<a;o++){var p=m[o],w=p.shadow;if(void 0!==w){var S=w.camera;if(g.copy(w.mapSize),g.min(v),p&&p.isPointLight){n=6,r=!0;var M=g.x,T=g.y;I[0].set(2*M,T,M,T),I[1].set(0,T,M,T),I[2].set(3*M,T,M,T),I[3].set(M,T,M,T),I[4].set(3*M,0,M,T),I[5].set(M,0,M,T),g.x*=4,g.y*=2}else n=1,r=!1;if(null===w.map){var E={minFilter:Ls,magFilter:Ls,format:Zs};w.map=new y(g.x,g.y,E),S.updateProjectionMatrix()}w&&w.isSpotLightShadow&&w.update(p);var C=w.map,A=w.matrix;b.setFromMatrixPosition(p.matrixWorld),S.position.copy(b),e.setRenderTarget(C),e.clear();for(var N=0;N<n;N++){if(r){x.copy(S.position),x.add(P[N]),S.up.copy(k[N]),S.lookAt(x);var L=I[N];u.viewport(L)}else x.setFromMatrixPosition(p.target.matrixWorld),S.lookAt(x);S.updateMatrixWorld(),S.matrixWorldInverse.getInverse(S.matrixWorld),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(S.projectionMatrix),A.multiply(S.matrixWorldInverse),f.multiplyMatrices(S.projectionMatrix,S.matrixWorldInverse),d.setFromMatrix(f),_.length=0,l(t,i,S);for(var D=0,z=_.length;D<z;D++){var R=_[D],O=s.update(R),B=R.material;if(B&&B.isMultiMaterial)for(var F=O.groups,U=B.materials,V=0,W=F.length;V<W;V++){var j=F[V],G=U[j.materialIndex];if(G.visible===!0){var X=h(R,G,r,b);e.renderBufferDirect(S,null,O,X,R,j)}}else{var X=h(R,B,r,b);e.renderBufferDirect(S,null,O,X,R,null)}}}}else console.warn("THREE.WebGLShadowMap:",p,"has no shadow.")}var Y=e.getClearColor(),q=e.getClearAlpha();e.setClearColor(Y,q),H.needsUpdate=!1}}}function L(){var t={};this.get=function(e){var i=e.uuid,n=t[i];return void 0===n&&(n={},t[i]=n),n},this.delete=function(e){delete t[e.uuid]},this.clear=function(){t={}}}function P(e,i){function n(t){if(i.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var e=i.maxVertexUniforms,n=Math.floor((e-20)/4),s=n;return void 0!==t&&t&&t.isSkinnedMesh&&(s=Math.min(t.skeleton.bones.length,s),s<t.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+s+" (try OpenGL instead of ANGLE)")),s}function s(t,e){var i;return t?t&&t.isTexture?i=t.encoding:t&&t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding):i=Sr,i===Sr&&e&&(i=Tr),i}var r=[],o={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","depthPacking"];this.getParameters=function(t,r,a,h,l){var c=o[t.type],u=n(l),d=e.getPrecision();null!==t.precision&&(d=i.getMaxPrecision(t.precision),d!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",d,"instead."));var p=e.getCurrentRenderTarget(),f={shaderID:c,precision:d,supportsVertexTextures:i.vertexTextures,outputEncoding:s(p?p.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:s(t.map,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:s(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===Ts||t.envMap.mapping===Es),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:s(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!a,useFog:t.fog,fogExp:a&&a.isFogExp2,flatShading:t.shading===Ln,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:i.logarithmicDepthBuffer,skinning:t.skinning,maxBones:u,useVertexTexture:i.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numHemiLights:r.hemi.length,numClippingPlanes:h,shadowMapEnabled:e.shadowMap.enabled&&l.receiveShadow&&r.shadows.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===Nn,flipSided:t.side===An,depthPacking:void 0!==t.depthPacking&&t.depthPacking};return f},this.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(var s=0;s<a.length;s++)i.push(e[a[s]]);return i.join()},this.acquireProgram=function(i,n,s){for(var o,a=0,h=r.length;a<h;a++){var l=r[a];if(l.code===s){o=l,++o.usedTimes;break}}return void 0===o&&(o=new t.WebGLProgram(e,s,i,n),r.push(o)),o},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function k(e,i,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=t.Math.generateUUID(),this.array=e,this.itemSize=i,this.normalized=n===!0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function I(t,e){return new k(new Int8Array(t),e)}function D(t,e){return new k(new Uint8Array(t),e)}function z(t,e){return new k(new Uint8ClampedArray(t),e)}function R(t,e){return new k(new Int16Array(t),e)}function O(t,e){return new k(new Uint16Array(t),e)}function B(t,e){return new k(new Int32Array(t),e)}function F(t,e){return new k(new Uint32Array(t),e)}function U(t,e){return new k(new Float32Array(t),e)}function V(t,e){return new k(new Float64Array(t),e)}function H(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new k(t,e).setDynamic(!0)}function W(t,e,i,n,s,r){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new a,this.vertexNormals=Array.isArray(n)?n:[],this.color=s&&s.isColor?s:new _,this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=void 0!==r?r:0}function j(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||j.DefaultOrder}function G(){this.mask=1}function X(){function e(){h.setFromEuler(s,!1)}function i(){s.setFromQuaternion(h,void 0,!1)}Object.defineProperty(this,"id",{value:Y()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=X.DefaultUp.clone();var n=new a,s=new j,h=new o,l=new a(1,1,1);s.onChange(e),h.onChange(i),Object.defineProperties(this,{position:{enumerable:!0,value:n},rotation:{enumerable:!0,value:s},quaternion:{enumerable:!0,value:h},scale:{enumerable:!0,value:l},modelViewMatrix:{value:new r},normalMatrix:{value:new E}}),this.matrix=new r,this.matrixWorld=new r,this.matrixAutoUpdate=X.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new G,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Y(){return Da++}function q(){Object.defineProperty(this,"id",{value:$()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function $(){return za++}function Z(){Object.defineProperty(this,"id",{value:$()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function J(){Object.defineProperty(this,"id",{value:$()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function K(t,e,i){function n(t){var e=t.geometry;if(void 0!==l[e.id])return l[e.id];e.addEventListener("dispose",s);var n;return e&&e.isBufferGeometry?n=e:e&&e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new J).setFromObject(t)),n=e._bufferGeometry),l[e.id]=n,i.memory.geometries++,n}function s(t){var n=t.target,r=l[n.id];null!==r.index&&o(r.index),a(r.attributes),n.removeEventListener("dispose",s),delete l[n.id];var h=e.get(n);h.wireframe&&o(h.wireframe),e.delete(n);var c=e.get(r);c.wireframe&&o(c.wireframe),e.delete(r),i.memory.geometries--}function r(t){return t&&t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function o(e){var i=r(e);void 0!==i&&(t.deleteBuffer(i),h(e))}function a(t){for(var e in t)o(t[e])}function h(t){t&&t.isInterleavedBufferAttribute?e.delete(t.data):e.delete(t)}var l={};this.get=n}function Q(t,e,i){function n(e){var i=c.get(e);e.geometry&&e.geometry.isGeometry&&i.updateFromObject(e);var n=i.index,r=i.attributes;null!==n&&s(n,t.ELEMENT_ARRAY_BUFFER);for(var o in r)s(r[o],t.ARRAY_BUFFER);var a=i.morphAttributes;for(var o in a)for(var h=a[o],l=0,u=h.length;l<u;l++)s(h[l],t.ARRAY_BUFFER);return i}function s(t,i){var n=t&&t.isInterleavedBufferAttribute?t.data:t,s=e.get(n);void 0===s.__webglBuffer?r(s,n,i):s.version!==n.version&&o(s,n,i)}function r(e,i,n){e.__webglBuffer=t.createBuffer(),t.bindBuffer(n,e.__webglBuffer);var s=i.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(n,i.array,s),e.version=i.version}function o(e,i,n){t.bindBuffer(n,e.__webglBuffer),i.dynamic===!1||i.updateRange.count===-1?t.bufferSubData(n,0,i.array):0===i.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0),e.version=i.version}function a(t){return t&&t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function h(i){var n=e.get(i);if(void 0!==n.wireframe)return n.wireframe;var r=[],o=i.index,a=i.attributes,h=a.position;if(null!==o)for(var c={},u=o.array,d=0,p=u.length;d<p;d+=3){var f=u[d+0],m=u[d+1],g=u[d+2];l(c,f,m)&&r.push(f,m),l(c,m,g)&&r.push(m,g),l(c,g,f)&&r.push(g,f)}else for(var u=a.position.array,d=0,p=u.length/3-1;d<p;d+=3){var f=d+0,m=d+1,g=d+2;r.push(f,m,m,g,g,f)}var v=h.count>65535?Uint32Array:Uint16Array,y=new k(new v(r),1);return s(y,t.ELEMENT_ARRAY_BUFFER),n.wireframe=y,y}function l(t,e,i){if(e>i){var n=e;e=i,i=n}var s=t[e];return void 0===s?(t[e]=[i],!0):s.indexOf(i)===-1&&(s.push(i),!0)}var c=new K(t,e,i);this.getAttributeBuffer=a,this.getWireframeAttribute=h,this.update=n}function tt(){var t={};this.get=function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new a,color:new _,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"SpotLight":n={position:new a,direction:new a,color:new _,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"PointLight":n={position:new a,color:new _,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"HemisphereLight":n={direction:new a,skyColor:new _,groundColor:new _}}return t[e.id]=n,n}}function et(t,e,i){function n(){if(void 0!==r)return r;var i=e.get("EXT_texture_filter_anisotropic");return r=null!==i?t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function s(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var r;this.getMaxAnisotropy=n,this.getMaxPrecision=s,this.precision=void 0!==i.precision?i.precision:"highp",this.logarithmicDepthBuffer=void 0!==i.logarithmicDepthBuffer&&i.logarithmicDepthBuffer,this.maxTextures=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCubemapSize=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.maxFragmentUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=this.maxVertexTextures>0,this.floatFragmentTextures=!!e.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var o=s(this.precision);o!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",o,"instead."),this.precision=o),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!e.get("EXT_frag_depth"))}function it(t){var e={};this.get=function(i){if(void 0!==e[i])return e[i];var n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=t.getExtension("WEBGL_compressed_texture_etc1");break;default:n=t.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),e[i]=n,n}}function nt(t,e,i){function n(t){a=t}function s(i){i.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(h=t.UNSIGNED_INT,l=4):(h=t.UNSIGNED_SHORT,l=2)}function r(e,n){t.drawElements(a,n,h,e*l),i.calls++,i.vertices+=n,a===t.TRIANGLES&&(i.faces+=n/3)}function o(n,s,r){var o=e.get("ANGLE_instanced_arrays");return null===o?void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(o.drawElementsInstancedANGLE(a,r,h,s*l,n.maxInstancedCount),i.calls++,i.vertices+=r*n.maxInstancedCount,void(a===t.TRIANGLES&&(i.faces+=n.maxInstancedCount*r/3)))}var a,h,l;this.setMode=n,this.setIndex=s,this.render=r,this.renderInstances=o}function st(){function t(){l.value!==n&&(l.value=n,l.needsUpdate=s>0),i.numPlanes=s}function e(t,e,n,s){var r=null!==t?t.length:0,o=null;if(0!==r){if(o=l.value,s!==!0||null===o){var c=n+4*r,u=e.matrixWorldInverse;h.getNormalMatrix(u),(null===o||o.length<c)&&(o=new Float32Array(c));for(var d=0,p=n;d!==r;++d,p+=4)a.copy(t[d]).applyMatrix4(u,h),a.normal.toArray(o,p),o[p+3]=a.constant}l.value=o,l.needsUpdate=!0}return i.numPlanes=r,o}var i=this,n=null,s=0,r=!1,o=!1,a=new C,h=new E,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==s||r;return r=i,n=e(t,o,0),s=t.length,a},this.beginShadows=function(){o=!0,e(null)},this.endShadows=function(){o=!1,t()},this.setState=function(i,a,h,c,u){if(!r||null===i||0===i.length||o&&!a)o?e(null):t();else{var d=o?0:s,p=4*d,f=c.clippingState||null;l.value=f,f=e(i,h,p,u);for(var m=0;m!==p;++m)f[m]=n[m];c.clippingState=f,this.numPlanes+=d}}}function rt(t,e,i){function n(t){o=t}function s(e,n){t.drawArrays(o,e,n),i.calls++,i.vertices+=n,o===t.TRIANGLES&&(i.faces+=n/3)}function r(n){var s=e.get("ANGLE_instanced_arrays");if(null===s)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var r=n.attributes.position,a=0;r&&r.isInterleavedBufferAttribute?(a=r.data.count,s.drawArraysInstancedANGLE(o,0,a,n.maxInstancedCount)):(a=r.count,s.drawArraysInstancedANGLE(o,0,a,n.maxInstancedCount)),i.calls++,i.vertices+=a*n.maxInstancedCount,o===t.TRIANGLES&&(i.faces+=n.maxInstancedCount*a/3)}var o;this.setMode=n,this.render=s,this.renderInstances=r}function ot(t,e,i){y.call(this,t,e,i),this.activeCubeFace=0,this.activeMipMapLevel=0}function at(t,e,i,n,s,r){function o(t,e,i){var n=0;return n+=(t+1)*(e+1)*2,n+=(t+1)*(i+1)*2,n+=(i+1)*(e+1)*2}function h(t,e,i){var n=0;return n+=t*e*2,n+=t*i*2,n+=i*e*2,6*n}function l(t,e,i,n,s,r,o,h,l,u,d){for(var _=r/l,S=o/u,M=r/2,T=o/2,E=h/2,C=l+1,A=u+1,N=0,L=0,P=new a,k=0;k<A;k++)for(var I=k*S-T,D=0;D<C;D++){var z=D*_-M;P[t]=z*n,P[e]=I*s,P[i]=E,f[v]=P.x,f[v+1]=P.y,f[v+2]=P.z,P[t]=0,P[e]=0,P[i]=h>0?1:-1,m[v]=P.x,m[v+1]=P.y,m[v+2]=P.z,g[y]=D/l,g[y+1]=1-k/u,v+=3,y+=2,N+=1}for(k=0;k<u;k++)for(D=0;D<l;D++){var R=b+D+C*k,O=b+D+C*(k+1),B=b+(D+1)+C*(k+1),F=b+(D+1)+C*k;p[x]=R,p[x+1]=O,p[x+2]=F,p[x+3]=O,p[x+4]=B,p[x+5]=F,x+=6,L+=6}c.addGroup(w,L,d),w+=L,b+=N}J.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:s,depthSegments:r};var c=this;n=Math.floor(n)||1,s=Math.floor(s)||1,r=Math.floor(r)||1;var u=o(n,s,r),d=h(n,s,r),p=new(d>65535?Uint32Array:Uint16Array)(d),f=new Float32Array(3*u),m=new Float32Array(3*u),g=new Float32Array(2*u),v=0,y=0,x=0,b=0,w=0;l("z","y","x",-1,-1,i,e,t,r,s,0),l("z","y","x",1,-1,i,e,-t,r,s,1),l("x","z","y",1,1,t,i,e,n,r,2),l("x","z","y",1,-1,t,i,-e,n,r,3),l("x","y","z",1,-1,t,e,i,n,s,4),l("x","y","z",-1,-1,t,e,-i,n,s,5),this.setIndex(new k(p,1)),this.addAttribute("position",new k(f,3)),this.addAttribute("normal",new k(m,3)),this.addAttribute("uv",new k(g,2))}function ht(t,e){this.origin=void 0!==t?t:new a,this.direction=void 0!==e?e:new a}function lt(t,e){this.start=void 0!==t?t:new a,this.end=void 0!==e?e:new a}function ct(t,e,i){this.a=void 0!==t?t:new a,this.b=void 0!==e?e:new a,this.c=void 0!==i?i:new a}function ut(t){x.call(this),this.type="MeshBasicMaterial",this.color=new _(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=us,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function dt(t,e,i){X.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new J,this.material=void 0!==e?e:new ut({color:16777215*Math.random()}),this.drawMode=br,this.name=i,this.updateMorphTargets()}function pt(t,e,i,n){J.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};for(var s=t/2,r=e/2,o=Math.floor(i)||1,a=Math.floor(n)||1,h=o+1,l=a+1,c=t/o,u=e/a,d=new Float32Array(h*l*3),p=new Float32Array(h*l*3),f=new Float32Array(h*l*2),m=0,g=0,v=0;v<l;v++)for(var y=v*u-r,x=0;x<h;x++){var b=x*c-s;d[m]=b,d[m+1]=-y,p[m+2]=1,f[g]=x/o,f[g+1]=1-v/a,m+=3,g+=2}m=0;for(var w=new(d.length/3>65535?Uint32Array:Uint16Array)(o*a*6),v=0;v<a;v++)for(var x=0;x<o;x++){var _=x+h*v,S=x+h*(v+1),M=x+1+h*(v+1),T=x+1+h*v;w[m]=_,w[m+1]=S,w[m+2]=T,w[m+3]=S,w[m+4]=M,w[m+5]=T,m+=6}this.setIndex(new k(w,1)),this.addAttribute("position",new k(d,3)),this.addAttribute("normal",new k(p,3)),this.addAttribute("uv",new k(f,2))}function ft(){X.call(this),this.type="Camera",this.matrixWorldInverse=new r,this.projectionMatrix=new r}function mt(t,e,i,n){ft.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function gt(t,e,i,n,s,r){ft.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==s?s:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()}function vt(e){function i(){return null===Nt?Ht:1}function n(t,e,i,n){vt===!0&&(t*=n,e*=n,i*=n),re.clearColor(t,e,i,n)}function s(){re.init(),re.scissor(Dt.copy(Wt).multiplyScalar(Ht)),re.viewport(Rt.copy(Gt).multiplyScalar(Ht)),n(Bt.r,Bt.g,Bt.b,Ft)}function o(){At=null,It=null,kt="",Pt=-1,re.reset()}function l(t){t.preventDefault(),o(),s(),oe.clear()}function u(t){var e=t.target;e.removeEventListener("dispose",u),m(e)}function m(t){g(t),oe.delete(t)}function g(t){var e=oe.get(t).program;t.program=void 0,void 0!==e&&le.releaseProgram(e)}function v(t,e,i,n){var s;if(i&&i.isInstancedBufferGeometry&&(s=ne.get("ANGLE_instanced_arrays"),null===s))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
void 0===n&&(n=0),re.initAttributes();var r=i.attributes,o=e.getAttributes(),a=t.defaultAttributeValues;for(var h in o){var l=o[h];if(l>=0){var c=r[h];if(void 0!==c){var u=ee.FLOAT,d=c.array,p=c.normalized;d instanceof Float32Array?u=ee.FLOAT:d instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):d instanceof Uint16Array?u=ee.UNSIGNED_SHORT:d instanceof Int16Array?u=ee.SHORT:d instanceof Uint32Array?u=ee.UNSIGNED_INT:d instanceof Int32Array?u=ee.INT:d instanceof Int8Array?u=ee.BYTE:d instanceof Uint8Array&&(u=ee.UNSIGNED_BYTE);var f=c.itemSize,m=he.getAttributeBuffer(c);if(c&&c.isInterleavedBufferAttribute){var g=c.data,v=g.stride,y=c.offset;g&&g.isInstancedInterleavedBuffer?(re.enableAttributeAndDivisor(l,g.meshPerAttribute,s),void 0===i.maxInstancedCount&&(i.maxInstancedCount=g.meshPerAttribute*g.count)):re.enableAttribute(l),ee.bindBuffer(ee.ARRAY_BUFFER,m),ee.vertexAttribPointer(l,f,u,p,v*g.array.BYTES_PER_ELEMENT,(n*v+y)*g.array.BYTES_PER_ELEMENT)}else c&&c.isInstancedBufferAttribute?(re.enableAttributeAndDivisor(l,c.meshPerAttribute,s),void 0===i.maxInstancedCount&&(i.maxInstancedCount=c.meshPerAttribute*c.count)):re.enableAttribute(l),ee.bindBuffer(ee.ARRAY_BUFFER,m),ee.vertexAttribPointer(l,f,u,p,0,n*f*c.array.BYTES_PER_ELEMENT)}else if(void 0!==a){var x=a[h];if(void 0!==x)switch(x.length){case 2:ee.vertexAttrib2fv(l,x);break;case 3:ee.vertexAttrib3fv(l,x);break;case 4:ee.vertexAttrib4fv(l,x);break;default:ee.vertexAttrib1fv(l,x)}}}}re.disableUnusedAttributes()}function y(t,e){return Math.abs(e[0])-Math.abs(t[0])}function x(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.program&&e.material.program&&t.material.program!==e.material.program?t.material.program.id-e.material.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function b(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function S(t,e,i,n,s){var r,o;i.transparent?(r=_t,o=++St):(r=bt,o=++wt);var a=r[o];void 0!==a?(a.id=t.id,a.object=t,a.geometry=e,a.material=i,a.z=Kt.z,a.group=s):(a={id:t.id,object:t,geometry:e,material:i,z:Kt.z,group:s},r.push(a))}function M(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Zt.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),C(Zt)}function E(t){return Zt.center.set(0,0,0),Zt.radius=.7071067811865476,Zt.applyMatrix4(t.matrixWorld),C(Zt)}function C(t){if(!Xt.intersectsSphere(t))return!1;var e=Yt.numPlanes;if(0===e)return!0;var i=Ct.clippingPlanes,n=t.center,s=-t.radius,r=0;do if(i[r].distanceToPoint(n)<s)return!1;while(++r!==e);return!0}function k(t,e){if(t.visible!==!1){var i=0!==(t.layers.mask&e.layers.mask);if(i)if(t.isLight)xt.push(t);else if(t.isSprite)t.frustumCulled!==!1&&E(t)!==!0||Tt.push(t);else if(t.isLensFlare)Et.push(t);else if(t.isImmediateRenderObject)Ct.sortObjects===!0&&(Kt.setFromMatrixPosition(t.matrixWorld),Kt.applyProjection(Jt)),S(t,null,t.material,Kt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),t.frustumCulled===!1||M(t)===!0)){var n=t.material;if(n.visible===!0){Ct.sortObjects===!0&&(Kt.setFromMatrixPosition(t.matrixWorld),Kt.applyProjection(Jt));var s=he.update(t);if(n&&n.isMultiMaterial)for(var r=s.groups,o=n.materials,a=0,h=r.length;a<h;a++){var l=r[a],c=o[l.materialIndex];c.visible===!0&&S(t,s,c,Kt.z,l)}else S(t,s,n,Kt.z,null)}}for(var u=t.children,a=0,h=u.length;a<h;a++)k(u[a],e)}}function I(t,e,i,n){for(var s=0,r=t.length;s<r;s++){var o=t[s],a=o.object,h=o.geometry,l=void 0===n?o.material:n,c=o.group;if(a.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,a.matrixWorld),a.normalMatrix.getNormalMatrix(a.modelViewMatrix),a.isImmediateRenderObject){z(l);var u=R(e,i,l,a);kt="",a.render(function(t){Ct.renderBufferImmediate(t,u,l)})}else Ct.renderBufferDirect(e,i,h,l,a,c)}}function D(e,i,n){var s=oe.get(e),r=le.getParameters(e,Qt,i,Yt.numPlanes,n),o=le.getProgramCode(e,r),a=s.program,h=!0;if(void 0===a)e.addEventListener("dispose",u);else if(a.code!==o)g(e);else{if(void 0!==r.shaderID)return;h=!1}if(h){if(r.shaderID){var l=t.ShaderLib[r.shaderID];s.__webglShader={name:e.type,uniforms:t.UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else s.__webglShader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.__webglShader=s.__webglShader,a=le.acquireProgram(e,r,o),s.program=a,e.program=a}var c=a.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var d=0;d<Ct.maxMorphTargets;d++)c["morphTarget"+d]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(var d=0;d<Ct.maxMorphNormals;d++)c["morphNormal"+d]>=0&&e.numSupportedMorphNormals++}var p=s.__webglShader.uniforms;(e&&e.isShaderMaterial||e&&e.isRawShaderMaterial)&&e.clipping!==!0||(s.numClippingPlanes=Yt.numPlanes,p.clippingPlanes=Yt.uniform),s.fog=i,s.lightsHash=Qt.hash,e.lights&&(p.ambientLightColor.value=Qt.ambient,p.directionalLights.value=Qt.directional,p.spotLights.value=Qt.spot,p.pointLights.value=Qt.point,p.hemisphereLights.value=Qt.hemi,p.directionalShadowMap.value=Qt.directionalShadowMap,p.directionalShadowMatrix.value=Qt.directionalShadowMatrix,p.spotShadowMap.value=Qt.spotShadowMap,p.spotShadowMatrix.value=Qt.spotShadowMatrix,p.pointShadowMap.value=Qt.pointShadowMap,p.pointShadowMatrix.value=Qt.pointShadowMatrix);var f=s.program.getUniforms(),m=t.WebGLUniforms.seqWithValue(f.seq,p);s.uniformsList=m,s.dynamicUniforms=t.WebGLUniforms.splitDynamic(m,p)}function z(t){t.side!==Nn?re.enable(ee.CULL_FACE):re.disable(ee.CULL_FACE),re.setFlipSided(t.side===An),t.transparent===!0?re.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):re.setBlending(zn),re.setDepthFunc(t.depthFunc),re.setDepthTest(t.depthTest),re.setDepthWrite(t.depthWrite),re.setColorWrite(t.colorWrite),re.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function R(e,i,n,s){Ot=0;var r=oe.get(n);if(qt&&($t||e!==It)){var o=e===It&&n.id===Pt;Yt.setState(n.clippingPlanes,n.clipShadows,e,r,o)}n.needsUpdate===!1&&(void 0===r.program?n.needsUpdate=!0:n.fog&&r.fog!==i?n.needsUpdate=!0:n.lights&&r.lightsHash!==Qt.hash?n.needsUpdate=!0:void 0!==r.numClippingPlanes&&r.numClippingPlanes!==Yt.numPlanes&&(n.needsUpdate=!0)),n.needsUpdate&&(D(n,i,s),n.needsUpdate=!1);var a=!1,h=!1,l=!1,c=r.program,u=c.getUniforms(),d=r.__webglShader.uniforms;if(c.id!==At&&(ee.useProgram(c.program),At=c.id,a=!0,h=!0,l=!0),n.id!==Pt&&(Pt=n.id,h=!0),a||e!==It){if(u.set(ee,e,"projectionMatrix"),se.logarithmicDepthBuffer&&u.setValue(ee,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),e!==It&&(It=e,h=!0,l=!0),n&&n.isShaderMaterial||n&&n.isMeshPhongMaterial||n&&n.isMeshStandardMaterial||n.envMap){var p=u.map.cameraPosition;void 0!==p&&p.setValue(ee,Kt.setFromMatrixPosition(e.matrixWorld))}(n&&n.isMeshPhongMaterial||n&&n.isMeshLambertMaterial||n&&n.isMeshBasicMaterial||n&&n.isMeshStandardMaterial||n&&n.isShaderMaterial||n.skinning)&&u.setValue(ee,"viewMatrix",e.matrixWorldInverse),u.set(ee,Ct,"toneMappingExposure"),u.set(ee,Ct,"toneMappingWhitePoint")}if(n.skinning){u.setOptional(ee,s,"bindMatrix"),u.setOptional(ee,s,"bindMatrixInverse");var f=s.skeleton;f&&(se.floatVertexTextures&&f.useVertexTexture?(u.set(ee,f,"boneTexture"),u.set(ee,f,"boneTextureWidth"),u.set(ee,f,"boneTextureHeight")):u.setOptional(ee,f,"boneMatrices"))}h&&(n.lights&&X(d,l),i&&n.fog&&V(d,i),(n&&n.isMeshBasicMaterial||n&&n.isMeshLambertMaterial||n&&n.isMeshPhongMaterial||n&&n.isMeshStandardMaterial||n&&n.isMeshDepthMaterial)&&O(d,n),n&&n.isLineBasicMaterial?B(d,n):n&&n.isLineDashedMaterial?(B(d,n),F(d,n)):n&&n.isPointsMaterial?U(d,n):n&&n.isMeshLambertMaterial?H(d,n):n&&n.isMeshPhongMaterial?W(d,n):n&&n.isMeshPhysicalMaterial?G(d,n):n&&n.isMeshStandardMaterial?j(d,n):n&&n.isMeshDepthMaterial?n.displacementMap&&(d.displacementMap.value=n.displacementMap,d.displacementScale.value=n.displacementScale,d.displacementBias.value=n.displacementBias):n&&n.isMeshNormalMaterial&&(d.opacity.value=n.opacity),t.WebGLUniforms.upload(ee,r.uniformsList,d,Ct)),u.set(ee,s,"modelViewMatrix"),u.set(ee,s,"normalMatrix"),u.setValue(ee,"modelMatrix",s.matrixWorld);var m=r.dynamicUniforms;return null!==m&&(t.WebGLUniforms.evalDynamic(m,d,s,e),t.WebGLUniforms.upload(ee,m,d,Ct)),c}function O(t,e){t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var i;if(e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i){i&&i.isWebGLRenderTarget&&(i=i.texture);var n=i.offset,s=i.repeat;t.offsetRepeat.value.set(n.x,n.y,s.x,s.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}function B(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function F(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function U(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*Ht,t.scale.value=.5*K.clientHeight,t.map.value=e.map,null!==e.map){var i=e.map.offset,n=e.map.repeat;t.offsetRepeat.value.set(i.x,i.y,n.x,n.y)}}function V(t,e){t.fogColor.value=e.color,e&&e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e&&e.isFogExp2&&(t.fogDensity.value=e.density)}function H(t,e){e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function W(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function j(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function G(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,j(t,e)}function X(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function Y(t){for(var e=0,i=0,n=t.length;i<n;i++){var s=t[i];s.castShadow&&(Qt.shadows[e++]=s)}Qt.shadows.length=e}function q(t,e){var i,n,s,o,a,h,l,c=0,u=0,d=0,p=e.matrixWorldInverse,f=0,m=0,g=0,v=0;for(i=0,n=t.length;i<n;i++)if(s=t[i],o=s.color,a=s.intensity,h=s.distance,l=s.shadow&&s.shadow.map?s.shadow.map.texture:null,s&&s.isAmbientLight)c+=o.r*a,u+=o.g*a,d+=o.b*a;else if(s&&s.isDirectionalLight){var y=ce.get(s);y.color.copy(s.color).multiplyScalar(s.intensity),y.direction.setFromMatrixPosition(s.matrixWorld),Kt.setFromMatrixPosition(s.target.matrixWorld),y.direction.sub(Kt),y.direction.transformDirection(p),y.shadow=s.castShadow,s.castShadow&&(y.shadowBias=s.shadow.bias,y.shadowRadius=s.shadow.radius,y.shadowMapSize=s.shadow.mapSize),Qt.directionalShadowMap[f]=l,Qt.directionalShadowMatrix[f]=s.shadow.matrix,Qt.directional[f++]=y}else if(s&&s.isSpotLight){var y=ce.get(s);y.position.setFromMatrixPosition(s.matrixWorld),y.position.applyMatrix4(p),y.color.copy(o).multiplyScalar(a),y.distance=h,y.direction.setFromMatrixPosition(s.matrixWorld),Kt.setFromMatrixPosition(s.target.matrixWorld),y.direction.sub(Kt),y.direction.transformDirection(p),y.coneCos=Math.cos(s.angle),y.penumbraCos=Math.cos(s.angle*(1-s.penumbra)),y.decay=0===s.distance?0:s.decay,y.shadow=s.castShadow,s.castShadow&&(y.shadowBias=s.shadow.bias,y.shadowRadius=s.shadow.radius,y.shadowMapSize=s.shadow.mapSize),Qt.spotShadowMap[g]=l,Qt.spotShadowMatrix[g]=s.shadow.matrix,Qt.spot[g++]=y}else if(s&&s.isPointLight){var y=ce.get(s);y.position.setFromMatrixPosition(s.matrixWorld),y.position.applyMatrix4(p),y.color.copy(s.color).multiplyScalar(s.intensity),y.distance=s.distance,y.decay=0===s.distance?0:s.decay,y.shadow=s.castShadow,s.castShadow&&(y.shadowBias=s.shadow.bias,y.shadowRadius=s.shadow.radius,y.shadowMapSize=s.shadow.mapSize),Qt.pointShadowMap[m]=l,void 0===Qt.pointShadowMatrix[m]&&(Qt.pointShadowMatrix[m]=new r),Kt.setFromMatrixPosition(s.matrixWorld).negate(),Qt.pointShadowMatrix[m].identity().setPosition(Kt),Qt.point[m++]=y}else if(s&&s.isHemisphereLight){var y=ce.get(s);y.direction.setFromMatrixPosition(s.matrixWorld),y.direction.transformDirection(p),y.direction.normalize(),y.skyColor.copy(s.color).multiplyScalar(a),y.groundColor.copy(s.groundColor).multiplyScalar(a),Qt.hemi[v++]=y}Qt.ambient[0]=c,Qt.ambient[1]=u,Qt.ambient[2]=d,Qt.directional.length=f,Qt.spot.length=g,Qt.point.length=m,Qt.hemi.length=v,Qt.hash=f+","+m+","+g+","+v+","+Qt.shadows.length}function $(){var t=Ot;return t>=se.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+se.maxTextures),Ot+=1,t}function Z(t){var e;if(t===Cs)return ee.REPEAT;if(t===As)return ee.CLAMP_TO_EDGE;if(t===Ns)return ee.MIRRORED_REPEAT;if(t===Ls)return ee.NEAREST;if(t===Ps)return ee.NEAREST_MIPMAP_NEAREST;if(t===ks)return ee.NEAREST_MIPMAP_LINEAR;if(t===Is)return ee.LINEAR;if(t===Ds)return ee.LINEAR_MIPMAP_NEAREST;if(t===zs)return ee.LINEAR_MIPMAP_LINEAR;if(t===Rs)return ee.UNSIGNED_BYTE;if(t===js)return ee.UNSIGNED_SHORT_4_4_4_4;if(t===Gs)return ee.UNSIGNED_SHORT_5_5_5_1;if(t===Xs)return ee.UNSIGNED_SHORT_5_6_5;if(t===Os)return ee.BYTE;if(t===Bs)return ee.SHORT;if(t===Fs)return ee.UNSIGNED_SHORT;if(t===Us)return ee.INT;if(t===Vs)return ee.UNSIGNED_INT;if(t===Hs)return ee.FLOAT;if(e=ne.get("OES_texture_half_float"),null!==e&&t===Ws)return e.HALF_FLOAT_OES;if(t===qs)return ee.ALPHA;if(t===$s)return ee.RGB;if(t===Zs)return ee.RGBA;if(t===Js)return ee.LUMINANCE;if(t===Ks)return ee.LUMINANCE_ALPHA;if(t===tr)return ee.DEPTH_COMPONENT;if(t===er)return ee.DEPTH_STENCIL;if(t===Vn)return ee.FUNC_ADD;if(t===Hn)return ee.FUNC_SUBTRACT;if(t===Wn)return ee.FUNC_REVERSE_SUBTRACT;if(t===Xn)return ee.ZERO;if(t===Yn)return ee.ONE;if(t===qn)return ee.SRC_COLOR;if(t===$n)return ee.ONE_MINUS_SRC_COLOR;if(t===Zn)return ee.SRC_ALPHA;if(t===Jn)return ee.ONE_MINUS_SRC_ALPHA;if(t===Kn)return ee.DST_ALPHA;if(t===Qn)return ee.ONE_MINUS_DST_ALPHA;if(t===ts)return ee.DST_COLOR;if(t===es)return ee.ONE_MINUS_DST_COLOR;if(t===is)return ee.SRC_ALPHA_SATURATE;if(e=ne.get("WEBGL_compressed_texture_s3tc"),null!==e){if(t===ir)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===nr)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===sr)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===rr)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e=ne.get("WEBGL_compressed_texture_pvrtc"),null!==e){if(t===or)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===ar)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===hr)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===lr)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e=ne.get("WEBGL_compressed_texture_etc1"),null!==e&&t===cr)return e.COMPRESSED_RGB_ETC1_WEBGL;if(e=ne.get("EXT_blend_minmax"),null!==e){if(t===jn)return e.MIN_EXT;if(t===Gn)return e.MAX_EXT}return e=ne.get("WEBGL_depth_texture"),null!==e&&t===Ys?e.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer",gn),e=e||{};var K=void 0!==e.canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),ot=void 0!==e.context?e.context:null,ht=void 0!==e.alpha&&e.alpha,lt=void 0===e.depth||e.depth,ct=void 0===e.stencil||e.stencil,ft=void 0!==e.antialias&&e.antialias,vt=void 0===e.premultipliedAlpha||e.premultipliedAlpha,yt=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,xt=[],bt=[],wt=-1,_t=[],St=-1,Mt=new Float32Array(8),Tt=[],Et=[];this.domElement=K,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=ms,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Ct=this,At=null,Nt=null,Lt=null,Pt=-1,kt="",It=null,Dt=new p,zt=null,Rt=new p,Ot=0,Bt=new _(0),Ft=0,Ut=K.width,Vt=K.height,Ht=1,Wt=new p(0,0,Ut,Vt),jt=!1,Gt=new p(0,0,Ut,Vt),Xt=new A,Yt=new st,qt=!1,$t=!1,Zt=new T,Jt=new r,Kt=new a,Qt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},te={calls:0,vertices:0,faces:0,points:0};this.info={render:te,memory:{geometries:0,textures:0},programs:null};var ee;try{var ie={alpha:ht,depth:lt,stencil:ct,antialias:ft,premultipliedAlpha:vt,preserveDrawingBuffer:yt};if(ee=ot||K.getContext("webgl",ie)||K.getContext("experimental-webgl",ie),null===ee)throw null!==K.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===ee.getShaderPrecisionFormat&&(ee.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),K.addEventListener("webglcontextlost",l,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var ne=new it(ee);ne.get("WEBGL_depth_texture"),ne.get("OES_texture_float"),ne.get("OES_texture_float_linear"),ne.get("OES_texture_half_float"),ne.get("OES_texture_half_float_linear"),ne.get("OES_standard_derivatives"),ne.get("ANGLE_instanced_arrays"),ne.get("OES_element_index_uint")&&(J.MaxIndex=4294967296);var se=new et(ee,ne,e),re=new f(ee,ne,Z),oe=new L,ae=new d(ee,ne,re,oe,se,Z,this.info),he=new Q(ee,oe,this.info),le=new P(this,se),ce=new tt;this.info.programs=le.programs;var ue=new rt(ee,ne,te),de=new nt(ee,ne,te),pe=new gt(-1,1,1,-1,0,1),fe=new mt,me=new dt(new pt(2,2),new ut({depthTest:!1,depthWrite:!1,fog:!1})),ge=t.ShaderLib.cube,ve=new dt(new at(5,5,5),new w({uniforms:ge.uniforms,vertexShader:ge.vertexShader,fragmentShader:ge.fragmentShader,side:An,depthTest:!1,depthWrite:!1,fog:!1}));s(),this.context=ee,this.capabilities=se,this.extensions=ne,this.properties=oe,this.state=re;var ye=new N(this,Qt,he,se);this.shadowMap=ye;var xe=new h(this,Tt),be=new c(this,Et);this.getContext=function(){return ee},this.getContextAttributes=function(){return ee.getContextAttributes()},this.forceContextLoss=function(){ne.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return se.getMaxAnisotropy()},this.getPrecision=function(){return se.precision},this.getPixelRatio=function(){return Ht},this.setPixelRatio=function(t){void 0!==t&&(Ht=t,this.setSize(Gt.z,Gt.w,!1))},this.getSize=function(){return{width:Ut,height:Vt}},this.setSize=function(t,e,i){Ut=t,Vt=e,K.width=t*Ht,K.height=e*Ht,i!==!1&&(K.style.width=t+"px",K.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,i,n){re.viewport(Gt.set(t,e,i,n))},this.setScissor=function(t,e,i,n){re.scissor(Wt.set(t,e,i,n))},this.setScissorTest=function(t){re.setScissorTest(jt=t)},this.getClearColor=function(){return Bt},this.setClearColor=function(t,e){Bt.set(t),Ft=void 0!==e?e:1,n(Bt.r,Bt.g,Bt.b,Ft)},this.getClearAlpha=function(){return Ft},this.setClearAlpha=function(t){Ft=t,n(Bt.r,Bt.g,Bt.b,Ft)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=ee.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=ee.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=ee.STENCIL_BUFFER_BIT),ee.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.resetGLState=o,this.dispose=function(){_t=[],St=-1,bt=[],wt=-1,K.removeEventListener("webglcontextlost",l,!1)},this.renderBufferImmediate=function(t,e,i){re.initAttributes();var n=oe.get(t);t.hasPositions&&!n.position&&(n.position=ee.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=ee.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=ee.createBuffer()),t.hasColors&&!n.color&&(n.color=ee.createBuffer());var s=e.getAttributes();if(t.hasPositions&&(ee.bindBuffer(ee.ARRAY_BUFFER,n.position),ee.bufferData(ee.ARRAY_BUFFER,t.positionArray,ee.DYNAMIC_DRAW),re.enableAttribute(s.position),ee.vertexAttribPointer(s.position,3,ee.FLOAT,!1,0,0)),t.hasNormals){if(ee.bindBuffer(ee.ARRAY_BUFFER,n.normal),"MeshPhongMaterial"!==i.type&&"MeshStandardMaterial"!==i.type&&"MeshPhysicalMaterial"!==i.type&&i.shading===Ln)for(var r=0,o=3*t.count;r<o;r+=9){var a=t.normalArray,h=(a[r+0]+a[r+3]+a[r+6])/3,l=(a[r+1]+a[r+4]+a[r+7])/3,c=(a[r+2]+a[r+5]+a[r+8])/3;a[r+0]=h,a[r+1]=l,a[r+2]=c,a[r+3]=h,a[r+4]=l,a[r+5]=c,a[r+6]=h,a[r+7]=l,a[r+8]=c}ee.bufferData(ee.ARRAY_BUFFER,t.normalArray,ee.DYNAMIC_DRAW),re.enableAttribute(s.normal),ee.vertexAttribPointer(s.normal,3,ee.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(ee.bindBuffer(ee.ARRAY_BUFFER,n.uv),ee.bufferData(ee.ARRAY_BUFFER,t.uvArray,ee.DYNAMIC_DRAW),re.enableAttribute(s.uv),ee.vertexAttribPointer(s.uv,2,ee.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==kn&&(ee.bindBuffer(ee.ARRAY_BUFFER,n.color),ee.bufferData(ee.ARRAY_BUFFER,t.colorArray,ee.DYNAMIC_DRAW),re.enableAttribute(s.color),ee.vertexAttribPointer(s.color,3,ee.FLOAT,!1,0,0)),re.disableUnusedAttributes(),ee.drawArrays(ee.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,s,r,o){z(s);var a=R(t,e,s,r),h=!1,l=n.id+"_"+a.id+"_"+s.wireframe;l!==kt&&(kt=l,h=!0);var c=r.morphTargetInfluences;if(void 0!==c){for(var u=[],d=0,p=c.length;d<p;d++){var f=c[d];u.push([f,d])}u.sort(y),u.length>8&&(u.length=8);for(var m=n.morphAttributes,d=0,p=u.length;d<p;d++){var f=u[d];if(Mt[d]=f[0],0!==f[0]){var g=f[1];s.morphTargets===!0&&m.position&&n.addAttribute("morphTarget"+d,m.position[g]),s.morphNormals===!0&&m.normal&&n.addAttribute("morphNormal"+d,m.normal[g])}else s.morphTargets===!0&&n.removeAttribute("morphTarget"+d),s.morphNormals===!0&&n.removeAttribute("morphNormal"+d)}a.getUniforms().setValue(ee,"morphTargetInfluences",Mt),h=!0}var g=n.index,x=n.attributes.position;s.wireframe===!0&&(g=he.getWireframeAttribute(n));var b;null!==g?(b=de,b.setIndex(g)):b=ue,h&&(v(s,a,n),null!==g&&ee.bindBuffer(ee.ELEMENT_ARRAY_BUFFER,he.getAttributeBuffer(g)));var w=0,_=1/0;null!==g?_=g.count:void 0!==x&&(_=x.count);var S=n.drawRange.start,M=n.drawRange.count,T=null!==o?o.start:0,E=null!==o?o.count:1/0,C=Math.max(w,S,T),A=Math.min(w+_,S+M,T+E)-1,N=Math.max(0,A-C+1);if(r.isMesh)if(s.wireframe===!0)re.setLineWidth(s.wireframeLinewidth*i()),b.setMode(ee.LINES);else switch(r.drawMode){case br:b.setMode(ee.TRIANGLES);break;case wr:b.setMode(ee.TRIANGLE_STRIP);break;case _r:b.setMode(ee.TRIANGLE_FAN)}else if(r.isLine){var L=s.linewidth;void 0===L&&(L=1),re.setLineWidth(L*i()),r.isLineSegments?b.setMode(ee.LINES):b.setMode(ee.LINE_STRIP)}else r.isPoints&&b.setMode(ee.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&b.renderInstances(n,C,N):b.render(C,N)},this.render=function(t,e,i,s){if((e&&e.isCamera)===!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var r=t.fog;kt="",Pt=-1,It=null,t.autoUpdate===!0&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),Jt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Xt.setFromMatrix(Jt),xt.length=0,wt=-1,St=-1,Tt.length=0,Et.length=0,$t=this.localClippingEnabled,qt=Yt.init(this.clippingPlanes,$t,e),k(t,e),bt.length=wt+1,_t.length=St+1,Ct.sortObjects===!0&&(bt.sort(x),_t.sort(b)),qt&&Yt.beginShadows(),Y(xt),ye.render(t,e),q(xt,e),qt&&Yt.endShadows(),te.calls=0,te.vertices=0,te.faces=0,te.points=0,void 0===i&&(i=null),this.setRenderTarget(i);var o=t.background;if(null===o?n(Bt.r,Bt.g,Bt.b,Ft):o&&o.isColor&&(n(o.r,o.g,o.b,1),s=!0),(this.autoClear||s)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),o&&o.isCubeTexture?(fe.projectionMatrix.copy(e.projectionMatrix),fe.matrixWorld.extractRotation(e.matrixWorld),fe.matrixWorldInverse.getInverse(fe.matrixWorld),ve.material.uniforms.tCube.value=o,ve.modelViewMatrix.multiplyMatrices(fe.matrixWorldInverse,ve.matrixWorld),he.update(ve),Ct.renderBufferDirect(fe,null,ve.geometry,ve.material,ve,null)):o&&o.isTexture&&(me.material.map=o,he.update(me),Ct.renderBufferDirect(pe,null,me.geometry,me.material,me,null)),t.overrideMaterial){var a=t.overrideMaterial;I(bt,e,r,a),I(_t,e,r,a)}else re.setBlending(zn),I(bt,e,r),I(_t,e,r);xe.render(t,e),be.render(t,e,Rt),i&&ae.updateRenderTargetMipmap(i),re.setDepthTest(!0),re.setDepthWrite(!0),re.setColorWrite(!0)},this.setFaceCulling=function(t,e){re.setCullFace(t),re.setFlipSided(e===_n)},this.allocTextureUnit=$,this.setTexture2D=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),ae.setTexture2D(e,i)}}(),this.setTexture=function(){var t=!1;return function(e,i){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),ae.setTexture2D(e,i)}}(),this.setTextureCube=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?ae.setTextureCube(e,i):ae.setTextureCubeDynamic(e,i)}}(),this.getCurrentRenderTarget=function(){return Nt},this.setRenderTarget=function(t){Nt=t,t&&void 0===oe.get(t).__webglFramebuffer&&ae.setupRenderTarget(t);var e,i=t&&t.isWebGLRenderTargetCube;if(t){var n=oe.get(t);e=i?n.__webglFramebuffer[t.activeCubeFace]:n.__webglFramebuffer,Dt.copy(t.scissor),zt=t.scissorTest,Rt.copy(t.viewport)}else e=null,Dt.copy(Wt).multiplyScalar(Ht),zt=jt,Rt.copy(Gt).multiplyScalar(Ht);if(Lt!==e&&(ee.bindFramebuffer(ee.FRAMEBUFFER,e),Lt=e),re.scissor(Dt),re.setScissorTest(zt),re.viewport(Rt),i){var s=oe.get(t.texture);ee.framebufferTexture2D(ee.FRAMEBUFFER,ee.COLOR_ATTACHMENT0,ee.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,s.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,i,n,s,r){if((t&&t.isWebGLRenderTarget)===!1)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var o=oe.get(t).__webglFramebuffer;if(o){var a=!1;o!==Lt&&(ee.bindFramebuffer(ee.FRAMEBUFFER,o),a=!0);try{var h=t.texture;if(h.format!==Zs&&Z(h.format)!==ee.getParameter(ee.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h.type===Rs||Z(h.type)===ee.getParameter(ee.IMPLEMENTATION_COLOR_READ_TYPE)||h.type===Hs&&ne.get("WEBGL_color_buffer_float")||h.type===Ws&&ne.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ee.checkFramebufferStatus(ee.FRAMEBUFFER)===ee.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-n&&i>=0&&i<=t.height-s&&ee.readPixels(e,i,n,s,Z(h.format),Z(h.type),r):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&ee.bindFramebuffer(ee.FRAMEBUFFER,Lt)}}}}function yt(t,e){this.name="",this.color=new _(t),this.density=void 0!==e?e:25e-5}function xt(t,e,i){this.name="",this.color=new _(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function bt(){X.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function wt(t,e,i,n,s){X.call(this),this.lensFlares=[],this.positionScreen=new a,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,i,n,s)}function _t(t){x.call(this),this.type="SpriteMaterial",this.color=new _(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function St(t){X.call(this),this.type="Sprite",this.material=void 0!==t?t:new _t}function Mt(){X.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Tt(t,e,i,s,r,o,a,h,l,c,u,d){n.call(this,null,o,a,h,l,c,s,r,u,d),this.image={data:t,width:e,height:i},this.magFilter=void 0!==l?l:Ls,this.minFilter=void 0!==c?c:Ls,this.flipY=!1,this.generateMipmaps=!1}function Et(e,i,n){if(this.useVertexTexture=void 0===n||n,this.identityMatrix=new r,e=e||[],this.bones=e.slice(0),this.useVertexTexture){var s=Math.sqrt(4*this.bones.length);s=t.Math.nextPowerOfTwo(Math.ceil(s)),s=Math.max(s,4),this.boneTextureWidth=s,this.boneTextureHeight=s,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new Tt(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,Zs,Hs)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===i)this.calculateInverses();else if(this.bones.length===i.length)this.boneInverses=i.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var o=0,a=this.bones.length;o<a;o++)this.boneInverses.push(new r)}}function Ct(t){X.call(this),this.type="Bone",this.skin=t}function At(t,e,i){dt.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new r,this.bindMatrixInverse=new r;var n=[];if(this.geometry&&void 0!==this.geometry.bones){for(var s,o,a=0,h=this.geometry.bones.length;a<h;++a)o=this.geometry.bones[a],s=new Ct(this),n.push(s),s.name=o.name,s.position.fromArray(o.pos),s.quaternion.fromArray(o.rotq),void 0!==o.scl&&s.scale.fromArray(o.scl);for(var a=0,h=this.geometry.bones.length;a<h;++a)o=this.geometry.bones[a],o.parent!==-1&&null!==o.parent&&void 0!==n[o.parent]?n[o.parent].add(n[a]):this.add(n[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new Et(n,void 0,i),this.matrixWorld)}function Nt(t){x.call(this),this.type="LineBasicMaterial",this.color=new _(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function Lt(t,e,i){return 1===i?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Pt(t,e)):(X.call(this),this.type="Line",this.geometry=void 0!==t?t:new J,void(this.material=void 0!==e?e:new Nt({color:16777215*Math.random()})))}function Pt(t,e){Lt.call(this,t,e),this.type="LineSegments"}function kt(t){x.call(this),this.type="PointsMaterial",this.color=new _(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function It(t,e){X.call(this),this.type="Points",this.geometry=void 0!==t?t:new J,this.material=void 0!==e?e:new kt({color:16777215*Math.random()})}function Dt(){X.call(this),this.type="Group"}function zt(t,e,i,s,r,o,a,h,l){function c(){requestAnimationFrame(c),
t.readyState>=t.HAVE_CURRENT_DATA&&(u.needsUpdate=!0)}n.call(this,t,e,i,s,r,o,a,h,l),this.generateMipmaps=!1;var u=this;c()}function Rt(t,e,i,s,r,o,a,h,l,c,u,d){n.call(this,null,o,a,h,l,c,s,r,u,d),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Ot(t,e,i,s,r,o,a,h,l){n.call(this,t,e,i,s,r,o,a,h,l),this.needsUpdate=!0}function Bt(t,e,i,s,r,o,a,h,l,c){if(c=void 0!==c?c:tr,c!==tr&&c!==er)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n.call(this,null,s,r,o,a,h,c,i,l),this.image={width:t,height:e},this.type=void 0!==i?i:Fs,this.magFilter=void 0!==a?a:Ls,this.minFilter=void 0!==h?h:Ls,this.flipY=!1,this.generateMipmaps=!1}function Ft(){w.call(this,{uniforms:t.UniformsUtils.merge([t.UniformsLib.lights,{opacity:{value:1}}]),vertexShader:Ia.shadow_vert,fragmentShader:Ia.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}}})}function Ut(t){w.call(this,t),this.type="RawShaderMaterial"}function Vt(e){this.uuid=t.Math.generateUUID(),this.type="MultiMaterial",this.materials=e instanceof Array?e:[],this.visible=!0}function Ht(t){x.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new _(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Wt(t){Ht.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function jt(t){x.call(this),this.type="MeshPhongMaterial",this.color=new _(16777215),this.specular=new _(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=us,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Gt(t){x.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.morphTargets=!1,this.setValues(t)}function Xt(t){x.call(this),this.type="MeshLambertMaterial",this.color=new _(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=us,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Yt(t){x.call(this),this.type="LineDashedMaterial",this.color=new _(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(t)}function qt(t,e,i){var n=this,s=!1,r=0,o=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){o++,s===!1&&void 0!==n.onStart&&n.onStart(t,r,o),s=!0},this.itemEnd=function(t){r++,void 0!==n.onProgress&&n.onProgress(t,r,o),r===o&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)}}function $t(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function Zt(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this._parser=null}function Jt(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this._parser=null}function Kt(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function Qt(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function te(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function ee(t,e){X.call(this),this.type="Light",this.color=new _(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function ie(t,e,i){ee.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(X.DefaultUp),this.updateMatrix(),this.groundColor=new _(e)}function ne(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new i(512,512),this.map=null,this.matrix=new r}function se(){ne.call(this,new mt(50,1,.5,500))}function re(t,e,i,n,s,r){ee.call(this,t,e),this.type="SpotLight",this.position.copy(X.DefaultUp),this.updateMatrix(),this.target=new X,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==s?s:0,this.decay=void 0!==r?r:1,this.shadow=new se}function oe(t,e,i,n){ee.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new ne(new mt(90,1,.5,500))}function ae(t){ne.call(this,new gt(-5,5,5,-5,.5,500))}function he(t,e){ee.call(this,t,e),this.type="DirectionalLight",this.position.copy(X.DefaultUp),this.updateMatrix(),this.target=new X,this.shadow=new ae}function le(t,e){ee.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function ce(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function ue(t,e,i,n){ce.call(this,t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function de(t,e,i,n){ce.call(this,t,e,i,n)}function pe(t,e,i,n){ce.call(this,t,e,i,n)}function fe(e,i,n,s){if(void 0===e)throw new Error("track name is undefined");if(void 0===i||0===i.length)throw new Error("no keyframes in track named "+e);this.name=e,this.times=t.AnimationUtils.convertArray(i,this.TimeBufferType),this.values=t.AnimationUtils.convertArray(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation),this.validate(),this.optimize()}function me(t,e,i,n){fe.call(this,t,e,i,n)}function ge(t,e,i,n){ce.call(this,t,e,i,n)}function ve(t,e,i,n){fe.call(this,t,e,i,n)}function ye(t,e,i,n){fe.call(this,t,e,i,n)}function xe(t,e,i,n){fe.call(this,t,e,i,n)}function be(t,e,i){fe.call(this,t,e,i)}function we(t,e,i,n){fe.call(this,t,e,i,n)}function _e(t,e,i,n){fe.apply(this,arguments)}function Se(e,i,n){this.name=e,this.tracks=n,this.duration=void 0!==i?i:-1,this.uuid=t.Math.generateUUID(),this.duration<0&&this.resetDuration(),this.trim(),this.optimize()}function Me(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this.textures={}}function Te(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function Ee(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function Ce(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:t.DefaultLoadingManager,this.withCredentials=!1}function Ae(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this.texturePath=""}function Ne(){}function Le(t,e){this.v1=t,this.v2=e}function Pe(){this.curves=[],this.autoClose=!1}function ke(t,e,i,n,s,r,o,a){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=s,this.aEndAngle=r,this.aClockwise=o,this.aRotation=a||0}function Ie(t){this.points=void 0===t?[]:t}function De(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n}function ze(t,e,i){this.v0=t,this.v1=e,this.v2=i}function Re(t,e,n,s,r,o){function h(t,e,i){return P.vertices.push(new a(t,e,i))-1}q.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:n,radialSegments:s,closed:r,taper:o},e=e||64,n=n||1,s=s||8,r=r||!1,o=o||Re.NoTaper;var l,c,u,d,p,f,m,g,v,y,x,b,w,_,S,M,T,E,C,A,N,L=[],P=this,k=e+1,I=new a,D=new Re.FrenetFrames(t,e,r),z=D.tangents,R=D.normals,O=D.binormals;for(this.tangents=z,this.normals=R,this.binormals=O,y=0;y<k;y++)for(L[y]=[],d=y/(k-1),v=t.getPointAt(d),l=z[y],c=R[y],u=O[y],f=n*o(d),x=0;x<s;x++)p=x/s*2*Math.PI,m=-f*Math.cos(p),g=f*Math.sin(p),I.copy(v),I.x+=m*c.x+g*u.x,I.y+=m*c.y+g*u.y,I.z+=m*c.z+g*u.z,L[y][x]=h(I.x,I.y,I.z);for(y=0;y<e;y++)for(x=0;x<s;x++)b=r?(y+1)%e:y+1,w=(x+1)%s,_=L[y][x],S=L[b][x],M=L[b][w],T=L[y][w],E=new i(y/e,x/s),C=new i((y+1)/e,x/s),A=new i((y+1)/e,(x+1)/s),N=new i(y/e,(x+1)/s),this.faces.push(new W(_,S,T)),this.faceVertexUvs[0].push([E,C,N]),this.faces.push(new W(S,M,T)),this.faceVertexUvs[0].push([C.clone(),A,N.clone()]);this.computeFaceNormals(),this.computeVertexNormals()}function Oe(t,e){return"undefined"==typeof t?void(t=[]):(q.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),void this.computeFaceNormals())}function Be(t,e){q.call(this),this.type="ShapeGeometry",Array.isArray(t)===!1&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()}function Fe(){Ue.apply(this,arguments),this.holes=[]}function Ue(t){Pe.call(this),this.currentPoint=new i,t&&this.fromPoints(t)}function Ve(){this.subPaths=[],this.currentPath=null}function He(t){this.data=t}function We(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function je(){return void 0===Fa&&(Fa=new(window.AudioContext||window.webkitAudioContext)),Fa}function Ge(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function Xe(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new mt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new mt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Ye(t,e,i){X.call(this),this.type="CubeCamera";var n=90,s=1,r=new mt(n,s,t,e);r.up.set(0,-1,0),r.lookAt(new a(1,0,0)),this.add(r);var o=new mt(n,s,t,e);o.up.set(0,-1,0),o.lookAt(new a(-1,0,0)),this.add(o);var h=new mt(n,s,t,e);h.up.set(0,0,1),h.lookAt(new a(0,1,0)),this.add(h);var l=new mt(n,s,t,e);l.up.set(0,0,-1),l.lookAt(new a(0,-1,0)),this.add(l);var c=new mt(n,s,t,e);c.up.set(0,-1,0),c.lookAt(new a(0,0,1)),this.add(c);var u=new mt(n,s,t,e);u.up.set(0,-1,0),u.lookAt(new a(0,0,-1)),this.add(u);var d={format:$s,magFilter:Is,minFilter:Is};this.renderTarget=new ot(i,i,d),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,n=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,r,i),i.activeCubeFace=1,t.render(e,o,i),i.activeCubeFace=2,t.render(e,h,i),i.activeCubeFace=3,t.render(e,l,i),i.activeCubeFace=4,t.render(e,c,i),i.texture.generateMipmaps=n,i.activeCubeFace=5,t.render(e,u,i),t.setRenderTarget(null)}}function qe(){X.call(this),this.type="AudioListener",this.context=je(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function $e(t){X.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ze(t){$e.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Je(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Ke(t,e,i){this.binding=t,this.valueSize=i;var n,s=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":s=Array,n=this._select;break;default:n=this._lerp}this.buffer=new s(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Qe(t,e,i){this.path=e,this.parsedPath=i||Qe.parseTrackName(e),this.node=Qe.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function ti(e){this.uuid=t.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var i={};this._indicesByUUID=i;for(var n=0,s=arguments.length;n!==s;++n)i[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function ei(){throw new Error("THREE.AnimationAction: Use mixer.clipAction for construction.")}function ii(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function ni(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t,this.dynamic=!1}function si(){J.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ri(e,i,n,s){this.uuid=t.Math.generateUUID(),this.data=e,this.itemSize=i,this.offset=n,this.normalized=s===!0}function oi(e,i){this.uuid=t.Math.generateUUID(),this.array=e,this.stride=i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function ai(t,e,i){oi.call(this,t,e),this.meshPerAttribute=i||1}function hi(t,e,i){k.call(this,t,e),this.meshPerAttribute=i||1}function li(t,e,i,n){this.ray=new ht(t,e),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ci(t,e){return t.distance-e.distance}function ui(t,e,i,n){if(t.visible!==!1&&(t.raycast(e,i),n===!0))for(var s=t.children,r=0,o=s.length;r<o;r++)ui(s[r],e,i,!0)}function di(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function pi(t){function e(t,e,i,n,s,r,o){var a=.5*(i-t),h=.5*(n-e);return(2*(e-i)+a+h)*o+(-3*(e-i)-2*a-h)*r+a*s+e}this.points=t;var i,n,s,r,o,h,l,c,u,d=[],p={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return i=(this.points.length-1)*t,n=Math.floor(i),s=i-n,d[0]=0===n?n:n-1,d[1]=n,d[2]=n>this.points.length-2?this.points.length-1:n+1,d[3]=n>this.points.length-3?this.points.length-1:n+2,h=this.points[d[0]],l=this.points[d[1]],c=this.points[d[2]],u=this.points[d[3]],r=s*s,o=s*r,p.x=e(h.x,l.x,c.x,u.x,s,r,o),p.y=e(h.y,l.y,c.y,u.y,s,r,o),p.z=e(h.z,l.z,c.z,u.z,s,r,o),p},this.getControlPointsArray=function(){var t,e,i=this.points.length,n=[];for(t=0;t<i;t++)e=this.points[t],n[t]=[e.x,e.y,e.z];return n},this.getLength=function(t){var e,i,n,s,r=0,o=0,h=0,l=new a,c=new a,u=[],d=0;for(u[0]=0,t||(t=100),n=this.points.length*t,l.copy(this.points[0]),e=1;e<n;e++)i=e/n,s=this.getPoint(i),c.copy(s),d+=c.distanceTo(l),l.copy(s),r=(this.points.length-1)*i,o=Math.floor(r),o!==h&&(u[o]=d,h=o);return u[u.length]=d,{chunks:u,total:d}},this.reparametrizeByArcLength=function(t){var e,i,n,s,r,o,h,l,c=[],u=new a,d=this.getLength();for(c.push(u.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(o=d.chunks[e]-d.chunks[e-1],h=Math.ceil(t*o/d.total),s=(e-1)/(this.points.length-1),r=e/(this.points.length-1),i=1;i<h-1;i++)n=s+i*(1/h)*(r-s),l=this.getPoint(n),c.push(u.copy(l).clone());c.push(u.copy(this.points[e]).clone())}this.points=c}}function fi(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function mi(t,e){dt.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n="__default",s=0,r=i-1,o=i/1;this.createAnimation(n,s,r,o),this.setAnimationWeight(n,1)}function gi(t){X.call(this),this.material=t,this.render=function(t){}}function vi(t){function e(t,e){return t-e}J.call(this);var i=[0,0],n={},s=["a","b","c"];if(t&&t.isGeometry){for(var r=t.vertices,o=t.faces,a=0,h=new Uint32Array(6*o.length),l=0,c=o.length;l<c;l++)for(var u=o[l],d=0;d<3;d++){i[0]=u[s[d]],i[1]=u[s[(d+1)%3]],i.sort(e);var p=i.toString();void 0===n[p]&&(h[2*a]=i[0],h[2*a+1]=i[1],n[p]=!0,a++)}for(var f=new Float32Array(2*a*3),l=0,c=a;l<c;l++)for(var d=0;d<2;d++){var m=r[h[2*l+d]],g=6*l+3*d;f[g+0]=m.x,f[g+1]=m.y,f[g+2]=m.z}this.addAttribute("position",new k(f,3))}else if(t&&t.isBufferGeometry)if(null!==t.index){var v=t.index.array,r=t.attributes.position,y=t.groups,a=0;0===y.length&&t.addGroup(0,v.length);for(var h=new Uint32Array(2*v.length),x=0,b=y.length;x<b;++x)for(var w=y[x],_=w.start,S=w.count,l=_,M=_+S;l<M;l+=3)for(var d=0;d<3;d++){i[0]=v[l+d],i[1]=v[l+(d+1)%3],i.sort(e);var p=i.toString();void 0===n[p]&&(h[2*a]=i[0],h[2*a+1]=i[1],n[p]=!0,a++)}for(var f=new Float32Array(2*a*3),l=0,c=a;l<c;l++)for(var d=0;d<2;d++){var g=6*l+3*d,T=h[2*l+d];f[g+0]=r.getX(T),f[g+1]=r.getY(T),f[g+2]=r.getZ(T)}this.addAttribute("position",new k(f,3))}else{for(var r=t.attributes.position.array,a=r.length/3,E=a/3,f=new Float32Array(2*a*3),l=0,c=E;l<c;l++)for(var d=0;d<3;d++){var g=18*l+6*d,C=9*l+3*d;f[g+0]=r[C],f[g+1]=r[C+1],f[g+2]=r[C+2];var T=9*l+3*((d+1)%3);f[g+3]=r[T],f[g+4]=r[T+1],f[g+5]=r[T+2]}this.addAttribute("position",new k(f,3))}}function yi(t,e){var i=void 0!==e?e:16777215;Pt.call(this,new vi(t.geometry),new Nt({color:i})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function xi(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var s=void 0!==i?i:16711680,r=void 0!==n?n:1,o=0,a=this.object.geometry;a&&a.isGeometry?o=3*a.faces.length:a&&a.isBufferGeometry&&(o=a.attributes.normal.count);var h=new J,l=new U(2*o*3,3);h.addAttribute("position",l),Pt.call(this,h,new Nt({color:s,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function bi(t){X.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;for(var e=new J,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,s=1,r=32;n<r;n++,s++){var o=n/r*Math.PI*2,a=s/r*Math.PI*2;i.push(Math.cos(o),Math.sin(o),1,Math.cos(a),Math.sin(a),1)}e.addAttribute("position",new U(i,3));var h=new Nt({fog:!1});this.cone=new Pt(e,h),this.add(this.cone),this.update()}function wi(t){this.bones=this.getBoneList(t);for(var e=new q,i=0;i<this.bones.length;i++){var n=this.bones[i];n.parent&&n.parent.isBone&&(e.vertices.push(new a),e.vertices.push(new a),e.colors.push(new _(0,0,1)),e.colors.push(new _(0,1,0)))}e.dynamic=!0;var s=new Nt({vertexColors:Dn,depthTest:!1,depthWrite:!1,transparent:!0});Pt.call(this,e,s),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function _i(t,e,i,n,s,r,o){J.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:s,thetaStart:r,thetaLength:o},t=t||50,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,s=void 0!==s?s:2*Math.PI,r=void 0!==r?r:0,o=void 0!==o?o:Math.PI;for(var h=r+o,l=(e+1)*(i+1),c=new k(new Float32Array(3*l),3),u=new k(new Float32Array(3*l),3),d=new k(new Float32Array(2*l),2),p=0,f=[],m=new a,g=0;g<=i;g++){for(var v=[],y=g/i,x=0;x<=e;x++){var b=x/e,w=-t*Math.cos(n+b*s)*Math.sin(r+y*o),_=t*Math.cos(r+y*o),S=t*Math.sin(n+b*s)*Math.sin(r+y*o);m.set(w,_,S).normalize(),c.setXYZ(p,w,_,S),u.setXYZ(p,m.x,m.y,m.z),d.setXY(p,b,1-y),v.push(p),p++}f.push(v)}for(var M=[],g=0;g<i;g++)for(var x=0;x<e;x++){var E=f[g][x+1],C=f[g][x],A=f[g+1][x],N=f[g+1][x+1];(0!==g||r>0)&&M.push(E,C,N),(g!==i-1||h<Math.PI)&&M.push(C,A,N)}this.setIndex(new(c.count>65535?F:O)(M,1)),this.addAttribute("position",c),this.addAttribute("normal",u),this.addAttribute("uv",d),this.boundingSphere=new T(new a,t)}function Si(t,e){this.light=t,this.light.updateMatrixWorld();var i=new _i(e,4,2),n=new ut({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),dt.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Mi(t,e,i,n,s,r,o){q.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:s,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new _i(t,e,i,n,s,r,o))}function Ti(t,e){X.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new _,new _];var i=new Mi(e,4,2);i.rotateX(-Math.PI/2);for(var n=0,s=8;n<s;n++)i.faces[n].color=this.colors[n<4?0:1];var r=new ut({vertexColors:In,wireframe:!0});this.lightSphere=new dt(i,r),this.add(this.lightSphere),this.update()}function Ei(t,e,i,n){e=e||1,i=new _(void 0!==i?i:4473924),n=new _(void 0!==n?n:8947848);for(var s=e/2,r=2*t/e,o=[],a=[],h=0,l=0,c=-t;h<=e;h++,c+=r){o.push(-t,0,c,t,0,c),o.push(c,0,-t,c,0,t);var u=h===s?i:n;u.toArray(a,l),l+=3,u.toArray(a,l),l+=3,u.toArray(a,l),l+=3,u.toArray(a,l),l+=3}var d=new J;d.addAttribute("position",new U(o,3)),d.addAttribute("color",new U(a,3));var p=new Nt({vertexColors:Dn});Pt.call(this,d,p)}function Ci(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var s=void 0!==i?i:16776960,r=void 0!==n?n:1,o=0,a=this.object.geometry;a&&a.isGeometry?o=a.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var h=new J,l=new U(2*o*3,3);h.addAttribute("position",l),Pt.call(this,h,new Nt({color:s,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function Ai(e,i){function n(t,e){return t-e}J.call(this),i=void 0!==i?i:1;var s,r=Math.cos(t.Math.DEG2RAD*i),o=[0,0],a={},h=["a","b","c"];e&&e.isBufferGeometry?(s=new q,s.fromBufferGeometry(e)):s=e.clone(),s.mergeVertices(),s.computeFaceNormals();for(var l=s.vertices,c=s.faces,u=0,d=c.length;u<d;u++)for(var p=c[u],f=0;f<3;f++){o[0]=p[h[f]],o[1]=p[h[(f+1)%3]],o.sort(n);var m=o.toString();void 0===a[m]?a[m]={vert1:o[0],vert2:o[1],face1:u,face2:void 0}:a[m].face2=u}var g=[];for(var m in a){var v=a[m];if(void 0===v.face2||c[v.face1].normal.dot(c[v.face2].normal)<=r){var y=l[v.vert1];g.push(y.x),g.push(y.y),g.push(y.z),y=l[v.vert2],g.push(y.x),g.push(y.y),g.push(y.z)}}this.addAttribute("position",new k(new Float32Array(g),3))}function Ni(t,e,i){var n=void 0!==e?e:16777215;Pt.call(this,new Ai(t.geometry,i),new Nt({color:n})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Li(t,e){X.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,void 0===e&&(e=1);var i=new J;i.addAttribute("position",new U([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var n=new Nt({fog:!1});this.add(new Lt(i,n)),i=new J,i.addAttribute("position",new U([0,0,0,0,0,1],3)),this.add(new Lt(i,n)),this.update()}function Pi(t){function e(t,e,n){i(t,n),i(e,n)}function i(t,e){n.vertices.push(new a),n.colors.push(new _(e)),void 0===r[t]&&(r[t]=[]),r[t].push(n.vertices.length-1)}var n=new q,s=new Nt({color:16777215,vertexColors:In}),r={},o=16755200,h=16711680,l=43775,c=16777215,u=3355443;e("n1","n2",o),e("n2","n4",o),e("n4","n3",o),e("n3","n1",o),e("f1","f2",o),e("f2","f4",o),e("f4","f3",o),e("f3","f1",o),e("n1","f1",o),e("n2","f2",o),e("n3","f3",o),e("n4","f4",o),e("p","n1",h),e("p","n2",h),e("p","n3",h),e("p","n4",h),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",c),e("p","c",u),e("cn1","cn2",u),e("cn3","cn4",u),e("cf1","cf2",u),e("cf3","cf4",u),Pt.call(this,n,s),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=r,this.update()}function ki(t,e,i,n,s,r){q.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:s,depthSegments:r},this.fromBufferGeometry(new at(t,e,i,n,s,r)),this.mergeVertices()}function Ii(t,e){var i=void 0!==e?e:8947848;this.object=t,this.box=new M,dt.call(this,new ki(1,1,1),new ut({color:i,wireframe:!0}))}function Di(t,e){void 0===e&&(e=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),s=new J;s.setIndex(new k(i,1)),s.addAttribute("position",new k(n,3)),Pt.call(this,s,new Nt({color:e})),void 0!==t&&this.update(t)}function zi(t,e,n,s,r,o,h,l){function c(){var t=(s+1)*(r+1);return o===!1&&(t+=(s+1)*m+s*m),t}function u(){var t=s*r*2*3;return o===!1&&(t+=s*m*3),t}function d(){var i,o,c=new a,u=new a,d=0,p=(e-t)/n;for(o=0;o<=r;o++){var m=[],g=o/r,v=g*(e-t)+t;for(i=0;i<=s;i++){var C=i/s;u.x=v*Math.sin(C*l+h),u.y=-g*n+T,u.z=v*Math.cos(C*l+h),x.setXYZ(_,u.x,u.y,u.z),c.copy(u),(0===t&&0===o||0===e&&o===r)&&(c.x=Math.sin(C*l+h),c.z=Math.cos(C*l+h)),c.setY(Math.sqrt(c.x*c.x+c.z*c.z)*p).normalize(),b.setXYZ(_,c.x,c.y,c.z),w.setXY(_,C,1-g),m.push(_),_++}M.push(m)}for(i=0;i<s;i++)for(o=0;o<r;o++){var A=M[o][i],N=M[o+1][i],L=M[o+1][i+1],P=M[o][i+1];y.setX(S,A),S++,y.setX(S,N),S++,y.setX(S,P),S++,y.setX(S,N),S++,y.setX(S,L),S++,y.setX(S,P),S++,d+=6}f.addGroup(E,d,0),E+=d}function p(n){var r,o,c,u=new i,d=new a,p=0,m=n===!0?t:e,g=n===!0?1:-1;for(o=_,r=1;r<=s;r++)x.setXYZ(_,0,T*g,0),b.setXYZ(_,0,g,0),u.x=.5,u.y=.5,w.setXY(_,u.x,u.y),_++;for(c=_,r=0;r<=s;r++){var v=r/s,M=v*l+h,C=Math.cos(M),A=Math.sin(M);d.x=m*A,d.y=T*g,d.z=m*C,x.setXYZ(_,d.x,d.y,d.z),b.setXYZ(_,0,g,0),u.x=.5*C+.5,u.y=.5*A*g+.5,w.setXY(_,u.x,u.y),_++}for(r=0;r<s;r++){var N=o+r,L=c+r;n===!0?(y.setX(S,L),S++,y.setX(S,L+1),S++,y.setX(S,N),S++):(y.setX(S,L+1),S++,y.setX(S,L),S++,y.setX(S,N),S++),p+=3}f.addGroup(E,p,n===!0?1:2),E+=p}J.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:s,heightSegments:r,openEnded:o,thetaStart:h,thetaLength:l};var f=this;t=void 0!==t?t:20,e=void 0!==e?e:20,n=void 0!==n?n:100,s=Math.floor(s)||8,r=Math.floor(r)||1,o=void 0!==o&&o,h=void 0!==h?h:0,l=void 0!==l?l:2*Math.PI;var m=0;o===!1&&(t>0&&m++,e>0&&m++);var g=c(),v=u(),y=new k(new(v>65535?Uint32Array:Uint16Array)(v),1),x=new k(new Float32Array(3*g),3),b=new k(new Float32Array(3*g),3),w=new k(new Float32Array(2*g),2),_=0,S=0,M=[],T=n/2,E=0;d(),o===!1&&(t>0&&p(!0),e>0&&p(!1)),this.setIndex(y),this.addAttribute("position",x),this.addAttribute("normal",b),this.addAttribute("uv",w)}function Ri(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),i=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),n=new J;n.addAttribute("position",new k(e,3)),n.addAttribute("color",new k(i,3));var s=new Nt({vertexColors:Dn});Pt.call(this,n,s)}function Oi(t,e,n){q.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n};var s,r,o,a,h,l=this.vertices,c=this.faces,u=this.faceVertexUvs[0],d=e+1;for(s=0;s<=n;s++)for(h=s/n,r=0;r<=e;r++)a=r/e,o=t(a,h),l.push(o);var p,f,m,g,v,y,x,b;for(s=0;s<n;s++)for(r=0;r<e;r++)p=s*d+r,f=s*d+r+1,m=(s+1)*d+r+1,g=(s+1)*d+r,v=new i(r/e,s/n),y=new i((r+1)/e,s/n),x=new i((r+1)/e,(s+1)/n),b=new i(r/e,(s+1)/n),c.push(new W(p,f,g)),u.push([v,y,b]),c.push(new W(f,m,g)),u.push([y.clone(),x,b.clone()]);this.computeFaceNormals(),this.computeVertexNormals()}function Bi(t,e,n,s){function r(t){var e=t.normalize().clone();e.index=d.vertices.push(e)-1;var n=l(t)/2/Math.PI+.5,s=c(t)/Math.PI+.5;return e.uv=new i(n,1-s),e}function o(t,e,i){var n=new W(t.index,e.index,i.index,[t.clone(),e.clone(),i.clone()]);d.faces.push(n),w.copy(t).add(e).add(i).divideScalar(3);var s=l(w);d.faceVertexUvs[0].push([u(t.uv,t,s),u(e.uv,e,s),u(i.uv,i,s)])}function h(t,e){for(var i=Math.pow(2,e),n=r(d.vertices[t.a]),s=r(d.vertices[t.b]),a=r(d.vertices[t.c]),h=[],l=0;l<=i;l++){h[l]=[];for(var c=r(n.clone().lerp(a,l/i)),u=r(s.clone().lerp(a,l/i)),p=i-l,f=0;f<=p;f++)0===f&&l===i?h[l][f]=c:h[l][f]=r(c.clone().lerp(u,f/p))}for(var l=0;l<i;l++)for(var f=0;f<2*(i-l)-1;f++){var m=Math.floor(f/2);f%2===0?o(h[l][m+1],h[l+1][m],h[l][m]):o(h[l][m+1],h[l+1][m+1],h[l+1][m])}}function l(t){return Math.atan2(t.z,-t.x)}function c(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}function u(t,e,n){return n<0&&1===t.x&&(t=new i(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new i(n/2/Math.PI+.5,t.y)),t.clone()}q.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:s},n=n||1,s=s||0;for(var d=this,p=0,f=t.length;p<f;p+=3)r(new a(t[p],t[p+1],t[p+2]));for(var m=this.vertices,g=[],p=0,v=0,f=e.length;p<f;p+=3,v++){var y=m[e[p]],x=m[e[p+1]],b=m[e[p+2]];g[v]=new W(y.index,x.index,b.index,[y.clone(),x.clone(),b.clone()])}for(var w=new a,p=0,f=g.length;p<f;p++)h(g[p],s);for(var p=0,f=this.faceVertexUvs[0].length;p<f;p++){var _=this.faceVertexUvs[0][p],S=_[0].x,M=_[1].x,E=_[2].x,C=Math.max(S,M,E),A=Math.min(S,M,E);C>.9&&A<.1&&(S<.2&&(_[0].x+=1),M<.2&&(_[1].x+=1),E<.2&&(_[2].x+=1))}for(var p=0,f=this.vertices.length;p<f;p++)this.vertices[p].multiplyScalar(n);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new T(new a,n)}function Fi(t,e){var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];Bi.call(this,i,n,t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}function Ui(t,e){var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Bi.call(this,i,n,t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}function Vi(t,e){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Bi.call(this,n,s,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}function Hi(t,e){var i=(1+Math.sqrt(5))/2,n=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],r=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Bi.call(this,s,r,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}function Wi(t,e,n,s,r,o){function h(t,e,i,n,s){var r=Math.cos(t),o=Math.sin(t),a=i/e*t,h=Math.cos(a);s.x=n*(2+h)*.5*r,s.y=n*(2+h)*o*.5,s.z=n*Math.sin(a)*.5}J.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:s,p:r,q:o},t=t||100,e=e||40,n=Math.floor(n)||64,s=Math.floor(s)||8,r=r||2,o=o||3;var l,c,u=(s+1)*(n+1),d=s*n*2*3,p=new k(new(d>65535?Uint32Array:Uint16Array)(d),1),f=new k(new Float32Array(3*u),3),m=new k(new Float32Array(3*u),3),g=new k(new Float32Array(2*u),2),v=0,y=0,x=new a,b=new a,w=new i,_=new a,S=new a,M=new a,T=new a,E=new a;for(l=0;l<=n;++l){var C=l/n*r*Math.PI*2;for(h(C,r,o,t,_),h(C+.01,r,o,t,S),T.subVectors(S,_),E.addVectors(S,_),M.crossVectors(T,E),E.crossVectors(M,T),M.normalize(),E.normalize(),c=0;c<=s;++c){var A=c/s*Math.PI*2,N=-e*Math.cos(A),L=e*Math.sin(A);x.x=_.x+(N*E.x+L*M.x),x.y=_.y+(N*E.y+L*M.y),x.z=_.z+(N*E.z+L*M.z),f.setXYZ(v,x.x,x.y,x.z),b.subVectors(x,_).normalize(),m.setXYZ(v,b.x,b.y,b.z),w.x=l/n,w.y=c/s,g.setXY(v,w.x,w.y),v++}}for(c=1;c<=n;c++)for(l=1;l<=s;l++){var P=(s+1)*(c-1)+(l-1),I=(s+1)*c+(l-1),D=(s+1)*c+l,z=(s+1)*(c-1)+l;p.setX(y,P),y++,p.setX(y,I),y++,p.setX(y,z),y++,p.setX(y,I),y++,p.setX(y,D),y++,p.setX(y,z),y++}this.setIndex(p),this.addAttribute("position",f),this.addAttribute("normal",m),this.addAttribute("uv",g)}function ji(t,e,i,n,s,r,o){q.call(this),
this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:s,q:r},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Wi(t,e,i,n,s,r)),this.mergeVertices()}function Gi(t,e,i,n,s){J.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:s},t=t||100,e=e||40,i=Math.floor(i)||8,n=Math.floor(n)||6,s=s||2*Math.PI;var r,o,h=(i+1)*(n+1),l=i*n*2*3,c=new(l>65535?Uint32Array:Uint16Array)(l),u=new Float32Array(3*h),d=new Float32Array(3*h),p=new Float32Array(2*h),f=0,m=0,g=0,v=new a,y=new a,x=new a;for(r=0;r<=i;r++)for(o=0;o<=n;o++){var b=o/n*s,w=r/i*Math.PI*2;y.x=(t+e*Math.cos(w))*Math.cos(b),y.y=(t+e*Math.cos(w))*Math.sin(b),y.z=e*Math.sin(w),u[f]=y.x,u[f+1]=y.y,u[f+2]=y.z,v.x=t*Math.cos(b),v.y=t*Math.sin(b),x.subVectors(y,v).normalize(),d[f]=x.x,d[f+1]=x.y,d[f+2]=x.z,p[m]=o/n,p[m+1]=r/i,f+=3,m+=2}for(r=1;r<=i;r++)for(o=1;o<=n;o++){var _=(n+1)*r+o-1,S=(n+1)*(r-1)+o-1,M=(n+1)*(r-1)+o,T=(n+1)*r+o;c[g]=_,c[g+1]=S,c[g+2]=T,c[g+3]=S,c[g+4]=M,c[g+5]=T,g+=6}this.setIndex(new k(c,1)),this.addAttribute("position",new k(u,3)),this.addAttribute("normal",new k(d,3)),this.addAttribute("uv",new k(p,2))}function Xi(t,e,i,n,s){q.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:s},this.fromBufferGeometry(new Gi(t,e,i,n,s))}function Yi(t,e){e=e||{};var i=e.font;if((i&&i.isFont)===!1)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new q;var n=i.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Oe.call(this,n,e),this.type="TextGeometry"}function qi(t,e,n,s,r,o){J.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:s,thetaStart:r,thetaLength:o},t=t||20,e=e||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8,s=void 0!==s?Math.max(1,s):1;var h,l,c,u=(n+1)*(s+1),d=n*s*2*3,p=new k(new(d>65535?Uint32Array:Uint16Array)(d),1),f=new k(new Float32Array(3*u),3),m=new k(new Float32Array(3*u),3),g=new k(new Float32Array(2*u),2),v=0,y=0,x=t,b=(e-t)/s,w=new a,_=new i;for(l=0;l<=s;l++){for(c=0;c<=n;c++)h=r+c/n*o,w.x=x*Math.cos(h),w.y=x*Math.sin(h),f.setXYZ(v,w.x,w.y,w.z),m.setXYZ(v,0,0,1),_.x=(w.x/e+1)/2,_.y=(w.y/e+1)/2,g.setXY(v,_.x,_.y),v++;x+=b}for(l=0;l<s;l++){var S=l*(n+1);for(c=0;c<n;c++){h=c+S;var M=h,T=h+n+1,E=h+n+2,C=h+1;p.setX(y,M),y++,p.setX(y,T),y++,p.setX(y,E),y++,p.setX(y,M),y++,p.setX(y,E),y++,p.setX(y,C),y++}}this.setIndex(p),this.addAttribute("position",f),this.addAttribute("normal",m),this.addAttribute("uv",g)}function $i(t,e,i,n,s,r){q.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:s,thetaLength:r},this.fromBufferGeometry(new qi(t,e,i,n,s,r))}function Zi(t,e,i,n){q.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new pt(t,e,i,n))}function Ji(e,n,s,r){J.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:n,phiStart:s,phiLength:r},n=Math.floor(n)||12,s=s||0,r=r||2*Math.PI,r=t.Math.clamp(r,0,2*Math.PI);var o,h,l,c=(n+1)*e.length,u=n*e.length*2*3,d=new k(new(u>65535?Uint32Array:Uint16Array)(u),1),p=new k(new Float32Array(3*c),3),f=new k(new Float32Array(2*c),2),m=0,g=0,v=1/n,y=new a,x=new i;for(h=0;h<=n;h++){var b=s+h*v*r,w=Math.sin(b),_=Math.cos(b);for(l=0;l<=e.length-1;l++)y.x=e[l].x*w,y.y=e[l].y,y.z=e[l].x*_,p.setXYZ(m,y.x,y.y,y.z),x.x=h/n,x.y=l/(e.length-1),f.setXY(m,x.x,x.y),m++}for(h=0;h<n;h++)for(l=0;l<e.length-1;l++){o=l+h*e.length;var S=o,M=o+e.length,T=o+e.length+1,E=o+1;d.setX(g,S),g++,d.setX(g,M),g++,d.setX(g,E),g++,d.setX(g,M),g++,d.setX(g,T),g++,d.setX(g,E),g++}if(this.setIndex(d),this.addAttribute("position",p),this.addAttribute("uv",f),this.computeVertexNormals(),r===2*Math.PI){var C=this.attributes.normal.array,A=new a,N=new a,L=new a;for(o=n*e.length*3,h=0,l=0;h<e.length;h++,l+=3)A.x=C[l+0],A.y=C[l+1],A.z=C[l+2],N.x=C[o+l+0],N.y=C[o+l+1],N.z=C[o+l+2],L.addVectors(A,N).normalize(),C[l+0]=C[o+l+0]=L.x,C[l+1]=C[o+l+1]=L.y,C[l+2]=C[o+l+2]=L.z}}function Ki(t,e,i,n){q.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new Ji(t,e,i,n)),this.mergeVertices()}function Qi(t,e,i,n,s,r,o,a){q.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new zi(t,e,i,n,s,r,o,a)),this.mergeVertices()}function tn(t,e,i,n,s,r,o){Qi.call(this,0,t,e,i,n,s,r,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:r,thetaLength:o}}function en(t,e,i,n,s,r,o){zi.call(this,0,t,e,i,n,s,r,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,thetaStart:r,thetaLength:o}}function nn(t,e,i,n){J.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var s=e+2,r=new Float32Array(3*s),o=new Float32Array(3*s),h=new Float32Array(2*s);o[2]=1,h[0]=.5,h[1]=.5;for(var l=0,c=3,u=2;l<=e;l++,c+=3,u+=2){var d=i+l/e*n;r[c]=t*Math.cos(d),r[c+1]=t*Math.sin(d),o[c+2]=1,h[u]=(r[c]/t+1)/2,h[u+1]=(r[c+1]/t+1)/2}for(var p=[],c=1;c<=e;c++)p.push(c,c+1,0);this.setIndex(new k(new Uint16Array(p),1)),this.addAttribute("position",new k(r,3)),this.addAttribute("normal",new k(o,3)),this.addAttribute("uv",new k(h,2)),this.boundingSphere=new T(new a,t)}function sn(t,e,i,n){q.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new nn(t,e,i,n))}function rn(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),t.CatmullRomCurve3.call(this,e),this.type="catmullrom",this.closed=!0}function on(t,e,i,n,s,r){ke.call(this,t,e,i,i,n,s,r)}function an(t,e,i,n,s,r,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new W(t,e,i,s,r,o)}function hn(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new It(t,e)}function ln(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new It(t,e)}function cn(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new kt(t)}function un(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new kt(t)}function dn(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new kt(t)}function pn(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new a(t,e,i)}function fn(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function mn(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&!function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}}(),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&i[t].indexOf(e)!==-1},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners,n=i[t];if(void 0!==n){var s=n.indexOf(e);s!==-1&&n.splice(s,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,i=e[t.type];if(void 0!==i){t.target=this;var n=[],s=0,r=i.length;for(s=0;s<r;s++)n[s]=i[s];for(s=0;s<r;s++)n[s].call(this,t)}}}});var gn="80dev",vn={LEFT:0,MIDDLE:1,RIGHT:2},yn=0,xn=1,bn=2,wn=3,_n=0,Sn=1,Mn=0,Tn=1,En=2,Cn=0,An=1,Nn=2,Ln=1,Pn=2,kn=0,In=1,Dn=2,zn=0,Rn=1,On=2,Bn=3,Fn=4,Un=5,Vn=100,Hn=101,Wn=102,jn=103,Gn=104,Xn=200,Yn=201,qn=202,$n=203,Zn=204,Jn=205,Kn=206,Qn=207,ts=208,es=209,is=210,ns=0,ss=1,rs=2,os=3,as=4,hs=5,ls=6,cs=7,us=0,ds=1,ps=2,fs=0,ms=1,gs=2,vs=3,ys=4,xs=300,bs=301,ws=302,_s=303,Ss=304,Ms=305,Ts=306,Es=307,Cs=1e3,As=1001,Ns=1002,Ls=1003,Ps=1004,ks=1005,Is=1006,Ds=1007,zs=1008,Rs=1009,Os=1010,Bs=1011,Fs=1012,Us=1013,Vs=1014,Hs=1015,Ws=1016,js=1017,Gs=1018,Xs=1019,Ys=1020,qs=1021,$s=1022,Zs=1023,Js=1024,Ks=1025,Qs=Zs,tr=1026,er=1027,ir=2001,nr=2002,sr=2003,rr=2004,or=2100,ar=2101,hr=2102,lr=2103,cr=2151,ur=2200,dr=2201,pr=2202,fr=2300,mr=2301,gr=2302,vr=2400,yr=2401,xr=2402,br=0,wr=1,_r=2,Sr=3e3,Mr=3001,Tr=3007,Er=3002,Cr=3003,Ar=3004,Nr=3005,Lr=3006,Pr=3200,kr=3201;t.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0;return function(){for(var s=0;s<36;s++)8===s||13===s||18===s||23===s?i[s]="-":14===s?i[s]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[s]=e[19===s?3&t|8:t]);return i.join("")}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,s){return n+(t-e)*(s-n)/(i-e)},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(e){return e*t.Math.DEG2RAD},radToDeg:function(e){return e*t.Math.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}},i.prototype={constructor:i,isVector2:!0,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(n,s){return void 0===t&&(t=new i,e=new i),t.set(n,n),e.set(s,s),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this},rotateAround:function(t,e){var i=Math.cos(e),n=Math.sin(e),s=this.x-t.x,r=this.y-t.y;return this.x=s*i-r*n+t.x,this.y=s*n+r*i+t.y,this}},n.DEFAULT_IMAGE=void 0,n.DEFAULT_MAPPING=xs,n.prototype={constructor:n,isTexture:!0,set needsUpdate(t){t===!0&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(e){function i(t){var e;return void 0!==t.toDataURL?e=t:(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var s=this.image;void 0===s.uuid&&(s.uuid=t.Math.generateUUID()),void 0===e.images[s.uuid]&&(e.images[s.uuid]={uuid:s.uuid,url:i(s)}),n.image=s.uuid}return e.textures[this.uuid]=n,n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===xs){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case Cs:t.x=t.x-Math.floor(t.x);break;case As:t.x=t.x<0?0:1;break;case Ns:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Cs:t.y=t.y-Math.floor(t.y);break;case As:t.y=t.y<0?0:1;break;case Ns:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},Object.assign(n.prototype,e.prototype);var Ir=0;r.prototype={constructor:r,isMatrix4:!0,set:function(t,e,i,n,s,r,o,a,h,l,c,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=s,g[5]=r,g[9]=o,g[13]=a,g[2]=h,g[6]=l,g[10]=c,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new r).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new a);var i=this.elements,n=e.elements,s=1/t.setFromMatrixColumn(e,0).length(),r=1/t.setFromMatrixColumn(e,1).length(),o=1/t.setFromMatrixColumn(e,2).length();return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i[4]=n[4]*r,i[5]=n[5]*r,i[6]=n[6]*r,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,this}}(),makeRotationFromEuler:function(t){(t&&t.isEuler)===!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,n=t.y,s=t.z,r=Math.cos(i),o=Math.sin(i),a=Math.cos(n),h=Math.sin(n),l=Math.cos(s),c=Math.sin(s);if("XYZ"===t.order){var u=r*l,d=r*c,p=o*l,f=o*c;e[0]=a*l,e[4]=-a*c,e[8]=h,e[1]=d+p*h,e[5]=u-f*h,e[9]=-o*a,e[2]=f-u*h,e[6]=p+d*h,e[10]=r*a}else if("YXZ"===t.order){var m=a*l,g=a*c,v=h*l,y=h*c;e[0]=m+y*o,e[4]=v*o-g,e[8]=r*h,e[1]=r*c,e[5]=r*l,e[9]=-o,e[2]=g*o-v,e[6]=y+m*o,e[10]=r*a}else if("ZXY"===t.order){var m=a*l,g=a*c,v=h*l,y=h*c;e[0]=m-y*o,e[4]=-r*c,e[8]=v+g*o,e[1]=g+v*o,e[5]=r*l,e[9]=y-m*o,e[2]=-r*h,e[6]=o,e[10]=r*a}else if("ZYX"===t.order){var u=r*l,d=r*c,p=o*l,f=o*c;e[0]=a*l,e[4]=p*h-d,e[8]=u*h+f,e[1]=a*c,e[5]=f*h+u,e[9]=d*h-p,e[2]=-h,e[6]=o*a,e[10]=r*a}else if("YZX"===t.order){var x=r*a,b=r*h,w=o*a,_=o*h;e[0]=a*l,e[4]=_-x*c,e[8]=w*c+b,e[1]=c,e[5]=r*l,e[9]=-o*l,e[2]=-h*l,e[6]=b*c+w,e[10]=x-_*c}else if("XZY"===t.order){var x=r*a,b=r*h,w=o*a,_=o*h;e[0]=a*l,e[4]=-c,e[8]=h*l,e[1]=x*c+_,e[5]=r*l,e[9]=b*c-w,e[2]=w*c-b,e[6]=o*l,e[10]=_*c+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,n=t.y,s=t.z,r=t.w,o=i+i,a=n+n,h=s+s,l=i*o,c=i*a,u=i*h,d=n*a,p=n*h,f=s*h,m=r*o,g=r*a,v=r*h;return e[0]=1-(d+f),e[4]=c-v,e[8]=u+g,e[1]=c+v,e[5]=1-(l+f),e[9]=p-m,e[2]=u-g,e[6]=p+m,e[10]=1-(l+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,i;return function(n,s,r){void 0===t&&(t=new a,e=new a,i=new a);var o=this.elements;return i.subVectors(n,s).normalize(),0===i.lengthSq()&&(i.z=1),t.crossVectors(r,i).normalize(),0===t.lengthSq()&&(i.z+=1e-4,t.crossVectors(r,i).normalize()),e.crossVectors(i,t),o[0]=t.x,o[4]=e.x,o[8]=i.x,o[1]=t.y,o[5]=e.y,o[9]=i.y,o[2]=t.z,o[6]=e.z,o[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,s=this.elements,r=i[0],o=i[4],a=i[8],h=i[12],l=i[1],c=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],x=i[11],b=i[15],w=n[0],_=n[4],S=n[8],M=n[12],T=n[1],E=n[5],C=n[9],A=n[13],N=n[2],L=n[6],P=n[10],k=n[14],I=n[3],D=n[7],z=n[11],R=n[15];return s[0]=r*w+o*T+a*N+h*I,s[4]=r*_+o*E+a*L+h*D,s[8]=r*S+o*C+a*P+h*z,s[12]=r*M+o*A+a*k+h*R,s[1]=l*w+c*T+u*N+d*I,s[5]=l*_+c*E+u*L+d*D,s[9]=l*S+c*C+u*P+d*z,s[13]=l*M+c*A+u*k+d*R,s[2]=p*w+f*T+m*N+g*I,s[6]=p*_+f*E+m*L+g*D,s[10]=p*S+f*C+m*P+g*z,s[14]=p*M+f*A+m*k+g*R,s[3]=v*w+y*T+x*N+b*I,s[7]=v*_+y*E+x*L+b*D,s[11]=v*S+y*C+x*P+b*z,s[15]=v*M+y*A+x*k+b*R,this},multiplyToArray:function(t,e,i){var n=this.elements;return this.multiplyMatrices(t,e),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,i,n){void 0===t&&(t=new a),void 0===i&&(i=0),void 0===n&&(n=e.length);for(var s=0,r=i;s<n;s+=3,r+=3)t.fromArray(e,r),t.applyMatrix4(this),t.toArray(e,r);return e}}(),applyToBuffer:function(){var t;return function(e,i,n){void 0===t&&(t=new a),void 0===i&&(i=0),void 0===n&&(n=e.length/e.itemSize);for(var s=0,r=i;s<n;s++,r++)t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.applyMatrix4(this),e.setXYZ(t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],s=t[12],r=t[1],o=t[5],a=t[9],h=t[13],l=t[2],c=t[6],u=t[10],d=t[14],p=t[3],f=t[7],m=t[11],g=t[15];return p*(+s*a*c-n*h*c-s*o*u+i*h*u+n*o*d-i*a*d)+f*(+e*a*d-e*h*u+s*r*u-n*r*d+n*h*l-s*a*l)+m*(+e*h*c-e*o*d-s*r*c+i*r*d+s*o*l-i*h*l)+g*(-n*o*l-e*a*c+e*o*u+n*r*c-i*r*u+i*a*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new a),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,s=n[0],r=n[1],o=n[2],a=n[3],h=n[4],l=n[5],c=n[6],u=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15],b=p*y*u-v*f*u+v*c*m-l*y*m-p*c*x+l*f*x,w=g*f*u-d*y*u-g*c*m+h*y*m+d*c*x-h*f*x,_=d*v*u-g*p*u+g*l*m-h*v*m-d*l*x+h*p*x,S=g*p*c-d*v*c-g*l*f+h*v*f+d*l*y-h*p*y,M=s*b+r*w+o*_+a*S;if(0===M){var T="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e===!0)throw new Error(T);return console.warn(T),this.identity()}var E=1/M;return i[0]=b*E,i[1]=(v*f*a-p*y*a-v*o*m+r*y*m+p*o*x-r*f*x)*E,i[2]=(l*y*a-v*c*a+v*o*u-r*y*u-l*o*x+r*c*x)*E,i[3]=(p*c*a-l*f*a-p*o*u+r*f*u+l*o*m-r*c*m)*E,i[4]=w*E,i[5]=(d*y*a-g*f*a+g*o*m-s*y*m-d*o*x+s*f*x)*E,i[6]=(g*c*a-h*y*a-g*o*u+s*y*u+h*o*x-s*c*x)*E,i[7]=(h*f*a-d*c*a+d*o*u-s*f*u-h*o*m+s*c*m)*E,i[8]=_*E,i[9]=(g*p*a-d*v*a-g*r*m+s*v*m+d*r*x-s*p*x)*E,i[10]=(h*v*a-g*l*a+g*r*u-s*v*u-h*r*x+s*l*x)*E,i[11]=(d*l*a-h*p*a-d*r*u+s*p*u+h*r*m-s*l*m)*E,i[12]=S*E,i[13]=(d*v*o-g*p*o+g*r*f-s*v*f-d*r*y+s*p*y)*E,i[14]=(g*l*o-h*v*o-g*r*c+s*v*c+h*r*y-s*l*y)*E,i[15]=(h*p*o-d*l*o+d*r*c-s*p*c-h*r*f+s*l*f)*E,this},scale:function(t){var e=this.elements,i=t.x,n=t.y,s=t.z;return e[0]*=i,e[4]*=n,e[8]*=s,e[1]*=i,e[5]*=n,e[9]*=s,e[2]*=i,e[6]*=n,e[10]*=s,e[3]*=i,e[7]*=n,e[11]*=s,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),s=1-i,r=t.x,o=t.y,a=t.z,h=s*r,l=s*o;return this.set(h*r+i,h*o-n*a,h*a+n*o,0,h*o+n*a,l*o+i,l*a-n*r,0,h*a-n*o,l*a+n*r,s*a*a+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(){var t,e;return function(i,n,s){void 0===t&&(t=new a,e=new r);var o=this.elements,h=t.set(o[0],o[1],o[2]).length(),l=t.set(o[4],o[5],o[6]).length(),c=t.set(o[8],o[9],o[10]).length(),u=this.determinant();u<0&&(h=-h),i.x=o[12],i.y=o[13],i.z=o[14],e.elements.set(this.elements);var d=1/h,p=1/l,f=1/c;return e.elements[0]*=d,e.elements[1]*=d,e.elements[2]*=d,e.elements[4]*=p,e.elements[5]*=p,e.elements[6]*=p,e.elements[8]*=f,e.elements[9]*=f,e.elements[10]*=f,n.setFromRotationMatrix(e),s.x=h,s.y=l,s.z=c,this}}(),makeFrustum:function(t,e,i,n,s,r){var o=this.elements,a=2*s/(e-t),h=2*s/(n-i),l=(e+t)/(e-t),c=(n+i)/(n-i),u=-(r+s)/(r-s),d=-2*r*s/(r-s);return o[0]=a,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=h,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(e,i,n,s){var r=n*Math.tan(t.Math.DEG2RAD*e*.5),o=-r,a=o*i,h=r*i;return this.makeFrustum(a,h,o,r,n,s)},makeOrthographic:function(t,e,i,n,s,r){var o=this.elements,a=1/(e-t),h=1/(i-n),l=1/(r-s),c=(e+t)*a,u=(i+n)*h,d=(r+s)*l;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*h,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}},o.prototype={constructor:o,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if((t&&t.isEuler)===!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=Math.cos(t._x/2),n=Math.cos(t._y/2),s=Math.cos(t._z/2),r=Math.sin(t._x/2),o=Math.sin(t._y/2),a=Math.sin(t._z/2),h=t.order;return"XYZ"===h?(this._x=r*n*s+i*o*a,this._y=i*o*s-r*n*a,this._z=i*n*a+r*o*s,this._w=i*n*s-r*o*a):"YXZ"===h?(this._x=r*n*s+i*o*a,this._y=i*o*s-r*n*a,this._z=i*n*a-r*o*s,this._w=i*n*s+r*o*a):"ZXY"===h?(this._x=r*n*s-i*o*a,this._y=i*o*s+r*n*a,this._z=i*n*a+r*o*s,this._w=i*n*s-r*o*a):"ZYX"===h?(this._x=r*n*s-i*o*a,this._y=i*o*s+r*n*a,this._z=i*n*a-r*o*s,this._w=i*n*s+r*o*a):"YZX"===h?(this._x=r*n*s+i*o*a,this._y=i*o*s+r*n*a,this._z=i*n*a-r*o*s,this._w=i*n*s-r*o*a):"XZY"===h&&(this._x=r*n*s-i*o*a,this._y=i*o*s-r*n*a,this._z=i*n*a+r*o*s,this._w=i*n*s+r*o*a),e!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],s=i[4],r=i[8],o=i[1],a=i[5],h=i[9],l=i[2],c=i[6],u=i[10],d=n+a+u;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(c-h)*e,this._y=(r-l)*e,this._z=(o-s)*e):n>a&&n>u?(e=2*Math.sqrt(1+n-a-u),this._w=(c-h)/e,this._x=.25*e,this._y=(s+o)/e,this._z=(r+l)/e):a>u?(e=2*Math.sqrt(1+a-n-u),this._w=(r-l)/e,this._x=(s+o)/e,this._y=.25*e,this._z=(h+c)/e):(e=2*Math.sqrt(1+u-n-a),this._w=(o-s)/e,this._x=(r+l)/e,this._y=(h+c)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e,i=1e-6;return function(n,s){return void 0===t&&(t=new a),e=n.dot(s)+1,e<i?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,s),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,s=t._z,r=t._w,o=e._x,a=e._y,h=e._z,l=e._w;return this._x=i*l+r*o+n*h-s*a,this._y=n*l+r*a+s*o-i*h,this._z=s*l+r*h+i*a-n*o,this._w=r*l-i*o-n*a-s*h,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,s=this._z,r=this._w,o=r*t._w+i*t._x+n*t._y+s*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=r,this._x=i,this._y=n,this._z=s,this;var a=Math.sqrt(1-o*o);if(Math.abs(a)<.001)return this._w=.5*(r+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(s+this._z),this;var h=Math.atan2(a,o),l=Math.sin((1-e)*h)/a,c=Math.sin(e*h)/a;return this._w=r*l+this._w*c,this._x=i*l+this._x*c,this._y=n*l+this._y*c,this._z=s*l+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(o,{slerp:function(t,e,i,n){
return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,s,r,o){var a=i[n+0],h=i[n+1],l=i[n+2],c=i[n+3],u=s[r+0],d=s[r+1],p=s[r+2],f=s[r+3];if(c!==f||a!==u||h!==d||l!==p){var m=1-o,g=a*u+h*d+l*p+c*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var x=Math.sqrt(y),b=Math.atan2(x,g*v);m=Math.sin(m*b)/x,o=Math.sin(o*b)/x}var w=o*v;if(a=a*m+u*w,h=h*m+d*w,l=l*m+p*w,c=c*m+f*w,m===1-o){var _=1/Math.sqrt(a*a+h*h+l*l+c*c);a*=_,h*=_,l*=_,c*=_}}t[e]=a,t[e+1]=h,t[e+2]=l,t[e+3]=c}}),a.prototype={constructor:a,isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return(e&&e.isEuler)===!1&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new o),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t;return function(e,i){return void 0===t&&(t=new o),this.applyQuaternion(t.setFromAxisAngle(e,i))}}(),applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[3]*i+s[6]*n,this.y=s[1]*e+s[4]*i+s[7]*n,this.z=s[2]*e+s[5]*i+s[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n+s[12],this.y=s[1]*e+s[5]*i+s[9]*n+s[13],this.z=s[2]*e+s[6]*i+s[10]*n+s[14],this},applyProjection:function(t){var e=this.x,i=this.y,n=this.z,s=t.elements,r=1/(s[3]*e+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*e+s[4]*i+s[8]*n+s[12])*r,this.y=(s[1]*e+s[5]*i+s[9]*n+s[13])*r,this.z=(s[2]*e+s[6]*i+s[10]*n+s[14])*r,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,o=t.z,a=t.w,h=a*e+r*n-o*i,l=a*i+o*e-s*n,c=a*n+s*i-r*e,u=-s*e-r*i-o*n;return this.x=h*a+u*-s+l*-o-c*-r,this.y=l*a+u*-r+c*-s-h*-o,this.z=c*a+u*-o+h*-r-l*-s,this},project:function(){var t;return function(e){return void 0===t&&(t=new r),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new r),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n,this.y=s[1]*e+s[5]*i+s[9]*n,this.z=s[2]*e+s[6]*i+s[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new a,e=new a),t.set(i,i,i),e.set(n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var i=this.x,n=this.y,s=this.z;return this.x=n*t.z-s*t.y,this.y=s*t.x-i*t.z,this.z=i*t.y-n*t.x,this},crossVectors:function(t,e){var i=t.x,n=t.y,s=t.z,r=e.x,o=e.y,a=e.z;return this.x=n*a-s*o,this.y=s*r-i*a,this.z=i*o-n*r,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new a),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new a),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(e){var i=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(t.Math.clamp(i,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this},setFromMatrixColumn:function(t,e){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var i=t;t=e,e=i}return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},l.prototype={constructor:l,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new i;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=+(1/0),this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){var e=t||new i;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new i;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){var n=e||new i;return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){var n=e||new i;return n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new i;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},u.prototype=Object.create(n.prototype),u.prototype.constructor=u,u.prototype.isCubeTexture=!0,Object.defineProperty(u.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),t.WebGLUniforms=function(){var t=new n,e=new u,i=function(){this.seq=[],this.map={}},s=[],r=[],o=function(t,e,i){var n=t[0];if(n<=0||n>0)return t;var r=e*i,o=s[r];if(void 0===o&&(o=new Float32Array(r),s[r]=o),0!==e){n.toArray(o,0);for(var a=1,h=0;a!==e;++a)h+=i,t[a].toArray(o,h)}return o},a=function(t,e){var i=r[e];void 0===i&&(i=new Int32Array(e),r[e]=i);for(var n=0;n!==e;++n)i[n]=t.allocTextureUnit();return i},h=function(t,e){t.uniform1f(this.addr,e)},l=function(t,e){t.uniform1i(this.addr,e)},c=function(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)},d=function(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)},p=function(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)},f=function(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)},m=function(t,e){t.uniformMatrix3fv(this.addr,!1,e.elements||e)},g=function(t,e){t.uniformMatrix4fv(this.addr,!1,e.elements||e)},v=function(e,i,n){var s=n.allocTextureUnit();e.uniform1i(this.addr,s),n.setTexture2D(i||t,s)},y=function(t,i,n){var s=n.allocTextureUnit();t.uniform1i(this.addr,s),n.setTextureCube(i||e,s)},x=function(t,e){t.uniform2iv(this.addr,e)},b=function(t,e){t.uniform3iv(this.addr,e)},w=function(t,e){t.uniform4iv(this.addr,e)},_=function(t){switch(t){case 5126:return h;case 35664:return c;case 35665:return d;case 35666:return p;case 35674:return f;case 35675:return m;case 35676:return g;case 35678:return v;case 35680:return y;case 5124:case 35670:return l;case 35667:case 35671:return x;case 35668:case 35672:return b;case 35669:case 35673:return w}},S=function(t,e){t.uniform1fv(this.addr,e)},M=function(t,e){t.uniform1iv(this.addr,e)},T=function(t,e){t.uniform2fv(this.addr,o(e,this.size,2))},E=function(t,e){t.uniform3fv(this.addr,o(e,this.size,3))},C=function(t,e){t.uniform4fv(this.addr,o(e,this.size,4))},A=function(t,e){t.uniformMatrix2fv(this.addr,!1,o(e,this.size,4))},N=function(t,e){t.uniformMatrix3fv(this.addr,!1,o(e,this.size,9))},L=function(t,e){t.uniformMatrix4fv(this.addr,!1,o(e,this.size,16))},P=function(e,i,n){var s=i.length,r=a(n,s);e.uniform1iv(this.addr,r);for(var o=0;o!==s;++o)n.setTexture2D(i[o]||t,r[o])},k=function(t,i,n){var s=i.length,r=a(n,s);t.uniform1iv(this.addr,r);for(var o=0;o!==s;++o)n.setTextureCube(i[o]||e,r[o])},I=function(t){switch(t){case 5126:return S;case 35664:return T;case 35665:return E;case 35666:return C;case 35674:return A;case 35675:return N;case 35676:return L;case 35678:return P;case 35680:return k;case 5124:case 35670:return M;case 35667:case 35671:return x;case 35668:case 35672:return b;case 35669:case 35673:return w}},D=function(t,e,i){this.id=t,this.addr=i,this.setValue=_(e.type)},z=function(t,e,i){this.id=t,this.addr=i,this.size=e.size,this.setValue=I(e.type)},R=function(t){this.id=t,i.call(this)};R.prototype.setValue=function(t,e){for(var i=this.seq,n=0,s=i.length;n!==s;++n){var r=i[n];r.setValue(t,e[r.id])}};var O=/([\w\d_]+)(\])?(\[|\.)?/g,B=function(t,e){t.seq.push(e),t.map[e.id]=e},F=function(t,e,i){var n=t.name,s=n.length;for(O.lastIndex=0;;){var r=O.exec(n),o=O.lastIndex,a=r[1],h="]"===r[2],l=r[3];if(h&&(a=0|a),void 0===l||"["===l&&o+2===s){B(i,void 0===l?new D(a,t,e):new z(a,t,e));break}var c=i.map,u=c[a];void 0===u&&(u=new R(a),B(i,u)),i=u}},U=function(t,e,n){i.call(this),this.renderer=n;for(var s=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),r=0;r!==s;++r){var o=t.getActiveUniform(e,r),a=o.name,h=t.getUniformLocation(e,a);F(o,h,this)}};return U.prototype.setValue=function(t,e,i){var n=this.map[e];void 0!==n&&n.setValue(t,i,this.renderer)},U.prototype.set=function(t,e,i){var n=this.map[i];void 0!==n&&n.setValue(t,e[i],this.renderer)},U.prototype.setOptional=function(t,e,i){var n=e[i];void 0!==n&&this.setValue(t,i,n)},U.upload=function(t,e,i,n){for(var s=0,r=e.length;s!==r;++s){var o=e[s],a=i[o.id];a.needsUpdate!==!1&&o.setValue(t,a.value,n)}},U.seqWithValue=function(t,e){for(var i=[],n=0,s=t.length;n!==s;++n){var r=t[n];r.id in e&&i.push(r)}return i},U.splitDynamic=function(t,e){for(var i=null,n=t.length,s=0,r=0;r!==n;++r){var o=t[r],a=e[o.id];a&&a.dynamic===!0?(null===i&&(i=[]),i.push(o)):(s<r&&(t[s]=o),++s)}return s<n&&(t.length=s),i},U.evalDynamic=function(t,e,i,n){for(var s=0,r=t.length;s!==r;++s){var o=e[t[s].id],a=o.onUpdateCallback;void 0!==a&&a.call(o,i,n)}},U}(),p.prototype={constructor:p,isVector4:!0,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,s=this.w,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12]*s,this.y=r[1]*e+r[5]*i+r[9]*n+r[13]*s,this.z=r[2]*e+r[6]*i+r[10]*n+r[14]*s,this.w=r[3]*e+r[7]*i+r[11]*n+r[15]*s,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,s,r=.01,o=.1,a=t.elements,h=a[0],l=a[4],c=a[8],u=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(l-u)<r&&Math.abs(c-f)<r&&Math.abs(p-m)<r){if(Math.abs(l+u)<o&&Math.abs(c+f)<o&&Math.abs(p+m)<o&&Math.abs(h+d+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;var v=(h+1)/2,y=(d+1)/2,x=(g+1)/2,b=(l+u)/4,w=(c+f)/4,_=(p+m)/4;return v>y&&v>x?v<r?(i=0,n=.707106781,s=.707106781):(i=Math.sqrt(v),n=b/i,s=w/i):y>x?y<r?(i=.707106781,n=0,s=.707106781):(n=Math.sqrt(y),i=b/n,s=_/n):x<r?(i=.707106781,n=.707106781,s=0):(s=Math.sqrt(x),i=w/s,n=_/s),this.set(i,n,s,e),this}var S=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(u-l)*(u-l));return Math.abs(S)<.001&&(S=1),this.x=(m-p)/S,this.y=(c-f)/S,this.z=(u-l)/S,this.w=Math.acos((h+d+g-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new p,e=new p),t.set(i,i,i,i),e.set(n,n,n,n),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},Object.assign(y.prototype,e.prototype,{isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),x.prototype={constructor:x,isMaterial:!0,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){t===!0&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i){var n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):"overdraw"===e?this[e]=Number(i):this[e]=i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){function e(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}var i=void 0===t;i&&(t={textures:{},images:{}});var n={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Rn&&(n.blending=this.blending),this.shading!==Pn&&(n.shading=this.shading),this.side!==Cn&&(n.side=this.side),this.vertexColors!==kn&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),n.skinning=this.skinning,n.morphTargets=this.morphTargets,i){var s=e(t.textures),r=e(t.images);s.length>0&&(n.textures=s),r.length>0&&(n.images=r)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows;var e=t.clippingPlanes,i=null;if(null!==e){var n=e.length;i=new Array(n);for(var s=0;s!==n;++s)i[s]=e[s].clone()}return this.clippingPlanes=i,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(x.prototype,e.prototype);var Dr=0;t.UniformsUtils={merge:function(t){for(var e={},i=0;i<t.length;i++){var n=this.clone(t[i]);for(var s in n)e[s]=n[s]}return e},clone:function(t){var e={};for(var i in t){e[i]={};for(var n in t[i]){var s=t[i][n];s&&s.isColor||s&&s.isVector2||s&&s.isVector3||s&&s.isVector4||s&&s.isMatrix3||s&&s.isMatrix4||s&&s.isTexture?e[i][n]=s.clone():Array.isArray(s)?e[i][n]=s.slice():e[i][n]=s}}return e}},w.prototype=Object.create(x.prototype),w.prototype.constructor=w,w.prototype.isShaderMaterial=!0,w.prototype.copy=function(e){return x.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=t.UniformsUtils.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},w.prototype.toJSON=function(t){var e=x.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e};var zr="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",Rr="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",Or="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",Br="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",Fr="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",Ur="\nvec3 transformed = vec3( position );\n",Vr="\nvec3 objectNormal = vec3( normal );\n",Hr="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",Wr="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",jr="#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n",Gr="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",Xr="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",Yr="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",qr="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",$r="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",Zr="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",Jr="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",Kr="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",Qr="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",to="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",eo="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",io="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",no="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",so="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",ro="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",oo="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",ao="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",ho="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",lo="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",co="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",uo="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",po="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",fo="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",mo="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",go="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",vo="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#include <normal_flip>\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#include <normal_flip>\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",yo="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",xo="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",bo="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",wo="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",_o="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\t\t\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",So="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",Mo="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",To="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",Eo="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",Co="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",Ao="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",No="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",Lo="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",Po="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",ko="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",Io="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",Do="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",zo="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",Ro="#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",Oo="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",Bo="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",Fo="vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",Uo="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",Vo="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",Ho="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",Wo="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",jo="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",Go="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",Xo="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",Yo="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",qo="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",$o="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",Zo="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",Jo="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",Ko="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",Qo="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",ta="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",ea="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",ia="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",na="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",sa="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",ra="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",oa="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",aa="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",ha="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",la="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",ca="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",ua="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",da="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",pa="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",fa="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",ma="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",ga="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",va="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",ya="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",xa="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",ba="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",wa="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",_a="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",Sa="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Ma="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",Ta="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Ea="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",Ca="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n",Aa="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",Na="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",La="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",Pa="uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",ka="#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",Ia={
alphamap_fragment:zr,alphamap_pars_fragment:Rr,alphatest_fragment:Or,aomap_fragment:Br,aomap_pars_fragment:Fr,begin_vertex:Ur,beginnormal_vertex:Vr,bsdfs:Hr,bumpmap_pars_fragment:Wr,clipping_planes_fragment:jr,clipping_planes_pars_fragment:Gr,clipping_planes_pars_vertex:Xr,clipping_planes_vertex:Yr,color_fragment:qr,color_pars_fragment:$r,color_pars_vertex:Zr,color_vertex:Jr,common:Kr,cube_uv_reflection_fragment:Qr,defaultnormal_vertex:to,displacementmap_pars_vertex:eo,displacementmap_vertex:io,emissivemap_fragment:no,emissivemap_pars_fragment:so,encodings_fragment:ro,encodings_pars_fragment:oo,envmap_fragment:ao,envmap_pars_fragment:ho,envmap_pars_vertex:lo,envmap_vertex:co,fog_fragment:uo,fog_pars_fragment:po,lightmap_fragment:fo,lightmap_pars_fragment:mo,lights_lambert_vertex:go,lights_pars:vo,lights_phong_fragment:yo,lights_phong_pars_fragment:xo,lights_physical_fragment:bo,lights_physical_pars_fragment:wo,lights_template:_o,logdepthbuf_fragment:So,logdepthbuf_pars_fragment:Mo,logdepthbuf_pars_vertex:To,logdepthbuf_vertex:Eo,map_fragment:Co,map_pars_fragment:Ao,map_particle_fragment:No,map_particle_pars_fragment:Lo,metalnessmap_fragment:Po,metalnessmap_pars_fragment:ko,morphnormal_vertex:Io,morphtarget_pars_vertex:Do,morphtarget_vertex:zo,normal_flip:Ro,normal_fragment:Oo,normalmap_pars_fragment:Bo,packing:Fo,premultiplied_alpha_fragment:Uo,project_vertex:Vo,roughnessmap_fragment:Ho,roughnessmap_pars_fragment:Wo,shadowmap_pars_fragment:jo,shadowmap_pars_vertex:Go,shadowmap_vertex:Xo,shadowmask_pars_fragment:Yo,skinbase_vertex:qo,skinning_pars_vertex:$o,skinning_vertex:Zo,skinnormal_vertex:Jo,specularmap_fragment:Ko,specularmap_pars_fragment:Qo,tonemapping_fragment:ta,tonemapping_pars_fragment:ea,uv_pars_fragment:ia,uv_pars_vertex:na,uv_vertex:sa,uv2_pars_fragment:ra,uv2_pars_vertex:oa,uv2_vertex:aa,worldpos_vertex:ha,cube_frag:la,cube_vert:ca,depth_frag:ua,depth_vert:da,distanceRGBA_frag:pa,distanceRGBA_vert:fa,equirect_frag:ma,equirect_vert:ga,linedashed_frag:va,linedashed_vert:ya,meshbasic_frag:xa,meshbasic_vert:ba,meshlambert_frag:wa,meshlambert_vert:_a,meshphong_frag:Sa,meshphong_vert:Ma,meshphysical_frag:Ta,meshphysical_vert:Ea,normal_frag:Ca,normal_vert:Aa,points_frag:Na,points_vert:La,shadow_frag:Pa,shadow_vert:ka};_.prototype={constructor:_,isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){this.r=t,this.g=t,this.b=t},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function e(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}return function(i,n,s){if(i=t.Math.euclideanModulo(i,1),n=t.Math.clamp(n,0,1),s=t.Math.clamp(s,0,1),0===n)this.r=this.g=this.b=s;else{var r=s<=.5?s*(1+n):s+n-s*n,o=2*s-r;this.r=e(o,r,i+1/3),this.g=e(o,r,i),this.b=e(o,r,i-1/3)}return this}}(),setStyle:function(e){function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var s,r=n[1],o=n[2];switch(r){case"rgb":case"rgba":if(s=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,i(s[5]),this;if(s=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,i(s[5]),this;break;case"hsl":case"hsla":if(s=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(s[1])/360,h=parseInt(s[2],10)/100,l=parseInt(s[3],10)/100;return i(s[5]),this.setHSL(a,h,l)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c=n[1],u=c.length;if(3===u)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}if(e&&e.length>0){var c=t.ColorKeywords[e];void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+e)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,i,n=t||{h:0,s:0,l:0},s=this.r,r=this.g,o=this.b,a=Math.max(s,r,o),h=Math.min(s,r,o),l=(h+a)/2;if(h===a)e=0,i=0;else{var c=a-h;switch(i=l<=.5?c/(a+h):c/(2-a-h),a){case s:e=(r-o)/c+(r<o?6:0);break;case r:e=(o-s)/c+2;break;case o:e=(s-r)/c+4}e/=6}return n.h=e,n.s=i,n.l=l,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}},t.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},t.UniformsLib={common:{diffuse:{value:new _(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new p(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new i(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}}},points:{diffuse:{value:new _(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new p(0,0,1,1)}}},t.ShaderLib={basic:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.aomap,t.UniformsLib.fog]),vertexShader:Ia.meshbasic_vert,fragmentShader:Ia.meshbasic_frag},lambert:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.aomap,t.UniformsLib.lightmap,t.UniformsLib.emissivemap,t.UniformsLib.fog,t.UniformsLib.lights,{emissive:{value:new _(0)}}]),vertexShader:Ia.meshlambert_vert,fragmentShader:Ia.meshlambert_frag},phong:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.aomap,t.UniformsLib.lightmap,t.UniformsLib.emissivemap,t.UniformsLib.bumpmap,t.UniformsLib.normalmap,t.UniformsLib.displacementmap,t.UniformsLib.fog,t.UniformsLib.lights,{emissive:{value:new _(0)},specular:{value:new _(1118481)},shininess:{value:30}}]),vertexShader:Ia.meshphong_vert,fragmentShader:Ia.meshphong_frag},standard:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.aomap,t.UniformsLib.lightmap,t.UniformsLib.emissivemap,t.UniformsLib.bumpmap,t.UniformsLib.normalmap,t.UniformsLib.displacementmap,t.UniformsLib.roughnessmap,t.UniformsLib.metalnessmap,t.UniformsLib.fog,t.UniformsLib.lights,{emissive:{value:new _(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ia.meshphysical_vert,fragmentShader:Ia.meshphysical_frag},points:{uniforms:t.UniformsUtils.merge([t.UniformsLib.points,t.UniformsLib.fog]),vertexShader:Ia.points_vert,fragmentShader:Ia.points_frag},dashed:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ia.linedashed_vert,fragmentShader:Ia.linedashed_frag},depth:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.displacementmap]),vertexShader:Ia.depth_vert,fragmentShader:Ia.depth_frag},normal:{uniforms:{opacity:{value:1}},vertexShader:Ia.normal_vert,fragmentShader:Ia.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ia.cube_vert,fragmentShader:Ia.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:Ia.equirect_vert,fragmentShader:Ia.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new a}},vertexShader:Ia.distanceRGBA_vert,fragmentShader:Ia.distanceRGBA_frag}},t.ShaderLib.physical={uniforms:t.UniformsUtils.merge([t.ShaderLib.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Ia.meshphysical_vert,fragmentShader:Ia.meshphysical_frag},S.prototype=Object.create(x.prototype),S.prototype.constructor=S,S.prototype.isMeshDepthMaterial=!0,S.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},M.prototype={constructor:M,isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=+(1/0),i=+(1/0),n=+(1/0),s=-(1/0),r=-(1/0),o=-(1/0),a=0,h=t.length;a<h;a+=3){var l=t[a],c=t[a+1],u=t[a+2];l<e&&(e=l),c<i&&(i=c),u<n&&(n=u),l>s&&(s=l),c>r&&(r=c),u>o&&(o=u)}this.min.set(e,i,n),this.max.set(s,r,o)},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new a;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(){var t=new a;return function(e){var i=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){var n=e.geometry;if(void 0!==n)if(n&&n.isGeometry)for(var s=n.vertices,r=0,o=s.length;r<o;r++)t.copy(s[r]),t.applyMatrix4(e.matrixWorld),i.expandByPoint(t);else if(n&&n.isBufferGeometry){var a=n.attributes.position;if(void 0!==a){var h,l,c;a&&a.isInterleavedBufferAttribute?(h=a.data.array,l=a.offset,c=a.data.stride):(h=a.array,l=0,c=3);for(var r=l,o=h.length;r<o;r+=c)t.fromArray(h,r),t.applyMatrix4(e.matrixWorld),i.expandByPoint(t)}}}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+(1/0),this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){var e=t||new a;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new a;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){var i=e||new a;return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new a),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=t.constant&&i>=t.constant},clampPoint:function(t,e){var i=e||new a;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new a;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),getBoundingSphere:function(){var t=new a;return function(e){var i=e||new T;return i.center=this.center(),i.radius=.5*this.size(t).length(),i}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new a,new a,new a,new a,new a,new a,new a,new a];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},T.prototype={constructor:T,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new M;return function(e,i){var n=this.center;void 0!==i?n.copy(i):t.setFromPoints(e).center(n);for(var s=0,r=0,o=e.length;r<o;r++)s=Math.max(s,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),n=e||new a;return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){var e=t||new M;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},E.prototype={constructor:E,isMatrix3:!0,set:function(t,e,i,n,s,r,o,a,h){var l=this.elements;return l[0]=t,l[1]=n,l[2]=o,l[3]=e,l[4]=s,l[5]=a,l[6]=i,l[7]=r,l[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToVector3Array:function(){var t;return function(e,i,n){void 0===t&&(t=new a),void 0===i&&(i=0),void 0===n&&(n=e.length);for(var s=0,r=i;s<n;s+=3,r+=3)t.fromArray(e,r),t.applyMatrix3(this),t.toArray(e,r);return e}}(),applyToBuffer:function(){var t;return function(e,i,n){void 0===t&&(t=new a),void 0===i&&(i=0),void 0===n&&(n=e.length/e.itemSize);for(var s=0,r=i;s<n;s++,r++)t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.applyMatrix3(this),e.setXYZ(t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],h=t[7],l=t[8];return e*r*l-e*o*h-i*s*l+i*o*a+n*s*h-n*r*a},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var i=t.elements,n=this.elements,s=i[0],r=i[1],o=i[2],a=i[3],h=i[4],l=i[5],c=i[6],u=i[7],d=i[8],p=d*h-l*u,f=l*c-d*a,m=u*a-h*c,g=s*p+r*f+o*m;if(0===g){var v="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e===!0)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=p*y,n[1]=(o*u-d*r)*y,n[2]=(l*r-o*h)*y,n[3]=f*y,n[4]=(d*s-o*c)*y,n[5]=(o*a-l*s)*y,n[6]=m*y,n[7]=(r*c-u*s)*y,n[8]=(h*s-r*a)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}},C.prototype={constructor:C,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new a,e=new a;return function(i,n,s){var r=t.subVectors(s,n).cross(e.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t),n=e||new a;return n.copy(this.normal).multiplyScalar(i)},intersectLine:function(){var t=new a;return function(e,i){var n=i||new a,s=e.delta(t),r=this.normal.dot(s);if(0!==r){var o=-(e.start.dot(this.normal)+this.constant)/r;if(!(o<0||o>1))return n.copy(s).multiplyScalar(o).add(e.start)}else if(0===this.distanceToPoint(e.start))return n.copy(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){var e=t||new a;return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new a,e=new E;return function(i,n){var s=this.coplanarPoint(t).applyMatrix4(i),r=n||e.getNormalMatrix(i),o=this.normal.applyMatrix3(r).normalize();return this.constant=-s.dot(o),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},A.prototype={constructor:A,set:function(t,e,i,n,s,r){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(s),o[5].copy(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],s=i[1],r=i[2],o=i[3],a=i[4],h=i[5],l=i[6],c=i[7],u=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(o-n,c-a,f-u,y-m).normalize(),e[1].setComponents(o+n,c+a,f+u,y+m).normalize(),e[2].setComponents(o+s,c+h,f+d,y+g).normalize(),e[3].setComponents(o-s,c-h,f-d,y-g).normalize(),e[4].setComponents(o-r,c-l,f-p,y-v).normalize(),e[5].setComponents(o+r,c+l,f+p,y+v).normalize(),this},intersectsObject:function(){var t=new T;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new T;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,s=0;s<6;s++){var r=e[s].distanceToPoint(i);if(r<n)return!1}return!0},intersectsBox:function(){var t=new a,e=new a;return function(i){for(var n=this.planes,s=0;s<6;s++){var r=n[s];t.x=r.normal.x>0?i.min.x:i.max.x,e.x=r.normal.x>0?i.max.x:i.min.x,t.y=r.normal.y>0?i.min.y:i.max.y,e.y=r.normal.y>0?i.max.y:i.min.y,t.z=r.normal.z>0?i.min.z:i.max.z,e.z=r.normal.z>0?i.max.z:i.min.z;var o=r.distanceToPoint(t),a=r.distanceToPoint(e);if(o<0&&a<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}},t.WebGLShader=function(){function t(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")}return function(e,i,n){var s=e.createShader(i);return e.shaderSource(s,n),e.compileShader(s),e.getShaderParameter(s,e.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(s)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",i===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(s),t(n)),s}}(),t.WebGLProgram=function(){function e(t){switch(t){case Sr:return["Linear","( value )"];case Mr:return["sRGB","( value )"];case Er:return["RGBE","( value )"];case Ar:return["RGBM","( value, 7.0 )"];case Nr:return["RGBM","( value, 16.0 )"];case Lr:return["RGBD","( value, 256.0 )"];case Tr:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function i(t,i){var n=e(i);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function n(t,i){var n=e(i);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function s(t,e){var i;switch(e){case ms:i="Linear";break;case gs:i="Reinhard";break;case vs:i="Uncharted2";break;case ys:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function r(t,e,i){t=t||{};var n=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return n.filter(h).join("\n")}function o(t){var e=[];for(var i in t){var n=t[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join("\n")}function a(t,e,i){for(var n={},s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<s;r++){var o=t.getActiveAttrib(e,r),a=o.name;n[a]=t.getAttribLocation(e,a)}return n}function h(t){return""!==t}function l(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function c(t){function e(t,e){var i=Ia[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return c(i)}var i=/#include +<([\w\d.]+)>/g;return t.replace(i,e)}function u(t){function e(t,e,i,n){for(var s="",r=parseInt(e);r<parseInt(i);r++)s+=n.replace(/\[ i \]/g,"[ "+r+" ]");return s}var i=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(i,e)}var d=0;return function(e,p,f,m){var g=e.context,v=f.extensions,y=f.defines,x=f.__webglShader.vertexShader,b=f.__webglShader.fragmentShader,w="SHADOWMAP_TYPE_BASIC";m.shadowMapType===Tn?w="SHADOWMAP_TYPE_PCF":m.shadowMapType===En&&(w="SHADOWMAP_TYPE_PCF_SOFT");var _="ENVMAP_TYPE_CUBE",S="ENVMAP_MODE_REFLECTION",M="ENVMAP_BLENDING_MULTIPLY";if(m.envMap){switch(f.envMap.mapping){case bs:case ws:_="ENVMAP_TYPE_CUBE";break;case Ts:case Es:_="ENVMAP_TYPE_CUBE_UV";break;case _s:case Ss:_="ENVMAP_TYPE_EQUIREC";break;case Ms:_="ENVMAP_TYPE_SPHERE"}switch(f.envMap.mapping){case ws:case Ss:S="ENVMAP_MODE_REFRACTION"}switch(f.combine){case us:M="ENVMAP_BLENDING_MULTIPLY";break;case ds:M="ENVMAP_BLENDING_MIX";break;case ps:M="ENVMAP_BLENDING_ADD"}}var T,E,C=e.gammaFactor>0?e.gammaFactor:1,A=r(v,m,e.extensions),N=o(y),L=g.createProgram();f&&f.isRawShaderMaterial?(T=[N].filter(h).join("\n"),E=[N].filter(h).join("\n")):(T=["precision "+m.precision+" float;","precision "+m.precision+" int;","#define SHADER_NAME "+f.__webglShader.name,N,m.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+C,"#define MAX_BONES "+m.maxBones,m.map?"#define USE_MAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+S:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.displacementMap&&m.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.vertexColors?"#define USE_COLOR":"",m.flatShading?"#define FLAT_SHADED":"",m.skinning?"#define USE_SKINNING":"",m.useVertexTexture?"#define BONE_TEXTURE":"",m.morphTargets?"#define USE_MORPHTARGETS":"",m.morphNormals&&m.flatShading===!1?"#define USE_MORPHNORMALS":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+m.numClippingPlanes,m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+w:"",m.sizeAttenuation?"#define USE_SIZEATTENUATION":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&e.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(h).join("\n"),
E=[A,"precision "+m.precision+" float;","precision "+m.precision+" int;","#define SHADER_NAME "+f.__webglShader.name,N,m.alphaTest?"#define ALPHATEST "+m.alphaTest:"","#define GAMMA_FACTOR "+C,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+_:"",m.envMap?"#define "+S:"",m.envMap?"#define "+M:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.vertexColors?"#define USE_COLOR":"",m.flatShading?"#define FLAT_SHADED":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+m.numClippingPlanes,m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+w:"",m.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",m.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&e.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",m.envMap&&e.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",m.toneMapping!==fs?"#define TONE_MAPPING":"",m.toneMapping!==fs?Ia.tonemapping_pars_fragment:"",m.toneMapping!==fs?s("toneMapping",m.toneMapping):"",m.outputEncoding||m.mapEncoding||m.envMapEncoding||m.emissiveMapEncoding?Ia.encodings_pars_fragment:"",m.mapEncoding?i("mapTexelToLinear",m.mapEncoding):"",m.envMapEncoding?i("envMapTexelToLinear",m.envMapEncoding):"",m.emissiveMapEncoding?i("emissiveMapTexelToLinear",m.emissiveMapEncoding):"",m.outputEncoding?n("linearToOutputTexel",m.outputEncoding):"",m.depthPacking?"#define DEPTH_PACKING "+f.depthPacking:"","\n"].filter(h).join("\n")),x=c(x,m),x=l(x,m),b=c(b,m),b=l(b,m),(f&&f.isShaderMaterial)===!1&&(x=u(x),b=u(b));var P=T+x,k=E+b,I=t.WebGLShader(g,g.VERTEX_SHADER,P),D=t.WebGLShader(g,g.FRAGMENT_SHADER,k);g.attachShader(L,I),g.attachShader(L,D),void 0!==f.index0AttributeName?g.bindAttribLocation(L,0,f.index0AttributeName):m.morphTargets===!0&&g.bindAttribLocation(L,0,"position"),g.linkProgram(L);var z=g.getProgramInfoLog(L),R=g.getShaderInfoLog(I),O=g.getShaderInfoLog(D),B=!0,F=!0;g.getProgramParameter(L,g.LINK_STATUS)===!1?(B=!1,console.error("THREE.WebGLProgram: shader error: ",g.getError(),"gl.VALIDATE_STATUS",g.getProgramParameter(L,g.VALIDATE_STATUS),"gl.getProgramInfoLog",z,R,O)):""!==z?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",z):""!==R&&""!==O||(F=!1),F&&(this.diagnostics={runnable:B,material:f,programLog:z,vertexShader:{log:R,prefix:T},fragmentShader:{log:O,prefix:E}}),g.deleteShader(I),g.deleteShader(D);var U;this.getUniforms=function(){return void 0===U&&(U=new t.WebGLUniforms(g,L,e)),U};var V;return this.getAttributes=function(){return void 0===V&&(V=a(g,L)),V},this.destroy=function(){g.deleteProgram(L),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=d++,this.code=p,this.usedTimes=1,this.program=L,this.vertexShader=I,this.fragmentShader=D,this}}(),k.prototype={constructor:k,isBufferAttribute:!0,get count(){return this.array.length/this.itemSize},set needsUpdate(t){t===!0&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,s=this.itemSize;n<s;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,s=t.length;n<s;n++){var r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),r=new _),e[i++]=r.r,e[i++]=r.g,e[i++]=r.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,n=0,s=t.length;n<s;n++){var r=t[n];e[i++]=r.a,e[i++]=r.b,e[i++]=r.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,s=0,r=t.length;s<r;s++){var o=t[s];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),o=new i),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,s=t.length;n<s;n++){var r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),r=new a),e[i++]=r.x,e[i++]=r.y,e[i++]=r.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,s=t.length;n<s;n++){var r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),r=new p),e[i++]=r.x,e[i++]=r.y,e[i++]=r.z,e[i++]=r.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,s){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=s,this},clone:function(){return(new this.constructor).copy(this)}},W.prototype={constructor:W,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},j.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],j.DefaultOrder="XYZ",j.prototype={constructor:j,isEuler:!0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,i,n){var s=t.Math.clamp,r=e.elements,o=r[0],a=r[4],h=r[8],l=r[1],c=r[5],u=r[9],d=r[2],p=r[6],f=r[10];return i=i||this._order,"XYZ"===i?(this._y=Math.asin(s(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,c),this._z=0)):"YXZ"===i?(this._x=Math.asin(-s(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(h,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,o),this._z=0)):"ZXY"===i?(this._x=Math.asin(s(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===i?(this._y=Math.asin(-s(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(p,f),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===i?(this._z=Math.asin(s(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(h,f))):"XZY"===i?(this._z=Math.asin(-s(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(p,c),this._y=Math.atan2(h,o)):(this._x=Math.atan2(-u,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this._order=i,n!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,i,n){return void 0===t&&(t=new r),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,i,n)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new o;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new a(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},G.prototype={constructor:G,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!==(this.mask&t.mask)}},X.DefaultUp=new a(0,1,0),X.DefaultMatrixAutoUpdate=!0,Object.assign(X.prototype,e.prototype,{isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new o;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new a(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new a(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new a(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new a;return function(e,i){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translateX:function(){var t=new a(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new a(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new a(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new r;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new r;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var i=this.children.indexOf(t);i!==-1&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(i,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;i<n;i++){var s=this.children[i],r=s.getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){var e=t||new a;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new a,e=new a;return function(i){var n=i||new o;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new o;return function(e){var i=e||new j;return this.getWorldQuaternion(t),i.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new a,e=new o;return function(i){var n=i||new a;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new o;return function(e){var i=e||new a;return this.getWorldQuaternion(t),i.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),this.matrixWorldNeedsUpdate!==!0&&t!==!0||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}var i=void 0===t||""===t,n={};i&&(t={geometries:{},materials:{},textures:{},images:{}},n.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var s={};if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),s.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),s.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),s.material=this.material.uuid),this.children.length>0){s.children=[];for(var r=0;r<this.children.length;r++)s.children.push(this.children[r].toJSON(t).object)}if(i){var o=e(t.geometries),a=e(t.materials),h=e(t.textures),l=e(t.images);o.length>0&&(n.geometries=o),a.length>0&&(n.materials=a),h.length>0&&(n.textures=h),l.length>0&&(n.images=l)}return n.object=s,n},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this}});var Da=0;Object.assign(q.prototype,e.prototype,{isGeometry:!0,applyMatrix:function(t){for(var e=(new E).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++){var s=this.vertices[i];s.applyMatrix4(t)}for(var i=0,n=this.faces.length;i<n;i++){var r=this.faces[i];r.normal.applyMatrix3(e).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new r),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new r),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new r),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,i,n){return void 0===t&&(t=new r),t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,i,n){return void 0===t&&(t=new r),t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new X),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,i,s){var r=void 0!==h?[d[t].clone(),d[e].clone(),d[i].clone()]:[],o=void 0!==l?[n.colors[t].clone(),n.colors[e].clone(),n.colors[i].clone()]:[],a=new W(t,e,i,r,o,s);n.faces.push(a),void 0!==c&&n.faceVertexUvs[0].push([p[t].clone(),p[e].clone(),p[i].clone()]),void 0!==u&&n.faceVertexUvs[1].push([f[t].clone(),f[e].clone(),f[i].clone()])}var n=this,s=null!==t.index?t.index.array:void 0,r=t.attributes,o=r.position.array,h=void 0!==r.normal?r.normal.array:void 0,l=void 0!==r.color?r.color.array:void 0,c=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var d=[],p=[],f=[],m=0,g=0;m<o.length;m+=3,g+=2)n.vertices.push(new a(o[m],o[m+1],o[m+2])),void 0!==h&&d.push(new a(h[m],h[m+1],h[m+2])),void 0!==l&&n.colors.push(new _(l[m],l[m+1],l[m+2])),void 0!==c&&p.push(new i(c[g],c[g+1])),void 0!==u&&f.push(new i(u[g],u[g+1]));if(void 0!==s){var v=t.groups;if(v.length>0)for(var m=0;m<v.length;m++)for(var y=v[m],x=y.start,b=y.count,g=x,w=x+b;g<w;g+=3)e(s[g],s[g+1],s[g+2],y.materialIndex);else for(var m=0;m<s.length;m+=3)e(s[m],s[m+1],s[m+2])}else for(var m=0;m<o.length/3;m+=3)e(m,m+1,m+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,n=new r;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new a,e=new a,i=0,n=this.faces.length;i<n;i++){var s=this.faces[i],r=this.vertices[s.a],o=this.vertices[s.b],h=this.vertices[s.c];t.subVectors(h,o),e.subVectors(r,o),t.cross(e),t.normalize(),s.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,i,n,s,r,o;for(o=new Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)o[e]=new a;if(t){var h,l,c,u=new a,d=new a;for(n=0,s=this.faces.length;n<s;n++)r=this.faces[n],h=this.vertices[r.a],l=this.vertices[r.b],c=this.vertices[r.c],u.subVectors(c,l),d.subVectors(h,l),u.cross(d),o[r.a].add(u),o[r.b].add(u),o[r.c].add(u)}else for(n=0,s=this.faces.length;n<s;n++)r=this.faces[n],o[r.a].add(r.normal),o[r.b].add(r.normal),o[r.c].add(r.normal);for(e=0,i=this.vertices.length;e<i;e++)o[e].normalize();for(n=0,s=this.faces.length;n<s;n++){r=this.faces[n];var p=r.vertexNormals;3===p.length?(p[0].copy(o[r.a]),p[1].copy(o[r.b]),p[2].copy(o[r.c])):(p[0]=o[r.a].clone(),p[1]=o[r.b].clone(),p[2]=o[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i,n,s;for(i=0,n=this.faces.length;i<n;i++)for(s=this.faces[i],s.__originalFaceNormal?s.__originalFaceNormal.copy(s.normal):s.__originalFaceNormal=s.normal.clone(),s.__originalVertexNormals||(s.__originalVertexNormals=[]),t=0,e=s.vertexNormals.length;t<e;t++)s.__originalVertexNormals[t]?s.__originalVertexNormals[t].copy(s.vertexNormals[t]):s.__originalVertexNormals[t]=s.vertexNormals[t].clone();var r=new q;for(r.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o,h,l=this.morphNormals[t].faceNormals,c=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)o=new a,h={a:new a,b:new a,c:new a},l.push(o),c.push(h)}var u=this.morphNormals[t];r.vertices=this.morphTargets[t].vertices,r.computeFaceNormals(),r.computeVertexNormals();var o,h;for(i=0,n=this.faces.length;i<n;i++)s=this.faces[i],o=u.faceNormals[i],h=u.vertexNormals[i],o.copy(s.normal),h.a.copy(s.vertexNormals[0]),h.b.copy(s.vertexNormals[1]),h.c.copy(s.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)s=this.faces[i],s.normal=s.__originalFaceNormal,s.vertexNormals=s.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,n=e.length;i<n;i++)i>0&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new M),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new T),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if((t&&t.isGeometry)===!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var n,s=this.vertices.length,r=this.vertices,o=t.vertices,a=this.faces,h=t.faces,l=this.faceVertexUvs[0],c=t.faceVertexUvs[0];void 0===i&&(i=0),void 0!==e&&(n=(new E).getNormalMatrix(e));for(var u=0,d=o.length;u<d;u++){var p=o[u],f=p.clone();void 0!==e&&f.applyMatrix4(e),r.push(f)}for(u=0,d=h.length;u<d;u++){var m,g,v,y=h[u],x=y.vertexNormals,b=y.vertexColors;m=new W(y.a+s,y.b+s,y.c+s),m.normal.copy(y.normal),void 0!==n&&m.normal.applyMatrix3(n).normalize();for(var w=0,_=x.length;w<_;w++)g=x[w].clone(),void 0!==n&&g.applyMatrix3(n).normalize(),m.vertexNormals.push(g);m.color.copy(y.color);for(var w=0,_=b.length;w<_;w++)v=b[w],m.vertexColors.push(v.clone());m.materialIndex=y.materialIndex+i,a.push(m)}for(u=0,d=c.length;u<d;u++){var S=c[u],M=[];if(void 0!==S){for(var w=0,_=S.length;w<_;w++)M.push(S[w].clone());l.push(M)}}},mergeMesh:function(t){return(t&&t.isMesh)===!1?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),void this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,i,n,s,r,o,a,h={},l=[],c=[],u=4,d=Math.pow(10,u);for(i=0,n=this.vertices.length;i<n;i++)t=this.vertices[i],e=Math.round(t.x*d)+"_"+Math.round(t.y*d)+"_"+Math.round(t.z*d),void 0===h[e]?(h[e]=i,l.push(this.vertices[i]),c[i]=l.length-1):c[i]=c[h[e]];var p=[];for(i=0,n=this.faces.length;i<n;i++){s=this.faces[i],s.a=c[s.a],s.b=c[s.b],s.c=c[s.c],r=[s.a,s.b,s.c];for(var f=-1,m=0;m<3;m++)if(r[m]===r[(m+1)%3]){f=m,p.push(i);break}}for(i=p.length-1;i>=0;i--){var g=p[i];for(this.faces.splice(g,1),o=0,a=this.faceVertexUvs.length;o<a;o++)this.faceVertexUvs[o].splice(g,1)}var v=this.vertices.length-l.length;return this.vertices=l,v},sortFacesByMaterialIndex:function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,i=e.length,n=0;n<i;n++)e[n]._id=n;e.sort(t);var s,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===i&&(s=[]),a&&a.length===i&&(r=[]);for(var n=0;n<i;n++){var h=e[n]._id;s&&s.push(o[h]),r&&r.push(a[h])}s&&(this.faceVertexUvs[0]=s),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){function t(t,e,i){return i?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==d[e]?d[e]:(d[e]=u.length/3,u.push(t.x,t.y,t.z),d[e])}function i(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==f[e]?f[e]:(f[e]=p.length,p.push(t.getHex()),f[e])}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==g[e]?g[e]:(g[e]=m.length/2,m.push(t.x,t.y),g[e])}var s={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),void 0!==this.parameters){var r=this.parameters;for(var o in r)void 0!==r[o]&&(s[o]=r[o]);return s}for(var a=[],h=0;h<this.vertices.length;h++){var l=this.vertices[h];a.push(l.x,l.y,l.z)}for(var c=[],u=[],d={},p=[],f={},m=[],g={},h=0;h<this.faces.length;h++){var v=this.faces[h],y=!0,x=!1,b=void 0!==this.faceVertexUvs[0][h],w=v.normal.length()>0,_=v.vertexNormals.length>0,S=1!==v.color.r||1!==v.color.g||1!==v.color.b,M=v.vertexColors.length>0,T=0;if(T=t(T,0,0),T=t(T,1,y),T=t(T,2,x),T=t(T,3,b),T=t(T,4,w),T=t(T,5,_),T=t(T,6,S),T=t(T,7,M),c.push(T),c.push(v.a,v.b,v.c),c.push(v.materialIndex),b){var E=this.faceVertexUvs[0][h];c.push(n(E[0]),n(E[1]),n(E[2]))}if(w&&c.push(e(v.normal)),_){var C=v.vertexNormals;c.push(e(C[0]),e(C[1]),e(C[2]))}if(S&&c.push(i(v.color)),M){var A=v.vertexColors;c.push(i(A[0]),i(A[1]),i(A[2]))}}return s.data={},s.data.vertices=a,s.data.normals=u,p.length>0&&(s.data.colors=p),m.length>0&&(s.data.uvs=[m]),s.data.faces=c,s},clone:function(){return(new q).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var e=t.vertices,i=0,n=e.length;i<n;i++)this.vertices.push(e[i].clone());for(var s=t.faces,i=0,n=s.length;i<n;i++)this.faces.push(s[i].clone());for(var i=0,n=t.faceVertexUvs.length;i<n;i++){var r=t.faceVertexUvs[i];void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]);for(var o=0,a=r.length;o<a;o++){for(var h=r[o],l=[],c=0,u=h.length;c<u;c++){var d=h[c];l.push(d.clone())}this.faceVertexUvs[i].push(l)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var za=0;Object.assign(Z.prototype,e.prototype,{computeBoundingBox:q.prototype.computeBoundingBox,computeBoundingSphere:q.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(t){for(var e,i,n=[],s=t.faces,r=0;r<s.length;r++){var o=s[r];o.materialIndex!==i&&(i=o.materialIndex,void 0!==e&&(e.count=3*r-e.start,n.push(e)),e={start:3*r,materialIndex:i})}void 0!==e&&(e.count=3*r-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,s=t.vertices,r=t.faceVertexUvs,o=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,h=t.morphTargets,l=h.length;if(l>0){e=[];for(var c=0;c<l;c++)e[c]=[];this.morphTargets.position=e}var u,d=t.morphNormals,p=d.length;if(p>0){u=[];for(var c=0;c<p;c++)u[c]=[];this.morphTargets.normal=u}for(var f=t.skinIndices,m=t.skinWeights,g=f.length===s.length,v=m.length===s.length,c=0;c<n.length;c++){var y=n[c];this.vertices.push(s[y.a],s[y.b],s[y.c]);var x=y.vertexNormals;if(3===x.length)this.normals.push(x[0],x[1],x[2]);else{var b=y.normal;this.normals.push(b,b,b)}var w=y.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var _=y.color;this.colors.push(_,_,_)}if(o===!0){var S=r[0][c];void 0!==S?this.uvs.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new i,new i,new i))}if(a===!0){var S=r[1][c];void 0!==S?this.uvs2.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new i,new i,new i))}for(var M=0;M<l;M++){var T=h[M].vertices;e[M].push(T[y.a],T[y.b],T[y.c])}for(var M=0;M<p;M++){var E=d[M].vertexNormals[c];u[M].push(E.a,E.b,E.c)}g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(J.prototype,e.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e){return(e&&e.isBufferAttribute)===!1&&(e&&e.isInterleavedBufferAttribute)===!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new k(arguments[1],arguments[2]))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){var n=(new E).getNormalMatrix(t);n.applyToVector3Array(i.array),i.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new r),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new r),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new r),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,i,n){return void 0===t&&(t=new r),t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,i,n){return void 0===t&&(t=new r),t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new X),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t&&t.isPoints||t&&t.isLine){var i=new U(3*e.vertices.length,3),n=new U(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var s=new U(e.lineDistances.length,1);this.addAttribute("lineDistance",s.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t&&t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t&&t.isMesh){var i=e.__directGeometry;if(e.elementsNeedUpdate===!0&&(i=void 0,e.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(e);i.verticesNeedUpdate=e.verticesNeedUpdate,i.normalsNeedUpdate=e.normalsNeedUpdate,i.colorsNeedUpdate=e.colorsNeedUpdate,i.uvsNeedUpdate=e.uvsNeedUpdate,i.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=i}var n;return e.verticesNeedUpdate===!0&&(n=this.attributes.position,void 0!==n&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),e.normalsNeedUpdate===!0&&(n=this.attributes.normal,void 0!==n&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),e.colorsNeedUpdate===!0&&(n=this.attributes.color,void 0!==n&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(n=this.attributes.uv,void 0!==n&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,void 0!==n&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),
e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Z).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new k(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new k(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new k(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var s=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new k(s,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var r=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new k(r,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var o=t.vertices.length>65535?Uint32Array:Uint16Array,a=new o(3*t.indices.length);this.setIndex(new k(a,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var h in t.morphTargets){for(var l=[],c=t.morphTargets[h],u=0,d=c.length;u<d;u++){var p=c[u],f=new U(3*p.length,3);l.push(f.copyVector3sArray(p))}this.morphAttributes[h]=l}if(t.skinIndices.length>0){var m=new U(4*t.skinIndices.length,4);this.addAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var g=new U(4*t.skinWeights.length,4);this.addAttribute("skinWeight",g.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new M);var t=this.attributes.position.array;void 0!==t?this.boundingBox.setFromArray(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new M,e=new a;return function(){null===this.boundingSphere&&(this.boundingSphere=new T);var i=this.attributes.position;if(i){var n=i.array,s=this.boundingSphere.center;t.setFromArray(n),t.center(s);for(var r=0,o=0,a=n.length;o<a;o+=3)e.fromArray(n,o),r=Math.max(r,s.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new k(new Float32Array(n.length),3));else for(var s=e.normal.array,r=0,o=s.length;r<o;r++)s[r]=0;var h,l,c,u=e.normal.array,d=new a,p=new a,f=new a,m=new a,g=new a;if(t){var v=t.array;0===i.length&&this.addGroup(0,v.length);for(var y=0,x=i.length;y<x;++y)for(var b=i[y],w=b.start,_=b.count,r=w,o=w+_;r<o;r+=3)h=3*v[r+0],l=3*v[r+1],c=3*v[r+2],d.fromArray(n,h),p.fromArray(n,l),f.fromArray(n,c),m.subVectors(f,p),g.subVectors(d,p),m.cross(g),u[h]+=m.x,u[h+1]+=m.y,u[h+2]+=m.z,u[l]+=m.x,u[l+1]+=m.y,u[l+2]+=m.z,u[c]+=m.x,u[c+1]+=m.y,u[c+2]+=m.z}else for(var r=0,o=n.length;r<o;r+=9)d.fromArray(n,r),p.fromArray(n,r+3),f.fromArray(n,r+6),m.subVectors(f,p),g.subVectors(d,p),m.cross(g),u[r]=m.x,u[r+1]=m.y,u[r+2]=m.z,u[r+3]=m.x,u[r+4]=m.y,u[r+5]=m.z,u[r+6]=m.x,u[r+7]=m.y,u[r+8]=m.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if((t&&t.isBufferGeometry)===!1)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0);var i=this.attributes;for(var n in i)if(void 0!==t.attributes[n])for(var s=i[n],r=s.array,o=t.attributes[n],a=o.array,h=o.itemSize,l=0,c=h*e;l<a.length;l++,c++)r[c]=a[l];return this},normalizeNormals:function(){for(var t,e,i,n,s=this.attributes.normal.array,r=0,o=s.length;r<o;r+=3)t=s[r],e=s[r+1],i=s[r+2],n=1/Math.sqrt(t*t+e*e+i*i),s[r]*=n,s[r+1]*=n,s[r+2]*=n},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new J,e=this.index.array,i=this.attributes;for(var n in i){for(var s=i[n],r=s.array,o=s.itemSize,a=new r.constructor(e.length*o),h=0,l=0,c=0,u=e.length;c<u;c++){h=e[c]*o;for(var d=0;d<o;d++)a[l++]=r[h++]}t.addAttribute(n,new k(a,o))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var n=this.index;if(null!==n){var s=Array.prototype.slice.call(n.array);t.data.index={type:n.array.constructor.name,array:s}}var r=this.attributes;for(var i in r){var o=r[i],s=Array.prototype.slice.call(o.array);t.data.attributes[i]={itemSize:o.itemSize,type:o.array.constructor.name,array:s,normalized:o.normalized}}var a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));var h=this.boundingSphere;return null!==h&&(t.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),t},clone:function(){return(new J).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var n in i){var s=i[n];this.addAttribute(n,s.clone())}for(var r=t.groups,o=0,a=r.length;o<a;o++){var h=r[o];this.addGroup(h.start,h.count,h.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),J.MaxIndex=65535,ot.prototype=Object.create(y.prototype),ot.prototype.constructor=ot,ot.prototype.isWebGLRenderTargetCube=!0,at.prototype=Object.create(J.prototype),at.prototype.constructor=at,ht.prototype={constructor:ht,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){var i=e||new a;return i.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new a;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var i=e||new a;i.subVectors(t,this.origin);var n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new a;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new a,e=new a,i=new a;return function(n,s,r,o){t.copy(n).add(s).multiplyScalar(.5),e.copy(s).sub(n).normalize(),i.copy(this.origin).sub(t);var a,h,l,c,u=.5*n.distanceTo(s),d=-this.direction.dot(e),p=i.dot(this.direction),f=-i.dot(e),m=i.lengthSq(),g=Math.abs(1-d*d);if(g>0)if(a=d*f-p,h=d*p-f,c=u*g,a>=0)if(h>=-c)if(h<=c){var v=1/g;a*=v,h*=v,l=a*(a+d*h+2*p)+h*(d*a+h+2*f)+m}else h=u,a=Math.max(0,-(d*h+p)),l=-a*a+h*(h+2*f)+m;else h=-u,a=Math.max(0,-(d*h+p)),l=-a*a+h*(h+2*f)+m;else h<=-c?(a=Math.max(0,-(-d*u+p)),h=a>0?-u:Math.min(Math.max(-u,-f),u),l=-a*a+h*(h+2*f)+m):h<=c?(a=0,h=Math.min(Math.max(-u,-f),u),l=h*(h+2*f)+m):(a=Math.max(0,-(d*u+p)),h=a>0?u:Math.min(Math.max(-u,-f),u),l=-a*a+h*(h+2*f)+m);else h=d>0?-u:u,a=Math.max(0,-(d*h+p)),l=-a*a+h*(h+2*f)+m;return r&&r.copy(this.direction).multiplyScalar(a).add(this.origin),o&&o.copy(e).multiplyScalar(h).add(t),l}}(),intersectSphere:function(){var t=new a;return function(e,i){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),s=t.dot(t)-n*n,r=e.radius*e.radius;if(s>r)return null;var o=Math.sqrt(r-s),a=n-o,h=n+o;return a<0&&h<0?null:a<0?this.at(h,i):this.at(a,i)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var i=t.normal.dot(this.direction);return i*e<0},intersectBox:function(t,e){var i,n,s,r,o,a,h=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,u=this.origin;return h>=0?(i=(t.min.x-u.x)*h,n=(t.max.x-u.x)*h):(i=(t.max.x-u.x)*h,n=(t.min.x-u.x)*h),l>=0?(s=(t.min.y-u.y)*l,r=(t.max.y-u.y)*l):(s=(t.max.y-u.y)*l,r=(t.min.y-u.y)*l),i>r||s>n?null:((s>i||i!==i)&&(i=s),(r<n||n!==n)&&(n=r),c>=0?(o=(t.min.z-u.z)*c,a=(t.max.z-u.z)*c):(o=(t.max.z-u.z)*c,a=(t.min.z-u.z)*c),i>a||o>n?null:((o>i||i!==i)&&(i=o),(a<n||n!==n)&&(n=a),n<0?null:this.at(i>=0?i:n,e)))},intersectsBox:function(){var t=new a;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new a,e=new a,i=new a,n=new a;return function(s,r,o,a,h){e.subVectors(r,s),i.subVectors(o,s),n.crossVectors(e,i);var l,c=this.direction.dot(n);if(c>0){if(a)return null;l=1}else{if(!(c<0))return null;l=-1,c=-c}t.subVectors(this.origin,s);var u=l*this.direction.dot(i.crossVectors(t,i));if(u<0)return null;var d=l*this.direction.dot(e.cross(t));if(d<0)return null;if(u+d>c)return null;var p=-l*t.dot(n);return p<0?null:this.at(p/c,h)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},lt.prototype={constructor:lt,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){var e=t||new a;return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var e=t||new a;return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new a;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var e=new a,i=new a;return function(n,s){e.subVectors(n,this.start),i.subVectors(this.end,this.start);var r=i.dot(i),o=i.dot(e),a=o/r;return s&&(a=t.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e),s=i||new a;return this.delta(s).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},ct.normal=function(){var t=new a;return function(e,i,n,s){var r=s||new a;r.subVectors(n,i),t.subVectors(e,i),r.cross(t);var o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}}(),ct.barycoordFromPoint=function(){var t=new a,e=new a,i=new a;return function(n,s,r,o,h){t.subVectors(o,s),e.subVectors(r,s),i.subVectors(n,s);var l=t.dot(t),c=t.dot(e),u=t.dot(i),d=e.dot(e),p=e.dot(i),f=l*d-c*c,m=h||new a;if(0===f)return m.set(-2,-1,-1);var g=1/f,v=(d*u-c*p)*g,y=(l*p-c*u)*g;return m.set(1-v-y,y,v)}}(),ct.containsPoint=function(){var t=new a;return function(e,i,n,s){var r=ct.barycoordFromPoint(e,i,n,s,t);return r.x>=0&&r.y>=0&&r.x+r.y<=1}}(),ct.prototype={constructor:ct,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new a,e=new a;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){var e=t||new a;return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return ct.normal(this.a,this.b,this.c,t)},plane:function(t){var e=t||new C;return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return ct.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return ct.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t,e,i,n;return function(s,r){void 0===t&&(t=new C,e=[new lt,new lt,new lt],i=new a,n=new a);var o=r||new a,h=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(s,i),this.containsPoint(i)===!0)o.copy(i);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var l=0;l<e.length;l++){e[l].closestPointToPoint(i,!0,n);var c=i.distanceToSquared(n);c<h&&(h=c,o.copy(n))}}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},ut.prototype=Object.create(x.prototype),ut.prototype.constructor=ut,ut.prototype.isMeshBasicMaterial=!0,ut.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},dt.prototype=Object.assign(Object.create(X.prototype),{constructor:dt,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return X.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;t<e;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},getMorphTargetIndexByName:function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},raycast:function(){function t(t,e,i,n,s,r,o){return ct.barycoordFromPoint(t,e,i,n,y),s.multiplyScalar(y.x),r.multiplyScalar(y.y),o.multiplyScalar(y.z),s.add(r).add(o),s.clone()}function e(t,e,i,n,s,r,o){var a,h=t.material;if(a=h.side===An?i.intersectTriangle(r,s,n,!0,o):i.intersectTriangle(n,s,r,h.side!==Nn,o),null===a)return null;b.copy(o),b.applyMatrix4(t.matrixWorld);var l=e.ray.origin.distanceTo(b);return l<e.near||l>e.far?null:{distance:l,point:b.clone(),object:t}}function n(i,n,s,r,o,a,h,d){l.fromArray(r,3*a),c.fromArray(r,3*h),u.fromArray(r,3*d);var p=e(i,n,s,l,c,u,x);return p&&(o&&(m.fromArray(o,2*a),g.fromArray(o,2*h),v.fromArray(o,2*d),p.uv=t(x,l,c,u,m,g,v)),p.face=new W(a,h,d,ct.normal(l,c,u)),p.faceIndex=a),p}var s=new r,o=new ht,h=new T,l=new a,c=new a,u=new a,d=new a,p=new a,f=new a,m=new i,g=new i,v=new i,y=new a,x=new a,b=new a;return function(i,r){var a=this.geometry,y=this.material,b=this.matrixWorld;if(void 0!==y&&(null===a.boundingSphere&&a.computeBoundingSphere(),h.copy(a.boundingSphere),h.applyMatrix4(b),i.ray.intersectsSphere(h)!==!1&&(s.getInverse(b),o.copy(i.ray).applyMatrix4(s),null===a.boundingBox||o.intersectsBox(a.boundingBox)!==!1))){var w,_;if(a&&a.isBufferGeometry){var S,M,T,E=a.index,C=a.attributes,A=C.position.array;if(void 0!==C.uv&&(w=C.uv.array),null!==E)for(var N=E.array,L=0,P=N.length;L<P;L+=3)S=N[L],M=N[L+1],T=N[L+2],_=n(this,i,o,A,w,S,M,T),_&&(_.faceIndex=Math.floor(L/3),r.push(_));else for(var L=0,P=A.length;L<P;L+=9)S=L/3,M=S+1,T=S+2,_=n(this,i,o,A,w,S,M,T),_&&(_.index=S,r.push(_))}else if(a&&a.isGeometry){var k,I,D,z=y&&y.isMultiMaterial,R=z===!0?y.materials:null,O=a.vertices,B=a.faces,F=a.faceVertexUvs[0];F.length>0&&(w=F);for(var U=0,V=B.length;U<V;U++){var H=B[U],W=z===!0?R[H.materialIndex]:y;if(void 0!==W){if(k=O[H.a],I=O[H.b],D=O[H.c],W.morphTargets===!0){var j=a.morphTargets,G=this.morphTargetInfluences;l.set(0,0,0),c.set(0,0,0),u.set(0,0,0);for(var X=0,Y=j.length;X<Y;X++){var q=G[X];if(0!==q){var $=j[X].vertices;l.addScaledVector(d.subVectors($[H.a],k),q),c.addScaledVector(p.subVectors($[H.b],I),q),u.addScaledVector(f.subVectors($[H.c],D),q)}}l.add(k),c.add(I),u.add(D),k=l,I=c,D=u}if(_=e(this,i,o,k,I,D,x)){if(w){var Z=w[U];m.copy(Z[0]),g.copy(Z[1]),v.copy(Z[2]),_.uv=t(x,k,I,D,m,g,v)}_.face=H,_.faceIndex=U,r.push(_)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),pt.prototype=Object.create(J.prototype),pt.prototype.constructor=pt,ft.prototype=Object.create(X.prototype),ft.prototype.constructor=ft,ft.prototype.isCamera=!0,ft.prototype.getWorldDirection=function(){var t=new o;return function(e){var i=e||new a;return this.getWorldQuaternion(t),i.set(0,0,-1).applyQuaternion(t)}}(),ft.prototype.lookAt=function(){var t=new r;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),ft.prototype.clone=function(){return(new this.constructor).copy(this)},ft.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},mt.prototype=Object.assign(Object.create(ft.prototype),{constructor:mt,isPerspectiveCamera:!0,copy:function(t){return ft.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(e){var i=.5*this.getFilmHeight()/e;this.fov=2*t.Math.RAD2DEG*Math.atan(i),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*t.Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*t.Math.RAD2DEG*Math.atan(Math.tan(.5*t.Math.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,s,r){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:i,offsetY:n,width:s,height:r},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,i=e*Math.tan(.5*t.Math.DEG2RAD*this.fov)/this.zoom,n=2*i,s=this.aspect*n,r=-.5*s,o=this.view;if(null!==o){var a=o.fullWidth,h=o.fullHeight;r+=o.offsetX*s/a,i-=o.offsetY*n/h,s*=o.width/a,n*=o.height/h}var l=this.filmOffset;0!==l&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makeFrustum(r,r+s,i-n,i,e,this.far)},toJSON:function(t){var e=X.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),gt.prototype=Object.assign(Object.create(ft.prototype),{constructor:gt,isOrthographicCamera:!0,copy:function(t){return ft.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,s,r){this.view={fullWidth:t,fullHeight:e,offsetX:i,offsetY:n,width:s,height:r},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,s=i-t,r=i+t,o=n+e,a=n-e;if(null!==this.view){var h=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;s+=c*(this.view.offsetX/h),r=s+c*(this.view.width/h),o-=u*(this.view.offsetY/l),a=o-u*(this.view.height/l)}this.projectionMatrix.makeOrthographic(s,r,o,a,this.near,this.far)},toJSON:function(t){var e=X.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),yt.prototype.isFogExp2=!0,yt.prototype.clone=function(){return new yt(this.color.getHex(),this.density)},yt.prototype.toJSON=function(t){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},xt.prototype.isFog=!0,xt.prototype.clone=function(){return new xt(this.color.getHex(),this.near,this.far)},xt.prototype.toJSON=function(t){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},bt.prototype=Object.create(X.prototype),bt.prototype.constructor=bt,bt.prototype.copy=function(t,e){return X.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},bt.prototype.toJSON=function(t){var e=X.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},wt.prototype=Object.assign(Object.create(X.prototype),{constructor:wt,isLensFlare:!0,copy:function(t){X.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,i=t.lensFlares.length;e<i;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,i,n,s,r){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===r&&(r=1),void 0===s&&(s=new _(16777215)),void 0===n&&(n=Rn),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:r,color:s,blending:n})},updateLensFlares:function(){var t,e,i=this.lensFlares.length,n=2*-this.positionScreen.x,s=2*-this.positionScreen.y;for(t=0;t<i;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+n*e.distance,e.y=this.positionScreen.y+s*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),_t.prototype=Object.create(x.prototype),_t.prototype.constructor=_t,_t.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},St.prototype=Object.assign(Object.create(X.prototype),{constructor:St,isSprite:!0,raycast:function(){var t=new a;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.distanceSqToPoint(t),s=this.scale.x*this.scale.y/4;n>s||i.push({distance:Math.sqrt(n),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),Mt.prototype=Object.assign(Object.create(X.prototype),{constructor:Mt,copy:function(t){X.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,n=e.length;i<n;i++){var s=e[i];this.addLevel(s.object.clone(),s.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length&&!(e<i[n].distance);n++);i.splice(n,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,i=1,n=e.length;i<n&&!(t<e[i].distance);i++);return e[i-1].object},raycast:function(){var t=new a;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,i)}}(),update:function(){var t=new a,e=new a;return function(i){var n=this.levels;if(n.length>1){t.setFromMatrixPosition(i.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var s=t.distanceTo(e);n[0].object.visible=!0;for(var r=1,o=n.length;r<o&&s>=n[r].distance;r++)n[r-1].object.visible=!1,n[r].object.visible=!0;for(;r<o;r++)n[r].object.visible=!1}}}(),toJSON:function(t){var e=X.prototype.toJSON.call(this,t);e.object.levels=[];for(var i=this.levels,n=0,s=i.length;n<s;n++){var r=i[n];e.object.levels.push({object:r.object.uuid,distance:r.distance})}return e}}),Tt.prototype=Object.create(n.prototype),Tt.prototype.constructor=Tt,Tt.prototype.isDataTexture=!0,Object.assign(Et.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new r;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){for(var t,e=0,i=this.bones.length;e<i;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(var e=0,i=this.bones.length;e<i;e++)t=this.bones[e],t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new r;return function(){for(var e=0,i=this.bones.length;e<i;e++){var n=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;t.multiplyMatrices(n,this.boneInverses[e]),t.toArray(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),clone:function(){return new Et(this.bones,this.boneInverses,this.useVertexTexture)}}),Ct.prototype=Object.assign(Object.create(X.prototype),{constructor:Ct,isBone:!0,copy:function(t){return X.prototype.copy.call(this,t),this.skin=t.skin,this}}),At.prototype=Object.assign(Object.create(dt.prototype),{constructor:At,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t],i=1/e.lengthManhattan();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry)for(var n=new p,s=this.geometry.attributes.skinWeight,t=0;t<s.count;t++){n.x=s.getX(t),n.y=s.getY(t),n.z=s.getZ(t),n.w=s.getW(t);var i=1/n.lengthManhattan();i!==1/0?n.multiplyScalar(i):n.set(1,0,0,0),s.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(t){dt.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),Nt.prototype=Object.create(x.prototype),Nt.prototype.constructor=Nt,Nt.prototype.isLineBasicMaterial=!0,Nt.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},Lt.prototype=Object.assign(Object.create(X.prototype),{constructor:Lt,isLine:!0,raycast:function(){var t=new r,e=new ht,i=new T;return function(n,s){var r=n.linePrecision,o=r*r,h=this.geometry,l=this.matrixWorld;if(null===h.boundingSphere&&h.computeBoundingSphere(),i.copy(h.boundingSphere),i.applyMatrix4(l),n.ray.intersectsSphere(i)!==!1){t.getInverse(l),e.copy(n.ray).applyMatrix4(t);var c=new a,u=new a,d=new a,p=new a,f=this&&this.isLineSegments?2:1;if(h&&h.isBufferGeometry){var m=h.index,g=h.attributes,v=g.position.array;if(null!==m)for(var y=m.array,x=0,b=y.length-1;x<b;x+=f){var w=y[x],_=y[x+1];c.fromArray(v,3*w),u.fromArray(v,3*_);var S=e.distanceSqToSegment(c,u,p,d);if(!(S>o)){p.applyMatrix4(this.matrixWorld);var M=n.ray.origin.distanceTo(p);M<n.near||M>n.far||s.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else for(var x=0,b=v.length/3-1;x<b;x+=f){c.fromArray(v,3*x),u.fromArray(v,3*x+3);var S=e.distanceSqToSegment(c,u,p,d);if(!(S>o)){p.applyMatrix4(this.matrixWorld);var M=n.ray.origin.distanceTo(p);M<n.near||M>n.far||s.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}else if(h&&h.isGeometry)for(var T=h.vertices,E=T.length,x=0;x<E-1;x+=f){var S=e.distanceSqToSegment(T[x],T[x+1],p,d);if(!(S>o)){p.applyMatrix4(this.matrixWorld);var M=n.ray.origin.distanceTo(p);M<n.near||M>n.far||s.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Pt.prototype=Object.assign(Object.create(Lt.prototype),{constructor:Pt,isLineSegments:!0}),kt.prototype=Object.create(x.prototype),kt.prototype.constructor=kt,kt.prototype.isPointsMaterial=!0,kt.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},It.prototype=Object.assign(Object.create(X.prototype),{constructor:It,isPoints:!0,raycast:function(){var t=new r,e=new ht,i=new T;return function(n,s){function r(t,i){var r=e.distanceSqToPoint(t);if(r<d){var a=e.closestPointToPoint(t);a.applyMatrix4(l);var h=n.ray.origin.distanceTo(a);if(h<n.near||h>n.far)return;s.push({distance:h,distanceToRay:Math.sqrt(r),point:a.clone(),index:i,face:null,object:o})}}var o=this,h=this.geometry,l=this.matrixWorld,c=n.params.Points.threshold;if(null===h.boundingSphere&&h.computeBoundingSphere(),i.copy(h.boundingSphere),i.applyMatrix4(l),n.ray.intersectsSphere(i)!==!1){t.getInverse(l),e.copy(n.ray).applyMatrix4(t);var u=c/((this.scale.x+this.scale.y+this.scale.z)/3),d=u*u,p=new a;if(h&&h.isBufferGeometry){var f=h.index,m=h.attributes,g=m.position.array;if(null!==f)for(var v=f.array,y=0,x=v.length;y<x;y++){var b=v[y];p.fromArray(g,3*b),r(p,b)}else for(var y=0,w=g.length/3;y<w;y++)p.fromArray(g,3*y),r(p,y)}else for(var _=h.vertices,y=0,w=_.length;y<w;y++)r(_[y],y)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Dt.prototype=Object.assign(Object.create(X.prototype),{constructor:Dt}),zt.prototype=Object.create(n.prototype),zt.prototype.constructor=zt,Rt.prototype=Object.create(n.prototype),Rt.prototype.constructor=Rt,Rt.prototype.isCompressedTexture=!0,Ot.prototype=Object.create(n.prototype),Ot.prototype.constructor=Ot,Bt.prototype=Object.create(n.prototype),Bt.prototype.constructor=Bt,Bt.prototype.isDepthTexture=!0,Ft.prototype=Object.create(w.prototype),Ft.prototype.constructor=Ft,Ft.prototype.isShadowMaterial=!0,Ut.prototype=Object.create(w.prototype),Ut.prototype.constructor=Ut,Ut.prototype.isRawShaderMaterial=!0,Vt.prototype={constructor:Vt,isMultiMaterial:!0,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},i=this.materials,n=0,s=i.length;n<s;n++){var r=i[n].toJSON(t);delete r.metadata,e.materials.push(r)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},Ht.prototype=Object.create(x.prototype),Ht.prototype.constructor=Ht,Ht.prototype.isMeshStandardMaterial=!0,Ht.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),
this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Wt.prototype=Object.create(Ht.prototype),Wt.prototype.constructor=Wt,Wt.prototype.isMeshPhysicalMaterial=!0,Wt.prototype.copy=function(t){return Ht.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},jt.prototype=Object.create(x.prototype),jt.prototype.constructor=jt,jt.prototype.isMeshPhongMaterial=!0,jt.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Gt.prototype=Object.create(x.prototype),Gt.prototype.constructor=Gt,Gt.prototype.isMeshNormalMaterial=!0,Gt.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Xt.prototype=Object.create(x.prototype),Xt.prototype.constructor=Xt,Xt.prototype.isMeshLambertMaterial=!0,Xt.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Yt.prototype=Object.create(x.prototype),Yt.prototype.constructor=Yt,Yt.prototype.isLineDashedMaterial=!0,Yt.prototype.copy=function(t){return x.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this},t.Cache={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},t.DefaultLoadingManager=new qt,Object.assign($t.prototype,{load:function(e,i,n,s){void 0!==this.path&&(e=this.path+e);var r=this,o=t.Cache.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout(function(){i&&i(o),r.manager.itemEnd(e)},0),o;var a=new XMLHttpRequest;return a.open("GET",e,!0),a.addEventListener("load",function(n){var o=n.target.response;t.Cache.add(e,o),200===this.status?(i&&i(o),r.manager.itemEnd(e)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),i&&i(o),r.manager.itemEnd(e)):(s&&s(n),r.manager.itemError(e))},!1),void 0!==n&&a.addEventListener("progress",function(t){n(t)},!1),a.addEventListener("error",function(t){s&&s(t),r.manager.itemError(e)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType("text/plain"),a.send(null),r.manager.itemStart(e),a},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this}}),Object.assign(Zt.prototype,{load:function(t,e,i,n){function s(s){h.load(t[s],function(t){var i=r._parser(t,!0);o[s]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},l+=1,6===l&&(1===i.mipmapCount&&(a.minFilter=Is),a.format=i.format,a.needsUpdate=!0,e&&e(a))},i,n)}var r=this,o=[],a=new Rt;a.image=o;var h=new $t(this.manager);if(h.setPath(this.path),h.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,c=0,u=t.length;c<u;++c)s(c);else h.load(t,function(t){var i=r._parser(t,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,s=0;s<n;s++){o[s]={mipmaps:[]};for(var h=0;h<i.mipmapCount;h++)o[s].mipmaps.push(i.mipmaps[s*i.mipmapCount+h]),o[s].format=i.format,o[s].width=i.width,o[s].height=i.height}else a.image.width=i.width,a.image.height=i.height,a.mipmaps=i.mipmaps;1===i.mipmapCount&&(a.minFilter=Is),a.format=i.format,a.needsUpdate=!0,e&&e(a)},i,n);return a},setPath:function(t){return this.path=t,this}});var Ra=Jt;Object.assign(Jt.prototype,{load:function(t,e,i,n){var s=this,r=new Tt,o=new $t(this.manager);return o.setResponseType("arraybuffer"),o.load(t,function(t){var i=s._parser(t);i&&(void 0!==i.image?r.image=i.image:void 0!==i.data&&(r.image.width=i.width,r.image.height=i.height,r.image.data=i.data),r.wrapS=void 0!==i.wrapS?i.wrapS:As,r.wrapT=void 0!==i.wrapT?i.wrapT:As,r.magFilter=void 0!==i.magFilter?i.magFilter:Is,r.minFilter=void 0!==i.minFilter?i.minFilter:zs,r.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(r.format=i.format),void 0!==i.type&&(r.type=i.type),void 0!==i.mipmaps&&(r.mipmaps=i.mipmaps),1===i.mipmapCount&&(r.minFilter=Is),r.needsUpdate=!0,e&&e(r,i))},i,n),r}}),Object.assign(Kt.prototype,{load:function(t,e,i,n){var s=this,r=document.createElementNS("http://www.w3.org/1999/xhtml","img");if(r.onload=function(){URL.revokeObjectURL(r.src),e&&e(r),s.manager.itemEnd(t)},0===t.indexOf("data:"))r.src=t;else{var o=new $t;o.setPath(this.path),o.setResponseType("blob"),o.setWithCredentials(this.withCredentials),o.load(t,function(t){r.src=URL.createObjectURL(t)},i,n)}return s.manager.itemStart(t),r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Qt.prototype,{load:function(t,e,i,n){function s(i){o.load(t[i],function(t){r.images[i]=t,a++,6===a&&(r.needsUpdate=!0,e&&e(r))},void 0,n)}var r=new u,o=new Kt(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);for(var a=0,h=0;h<t.length;++h)s(h);return r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(te.prototype,{load:function(t,e,i,s){var r=new n,o=new Kt(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setWithCredentials(this.withCredentials),o.setPath(this.path),o.load(t,function(i){var n=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);r.format=n?$s:Zs,r.image=i,r.needsUpdate=!0,void 0!==e&&e(r)},i,s),r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),ee.prototype=Object.assign(Object.create(X.prototype),{constructor:ee,isLight:!0,copy:function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=X.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),ie.prototype=Object.assign(Object.create(ee.prototype),{constructor:ie,isHemisphereLight:!0,copy:function(t){return ee.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(ne.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),se.prototype=Object.assign(Object.create(ne.prototype),{constructor:se,isSpotLightShadow:!0,update:function(e){var i=2*t.Math.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,s=e.distance||500,r=this.camera;i===r.fov&&n===r.aspect&&s===r.far||(r.fov=i,r.aspect=n,r.far=s,r.updateProjectionMatrix())}}),re.prototype=Object.assign(Object.create(ee.prototype),{constructor:re,isSpotLight:!0,copy:function(t){return ee.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),oe.prototype=Object.assign(Object.create(ee.prototype),{constructor:oe,isPointLight:!0,copy:function(t){return ee.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),ae.prototype=Object.assign(Object.create(ne.prototype),{constructor:ae}),he.prototype=Object.assign(Object.create(ee.prototype),{constructor:he,isDirectionalLight:!0,copy:function(t){return ee.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),le.prototype=Object.assign(Object.create(ee.prototype),{constructor:le,isAmbientLight:!0}),t.AnimationUtils={arraySlice:function(e,i,n){return t.AnimationUtils.isTypedArray(e)?new e.constructor(e.subarray(i,n)):e.slice(i,n)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,i){return t[e]-t[i]}for(var i=t.length,n=new Array(i),s=0;s!==i;++s)n[s]=s;return n.sort(e),n},sortedArray:function(t,e,i){for(var n=t.length,s=new t.constructor(n),r=0,o=0;o!==n;++r)for(var a=i[r]*e,h=0;h!==e;++h)s[o++]=t[a+h];return s},flattenJSON:function(t,e,i,n){for(var s=1,r=t[0];void 0!==r&&void 0===r[n];)r=t[s++];if(void 0!==r){var o=r[n];if(void 0!==o)if(Array.isArray(o)){do o=r[n],void 0!==o&&(e.push(r.time),i.push.apply(i,o)),r=t[s++];while(void 0!==r)}else if(void 0!==o.toArray){do o=r[n],void 0!==o&&(e.push(r.time),o.toArray(i,i.length)),r=t[s++];while(void 0!==r)}else do o=r[n],void 0!==o&&(e.push(r.time),i.push(o)),r=t[s++];while(void 0!==r)}}},ce.prototype={constructor:ce,evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],s=e[i-1];t:{e:{var r;i:{n:if(!(t<n)){for(var o=i+2;;){if(void 0===n){if(t<s)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,s)}if(i===o)break;if(s=n,n=e[++i],t<n)break e}r=e.length;break i}if(t>=s)break t;var a=e[1];t<a&&(i=2,s=a);for(var o=i-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===o)break;if(n=s,s=e[--i-1],t>=s)break e}r=i,i=0}for(;i<r;){var h=i+r>>>1;t<e[h]?r=h:i=h+1}if(n=e[i],s=e[i-1],void 0===s)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,s,t)}this._cachedIndex=i,this.intervalChanged_(i,s,n)}return this.interpolate_(i,s,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,s=t*n,r=0;r!==n;++r)e[r]=i[s+r];return e},interpolate_:function(t,e,i,n){throw new Error("call to abstract method")},intervalChanged_:function(t,e,i){}},Object.assign(ce.prototype,{beforeStart_:ce.prototype.copySampleValue_,afterEnd_:ce.prototype.copySampleValue_}),ue.prototype=Object.assign(Object.create(ce.prototype),{constructor:ue,DefaultSettings_:{endingStart:vr,endingEnd:vr},intervalChanged_:function(t,e,i){var n=this.parameterPositions,s=t-2,r=t+1,o=n[s],a=n[r];if(void 0===o)switch(this.getSettings_().endingStart){case yr:s=t,o=2*e-i;break;case xr:s=n.length-2,o=e+n[s]-n[s+1];break;default:s=t,o=i}if(void 0===a)switch(this.getSettings_().endingEnd){case yr:r=t,a=2*i-e;break;case xr:r=1,a=i+n[1]-n[0];break;default:r=t-1,a=e}var h=.5*(i-e),l=this.valueSize;this._weightPrev=h/(e-o),this._weightNext=h/(a-i),this._offsetPrev=s*l,this._offsetNext=r*l},interpolate_:function(t,e,i,n){for(var s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=t*o,h=a-o,l=this._offsetPrev,c=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f,b=0;b!==o;++b)s[b]=g*r[l+b]+v*r[h+b]+y*r[a+b]+x*r[c+b];return s}}),de.prototype=Object.assign(Object.create(ce.prototype),{constructor:de,interpolate_:function(t,e,i,n){for(var s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=t*o,h=a-o,l=(i-e)/(n-e),c=1-l,u=0;u!==o;++u)s[u]=r[h+u]*c+r[a+u]*l;return s}}),pe.prototype=Object.assign(Object.create(ce.prototype),{constructor:pe,interpolate_:function(t,e,i,n){return this.copySampleValue_(t-1)}});var Oa;Oa={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:mr,InterpolantFactoryMethodDiscrete:function(t){return new pe(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new de(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new ue(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case fr:e=this.InterpolantFactoryMethodDiscrete;break;case mr:e=this.InterpolantFactoryMethodLinear;break;case gr:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return void console.warn(i)}this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return fr;case this.InterpolantFactoryMethodLinear:return mr;case this.InterpolantFactoryMethodSmooth:return gr}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(e,i){for(var n=this.times,s=n.length,r=0,o=s-1;r!==s&&n[r]<e;)++r;for(;o!==-1&&n[o]>i;)--o;if(++o,0!==r||o!==s){r>=o&&(o=Math.max(o,1),r=o-1);var a=this.getValueSize();this.times=t.AnimationUtils.arraySlice(n,r,o),this.values=t.AnimationUtils.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var e=!0,i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("invalid value size in track",this),e=!1);var n=this.times,s=this.values,r=n.length;0===r&&(console.error("track is empty",this),e=!1);for(var o=null,a=0;a!==r;a++){var h=n[a];if("number"==typeof h&&isNaN(h)){console.error("time is not a valid number",this,a,h),e=!1;break}if(null!==o&&o>h){console.error("out of order keys",this,a,h,o),e=!1;break}o=h}if(void 0!==s&&t.AnimationUtils.isTypedArray(s))for(var a=0,l=s.length;a!==l;++a){var c=s[a];if(isNaN(c)){console.error("value is not a valid number",this,a,c),e=!1;break}}return e},optimize:function(){for(var e=this.times,i=this.values,n=this.getValueSize(),s=1,r=1,o=e.length-1;r<=o;++r){var a=!1,h=e[r],l=e[r+1];if(h!==l&&(1!==r||h!==h[0]))for(var c=r*n,u=c-n,d=c+n,p=0;p!==n;++p){var f=i[c+p];if(f!==i[u+p]||f!==i[d+p]){a=!0;break}}if(a){if(r!==s){e[s]=e[r];for(var m=r*n,g=s*n,p=0;p!==n;++p)i[g+p]=i[m+p]}++s}}return s!==e.length&&(this.times=t.AnimationUtils.arraySlice(e,0,s),this.values=t.AnimationUtils.arraySlice(i,0,s*n)),this}},me.prototype=Object.assign(Object.create(Oa),{constructor:me,ValueTypeName:"vector"}),ge.prototype=Object.assign(Object.create(ce.prototype),{constructor:ge,interpolate_:function(t,e,i,n){for(var s=this.resultBuffer,r=this.sampleValues,a=this.valueSize,h=t*a,l=(i-e)/(n-e),c=h+a;h!==c;h+=4)o.slerpFlat(s,0,r,h-a,r,h,l);return s}}),ve.prototype=Object.assign(Object.create(Oa),{constructor:ve,ValueTypeName:"quaternion",DefaultInterpolation:mr,InterpolantFactoryMethodLinear:function(t){return new ge(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),ye.prototype=Object.assign(Object.create(Oa),{constructor:ye,ValueTypeName:"number"}),xe.prototype=Object.assign(Object.create(Oa),{constructor:xe,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:fr,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),be.prototype=Object.assign(Object.create(Oa),{constructor:be,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:fr,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),we.prototype=Object.assign(Object.create(Oa),{constructor:we,ValueTypeName:"color"}),_e.prototype=Oa,Oa.constructor=_e,Object.assign(_e,{parse:function(e){if(void 0===e.type)throw new Error("track type undefined, can not parse");var i=_e._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var n=[],s=[];t.AnimationUtils.flattenJSON(e.keys,n,s,"value"),e.times=n,e.values=s}return void 0!==i.parse?i.parse(e):new i(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var i,n=e.constructor;if(void 0!==n.toJSON)i=n.toJSON(e);else{i={name:e.name,times:t.AnimationUtils.convertArray(e.times,Array),values:t.AnimationUtils.convertArray(e.values,Array)};var s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ye;case"vector":case"vector2":case"vector3":case"vector4":return me;case"color":return we;case"quaternion":return ve;case"bool":case"boolean":return be;case"string":return xe}throw new Error("Unsupported typeName: "+t)}}),Se.prototype={constructor:Se,resetDuration:function(){for(var t=this.tracks,e=0,i=0,n=t.length;i!==n;++i){var s=this.tracks[i];e=Math.max(e,s.times[s.times.length-1])}this.duration=e},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(Se,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),s=0,r=i.length;s!==r;++s)e.push(_e.parse(i[s]).scale(n));return new Se(t.name,t.duration,e)},toJSON:function(t){for(var e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e},s=0,r=i.length;s!==r;++s)e.push(_e.toJSON(i[s]));return n},CreateFromMorphTargetSequence:function(e,i,n,s){for(var r=i.length,o=[],a=0;a<r;a++){var h=[],l=[];h.push((a+r-1)%r,a,(a+1)%r),l.push(0,1,0);var c=t.AnimationUtils.getKeyframeOrder(h);h=t.AnimationUtils.sortedArray(h,1,c),l=t.AnimationUtils.sortedArray(l,1,c),s||0!==h[0]||(h.push(r),l.push(l[0])),o.push(new ye(".morphTargetInfluences["+i[a].name+"]",h,l).scale(1/n))}return new Se(e,-1,o)},findByName:function(t,e){var i=t;if(!Array.isArray(t)){var n=t;i=n.geometry&&n.geometry.animations||n.animations}for(var s=0;s<i.length;s++)if(i[s].name===e)return i[s];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var n={},s=/^([\w-]*?)([\d]+)$/,r=0,o=t.length;r<o;r++){var a=t[r],h=a.name.match(s);if(h&&h.length>1){var l=h[1],c=n[l];c||(n[l]=c=[]),c.push(a)}}var u=[];for(var l in n)u.push(Se.CreateFromMorphTargetSequence(l,n[l],e,i));return u},parseAnimation:function(e,i,n){if(!e)return console.error("  no animation in JSONLoader data"),null;for(var s=function(e,i,n,s,r){if(0!==n.length){var o=[],a=[];t.AnimationUtils.flattenJSON(n,o,a,s),0!==o.length&&r.push(new e(i,o,a))}},r=[],o=e.name||"default",a=e.length||-1,h=e.fps||30,l=e.hierarchy||[],c=0;c<l.length;c++){var u=l[c].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var d={},p=0;p<u.length;p++)if(u[p].morphTargets)for(var f=0;f<u[p].morphTargets.length;f++)d[u[p].morphTargets[f]]=-1;for(var m in d){for(var g=[],v=[],f=0;f!==u[p].morphTargets.length;++f){var y=u[p];g.push(y.time),v.push(y.morphTarget===m?1:0)}r.push(new ye(".morphTargetInfluence["+m+"]",g,v))}a=d.length*(h||1)}else{var x=".bones["+i[c].name+"]";s(me,x+".position",u,"pos",r),s(ve,x+".quaternion",u,"rot",r),s(me,x+".scale",u,"scl",r)}}if(0===r.length)return null;var b=new Se(o,a,r);return b}}),Object.assign(Me.prototype,{load:function(t,e,i,n){var s=this,r=new $t(s.manager);r.load(t,function(t){e(s.parse(JSON.parse(t)))},i,n)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===n[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),n[t]}var n=this.textures,s=new THREE[t.type];if(void 0!==t.uuid&&(s.uuid=t.uuid),void 0!==t.name&&(s.name=t.name),void 0!==t.color&&s.color.setHex(t.color),void 0!==t.roughness&&(s.roughness=t.roughness),void 0!==t.metalness&&(s.metalness=t.metalness),void 0!==t.emissive&&s.emissive.setHex(t.emissive),void 0!==t.specular&&s.specular.setHex(t.specular),void 0!==t.shininess&&(s.shininess=t.shininess),void 0!==t.uniforms&&(s.uniforms=t.uniforms),void 0!==t.vertexShader&&(s.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(s.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(s.vertexColors=t.vertexColors),void 0!==t.fog&&(s.fog=t.fog),void 0!==t.shading&&(s.shading=t.shading),void 0!==t.blending&&(s.blending=t.blending),void 0!==t.side&&(s.side=t.side),void 0!==t.opacity&&(s.opacity=t.opacity),void 0!==t.transparent&&(s.transparent=t.transparent),void 0!==t.alphaTest&&(s.alphaTest=t.alphaTest),void 0!==t.depthTest&&(s.depthTest=t.depthTest),void 0!==t.depthWrite&&(s.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(s.colorWrite=t.colorWrite),void 0!==t.wireframe&&(s.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(s.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(s.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(s.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(s.skinning=t.skinning),void 0!==t.morphTargets&&(s.morphTargets=t.morphTargets),void 0!==t.size&&(s.size=t.size),void 0!==t.sizeAttenuation&&(s.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(s.map=e(t.map)),void 0!==t.alphaMap&&(s.alphaMap=e(t.alphaMap),s.transparent=!0),void 0!==t.bumpMap&&(s.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(s.bumpScale=t.bumpScale),void 0!==t.normalMap&&(s.normalMap=e(t.normalMap)),void 0!==t.normalScale){var r=t.normalScale;Array.isArray(r)===!1&&(r=[r,r]),s.normalScale=(new i).fromArray(r)}if(void 0!==t.displacementMap&&(s.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(s.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(s.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(s.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(s.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(s.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(s.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(s.specularMap=e(t.specularMap)),void 0!==t.envMap&&(s.envMap=e(t.envMap)),void 0!==t.reflectivity&&(s.reflectivity=t.reflectivity),void 0!==t.lightMap&&(s.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(s.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(s.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(s.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var o=0,a=t.materials.length;o<a;o++)s.materials.push(this.parse(t.materials[o]));return s}}),Object.assign(Te.prototype,{load:function(t,e,i,n){var s=this,r=new $t(s.manager);r.load(t,function(t){e(s.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=new J,i=t.data.index,n={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(void 0!==i){var s=new n[i.type](i.array);e.setIndex(new k(s,1))}var r=t.data.attributes;for(var o in r){var h=r[o],s=new n[h.type](h.array);e.addAttribute(o,new k(s,h.itemSize,h.normalized))}var l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(var c=0,u=l.length;c!==u;++c){var d=l[c];e.addGroup(d.start,d.count,d.materialIndex)}var p=t.data.boundingSphere;if(void 0!==p){var f=new a;void 0!==p.center&&f.fromArray(p.center),e.boundingSphere=new T(f,p.radius)}return e}}),Ee.prototype={constructor:Ee,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,i){for(var n=[],s=0;s<t.length;++s)n[s]=this.createMaterial(t[s],e,i);return n},createMaterial:function(){var e,i,n;return function(s,r,o){function a(e,n,s,a,l){var c,u=r+e,d=Ee.Handlers.get(u);null!==d?c=d.load(u):(i.setCrossOrigin(o),c=i.load(u)),void 0!==n&&(c.repeat.fromArray(n),1!==n[0]&&(c.wrapS=Cs),1!==n[1]&&(c.wrapT=Cs)),void 0!==s&&c.offset.fromArray(s),void 0!==a&&("repeat"===a[0]&&(c.wrapS=Cs),"mirror"===a[0]&&(c.wrapS=Ns),"repeat"===a[1]&&(c.wrapT=Cs),"mirror"===a[1]&&(c.wrapT=Ns)),void 0!==l&&(c.anisotropy=l);var p=t.Math.generateUUID();return h[p]=c,p}void 0===e&&(e=new _),void 0===i&&(i=new te),void 0===n&&(n=new Me);var h={},l={uuid:t.Math.generateUUID(),type:"MeshLambertMaterial"};for(var c in s){var u=s[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=u;break;case"blending":l.blending=THREE[u];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":l.color=e.fromArray(u).getHex();break;case"colorSpecular":l.specular=e.fromArray(u).getHex();break;case"colorEmissive":l.emissive=e.fromArray(u).getHex();break;case"specularCoef":l.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(l.type="MeshPhongMaterial"),"standard"===u.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=a(u,s.mapDiffuseRepeat,s.mapDiffuseOffset,s.mapDiffuseWrap,s.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=a(u,s.mapEmissiveRepeat,s.mapEmissiveOffset,s.mapEmissiveWrap,s.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=a(u,s.mapLightRepeat,s.mapLightOffset,s.mapLightWrap,s.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=a(u,s.mapAORepeat,s.mapAOOffset,s.mapAOWrap,s.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=a(u,s.mapBumpRepeat,s.mapBumpOffset,s.mapBumpWrap,s.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=a(u,s.mapNormalRepeat,s.mapNormalOffset,s.mapNormalWrap,s.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=[u,u];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=a(u,s.mapSpecularRepeat,s.mapSpecularOffset,s.mapSpecularWrap,s.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=a(u,s.mapMetalnessRepeat,s.mapMetalnessOffset,s.mapMetalnessWrap,s.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=a(u,s.mapRoughnessRepeat,s.mapRoughnessOffset,s.mapRoughnessWrap,s.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=a(u,s.mapAlphaRepeat,s.mapAlphaOffset,s.mapAlphaWrap,s.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=An;break;case"doubleSided":l.side=Nn;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),l.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[c]=u;break;case"vertexColors":u===!0&&(l.vertexColors=Dn),"face"===u&&(l.vertexColors=In);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,u)}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,l.opacity<1&&(l.transparent=!0),n.setTextures(h),n.parse(l)}}()},Ee.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,n=e.length;i<n;i+=2){var s=e[i],r=e[i+1];if(s.test(t))return r}return null}},Object.assign(Ce.prototype,{load:function(t,e,i,n){var s=this,r=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Ee.prototype.extractUrlBase(t),o=new $t(this.manager);o.setWithCredentials(this.withCredentials),o.load(t,function(i){var n=JSON.parse(i),o=n.metadata;if(void 0!==o){var a=o.type;if(void 0!==a){if("object"===a.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===a.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}}var h=s.parse(n,r);e(h.geometry,h.materials)},i,n)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){function n(e){function n(t,e){return t&1<<e}var s,r,o,l,c,u,d,p,f,m,g,v,y,x,b,w,S,M,T,E,C,A,N,L,P,k,I,D=t.faces,z=t.vertices,R=t.normals,O=t.colors,B=0;if(void 0!==t.uvs){for(s=0;s<t.uvs.length;s++)t.uvs[s].length&&B++;for(s=0;s<B;s++)h.faceVertexUvs[s]=[]}for(l=0,c=z.length;l<c;)M=new a,M.x=z[l++]*e,M.y=z[l++]*e,M.z=z[l++]*e,h.vertices.push(M);for(l=0,c=D.length;l<c;)if(m=D[l++],g=n(m,0),v=n(m,1),y=n(m,3),x=n(m,4),b=n(m,5),w=n(m,6),S=n(m,7),g){if(E=new W,E.a=D[l],E.b=D[l+1],E.c=D[l+3],C=new W,C.a=D[l+1],C.b=D[l+2],C.c=D[l+3],l+=4,v&&(f=D[l++],E.materialIndex=f,C.materialIndex=f),o=h.faces.length,y)for(s=0;s<B;s++)for(L=t.uvs[s],
h.faceVertexUvs[s][o]=[],h.faceVertexUvs[s][o+1]=[],r=0;r<4;r++)p=D[l++],k=L[2*p],I=L[2*p+1],P=new i(k,I),2!==r&&h.faceVertexUvs[s][o].push(P),0!==r&&h.faceVertexUvs[s][o+1].push(P);if(x&&(d=3*D[l++],E.normal.set(R[d++],R[d++],R[d]),C.normal.copy(E.normal)),b)for(s=0;s<4;s++)d=3*D[l++],N=new a(R[d++],R[d++],R[d]),2!==s&&E.vertexNormals.push(N),0!==s&&C.vertexNormals.push(N);if(w&&(u=D[l++],A=O[u],E.color.setHex(A),C.color.setHex(A)),S)for(s=0;s<4;s++)u=D[l++],A=O[u],2!==s&&E.vertexColors.push(new _(A)),0!==s&&C.vertexColors.push(new _(A));h.faces.push(E),h.faces.push(C)}else{if(T=new W,T.a=D[l++],T.b=D[l++],T.c=D[l++],v&&(f=D[l++],T.materialIndex=f),o=h.faces.length,y)for(s=0;s<B;s++)for(L=t.uvs[s],h.faceVertexUvs[s][o]=[],r=0;r<3;r++)p=D[l++],k=L[2*p],I=L[2*p+1],P=new i(k,I),h.faceVertexUvs[s][o].push(P);if(x&&(d=3*D[l++],T.normal.set(R[d++],R[d++],R[d])),b)for(s=0;s<3;s++)d=3*D[l++],N=new a(R[d++],R[d++],R[d]),T.vertexNormals.push(N);if(w&&(u=D[l++],T.color.setHex(O[u])),S)for(s=0;s<3;s++)u=D[l++],T.vertexColors.push(new _(O[u]));h.faces.push(T)}}function s(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var i=0,n=t.skinWeights.length;i<n;i+=e){var s=t.skinWeights[i],r=e>1?t.skinWeights[i+1]:0,o=e>2?t.skinWeights[i+2]:0,a=e>3?t.skinWeights[i+3]:0;h.skinWeights.push(new p(s,r,o,a))}if(t.skinIndices)for(var i=0,n=t.skinIndices.length;i<n;i+=e){var l=t.skinIndices[i],c=e>1?t.skinIndices[i+1]:0,u=e>2?t.skinIndices[i+2]:0,d=e>3?t.skinIndices[i+3]:0;h.skinIndices.push(new p(l,c,u,d))}h.bones=t.bones,h.bones&&h.bones.length>0&&(h.skinWeights.length!==h.skinIndices.length||h.skinIndices.length!==h.vertices.length)&&console.warn("When skinning, number of vertices ("+h.vertices.length+"), skinIndices ("+h.skinIndices.length+"), and skinWeights ("+h.skinWeights.length+") should match.")}function r(e){if(void 0!==t.morphTargets)for(var i=0,n=t.morphTargets.length;i<n;i++){h.morphTargets[i]={},h.morphTargets[i].name=t.morphTargets[i].name,h.morphTargets[i].vertices=[];for(var s=h.morphTargets[i].vertices,r=t.morphTargets[i].vertices,o=0,l=r.length;o<l;o+=3){var c=new a;c.x=r[o]*e,c.y=r[o+1]*e,c.z=r[o+2]*e,s.push(c)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var u=h.faces,d=t.morphColors[0].colors,i=0,n=u.length;i<n;i++)u[i].color.fromArray(d,3*i)}}function o(){var e=[],i=[];void 0!==t.animation&&i.push(t.animation),void 0!==t.animations&&(t.animations.length?i=i.concat(t.animations):i.push(t.animations));for(var n=0;n<i.length;n++){var s=Se.parseAnimation(i[n],h.bones);s&&e.push(s)}if(h.morphTargets){var r=Se.CreateClipsFromMorphTargetSequences(h.morphTargets,10);e=e.concat(r)}e.length>0&&(h.animations=e)}var h=new q,l=void 0!==t.scale?1/t.scale:1;if(n(l),s(),r(l),o(),h.computeFaceNormals(),h.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:h};var c=Ee.prototype.initMaterials(t.materials,e,this.crossOrigin);return{geometry:h,materials:c}}}),Object.assign(Ae.prototype,{load:function(t,e,i,n){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var s=this,r=new $t(s.manager);r.load(t,function(t){s.parse(JSON.parse(t),e)},i,n)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseGeometries(t.geometries),n=this.parseImages(t.images,function(){void 0!==e&&e(o)}),s=this.parseTextures(t.textures,n),r=this.parseMaterials(t.materials,s),o=this.parseObject(t.object,i,r);return t.animations&&(o.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(o),o},parseGeometries:function(t){var e={};if(void 0!==t)for(var i=new Ce,n=new Te,s=0,r=t.length;s<r;s++){var o,a=t[s];switch(a.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new THREE[a.type](a.width,a.height,a.widthSegments,a.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new THREE[a.type](a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new THREE[a.type](a.radius,a.segments,a.thetaStart,a.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new THREE[a.type](a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new THREE[a.type](a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new THREE[a.type](a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":o=new THREE[a.type](a.radius,a.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new THREE[a.type](a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new THREE[a.type](a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new THREE[a.type](a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q);break;case"LatheGeometry":case"LatheBufferGeometry":o=new THREE[a.type](a.points,a.segments,a.phiStart,a.phiLength);break;case"BufferGeometry":o=n.parse(a);break;case"Geometry":o=i.parse(a.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+a.type+'"');continue}o.uuid=a.uuid,void 0!==a.name&&(o.name=a.name),e[a.uuid]=o}return e},parseMaterials:function(t,e){var i={};if(void 0!==t){var n=new Me;n.setTextures(e);for(var s=0,r=t.length;s<r;s++){var o=n.parse(t[s]);i[o.uuid]=o}}return i},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=Se.parse(t[i]);e.push(n)}return e},parseImages:function(t,e){function i(t){return n.manager.itemStart(t),o.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t)})}var n=this,s={};if(void 0!==t&&t.length>0){var r=new qt(e),o=new Kt(r);o.setCrossOrigin(this.crossOrigin);for(var a=0,h=t.length;a<h;a++){var l=t[a],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.texturePath+l.url;s[l.uuid]=i(c)}}return s},parseTextures:function(t,e){function i(t){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),THREE[t])}var s={};if(void 0!==t)for(var r=0,o=t.length;r<o;r++){var a=t[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var h=new n(e[a.image]);h.needsUpdate=!0,h.uuid=a.uuid,void 0!==a.name&&(h.name=a.name),void 0!==a.mapping&&(h.mapping=i(a.mapping)),void 0!==a.offset&&h.offset.fromArray(a.offset),void 0!==a.repeat&&h.repeat.fromArray(a.repeat),void 0!==a.wrap&&(h.wrapS=i(a.wrap[0]),h.wrapT=i(a.wrap[1])),void 0!==a.minFilter&&(h.minFilter=i(a.minFilter)),void 0!==a.magFilter&&(h.magFilter=i(a.magFilter)),void 0!==a.anisotropy&&(h.anisotropy=a.anisotropy),void 0!==a.flipY&&(h.flipY=a.flipY),s[a.uuid]=h}return s},parseObject:function(){var t=new r;return function(e,i,n){function s(t){return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),i[t]}function r(t){if(void 0!==t)return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}var o;switch(e.type){case"Scene":o=new bt,void 0!==e.background&&Number.isInteger(e.background)&&(o.background=new THREE.Color(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new xt(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new yt(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new mt(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new gt(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":o=new le(e.color,e.intensity);break;case"DirectionalLight":o=new he(e.color,e.intensity);break;case"PointLight":o=new oe(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":o=new re(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new ie(e.color,e.groundColor,e.intensity);break;case"Mesh":var a=s(e.geometry),h=r(e.material);o=a.bones&&a.bones.length>0?new At(a,h):new dt(a,h);break;case"LOD":o=new Mt;break;case"Line":o=new Lt(s(e.geometry),r(e.material),e.mode);break;case"LineSegments":o=new Pt(s(e.geometry),r(e.material));break;case"PointCloud":case"Points":o=new It(s(e.geometry),r(e.material));break;case"Sprite":o=new St(r(e.material));break;case"Group":o=new Dt;break;default:o=new X}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.children)for(var l in e.children)o.add(this.parseObject(e.children[l],i,n));if("LOD"===e.type)for(var c=e.levels,u=0;u<c.length;u++){var d=c[u],l=o.getObjectByProperty("uuid",d.object);void 0!==l&&o.addLevel(l,d.distance)}return o}}()}),t.ShapeUtils={area:function(t){for(var e=t.length,i=0,n=e-1,s=0;s<e;n=s++)i+=t[n].x*t[s].y-t[s].x*t[n].y;return.5*i},triangulate:function(){function e(t,e,i,n,s,r){var o,a,h,l,c,u,d,p,f;if(a=t[r[e]].x,h=t[r[e]].y,l=t[r[i]].x,c=t[r[i]].y,u=t[r[n]].x,d=t[r[n]].y,Number.EPSILON>(l-a)*(d-h)-(c-h)*(u-a))return!1;var m,g,v,y,x,b,w,_,S,M,T,E,C,A,N;for(m=u-l,g=d-c,v=a-u,y=h-d,x=l-a,b=c-h,o=0;o<s;o++)if(p=t[r[o]].x,f=t[r[o]].y,!(p===a&&f===h||p===l&&f===c||p===u&&f===d)&&(w=p-a,_=f-h,S=p-l,M=f-c,T=p-u,E=f-d,N=m*M-g*S,C=x*_-b*w,A=v*E-y*T,N>=-Number.EPSILON&&A>=-Number.EPSILON&&C>=-Number.EPSILON))return!1;return!0}return function(i,n){var s=i.length;if(s<3)return null;var r,o,a,h=[],l=[],c=[];if(t.ShapeUtils.area(i)>0)for(o=0;o<s;o++)l[o]=o;else for(o=0;o<s;o++)l[o]=s-1-o;var u=s,d=2*u;for(o=u-1;u>2;){if(d--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),n?c:h;if(r=o,u<=r&&(r=0),o=r+1,u<=o&&(o=0),a=o+1,u<=a&&(a=0),e(i,r,o,a,u,l)){var p,f,m,g,v;for(p=l[r],f=l[o],m=l[a],h.push([i[p],i[f],i[m]]),c.push([l[r],l[o],l[a]]),g=o,v=o+1;v<u;g++,v++)l[g]=l[v];u--,d=2*u}}return n?c:h}}(),triangulateShape:function(e,i){function n(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function s(t,e,i){return t.x!==e.x?t.x<e.x?t.x<=i.x&&i.x<=e.x:e.x<=i.x&&i.x<=t.x:t.y<e.y?t.y<=i.y&&i.y<=e.y:e.y<=i.y&&i.y<=t.y}function r(t,e,i,n,r){var o=e.x-t.x,a=e.y-t.y,h=n.x-i.x,l=n.y-i.y,c=t.x-i.x,u=t.y-i.y,d=a*h-o*l,p=a*c-o*u;if(Math.abs(d)>Number.EPSILON){var f;if(d>0){if(p<0||p>d)return[];if(f=l*c-h*u,f<0||f>d)return[]}else{if(p>0||p<d)return[];if(f=l*c-h*u,f>0||f<d)return[]}if(0===f)return!r||0!==p&&p!==d?[t]:[];if(f===d)return!r||0!==p&&p!==d?[e]:[];if(0===p)return[i];if(p===d)return[n];var m=f/d;return[{x:t.x+m*o,y:t.y+m*a}]}if(0!==p||l*c!==h*u)return[];var g=0===o&&0===a,v=0===h&&0===l;if(g&&v)return t.x!==i.x||t.y!==i.y?[]:[t];if(g)return s(i,n,t)?[t]:[];if(v)return s(t,e,i)?[i]:[];var y,x,b,w,_,S,M,T;return 0!==o?(t.x<e.x?(y=t,b=t.x,x=e,w=e.x):(y=e,b=e.x,x=t,w=t.x),i.x<n.x?(_=i,M=i.x,S=n,T=n.x):(_=n,M=n.x,S=i,T=i.x)):(t.y<e.y?(y=t,b=t.y,x=e,w=e.y):(y=e,b=e.y,x=t,w=t.y),i.y<n.y?(_=i,M=i.y,S=n,T=n.y):(_=n,M=n.y,S=i,T=i.y)),b<=M?w<M?[]:w===M?r?[]:[_]:w<=T?[_,x]:[_,S]:b>T?[]:b===T?r?[]:[y]:w<=T?[y,x]:[y,S]}function o(t,e,i,n){var s=e.x-t.x,r=e.y-t.y,o=i.x-t.x,a=i.y-t.y,h=n.x-t.x,l=n.y-t.y,c=s*a-r*o,u=s*l-r*h;if(Math.abs(c)>Number.EPSILON){var d=h*a-l*o;return c>0?u>=0&&d>=0:u>=0||d>=0}return u>0}function a(t,e){function i(t,e){var i=y.length-1,n=t-1;n<0&&(n=i);var s=t+1;s>i&&(s=0);var r=o(y[t],y[n],y[s],a[e]);if(!r)return!1;var h=a.length-1,l=e-1;l<0&&(l=h);var c=e+1;return c>h&&(c=0),r=o(a[e],a[l],a[c],y[t]),!!r}function n(t,e){var i,n,s;for(i=0;i<y.length;i++)if(n=i+1,n%=y.length,s=r(t,e,y[i],y[n],!0),s.length>0)return!0;return!1}function s(t,i){var n,s,o,a,h;for(n=0;n<x.length;n++)for(s=e[x[n]],o=0;o<s.length;o++)if(a=o+1,a%=s.length,h=r(t,i,s[o],s[a],!0),h.length>0)return!0;return!1}for(var a,h,l,c,u,d,p,f,m,g,v,y=t.concat(),x=[],b=[],w=0,_=e.length;w<_;w++)x.push(w);for(var S=0,M=2*x.length;x.length>0;){if(M--,M<0){console.log("Infinite Loop! Holes left:"+x.length+", Probably Hole outside Shape!");break}for(l=S;l<y.length;l++){c=y[l],h=-1;for(var w=0;w<x.length;w++)if(d=x[w],p=c.x+":"+c.y+":"+d,void 0===b[p]){a=e[d];for(var T=0;T<a.length;T++)if(u=a[T],i(l,T)&&!n(c,u)&&!s(c,u)){h=T,x.splice(w,1),f=y.slice(0,l+1),m=y.slice(l),g=a.slice(h),v=a.slice(0,h+1),y=f.concat(g).concat(v).concat(m),S=l;break}if(h>=0)break;b[p]=!0}if(h>=0)break}}return y}n(e),i.forEach(n);for(var h,l,c,u,d,p,f={},m=e.concat(),g=0,v=i.length;g<v;g++)Array.prototype.push.apply(m,i[g]);for(h=0,l=m.length;h<l;h++)d=m[h].x+":"+m[h].y,void 0!==f[d]&&console.warn("THREE.ShapeUtils: Duplicate point",d,h),f[d]=h;var y=a(e,i),x=t.ShapeUtils.triangulate(y,!1);for(h=0,l=x.length;h<l;h++)for(u=x[h],c=0;c<3;c++)d=u[c].x+":"+u[c].y,p=f[d],void 0!==p&&(u[c]=p);return x.concat()},isClockWise:function(e){return t.ShapeUtils.area(e)<0},b2:function(){function t(t,e){var i=1-t;return i*i*e}function e(t,e){return 2*(1-t)*t*e}function i(t,e){return t*t*e}return function(n,s,r,o){return t(n,s)+e(n,r)+i(n,o)}}(),b3:function(){function t(t,e){var i=1-t;return i*i*i*e}function e(t,e){var i=1-t;return 3*i*i*t*e}function i(t,e){var i=1-t;return 3*i*t*t*e}function n(t,e){return t*t*t*e}return function(s,r,o,a,h){return t(s,r)+e(s,o)+i(s,a)+n(s,h)}}()},Ne.prototype={constructor:Ne,getPoint:function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},getPoints:function(t){t||(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){t||(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],s=this.getPoint(0),r=0;for(n.push(0),i=1;i<=t;i++)e=this.getPoint(i/t),r+=e.distanceTo(s),n.push(r),s=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i,n=this.getLengths(),s=0,r=n.length;i=e?e:t*n[r-1];for(var o,a=0,h=r-1;a<=h;)if(s=Math.floor(a+(h-a)/2),o=n[s]-i,o<0)a=s+1;else{if(!(o>0)){h=s;break}h=s-1}if(s=h,n[s]===i){var l=s/(r-1);return l}var c=n[s],u=n[s+1],d=u-c,p=(i-c)/d,l=(s+p)/(r-1);return l},getTangent:function(t){var e=1e-4,i=t-e,n=t+e;i<0&&(i=0),n>1&&(n=1);var s=this.getPoint(i),r=this.getPoint(n),o=r.clone().sub(s);return o.normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)}},Ne.create=function(t,e){return t.prototype=Object.create(Ne.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Le.prototype=Object.create(Ne.prototype),Le.prototype.constructor=Le,Le.prototype.isLineCurve=!0,Le.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},Le.prototype.getPointAt=function(t){return this.getPoint(t)},Le.prototype.getTangent=function(t){var e=this.v2.clone().sub(this.v1);return e.normalize()},Pe.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Pe,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Le(e,t))},getPoint:function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e){var s=i[n]-e,r=this.curves[n],o=r.getLength(),a=0===o?0:1-s/o;return r.getPointAt(a)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){t||(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],n=0,s=this.curves;n<s.length;n++)for(var r=s[n],o=r&&r.isEllipseCurve?2*t:r&&r.isLineCurve?1:r&&r.isSplineCurve?t*r.points.length:t,a=r.getPoints(o),h=0;h<a.length;h++){var l=a[h];e&&e.equals(l)||(i.push(l),e=l)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},createPointsGeometry:function(t){var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){for(var e=new q,i=0,n=t.length;i<n;i++){var s=t[i];e.vertices.push(new a(s.x,s.y,s.z||0))}return e}}),ke.prototype=Object.create(Ne.prototype),ke.prototype.constructor=ke,ke.prototype.isEllipseCurve=!0,ke.prototype.getPoint=function(t){for(var e=2*Math.PI,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;n<0;)n+=e;for(;n>e;)n-=e;n<Number.EPSILON&&(n=s?0:e),this.aClockwise!==!0||s||(n===e?n=-e:n-=e);var r=this.aStartAngle+t*n,o=this.aX+this.xRadius*Math.cos(r),a=this.aY+this.yRadius*Math.sin(r);if(0!==this.aRotation){var h=Math.cos(this.aRotation),l=Math.sin(this.aRotation),c=o-this.aX,u=a-this.aY;o=c*h-u*l+this.aX,a=c*l+u*h+this.aY}return new i(o,a)},t.CurveUtils={tangentQuadraticBezier:function(t,e,i,n){return 2*(1-t)*(i-e)+2*t*(n-i)},tangentCubicBezier:function(t,e,i,n,s){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*n*(1-t)-3*t*t*n+3*t*t*s},tangentSpline:function(t,e,i,n,s){var r=6*t*t-6*t,o=3*t*t-4*t+1,a=-6*t*t+6*t,h=3*t*t-2*t;return r+o+a+h},interpolate:function(t,e,i,n,s){var r=.5*(i-t),o=.5*(n-e),a=s*s,h=s*a;return(2*e-2*i+r+o)*h+(-3*e+3*i-2*r-o)*a+r*s+e}},Ie.prototype=Object.create(Ne.prototype),Ie.prototype.constructor=Ie,Ie.prototype.isSplineCurve=!0,Ie.prototype.getPoint=function(e){var n=this.points,s=(n.length-1)*e,r=Math.floor(s),o=s-r,a=n[0===r?r:r-1],h=n[r],l=n[r>n.length-2?n.length-1:r+1],c=n[r>n.length-3?n.length-1:r+2],u=t.CurveUtils.interpolate;return new i(u(a.x,h.x,l.x,c.x,o),u(a.y,h.y,l.y,c.y,o))},De.prototype=Object.create(Ne.prototype),De.prototype.constructor=De,De.prototype.getPoint=function(e){var n=t.ShapeUtils.b3;return new i(n(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},De.prototype.getTangent=function(e){var n=t.CurveUtils.tangentCubicBezier;return new i(n(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},ze.prototype=Object.create(Ne.prototype),ze.prototype.constructor=ze,ze.prototype.getPoint=function(e){var n=t.ShapeUtils.b2;return new i(n(e,this.v0.x,this.v1.x,this.v2.x),n(e,this.v0.y,this.v1.y,this.v2.y))},ze.prototype.getTangent=function(e){var n=t.CurveUtils.tangentQuadraticBezier;return new i(n(e,this.v0.x,this.v1.x,this.v2.x),n(e,this.v0.y,this.v1.y,this.v2.y)).normalize()};var Ba=Object.assign(Object.create(Pe.prototype),{fromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new Le(this.currentPoint.clone(),new i(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,s){var r=new ze(this.currentPoint.clone(),new i(t,e),new i(n,s));this.curves.push(r),this.currentPoint.set(n,s)},bezierCurveTo:function(t,e,n,s,r,o){var a=new De(this.currentPoint.clone(),new i(t,e),new i(n,s),new i(r,o));this.curves.push(a),this.currentPoint.set(r,o)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),i=new Ie(e);this.curves.push(i),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,i,n,s,r){var o=this.currentPoint.x,a=this.currentPoint.y;this.absarc(t+o,e+a,i,n,s,r)},absarc:function(t,e,i,n,s,r){this.absellipse(t,e,i,i,n,s,r)},ellipse:function(t,e,i,n,s,r,o,a){var h=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(t+h,e+l,i,n,s,r,o,a)},absellipse:function(t,e,i,n,s,r,o,a){var h=new ke(t,e,i,n,s,r,o,a);if(this.curves.length>0){var l=h.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(h);var c=h.getPoint(1);this.currentPoint.copy(c)}});Re.prototype=Object.create(q.prototype),Re.prototype.constructor=Re,Re.NoTaper=function(t){return 1},Re.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},Re.FrenetFrames=function(e,i,n){function s(){g[0]=new a,v[0]=new a,h=Number.MAX_VALUE,l=Math.abs(m[0].x),c=Math.abs(m[0].y),u=Math.abs(m[0].z),l<=h&&(h=l,f.set(1,0,0)),c<=h&&(h=c,f.set(0,1,0)),u<=h&&f.set(0,0,1),y.crossVectors(m[0],f).normalize(),g[0].crossVectors(m[0],y),v[0].crossVectors(m[0],g[0])}var o,h,l,c,u,d,p,f=new a,m=[],g=[],v=[],y=new a,x=new r,b=i+1;for(this.tangents=m,this.normals=g,this.binormals=v,d=0;d<b;d++)p=d/(b-1),m[d]=e.getTangentAt(p),m[d].normalize();for(s(),d=1;d<b;d++)g[d]=g[d-1].clone(),v[d]=v[d-1].clone(),y.crossVectors(m[d-1],m[d]),y.length()>Number.EPSILON&&(y.normalize(),o=Math.acos(t.Math.clamp(m[d-1].dot(m[d]),-1,1)),g[d].applyMatrix4(x.makeRotationAxis(y,o))),v[d].crossVectors(m[d],g[d]);if(n)for(o=Math.acos(t.Math.clamp(g[0].dot(g[b-1]),-1,1)),o/=b-1,m[0].dot(y.crossVectors(g[0],g[b-1]))>0&&(o=-o),d=1;d<b;d++)g[d].applyMatrix4(x.makeRotationAxis(m[d],o*d)),v[d].crossVectors(m[d],g[d])},Oe.prototype=Object.create(q.prototype),Oe.prototype.constructor=Oe,Oe.prototype.addShapeList=function(t,e){for(var i=t.length,n=0;n<i;n++){var s=t[n];this.addShape(s,e)}},Oe.prototype.addShape=function(e,n){function s(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}function r(t,e,n){var s,r,o=1,a=t.x-e.x,h=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=a*a+h*h,d=a*c-h*l;if(Math.abs(d)>Number.EPSILON){var p=Math.sqrt(u),f=Math.sqrt(l*l+c*c),m=e.x-h/p,g=e.y+a/p,v=n.x-c/f,y=n.y+l/f,x=((v-m)*c-(y-g)*l)/(a*c-h*l);s=m+a*x-t.x,r=g+h*x-t.y;var b=s*s+r*r;if(b<=2)return new i(s,r);o=Math.sqrt(b/2)}else{var w=!1;a>Number.EPSILON?l>Number.EPSILON&&(w=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(w=!0):Math.sign(h)===Math.sign(c)&&(w=!0),w?(s=-h,r=a,o=Math.sqrt(u)):(s=a,r=h,o=Math.sqrt(u/2))}return new i(s/o,r/o)}function o(){if(_){var t=0,e=X*t;for($=0;$<Y;$++)G=O[$],u(G[2]+e,G[1]+e,G[0]+e);for(t=M+2*w,e=X*t,$=0;$<Y;$++)G=O[$],u(G[0]+e,G[1]+e,G[2]+e)}else{for($=0;$<Y;$++)G=O[$],u(G[2],G[1],G[0]);for($=0;$<Y;$++)G=O[$],u(G[0]+X*M,G[1]+X*M,G[2]+X*M)}}function h(){var t=0;for(l(B,t),t+=B.length,N=0,L=z.length;N<L;N++)A=z[N],l(A,t),t+=A.length}function l(t,e){var i,n;for($=t.length;--$>=0;){i=$,n=$-1,n<0&&(n=t.length-1);var s=0,r=M+2*w;for(s=0;s<r;s++){var o=X*s,a=X*(s+1),h=e+i+o,l=e+n+o,c=e+n+a,u=e+i+a;d(h,l,c,u,t,s,r,i,n)}}}function c(t,e,i){P.vertices.push(new a(t,e,i))}function u(t,e,i){t+=k,e+=k,i+=k,P.faces.push(new W(t,e,i,null,null,0));var n=C.generateTopUV(P,t,e,i);P.faceVertexUvs[0].push(n)}function d(t,e,i,n,s,r,o,a,h){t+=k,e+=k,i+=k,n+=k,P.faces.push(new W(t,e,n,null,null,1)),P.faces.push(new W(e,i,n,null,null,1));var l=C.generateSideWallUV(P,t,e,i,n);P.faceVertexUvs[0].push([l[0],l[1],l[3]]),P.faceVertexUvs[0].push([l[1],l[2],l[3]])}var p,f,m,g,v,y=void 0!==n.amount?n.amount:100,x=void 0!==n.bevelThickness?n.bevelThickness:6,b=void 0!==n.bevelSize?n.bevelSize:x-2,w=void 0!==n.bevelSegments?n.bevelSegments:3,_=void 0===n.bevelEnabled||n.bevelEnabled,S=void 0!==n.curveSegments?n.curveSegments:12,M=void 0!==n.steps?n.steps:1,T=n.extrudePath,E=!1,C=void 0!==n.UVGenerator?n.UVGenerator:Oe.WorldUVGenerator;T&&(p=T.getSpacedPoints(M),E=!0,_=!1,f=void 0!==n.frames?n.frames:new Re.FrenetFrames(T,M,!1),m=new a,g=new a,v=new a),_||(w=0,x=0,b=0);var A,N,L,P=this,k=this.vertices.length,I=e.extractPoints(S),D=I.shape,z=I.holes,R=!t.ShapeUtils.isClockWise(D);if(R){for(D=D.reverse(),N=0,L=z.length;N<L;N++)A=z[N],t.ShapeUtils.isClockWise(A)&&(z[N]=A.reverse());R=!1}var O=t.ShapeUtils.triangulateShape(D,z),B=D;for(N=0,L=z.length;N<L;N++)A=z[N],D=D.concat(A);for(var F,U,V,H,j,G,X=D.length,Y=O.length,q=[],$=0,Z=B.length,J=Z-1,K=$+1;$<Z;$++,J++,K++)J===Z&&(J=0),K===Z&&(K=0),q[$]=r(B[$],B[J],B[K]);var Q,tt=[],et=q.concat();for(N=0,L=z.length;N<L;N++){for(A=z[N],Q=[],$=0,Z=A.length,J=Z-1,K=$+1;$<Z;$++,J++,K++)J===Z&&(J=0),K===Z&&(K=0),Q[$]=r(A[$],A[J],A[K]);tt.push(Q),et=et.concat(Q)}for(F=0;F<w;F++){for(V=F/w,H=x*Math.cos(V*Math.PI/2),U=b*Math.sin(V*Math.PI/2),$=0,Z=B.length;$<Z;$++)j=s(B[$],q[$],U),c(j.x,j.y,-H);for(N=0,L=z.length;N<L;N++)for(A=z[N],Q=tt[N],$=0,Z=A.length;$<Z;$++)j=s(A[$],Q[$],U),c(j.x,j.y,-H)}for(U=b,$=0;$<X;$++)j=_?s(D[$],et[$],U):D[$],E?(g.copy(f.normals[0]).multiplyScalar(j.x),m.copy(f.binormals[0]).multiplyScalar(j.y),v.copy(p[0]).add(g).add(m),c(v.x,v.y,v.z)):c(j.x,j.y,0);var it;for(it=1;it<=M;it++)for($=0;$<X;$++)j=_?s(D[$],et[$],U):D[$],E?(g.copy(f.normals[it]).multiplyScalar(j.x),m.copy(f.binormals[it]).multiplyScalar(j.y),v.copy(p[it]).add(g).add(m),c(v.x,v.y,v.z)):c(j.x,j.y,y/M*it);for(F=w-1;F>=0;F--){for(V=F/w,H=x*Math.cos(V*Math.PI/2),U=b*Math.sin(V*Math.PI/2),$=0,Z=B.length;$<Z;$++)j=s(B[$],q[$],U),c(j.x,j.y,y+H);for(N=0,L=z.length;N<L;N++)for(A=z[N],Q=tt[N],$=0,Z=A.length;$<Z;$++)j=s(A[$],Q[$],U),E?c(j.x,j.y+p[M-1].y,p[M-1].x+H):c(j.x,j.y,y+H)}o(),h()},Oe.WorldUVGenerator={generateTopUV:function(t,e,n,s){var r=t.vertices,o=r[e],a=r[n],h=r[s];return[new i(o.x,o.y),new i(a.x,a.y),new i(h.x,h.y)]},generateSideWallUV:function(t,e,n,s,r){var o=t.vertices,a=o[e],h=o[n],l=o[s],c=o[r];return Math.abs(a.y-h.y)<.01?[new i(a.x,1-a.z),new i(h.x,1-h.z),new i(l.x,1-l.z),new i(c.x,1-c.z)]:[new i(a.y,1-a.z),new i(h.y,1-h.z),new i(l.y,1-l.z),new i(c.y,1-c.z)]}},Be.prototype=Object.create(q.prototype),Be.prototype.constructor=Be,Be.prototype.addShapeList=function(t,e){for(var i=0,n=t.length;i<n;i++)this.addShape(t[i],e);return this},Be.prototype.addShape=function(e,i){void 0===i&&(i={});var n,s,r,o=void 0!==i.curveSegments?i.curveSegments:12,h=i.material,l=void 0===i.UVGenerator?Oe.WorldUVGenerator:i.UVGenerator,c=this.vertices.length,u=e.extractPoints(o),d=u.shape,p=u.holes,f=!t.ShapeUtils.isClockWise(d);if(f){for(d=d.reverse(),n=0,s=p.length;n<s;n++)r=p[n],t.ShapeUtils.isClockWise(r)&&(p[n]=r.reverse());f=!1}var m=t.ShapeUtils.triangulateShape(d,p);for(n=0,s=p.length;n<s;n++)r=p[n],d=d.concat(r);var g,v,y=d.length,x=m.length;for(n=0;n<y;n++)g=d[n],this.vertices.push(new a(g.x,g.y,0));for(n=0;n<x;n++){v=m[n];var b=v[0]+c,w=v[1]+c,_=v[2]+c;this.faces.push(new W(b,w,_,null,null,h)),this.faceVertexUvs[0].push(l.generateTopUV(this,b,w,_))}},Fe.prototype=Object.assign(Object.create(Ba),{constructor:Fe,extrude:function(t){return new Oe(this,t)},makeGeometry:function(t){return new Be(this,t)},getPointsHoles:function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},extractAllPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},extractPoints:function(t){return this.extractAllPoints(t)}}),Ue.prototype=Ba,Ba.constructor=Ue,Ve.prototype={moveTo:function(t,e){this.currentPath=new Ue,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,i,n){this.currentPath.quadraticCurveTo(t,e,i,n)},bezierCurveTo:function(t,e,i,n,s,r){this.currentPath.bezierCurveTo(t,e,i,n,s,r)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(e,i){function n(t){for(var e=[],i=0,n=t.length;i<n;i++){var s=t[i],r=new Fe;r.curves=s.curves,e.push(r)}return e}function s(t,e){for(var i=e.length,n=!1,s=i-1,r=0;r<i;s=r++){var o=e[s],a=e[r],h=a.x-o.x,l=a.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=e[r],h=-h,a=e[s],l=-l),t.y<o.y||t.y>a.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var c=l*(t.x-o.x)-h*(t.y-o.y);if(0===c)return!0;if(c<0)continue;n=!n}}else{if(t.y!==o.y)continue;if(a.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=a.x)return!0}}return n}var r=t.ShapeUtils.isClockWise,o=this.subPaths;if(0===o.length)return[];if(i===!0)return n(o);var a,h,l,c=[];if(1===o.length)return h=o[0],l=new Fe,l.curves=h.curves,c.push(l),c;var u=!r(o[0].getPoints());u=e?!u:u;var d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)h=o[v],d=h.getPoints(),a=r(d),a=e?!a:a,a?(!u&&f[g]&&g++,f[g]={s:new Fe,p:d},f[g].s.curves=h.curves,u&&g++,m[g]=[]):m[g].push({h:h,p:d[0]});if(!f[0])return n(o);if(f.length>1){for(var x=!1,b=[],w=0,_=f.length;w<_;w++)p[w]=[];for(var w=0,_=f.length;w<_;w++)for(var S=m[w],M=0;M<S.length;M++){for(var T=S[M],E=!0,C=0;C<f.length;C++)s(T.p,f[C].p)&&(w!==C&&b.push({froms:w,tos:C,hole:M}),E?(E=!1,p[C].push(T)):x=!0);E&&p[w].push(T)}b.length>0&&(x||(m=p))}for(var A,v=0,N=f.length;v<N;v++){l=f[v].s,c.push(l),A=m[v];for(var L=0,P=A.length;L<P;L++)l.holes.push(A[L].h)}return c}},Object.assign(He.prototype,{isFont:!0,generateShapes:function(e,i,n){function s(t){for(var e=String(t).split(""),n=i/o.resolution,s=0,a=[],h=0;h<e.length;h++){var l=r(e[h],n,s);s+=l.offset,a.push(l.path)}return a}function r(e,i,s){var r=o.glyphs[e]||o.glyphs["?"];if(r){var a,h,l,c,u,d,p,f,m,g,v,y=new Ve,x=[],b=t.ShapeUtils.b2,w=t.ShapeUtils.b3;if(r.o)for(var _=r._cachedOutline||(r._cachedOutline=r.o.split(" ")),S=0,M=_.length;S<M;){var T=_[S++];switch(T){case"m":a=_[S++]*i+s,h=_[S++]*i,y.moveTo(a,h);break;case"l":a=_[S++]*i+s,h=_[S++]*i,y.lineTo(a,h);break;case"q":if(l=_[S++]*i+s,c=_[S++]*i,p=_[S++]*i+s,f=_[S++]*i,y.quadraticCurveTo(p,f,l,c),v=x[x.length-1]){u=v.x,d=v.y;for(var E=1;E<=n;E++){var C=E/n;b(C,u,p,l),b(C,d,f,c)}}break;case"b":if(l=_[S++]*i+s,c=_[S++]*i,p=_[S++]*i+s,f=_[S++]*i,m=_[S++]*i+s,g=_[S++]*i,y.bezierCurveTo(p,f,m,g,l,c),v=x[x.length-1]){u=v.x,d=v.y;for(var E=1;E<=n;E++){var C=E/n;w(C,u,p,m,l),w(C,d,f,g,c)}}}}return{offset:r.ha*i,path:y}}}void 0===i&&(i=100),void 0===n&&(n=4);for(var o=this.data,a=s(e),h=[],l=0,c=a.length;l<c;l++)Array.prototype.push.apply(h,a[l].toShapes());return h}}),Object.assign(We.prototype,{load:function(t,e,i,n){var s=this,r=new $t(this.manager);r.load(t,function(t){var i;try{i=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(t.substring(65,t.length-2))}var n=s.parse(i);e&&e(n)},i,n)},parse:function(t){return new He(t)}});var Fa;Object.assign(Ge.prototype,{load:function(t,e,i,n){var s=new $t(this.manager);s.setResponseType("arraybuffer"),s.load(t,function(t){var i=je();i.decodeAudioData(t,function(t){e(t)})},i,n)}}),Object.assign(Xe.prototype,{update:function(){var e,i,n,s,o,a=new r,h=new r;return function(r){var l=e!==r.focus||i!==r.fov||n!==r.aspect*this.aspect||s!==r.near||o!==r.far;if(l){e=r.focus,i=r.fov,n=r.aspect*this.aspect,s=r.near,o=r.far;var c,u,d=r.projectionMatrix.clone(),p=this.eyeSep/2,f=p*s/e,m=s*Math.tan(t.Math.DEG2RAD*i*.5);h.elements[12]=-p,
a.elements[12]=p,c=-m*n+f,u=m*n+f,d.elements[0]=2*s/(u-c),d.elements[8]=(u+c)/(u-c),this.cameraL.projectionMatrix.copy(d),c=-m*n-f,u=m*n-f,d.elements[0]=2*s/(u-c),d.elements[8]=(u+c)/(u-c),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(r.matrixWorld).multiply(h),this.cameraR.matrixWorld.copy(r.matrixWorld).multiply(a)}}()}),Ye.prototype=Object.create(X.prototype),Ye.prototype.constructor=Ye,qe.prototype=Object.assign(Object.create(X.prototype),{constructor:qe,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new a,e=new o,i=new a,n=new a;return function(s){X.prototype.updateMatrixWorld.call(this,s);var r=this.context.listener,o=this.up;this.matrixWorld.decompose(t,e,i),n.set(0,0,-1).applyQuaternion(e),r.setPosition(t.x,t.y,t.z),r.setOrientation(n.x,n.y,n.z,o.x,o.y,o.z)}}()}),$e.prototype=Object.assign(Object.create(X.prototype),{constructor:$e,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.source.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");var t=this.context.createBufferSource();return t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()},pause:function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this)},stop:function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0,this.isPlaying=!1,this)},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),this.isPlaying===!0?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=t,this.isPlaying===!0&&(this.source.playbackRate.value=this.playbackRate),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop},setLoop:function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):void(this.source.loop=t)},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),Ze.prototype=Object.assign(Object.create($e.prototype),{constructor:Ze,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new a;return function(e){X.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(Je.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),Ke.prototype={constructor:Ke,accumulate:function(t,e){var i=this.buffer,n=this.valueSize,s=t*n+n,r=this.cumulativeWeight;if(0===r){for(var o=0;o!==n;++o)i[s+o]=i[o];r=e}else{r+=e;var a=e/r;this._mixBufferRegion(i,s,0,a,n)}this.cumulativeWeight=r},apply:function(t){var e=this.valueSize,i=this.buffer,n=t*e+e,s=this.cumulativeWeight,r=this.binding;if(this.cumulativeWeight=0,s<1){var o=3*e;this._mixBufferRegion(i,n,o,1-s,e)}for(var a=e,h=e+e;a!==h;++a)if(i[a]!==i[a+e]){r.setValue(i,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,i=this.valueSize,n=3*i;t.getValue(e,n);for(var s=i,r=n;s!==r;++s)e[s]=e[n+s%i];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,i,n,s){if(n>=.5)for(var r=0;r!==s;++r)t[e+r]=t[i+r]},_slerp:function(t,e,i,n,s){o.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,s){for(var r=1-n,o=0;o!==s;++o){var a=e+o;t[a]=t[a]*r+t[i+o]*n}}},Qe.prototype={constructor:Qe,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,s=e.propertyIndex;if(t||(t=Qe.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("  trying to update node for track: "+this.path+" but it wasn't found.");if(i){var r=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===r){r=o;break}break;default:if(void 0===t[i])return void console.error("  can not bind to objectName of node, undefined",this);t=t[i]}if(void 0!==r){if(void 0===t[r])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[r]}}var a=t[n];if(void 0===a){var h=e.nodeName;return void console.error("  trying to update property for track: "+h+"."+n+" but it wasn't found.",t)}var l=this.Versioning.None;void 0!==t.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var c=this.BindingType.Direct;if(void 0!==s){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(var o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===s){s=o;break}}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):void 0!==a.length?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(Qe.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:Qe.prototype.getValue,_setValue_unbound:Qe.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,s=i.length;n!==s;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,s=i.length;n!==s;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,s=i.length;n!==s;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,s=i.length;n!==s;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),Qe.Composite=function(t,e,i){var n=i||Qe.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)},Qe.Composite.prototype={constructor:Qe.Composite,getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,s=i.length;n!==s;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},Qe.create=function(t,e,i){return t&&t.isAnimationObjectGroup?new Qe.Composite(t,e,i):new Qe(t,e,i)},Qe.parseTrackName=function(t){var e=/^((?:\w+\/)*)(\w+)?(?:\.(\w+)(?:\[(.+)\])?)?\.(\w+)(?:\[(.+)\])?$/,i=e.exec(t);if(!i)throw new Error("cannot parse trackName at all: "+t);var n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]};if(null===n.propertyName||0===n.propertyName.length)throw new Error("can not parse propertyName from trackName: "+t);return n},Qe.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=function(t){for(var i=0;i<t.bones.length;i++){var n=t.bones[i];if(n.name===e)return n}return null},n=i(t.skeleton);if(n)return n}if(t.children){var s=function(t){for(var i=0;i<t.length;i++){var n=t[i];if(n.name===e||n.uuid===e)return n;var r=s(n.children);if(r)return r}return null},r=s(t.children);if(r)return r}return null},ti.prototype={constructor:ti,isAnimationObjectGroup:!0,add:function(t){for(var e=this._objects,i=e.length,n=this.nCachedObjects_,s=this._indicesByUUID,r=this._paths,o=this._parsedPaths,a=this._bindings,h=a.length,l=0,c=arguments.length;l!==c;++l){var u=arguments[l],d=u.uuid,p=s[d];if(void 0===p){p=i++,s[d]=p,e.push(u);for(var f=0,m=h;f!==m;++f)a[f].push(new Qe(u,r[f],o[f]))}else if(p<n){var g=e[p],v=--n,y=e[v];s[y.uuid]=p,e[p]=y,s[d]=v,e[v]=u;for(var f=0,m=h;f!==m;++f){var x=a[f],b=x[v],w=x[p];x[p]=b,void 0===w&&(w=new Qe(u,r[f],o[f])),x[v]=w}}else e[p]!==g&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=n},remove:function(t){for(var e=this._objects,i=this.nCachedObjects_,n=this._indicesByUUID,s=this._bindings,r=s.length,o=0,a=arguments.length;o!==a;++o){var h=arguments[o],l=h.uuid,c=n[l];if(void 0!==c&&c>=i){var u=i++,d=e[u];n[d.uuid]=c,e[c]=d,n[l]=u,e[u]=h;for(var p=0,f=r;p!==f;++p){var m=s[p],g=m[u],v=m[c];m[c]=g,m[u]=v}}}this.nCachedObjects_=i},uncache:function(t){for(var e=this._objects,i=e.length,n=this.nCachedObjects_,s=this._indicesByUUID,r=this._bindings,o=r.length,a=0,h=arguments.length;a!==h;++a){var l=arguments[a],c=l.uuid,u=s[c];if(void 0!==u)if(delete s[c],u<n){var d=--n,p=e[d],f=--i,m=e[f];s[p.uuid]=u,e[u]=p,s[m.uuid]=d,e[d]=m,e.pop();for(var g=0,v=o;g!==v;++g){var y=r[g],x=y[d],b=y[f];y[u]=x,y[d]=b,y.pop()}}else{var f=--i,m=e[f];s[m.uuid]=u,e[u]=m,e.pop();for(var g=0,v=o;g!==v;++g){var y=r[g];y[u]=y[f],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],s=this._bindings;if(void 0!==n)return s[n];var r=this._paths,o=this._parsedPaths,a=this._objects,h=a.length,l=this.nCachedObjects_,c=new Array(h);n=s.length,i[t]=n,r.push(t),o.push(e),s.push(c);for(var u=l,d=a.length;u!==d;++u){var p=a[u];c[u]=new Qe(p,t,e)}return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var n=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length-1,a=r[o],h=t[o];e[h]=i,r[i]=a,r.pop(),s[i]=s[o],s.pop(),n[i]=n[o],n.pop()}}},ei._new=function(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null;for(var n=e.tracks,s=n.length,r=new Array(s),o={endingStart:vr,endingEnd:vr},a=0;a!==s;++a){var h=n[a].createInterpolant(null);r[a]=h,h.settings=o}this._interpolantSettings=o,this._interpolants=r,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=dr,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0},ei._new.prototype={constructor:ei._new,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){var n=this._clip.duration,s=t._clip.duration,r=s/n,o=n/s;t.warp(1,r,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,s=n.time,r=this._timeScaleInterpolant,o=this.timeScale;null===r&&(r=n._lendControlInterpolant(),this._timeScaleInterpolant=r);var a=r.parameterPositions,h=r.sampleValues;return a[0]=s,a[1]=s+i,h[0]=t/o,h[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){var s=this._startTime;if(null!==s){var r=(t-s)*i;if(r<0||0===i)return;this._startTime=null,e=i*r}e*=this._updateTimeScale(t);var o=this._updateTime(e),a=this._updateWeight(t);if(a>0)for(var h=this._interpolants,l=this._propertyBindings,c=0,u=h.length;c!==u;++c)h[c].evaluate(o),l[c].accumulate(n,a)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var i=this._clip.duration,n=this.loop,s=this._loopCount;if(n===ur){s===-1&&(this.loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=i)e=i;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var r=n===pr;if(s===-1&&(t>=0?(s=0,this._setEndings(!0,0===this.repetitions,r)):this._setEndings(0===this.repetitions,!0,r)),e>=i||e<0){var o=Math.floor(e/i);e-=i*o,s+=Math.abs(o);var a=this.repetitions-s;if(a<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(0===a){var h=t<0;this._setEndings(h,!h,r)}else this._setEndings(!1,!1,r);this._loopCount=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(r&&1===(1&s))return this.time=e,i-e}return this.time=e,e},_setEndings:function(t,e,i){var n=this._interpolantSettings;i?(n.endingStart=yr,n.endingEnd=yr):(t?n.endingStart=this.zeroSlopeAtStart?yr:vr:n.endingStart=xr,e?n.endingEnd=this.zeroSlopeAtEnd?yr:vr:n.endingEnd=xr)},_scheduleFading:function(t,e,i){var n=this._mixer,s=n.time,r=this._weightInterpolant;null===r&&(r=n._lendControlInterpolant(),this._weightInterpolant=r);var o=r.parameterPositions,a=r.sampleValues;return o[0]=s,a[0]=e,o[1]=s+t,a[1]=i,this}},Object.assign(ii.prototype,e.prototype,{clipAction:function(t,e){var i=e||this._root,n=i.uuid,s="string"==typeof t?Se.findByName(i,t):t,r=null!==s?s.uuid:t,o=this._actionsByClip[r],a=null;if(void 0!==o){var h=o.actionByRoot[n];if(void 0!==h)return h;a=o.knownActions[0],null===s&&(s=a._clip)}if(null===s)return null;var l=new ii._Action(this,s,e);return this._bindAction(l,a),this._addInactiveAction(l,r,n),l},existingAction:function(t,e){var i=e||this._root,n=i.uuid,s="string"==typeof t?Se.findByName(i,t):t,r=s?s.uuid:t,o=this._actionsByClip[r];return void 0!==o?o.actionByRoot[n]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var s=0;s!==e;++s)t[s].reset();for(var s=0;s!==n;++s)i[s].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,s=Math.sign(t),r=this._accuIndex^=1,o=0;o!==i;++o){var a=e[o];a.enabled&&a._update(n,t,s,r)}for(var h=this._bindings,l=this._nActiveBindings,o=0;o!==l;++o)h[o].apply(r);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,i=t.uuid,n=this._actionsByClip,s=n[i];if(void 0!==s){for(var r=s.knownActions,o=0,a=r.length;o!==a;++o){var h=r[o];this._deactivateAction(h);var l=h._cacheIndex,c=e[e.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,c._cacheIndex=l,e[l]=c,e.pop(),this._removeInactiveBindingsForAction(h)}delete n[i]}},uncacheRoot:function(t){var e=t.uuid,i=this._actionsByClip;for(var n in i){var s=i[n].actionByRoot,r=s[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var o=this._bindingsByRootAndName,a=o[e];if(void 0!==a)for(var h in a){var l=a[h];l.restoreOriginalState(),this._removeInactiveBinding(l)}},uncacheAction:function(t,e){var i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),ii._Action=ei._new,Object.assign(ii.prototype,{_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,s=n.length,r=t._propertyBindings,o=t._interpolants,a=i.uuid,h=this._bindingsByRootAndName,l=h[a];void 0===l&&(l={},h[a]=l);for(var c=0;c!==s;++c){var u=n[c],d=u.name,p=l[d];if(void 0!==p)r[c]=p;else{if(p=r[c],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,a,d));continue}var f=e&&e._propertyBindings[c].binding.parsedPath;p=new Ke(Qe.create(i,d,f),u.ValueTypeName,u.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,a,d),r[c]=p}o[c].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}for(var s=t._propertyBindings,r=0,o=s.length;r!==o;++r){var a=s[r];0===a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var s=e[i];0===--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,s=this._actionsByClip,r=s[e];if(void 0===r)r={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,s[e]=r;else{var o=r.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=n.length,n.push(t),r.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;var s=t._clip.uuid,r=this._actionsByClip,o=r[s],a=o.knownActions,h=a[a.length-1],l=t._byClipCacheIndex;h._byClipCacheIndex=l,a[l]=h,a.pop(),t._byClipCacheIndex=null;var c=o.actionByRoot,u=(e._localRoot||this._root).uuid;delete c[u],0===a.length&&delete r[s],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var s=e[i];0===--s.referenceCount&&this._removeInactiveBinding(s)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,s=e[n];t._cacheIndex=n,e[n]=t,s._cacheIndex=i,e[i]=s},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,s=e[n];t._cacheIndex=n,e[n]=t,s._cacheIndex=i,e[i]=s},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,s=n[e],r=this._bindings;void 0===s&&(s={},n[e]=s),s[i]=t,t._cacheIndex=r.length,r.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=t.binding,n=i.rootNode.uuid,s=i.path,r=this._bindingsByRootAndName,o=r[n],a=e[e.length-1],h=t._cacheIndex;a._cacheIndex=h,e[h]=a,e.pop(),delete o[s];t:{for(var l in o)break t;delete r[n]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,s=e[n];t._cacheIndex=n,e[n]=t,s._cacheIndex=i,e[i]=s},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,s=e[n];t._cacheIndex=n,e[n]=t,s._cacheIndex=i,e[i]=s},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(i=new de(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=e,t[e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,s=e[n];t.__cacheIndex=n,e[n]=t,s.__cacheIndex=i,e[i]=s},_controlInterpolantsResultBuffer:new Float32Array(1)}),ni.prototype={constructor:ni,onUpdate:function(t){return this.dynamic=!0,this.onUpdateCallback=t,this}},si.prototype=Object.create(J.prototype),si.prototype.constructor=si,si.prototype.isInstancedBufferGeometry=!0,si.prototype.addGroup=function(t,e,i){this.groups.push({start:t,count:e,instances:i})},si.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var n in i){var s=i[n];this.addAttribute(n,s.clone())}for(var r=t.groups,o=0,a=r.length;o<a;o++){var h=r[o];this.addGroup(h.start,h.count,h.instances)}return this},ri.prototype={constructor:ri,isInterleavedBufferAttribute:!0,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.count},get array(){return this.data.array},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,s){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=s,this}},oi.prototype={constructor:oi,isInterleavedBuffer:!0,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(t){t===!0&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,s=this.stride;n<s;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},ai.prototype=Object.create(oi.prototype),ai.prototype.constructor=ai,ai.prototype.isInstancedInterleavedBuffer=!0,ai.prototype.copy=function(t){return oi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},hi.prototype=Object.create(k.prototype),hi.prototype.constructor=hi,hi.prototype.isInstancedBufferAttribute=!0,hi.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},li.prototype={constructor:li,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var i=[];return ui(t,this,i,e),i.sort(ci),i},intersectObjects:function(t,e){var i=[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var n=0,s=t.length;n<s;n++)ui(t[n],this,i,e);return i.sort(ci),i}},di.prototype={constructor:di,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=(performance||Date).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}},fi.prototype={constructor:fi,set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius.copy(t.radius),this.phi.copy(t.phi),this.theta.copy(t.theta),this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(t.Math.clamp(e.y/this.radius,-1,1))),this}},mi.prototype=Object.create(dt.prototype),mi.prototype.constructor=mi,mi.prototype.createAnimation=function(t,e,i,n){var s={start:e,end:i,length:i-e+1,fps:n,duration:(i-e)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=s,this.animationsList.push(s)},mi.prototype.autoCreateAnimations=function(t){for(var e,i=/([a-z]+)_?(\d+)/i,n={},s=this.geometry,r=0,o=s.morphTargets.length;r<o;r++){var a=s.morphTargets[r],h=a.name.match(i);if(h&&h.length>1){var l=h[1];n[l]||(n[l]={start:1/0,end:-(1/0)});var c=n[l];r<c.start&&(c.start=r),r>c.end&&(c.end=r),e||(e=l)}}for(var l in n){var c=n[l];this.createAnimation(l,c.start,c.end,t)}this.firstAnimation=e},mi.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},mi.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},mi.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},mi.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},mi.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},mi.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},mi.prototype.getAnimationTime=function(t){var e=0,i=this.animationsMap[t];return i&&(e=i.time),e},mi.prototype.getAnimationDuration=function(t){var e=-1,i=this.animationsMap[t];return i&&(e=i.duration),e},mi.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()");
},mi.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},mi.prototype.update=function(e){for(var i=0,n=this.animationsList.length;i<n;i++){var s=this.animationsList[i];if(s.active){var r=s.duration/s.length;s.time+=s.direction*e,s.mirroredLoop?(s.time>s.duration||s.time<0)&&(s.direction*=-1,s.time>s.duration&&(s.time=s.duration,s.directionBackwards=!0),s.time<0&&(s.time=0,s.directionBackwards=!1)):(s.time=s.time%s.duration,s.time<0&&(s.time+=s.duration));var o=s.start+t.Math.clamp(Math.floor(s.time/r),0,s.length-1),a=s.weight;o!==s.currentFrame&&(this.morphTargetInfluences[s.lastFrame]=0,this.morphTargetInfluences[s.currentFrame]=1*a,this.morphTargetInfluences[o]=0,s.lastFrame=s.currentFrame,s.currentFrame=o);var h=s.time%r/r;s.directionBackwards&&(h=1-h),s.currentFrame!==s.lastFrame?(this.morphTargetInfluences[s.currentFrame]=h*a,this.morphTargetInfluences[s.lastFrame]=(1-h)*a):this.morphTargetInfluences[s.currentFrame]=a}}},gi.prototype=Object.create(X.prototype),gi.prototype.constructor=gi,gi.prototype.isImmediateRenderObject=!0,vi.prototype=Object.create(J.prototype),vi.prototype.constructor=vi,yi.prototype=Object.create(Pt.prototype),yi.prototype.constructor=yi,xi.prototype=Object.create(Pt.prototype),xi.prototype.constructor=xi,xi.prototype.update=function(){var t=new a,e=new a,i=new E;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var s=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var a=o.vertices,h=o.faces,l=0,c=0,u=h.length;c<u;c++)for(var d=h[c],p=0,f=d.vertexNormals.length;p<f;p++){var m=a[d[n[p]]],g=d.vertexNormals[p];t.copy(m).applyMatrix4(s),e.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),r.setXYZ(l,t.x,t.y,t.z),l+=1,r.setXYZ(l,e.x,e.y,e.z),l+=1}else if(o&&o.isBufferGeometry)for(var v=o.attributes.position,y=o.attributes.normal,l=0,p=0,f=v.count;p<f;p++)t.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(s),e.set(y.getX(p),y.getY(p),y.getZ(p)),e.applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),r.setXYZ(l,t.x,t.y,t.z),l+=1,r.setXYZ(l,e.x,e.y,e.z),l+=1;return r.needsUpdate=!0,this}}(),bi.prototype=Object.create(X.prototype),bi.prototype.constructor=bi,bi.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},bi.prototype.update=function(){var t=new a,e=new a;return function(){var i=this.light.distance?this.light.distance:1e3,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),wi.prototype=Object.create(Pt.prototype),wi.prototype.constructor=wi,wi.prototype.getBoneList=function(t){var e=[];t&&t.isBone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,this.getBoneList(t.children[i]));return e},wi.prototype.update=function(){for(var t=this.geometry,e=(new r).getInverse(this.root.matrixWorld),i=new r,n=0,s=0;s<this.bones.length;s++){var o=this.bones[s];o.parent&&o.parent.isBone&&(i.multiplyMatrices(e,o.matrixWorld),t.vertices[n].setFromMatrixPosition(i),i.multiplyMatrices(e,o.parent.matrixWorld),t.vertices[n+1].setFromMatrixPosition(i),n+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},_i.prototype=Object.create(J.prototype),_i.prototype.constructor=_i,Si.prototype=Object.create(dt.prototype),Si.prototype.constructor=Si,Si.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Si.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},Mi.prototype=Object.create(q.prototype),Mi.prototype.constructor=Mi,Ti.prototype=Object.create(X.prototype),Ti.prototype.constructor=Ti,Ti.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},Ti.prototype.update=function(){var t=new a;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),Ei.prototype=Object.create(Pt.prototype),Ei.prototype.constructor=Ei,Ei.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ci.prototype=Object.create(Pt.prototype),Ci.prototype.constructor=Ci,Ci.prototype.update=function(){var t=new a,e=new a,i=new E;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,s=this.geometry.attributes.position,r=this.object.geometry,o=r.vertices,a=r.faces,h=0,l=0,c=a.length;l<c;l++){var u=a[l],d=u.normal;t.copy(o[u.a]).add(o[u.b]).add(o[u.c]).divideScalar(3).applyMatrix4(n),e.copy(d).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),s.setXYZ(h,t.x,t.y,t.z),h+=1,s.setXYZ(h,e.x,e.y,e.z),h+=1}return s.needsUpdate=!0,this}}(),Ai.prototype=Object.create(J.prototype),Ai.prototype.constructor=Ai,Ni.prototype=Object.create(Pt.prototype),Ni.prototype.constructor=Ni,Li.prototype=Object.create(X.prototype),Li.prototype.constructor=Li,Li.prototype.dispose=function(){var t=this.children[0],e=this.children[1];t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()},Li.prototype.update=function(){var t=new a,e=new a,i=new a;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(e,t);var n=this.children[0],s=this.children[1];n.lookAt(i),n.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),s.lookAt(i),s.scale.z=i.length()}}(),Pi.prototype=Object.create(Pt.prototype),Pi.prototype.constructor=Pi,Pi.prototype.update=function(){function t(t,r,o,a){n.set(r,o,a).unproject(s);var h=i[t];if(void 0!==h)for(var l=0,c=h.length;l<c;l++)e.vertices[h[l]].copy(n)}var e,i,n=new a,s=new ft;return function(){e=this.geometry,i=this.pointMap;var n=1,r=1;s.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-n,-r,-1),t("n2",n,-r,-1),t("n3",-n,r,-1),t("n4",n,r,-1),t("f1",-n,-r,1),t("f2",n,-r,1),t("f3",-n,r,1),t("f4",n,r,1),t("u1",.7*n,1.1*r,-1),t("u2",.7*-n,1.1*r,-1),t("u3",0,2*r,-1),t("cf1",-n,0,1),t("cf2",n,0,1),t("cf3",0,-r,1),t("cf4",0,r,1),t("cn1",-n,0,-1),t("cn2",n,0,-1),t("cn3",0,-r,-1),t("cn4",0,r,-1),e.verticesNeedUpdate=!0}}(),ki.prototype=Object.create(q.prototype),ki.prototype.constructor=ki,Ii.prototype=Object.create(dt.prototype),Ii.prototype.constructor=Ii,Ii.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},Di.prototype=Object.create(Pt.prototype),Di.prototype.constructor=Di,Di.prototype.update=function(){var t=new M;return function(e){if(e&&e.isBox3?t.copy(e):t.setFromObject(e),!t.isEmpty()){var i=t.min,n=t.max,s=this.geometry.attributes.position,r=s.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=i.x,r[4]=n.y,r[5]=n.z,r[6]=i.x,r[7]=i.y,r[8]=n.z,r[9]=n.x,r[10]=i.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=i.z,r[15]=i.x,r[16]=n.y,r[17]=i.z,r[18]=i.x,r[19]=i.y,r[20]=i.z,r[21]=n.x,r[22]=i.y,r[23]=i.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),zi.prototype=Object.create(J.prototype),zi.prototype.constructor=zi,t.ArrowHelper=function(){var t=new J;t.addAttribute("position",new U([0,0,0,0,1,0],3));var e=new zi(0,.5,1,5,1);return e.translate(0,-.5,0),function(i,n,s,r,o,a){X.call(this),void 0===r&&(r=16776960),void 0===s&&(s=1),void 0===o&&(o=.2*s),void 0===a&&(a=.2*o),this.position.copy(n),this.line=new Lt(t,new Nt({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new dt(e,new ut({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(i),this.setLength(s,o,a)}}(),t.ArrowHelper.prototype=Object.create(X.prototype),t.ArrowHelper.prototype.constructor=t.ArrowHelper,t.ArrowHelper.prototype.setDirection=function(){var t,e=new a;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),t.ArrowHelper.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},t.ArrowHelper.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},Ri.prototype=Object.create(Pt.prototype),Ri.prototype.constructor=Ri,Oi.prototype=Object.create(q.prototype),Oi.prototype.constructor=Oi,Bi.prototype=Object.create(q.prototype),Bi.prototype.constructor=Bi,Fi.prototype=Object.create(Bi.prototype),Fi.prototype.constructor=Fi,Ui.prototype=Object.create(Bi.prototype),Ui.prototype.constructor=Ui,Vi.prototype=Object.create(Bi.prototype),Vi.prototype.constructor=Vi,Hi.prototype=Object.create(Bi.prototype),Hi.prototype.constructor=Hi,Wi.prototype=Object.create(J.prototype),Wi.prototype.constructor=Wi,ji.prototype=Object.create(q.prototype),ji.prototype.constructor=ji,Gi.prototype=Object.create(J.prototype),Gi.prototype.constructor=Gi,Xi.prototype=Object.create(q.prototype),Xi.prototype.constructor=Xi,Yi.prototype=Object.create(Oe.prototype),Yi.prototype.constructor=Yi,qi.prototype=Object.create(J.prototype),qi.prototype.constructor=qi,$i.prototype=Object.create(q.prototype),$i.prototype.constructor=$i,Zi.prototype=Object.create(q.prototype),Zi.prototype.constructor=Zi,Ji.prototype=Object.create(J.prototype),Ji.prototype.constructor=Ji,Ki.prototype=Object.create(q.prototype),Ki.prototype.constructor=Ki,Qi.prototype=Object.create(q.prototype),Qi.prototype.constructor=Qi,tn.prototype=Object.create(Qi.prototype),tn.prototype.constructor=tn,en.prototype=Object.create(J.prototype),en.prototype.constructor=en,nn.prototype=Object.create(J.prototype),nn.prototype.constructor=nn,sn.prototype=Object.create(q.prototype),sn.prototype.constructor=sn,t.CatmullRomCurve3=function(){function t(){}var e=new a,i=new t,n=new t,s=new t;return t.prototype.init=function(t,e,i,n){this.c0=t,this.c1=i,this.c2=-3*t+3*e-2*i-n,this.c3=2*t-2*e+i+n},t.prototype.initNonuniformCatmullRom=function(t,e,i,n,s,r,o){var a=(e-t)/s-(i-t)/(s+r)+(i-e)/r,h=(i-e)/r-(n-e)/(r+o)+(n-i)/o;a*=r,h*=r,this.init(e,i,a,h)},t.prototype.initCatmullRom=function(t,e,i,n,s){this.init(e,i,s*(i-t),s*(n-e))},t.prototype.calc=function(t){var e=t*t,i=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*i},Ne.create(function(t){this.points=t||[],this.closed=!1},function(t){var r,o,h,l,c=this.points;l=c.length,l<2&&console.log("duh, you need at least 2 points"),r=(l-(this.closed?0:1))*t,o=Math.floor(r),h=r-o,this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/c.length)+1)*c.length:0===h&&o===l-1&&(o=l-2,h=1);var u,d,p,f;if(this.closed||o>0?u=c[(o-1)%l]:(e.subVectors(c[0],c[1]).add(c[0]),u=e),d=c[o%l],p=c[(o+1)%l],this.closed||o+2<l?f=c[(o+2)%l]:(e.subVectors(c[l-1],c[l-2]).add(c[l-1]),f=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var m="chordal"===this.type?.5:.25,g=Math.pow(u.distanceToSquared(d),m),v=Math.pow(d.distanceToSquared(p),m),y=Math.pow(p.distanceToSquared(f),m);v<1e-4&&(v=1),g<1e-4&&(g=v),y<1e-4&&(y=v),i.initNonuniformCatmullRom(u.x,d.x,p.x,f.x,g,v,y),n.initNonuniformCatmullRom(u.y,d.y,p.y,f.y,g,v,y),s.initNonuniformCatmullRom(u.z,d.z,p.z,f.z,g,v,y)}else if("catmullrom"===this.type){var x=void 0!==this.tension?this.tension:.5;i.initCatmullRom(u.x,d.x,p.x,f.x,x),n.initCatmullRom(u.y,d.y,p.y,f.y,x),s.initCatmullRom(u.z,d.z,p.z,f.z,x)}var b=new a(i.calc(h),n.calc(h),s.calc(h));return b})}(),rn.prototype=Object.create(t.CatmullRomCurve3.prototype);var Ua=Ne.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0===t?[]:t},function(e){var i=this.points,n=(i.length-1)*e,s=Math.floor(n),r=n-s,o=i[0==s?s:s-1],h=i[s],l=i[s>i.length-2?i.length-1:s+1],c=i[s>i.length-3?i.length-1:s+2],u=t.CurveUtils.interpolate;return new a(u(o.x,h.x,l.x,c.x,r),u(o.y,h.y,l.y,c.y,r),u(o.z,h.z,l.z,c.z,r))});t.CubicBezierCurve3=Ne.create(function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},function(e){var i=t.ShapeUtils.b3;return new a(i(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),i(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),t.QuadraticBezierCurve3=Ne.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(e){var i=t.ShapeUtils.b2;return new a(i(e,this.v0.x,this.v1.x,this.v2.x),i(e,this.v0.y,this.v1.y,this.v2.y),i(e,this.v0.z,this.v1.z,this.v2.z))}),t.LineCurve3=Ne.create(function(t,e){this.v1=t,this.v2=e},function(t){if(1===t)return this.v2.clone();var e=new a;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),on.prototype=Object.create(ke.prototype),on.prototype.constructor=on,t.SceneUtils={createMultiMaterialObject:function(t,e){for(var i=new Dt,n=0,s=e.length;n<s;n++)i.add(new dt(t,e[n]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var n=new r;n.getInverse(i.matrixWorld),t.applyMatrix(n),e.remove(t),i.add(t)}};var Va=0,Ha=1;Object.assign(l.prototype,{empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)}}),Object.assign(M.prototype,{empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(E.prototype,{multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)}}),Object.assign(r.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(t){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(t){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(t){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(t){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(t,e){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}),Object.assign(C.prototype,{isIntersectionLine:function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)}}),Object.assign(o.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)}}),Object.assign(ht.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(a.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)}}),Object.assign(X.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(t){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(X.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Mt.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),mt.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(ee.prototype,{onlyShadow:{set:function(t){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(t){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(t){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(k.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length}}}),Object.assign(J.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(J.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(x.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(t){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new _}}}),Object.defineProperties(jt.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(t){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(w.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),e.prototype=Object.assign(Object.create({constructor:e,apply:function(t){console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."),Object.assign(t,this)}}),e.prototype),Object.assign(vt.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(vt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(N.prototype,{cullFace:{get:function(){return this.renderReverseSided?bn:xn},set:function(t){var e=t!==xn;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(y.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.assign($e.prototype,{load:function(t){console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");var e=this,i=new Ge;return i.load(t,function(t){e.setBuffer(t)}),this}}),Object.assign(Je.prototype,{getData:function(t){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()}});var Wa={merge:function(t,e,i){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},ja={crossOrigin:void 0,loadTexture:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var s=new te;s.setCrossOrigin(this.crossOrigin);var r=s.load(t,i,void 0,n);return e&&(r.mapping=e),r},loadTextureCube:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var s=new Qt;s.setCrossOrigin(this.crossOrigin);var r=s.load(t,i,void 0,n);return e&&(r.mapping=e),r},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};Object.defineProperty(t,"AudioContext",{get:function(){return t.getAudioContext()}}),t.SpritePlugin=h,t.LensFlarePlugin=c,t.WebGLTextures=d,t.WebGLStencilBuffer=v,t.WebGLDepthBuffer=g,t.WebGLColorBuffer=m,t.WebGLState=f,t.WebGLShadowMap=N,t.WebGLProperties=L,t.WebGLPrograms=P,t.WebGLObjects=Q,t.WebGLLights=tt,t.WebGLGeometries=K,t.WebGLCapabilities=et,t.WebGLExtensions=it,t.WebGLIndexedBufferRenderer=nt,t.WebGLClipping=st,t.WebGLBufferRenderer=rt,t.WebGLRenderTargetCube=ot,t.WebGLRenderTarget=y,t.WebGLRenderer=vt,t.ShaderChunk=Ia,t.FogExp2=yt,t.Fog=xt,t.Scene=bt,t.LensFlare=wt,t.Sprite=St,t.LOD=Mt,t.SkinnedMesh=At,t.Skeleton=Et,t.Bone=Ct,t.Mesh=dt,t.LineSegments=Pt,t.Line=Lt,t.Points=It,t.Group=Dt,t.VideoTexture=zt,t.DataTexture=Tt,t.CompressedTexture=Rt,t.CubeTexture=u,t.CanvasTexture=Ot,t.DepthTexture=Bt,t.TextureIdCount=s,t.Texture=n,t.ShadowMaterial=Ft,t.SpriteMaterial=_t,t.RawShaderMaterial=Ut,t.ShaderMaterial=w,t.PointsMaterial=kt,t.MultiMaterial=Vt,t.MeshPhysicalMaterial=Wt,t.MeshStandardMaterial=Ht,t.MeshPhongMaterial=jt,t.MeshNormalMaterial=Gt,t.MeshLambertMaterial=Xt,t.MeshDepthMaterial=S,t.MeshBasicMaterial=ut,t.LineDashedMaterial=Yt,t.LineBasicMaterial=Nt,t.MaterialIdCount=b,t.Material=x,t.CompressedTextureLoader=Zt,t.BinaryTextureLoader=Jt,t.DataTextureLoader=Ra,t.CubeTextureLoader=Qt,t.TextureLoader=te,t.ObjectLoader=Ae,t.MaterialLoader=Me,t.BufferGeometryLoader=Te,t.LoadingManager=qt,t.JSONLoader=Ce,t.ImageLoader=Kt,t.FontLoader=We,t.XHRLoader=$t,t.Loader=Ee,t.AudioLoader=Ge,t.SpotLightShadow=se,t.SpotLight=re,
t.PointLight=oe,t.HemisphereLight=ie,t.DirectionalLightShadow=ae,t.DirectionalLight=he,t.AmbientLight=le,t.LightShadow=ne,t.Light=ee,t.StereoCamera=Xe,t.PerspectiveCamera=mt,t.OrthographicCamera=gt,t.CubeCamera=Ye,t.Camera=ft,t.AudioListener=qe,t.PositionalAudio=Ze,t.getAudioContext=je,t.AudioAnalyser=Je,t.Audio=$e,t.VectorKeyframeTrack=me,t.StringKeyframeTrack=xe,t.QuaternionKeyframeTrack=ve,t.NumberKeyframeTrack=ye,t.ColorKeyframeTrack=we,t.BooleanKeyframeTrack=be,t.PropertyMixer=Ke,t.PropertyBinding=Qe,t.KeyframeTrack=_e,t.AnimationObjectGroup=ti,t.AnimationMixer=ii,t.AnimationClip=Se,t.AnimationAction=ei,t.Uniform=ni,t.InstancedBufferGeometry=si,t.BufferGeometry=J,t.DirectGeometry=Z,t.GeometryIdCount=$,t.Geometry=q,t.InterleavedBufferAttribute=ri,t.InstancedInterleavedBuffer=ai,t.InterleavedBuffer=oi,t.InstancedBufferAttribute=hi,t.DynamicBufferAttribute=H,t.Float64Attribute=V,t.Float32Attribute=U,t.Uint32Attribute=F,t.Int32Attribute=B,t.Uint16Attribute=O,t.Int16Attribute=R,t.Uint8ClampedAttribute=z,t.Uint8Attribute=D,t.Int8Attribute=I,t.BufferAttribute=k,t.Face3=W,t.Object3DIdCount=Y,t.Object3D=X,t.Raycaster=li,t.Layers=G,t.EventDispatcher=e,t.Clock=di,t.QuaternionLinearInterpolant=ge,t.LinearInterpolant=de,t.DiscreteInterpolant=pe,t.CubicInterpolant=ue,t.Interpolant=ce,t.Triangle=ct,t.Spline=pi,t.Spherical=fi,t.Plane=C,t.Frustum=A,t.Sphere=T,t.Ray=ht,t.Matrix4=r,t.Matrix3=E,t.Box3=M,t.Box2=l,t.Line3=lt,t.Euler=j,t.Vector4=p,t.Vector3=a,t.Vector2=i,t.Quaternion=o,t.Color=_,t.MorphBlendMesh=mi,t.ImmediateRenderObject=gi,t.WireframeHelper=yi,t.VertexNormalsHelper=xi,t.SpotLightHelper=bi,t.SkeletonHelper=wi,t.PointLightHelper=Si,t.HemisphereLightHelper=Ti,t.GridHelper=Ei,t.FaceNormalsHelper=Ci,t.EdgesHelper=Ni,t.DirectionalLightHelper=Li,t.CameraHelper=Pi,t.BoundingBoxHelper=Ii,t.BoxHelper=Di,t.AxisHelper=Ri,t.WireframeGeometry=vi,t.ParametricGeometry=Oi,t.TetrahedronGeometry=Fi,t.OctahedronGeometry=Ui,t.IcosahedronGeometry=Vi,t.DodecahedronGeometry=Hi,t.PolyhedronGeometry=Bi,t.TubeGeometry=Re,t.TorusKnotGeometry=ji,t.TorusKnotBufferGeometry=Wi,t.TorusGeometry=Xi,t.TorusBufferGeometry=Gi,t.TextGeometry=Yi,t.SphereBufferGeometry=_i,t.SphereGeometry=Mi,t.RingGeometry=$i,t.RingBufferGeometry=qi,t.PlaneBufferGeometry=pt,t.PlaneGeometry=Zi,t.LatheGeometry=Ki,t.LatheBufferGeometry=Ji,t.ShapeGeometry=Be,t.ExtrudeGeometry=Oe,t.EdgesGeometry=Ai;t.ConeGeometry=tn;t.ConeBufferGeometry=en,t.CylinderGeometry=Qi,t.CylinderBufferGeometry=zi,t.CircleBufferGeometry=nn,t.CircleGeometry=sn,t.BoxBufferGeometry=at,t.BoxGeometry=ki,t.ClosedSplineCurve3=rn,t.SplineCurve3=Ua,t.ArcCurve=on,t.EllipseCurve=ke,t.SplineCurve=Ie,t.CubicBezierCurve=De,t.QuadraticBezierCurve=ze,t.LineCurve=Le,t.Shape=Fe,t.ShapePath=Ve,t.Path=Ue,t.Font=He,t.CurvePath=Pe,t.Curve=Ne,t.REVISION=gn,t.MOUSE=vn,t.CullFaceNone=yn,t.CullFaceBack=xn,t.CullFaceFront=bn,t.CullFaceFrontBack=wn,t.FrontFaceDirectionCW=_n,t.FrontFaceDirectionCCW=Sn,t.BasicShadowMap=Mn,t.PCFShadowMap=Tn,t.PCFSoftShadowMap=En,t.FrontSide=Cn,t.BackSide=An,t.DoubleSide=Nn,t.FlatShading=Ln,t.SmoothShading=Pn,t.NoColors=kn,t.FaceColors=In,t.VertexColors=Dn,t.NoBlending=zn,t.NormalBlending=Rn,t.AdditiveBlending=On,t.SubtractiveBlending=Bn,t.MultiplyBlending=Fn,t.CustomBlending=Un,t.AddEquation=Vn,t.SubtractEquation=Hn,t.ReverseSubtractEquation=Wn,t.MinEquation=jn,t.MaxEquation=Gn,t.ZeroFactor=Xn,t.OneFactor=Yn,t.SrcColorFactor=qn,t.OneMinusSrcColorFactor=$n,t.SrcAlphaFactor=Zn,t.OneMinusSrcAlphaFactor=Jn,t.DstAlphaFactor=Kn,t.OneMinusDstAlphaFactor=Qn,t.DstColorFactor=ts,t.OneMinusDstColorFactor=es,t.SrcAlphaSaturateFactor=is,t.NeverDepth=ns,t.AlwaysDepth=ss,t.LessDepth=rs,t.LessEqualDepth=os,t.EqualDepth=as,t.GreaterEqualDepth=hs,t.GreaterDepth=ls,t.NotEqualDepth=cs,t.MultiplyOperation=us,t.MixOperation=ds,t.AddOperation=ps,t.NoToneMapping=fs,t.LinearToneMapping=ms,t.ReinhardToneMapping=gs,t.Uncharted2ToneMapping=vs,t.CineonToneMapping=ys,t.UVMapping=xs,t.CubeReflectionMapping=bs,t.CubeRefractionMapping=ws,t.EquirectangularReflectionMapping=_s,t.EquirectangularRefractionMapping=Ss,t.SphericalReflectionMapping=Ms,t.CubeUVReflectionMapping=Ts,t.CubeUVRefractionMapping=Es,t.RepeatWrapping=Cs,t.ClampToEdgeWrapping=As,t.MirroredRepeatWrapping=Ns,t.NearestFilter=Ls,t.NearestMipMapNearestFilter=Ps,t.NearestMipMapLinearFilter=ks,t.LinearFilter=Is,t.LinearMipMapNearestFilter=Ds,t.LinearMipMapLinearFilter=zs,t.UnsignedByteType=Rs,t.ByteType=Os,t.ShortType=Bs,t.UnsignedShortType=Fs,t.IntType=Us,t.UnsignedIntType=Vs,t.FloatType=Hs,t.HalfFloatType=Ws,t.UnsignedShort4444Type=js,t.UnsignedShort5551Type=Gs,t.UnsignedShort565Type=Xs,t.UnsignedInt248Type=Ys,t.AlphaFormat=qs,t.RGBFormat=$s,t.RGBAFormat=Zs,t.LuminanceFormat=Js,t.LuminanceAlphaFormat=Ks,t.RGBEFormat=Qs,t.DepthFormat=tr,t.DepthStencilFormat=er,t.RGB_S3TC_DXT1_Format=ir,t.RGBA_S3TC_DXT1_Format=nr,t.RGBA_S3TC_DXT3_Format=sr,t.RGBA_S3TC_DXT5_Format=rr,t.RGB_PVRTC_4BPPV1_Format=or,t.RGB_PVRTC_2BPPV1_Format=ar,t.RGBA_PVRTC_4BPPV1_Format=hr,t.RGBA_PVRTC_2BPPV1_Format=lr,t.RGB_ETC1_Format=cr,t.LoopOnce=ur,t.LoopRepeat=dr,t.LoopPingPong=pr,t.InterpolateDiscrete=fr,t.InterpolateLinear=mr,t.InterpolateSmooth=gr,t.ZeroCurvatureEnding=vr,t.ZeroSlopeEnding=yr,t.WrapAroundEnding=xr,t.TrianglesDrawMode=br,t.TriangleStripDrawMode=wr,t.TriangleFanDrawMode=_r,t.LinearEncoding=Sr,t.sRGBEncoding=Mr,t.GammaEncoding=Tr,t.RGBEEncoding=Er,t.LogLuvEncoding=Cr,t.RGBM7Encoding=Ar,t.RGBM16Encoding=Nr,t.RGBDEncoding=Lr,t.BasicDepthPacking=Pr,t.RGBADepthPacking=kr,t.CubeGeometry=ki,t.Face4=an,t.LineStrip=Va,t.LinePieces=Ha,t.MeshFaceMaterial=Vt,t.PointCloud=hn,t.Particle=St,t.ParticleSystem=ln,t.PointCloudMaterial=cn,t.ParticleBasicMaterial=un,t.ParticleSystemMaterial=dn,t.Vertex=pn,t.GeometryUtils=Wa,t.ImageUtils=ja,t.Projector=fn,t.CanvasRenderer=mn,Object.defineProperty(t,"__esModule",{value:!0})}),define("game/v3d",["game/three"],function(t){"use strict";var t,e={};return e.ToRad=Math.PI/180,e.ToDeg=180/Math.PI,e.msePos={x:0,y:0},e.View=function(e,i,n){var s=navigator.userAgent;this.isMobile=!1,(s.match(/Android/i)||s.match(/webOS/i)||s.match(/iPhone/i)||s.match(/iPad/i)||s.match(/iPod/i)||s.match(/BlackBerry/i)||s.match(/Windows Phone/i))&&(this.isMobile=!0);var r=document.getElementById("container");r.style.width="100%",r.style.height="500px",this.w=r.clientWidth,this.h=r.clientHeight,this.id="container",this.init(e,i,n),this.initBasic(),this.sight,this.startRot={issleeping:1,rot:0,camAngle:.05,axis:new t.Vector3}},e.View.prototype={constructor:e.View,init:function(e,i,n){this.clock=new t.Clock,this.renderer=new t.WebGLRenderer({precision:"mediump",antialias:!1}),this.renderer.setSize(this.w,this.h),this.renderer.setClearColor(1908512,1),this.camera=new t.PerspectiveCamera(60,this.w/this.h,.1,1e4),this.camera.useQuarternion=!0,this.camera.position.z=100,this.camera.position.y=0,this.scene=new t.Scene,this.scene.background=new t.Color(0),this.container=document.getElementById(this.id),this.container.appendChild(this.renderer.domElement),this.miniMap=null,this.player=null,this.raycaster=new t.Raycaster,this.camAngle=.01,this.tmpVCPprev1=new t.Vector3(0,0,100),this.tmpVCPprev=new t.Vector3(0,0,100),this.tmppbprev=new t.Vector3(0,0,-100),this.containerMesh,this.proBox,this.camrot=new t.Vector3,this.pbrot=new t.Vector3},initBackground:function(){var i=new t.BufferGeometry;i.fromGeometry(new t.IcosahedronGeometry(1e3,1));var n=new t.Mesh(i,new t.MeshBasicMaterial({map:this.gradTexture([[.75,.6,.4,.25],["#1B1D1E","#3D4143","#72797D","#b0babf"]]),side:t.BackSide,depthWrite:!1,fog:!1}));n.geometry.applyMatrix((new t.Matrix4).makeRotationZ(15*e.ToRad)),this.scene.add(n),this.renderer.autoClear=!1},initLight:function(){if(!this.isMobile){var e=new t.HemisphereLight(16777215,3158064,.3);this.scene.add(e);var i=new t.DirectionalLight(16777215,1.2);i.position.set(.5,1,.5).normalize(),this.scene.add(i)}},initLightShadow:function(){if(!this.isMobile){this.scene.add(new t.AmbientLight(6316128));var e=new t.DirectionalLight(16777215,1);e.position.set(300,1e3,500),e.target.position.set(0,0,0),e.castShadow=!0,e.shadowCameraNear=500,e.shadowCameraFar=1600,e.shadowCameraFov=70,e.shadowBias=1e-4,e.shadowDarkness=.7,e.shadowMapWidth=e.shadowMapHeight=1024,this.scene.add(e)}},initBasic:function(){var i={};i.sph=new t.BufferGeometry,i.box=new t.BufferGeometry,i.cyl=new t.BufferGeometry,i.sph.fromGeometry(new t.SphereGeometry(1,12,10)),i.cyl.fromGeometry(new t.CylinderGeometry(.5,.5,1,12,1)),i.box.fromGeometry(new t.BoxGeometry(1,1,1)),i.plane=new t.PlaneBufferGeometry(1,1,100,100),i.plane.applyMatrix((new t.Matrix4).makeRotationX(-90*e.ToRad));var n={};n.ssph=new t.MeshLambertMaterial({map:this.basicTexture(1),name:"ssph"}),n.box=new t.MeshLambertMaterial({color:6750003,wireframe:!0,name:"box"}),n.transbox=new t.MeshLambertMaterial({color:255,wireframe:!0,name:"transbox",transparent:!0,opacity:0}),n.sbox=new t.MeshLambertMaterial({map:this.basicTexture(3),name:"sbox"}),n.cyl=new t.MeshLambertMaterial({map:this.basicTexture(5),name:"cyl"}),n.scyl=new t.MeshLambertMaterial({map:this.basicTexture(6),name:"scyl"}),n.static=new t.MeshLambertMaterial({map:this.basicTexture(4),name:"static"}),n.static2=new t.MeshLambertMaterial({color:16711680,wireframe:!0,name:"static2"}),n.joint=new t.LineBasicMaterial({color:65280}),this.mats=n,this.geos=i},render:function(){this.startRot.rot&&this.applyRot(),this.raycaster.setFromCamera(e.msePos,this.camera);for(var t=this.raycaster.intersectObjects(this.scene.children),i=0;i<t.length;i++)"proBox"==t[i].object.name&&this.sight.position.copy(t[i].point);this.renderer.render(this.scene,this.camera)},setMesh:function(e){var i={};return i.sph=new t.MeshLambertMaterial({color:e,wireframe:!0,name:"sph"})},add:function(i,n,s,r){var o=i.type||"box",a=i.size||[10,10,10],h=i.pos||[0,0,0],l=i.rot||[0,0,0],c=i.move||!1,u=i.name||"";if(i.flat&&(o="plane",h[1]+=.5*a[1]),"joint"===o.substring(0,5)){var d,p=i.pos1||[0,0,0],f=i.pos2||[0,0,0],m=new t.Geometry;return m.vertices.push(new t.Vector3(p[0],p[1],p[2])),m.vertices.push(new t.Vector3(f[0],f[1],f[2])),d=new t.Line(m,this.mats.joint,t.LinePieces),n?n.add(g):this.scene.add(d),d}var g;return s&&(this.mats.sph=this.setMesh(s)),"box"==o&&c&&(g=new t.Mesh(this.geos.box,this.mats.box,u)),"box"!=o||c||(g=new t.Mesh(this.geos.box,this.mats.static,u)),"transbox"==o&&c&&(g=new t.Mesh(this.geos.box,this.mats.transbox,u)),"plane"!=o||c||(g=new t.Mesh(this.geos.plane,this.mats.static2,u)),"sphere"==o&&c&&(g=new t.Mesh(this.geos.sph,this.mats.sph,u)),"sphere"!=o||c||(g=new t.Mesh(this.geos.sph,this.mats.static,u)),"cylinder"==o&&c&&(g=new t.Mesh(this.geos.cyl,this.mats.cyl,u)),"cylinder"!=o||c||(g=new t.Mesh(this.geos.cyl,this.mats.static,u)),g.scale.set(a[0],a[1],a[2]),g.position.set(h[0],h[1],h[2]),g.rotation.set(l[0]*e.ToRad,l[1]*e.ToRad,l[2]*e.ToRad),n?n.add(g):this.scene.add(g),"sight"==g.name&&(this.sight=g),"containerSphere"==g.name&&(this.containerMesh=g),"proBox"==g.name&&(this.proBox=g),g},moveLink:function(t,e,i){t.geometry.vertices[0].copy(e),t.geometry.vertices[1].copy(i),t.geometry.verticesNeedUpdate=!0},initKeyboard:function(){this.nav.bindKeys()},customShader:function(e){var i=new t.ShaderMaterial({uniforms:e.uniforms,attributes:e.attributes,vertexShader:e.vs,fragmentShader:e.fs});return i},gradTexture:function(e){var i=document.createElement("canvas"),n=i.getContext("2d");i.width=16,i.height=128;for(var s=n.createLinearGradient(0,0,0,128),r=e[0].length;r--;)s.addColorStop(e[0][r],e[1][r]);n.fillStyle=s,n.fillRect(0,0,16,128);var o=new t.Texture(i);return o.needsUpdate=!0,o},basicTexture:function(e,i){var n=document.createElement("canvas");n.width=n.height=64;var s,r=n.getContext("2d");0===e&&(s="#58C3FF"),1===e&&(s="#3580AA"),2===e&&(s="#FFAA58"),3===e&&(s="#AA8038"),4===e&&(s="#1d1f20"),5===e&&(s="#58FFAA"),6===e&&(s="#38AA80"),r.fillStyle=s,r.fillRect(0,0,64,64),r.fillStyle="rgba(0,0,0,0.1);",r.fillRect(0,0,32,32),r.fillRect(32,32,32,32);var o=new t.Texture(n);return o.wrapS=o.wrapT=t.RepeatWrapping,o.repeat=new t.Vector2(i||1,i||1),o.needsUpdate=!0,o},gs_mse_pos:function(t,e){return"get"==t?this.sight.position:(this.sight.position.x=e.x,this.sight.position.y=e.y,this.sight.position.z=e.z,void 0)},getPlayerDir:function(e,i){var n=new t.Vector3;if("forward"==e){var s=this.gs_mse_pos("get");n=n.subVectors(this.gs_mse_pos("get"),i)}else{var s=this.gs_mse_pos("get");this.log("reverse sight pos ",s),n=n.subVectors(i,this.gs_mse_pos("get"))}return n.normalize()},applyRot:function(e){var i=new t.Vector3;i.copy(this.tmpVCPprev),i.applyAxisAngle(this.startRot.axis,this.startRot.camAngle),i.x-=this.tmpVCPprev.x,i.y-=this.tmpVCPprev.y,i.z-=this.tmpVCPprev.z,this.tmpVCPprev.x+=i.x,this.tmpVCPprev.y+=i.y,this.tmpVCPprev.z+=i.z,this.startRot.issleeping?(this.camera.position.x+=i.x,this.camera.position.y+=i.y,this.camera.position.z+=i.z,this.camera.lookAt(this.containerMesh.position)):(this.camrot.x=i.x,this.camrot.y=i.y,this.camrot.z=i.z);var i=new t.Vector3;i.copy(this.tmppbprev),i.applyAxisAngle(this.startRot.axis,this.startRot.camAngle),i.x-=this.tmppbprev.x,i.y-=this.tmppbprev.y,i.z-=this.tmppbprev.z,this.tmppbprev.x+=i.x,this.tmppbprev.y+=i.y,this.tmppbprev.z+=i.z,this.startRot.issleeping?(this.proBox.position.x+=i.x,this.proBox.position.y+=i.y,this.proBox.position.z+=i.z,this.proBox.lookAt(this.containerMesh.position)):(this.pbrot.x=i.x,this.pbrot.y=i.y,this.pbrot.z=i.z)},whcam:function(){var t=this.camera.fov*Math.PI/180,e=2*Math.tan(t/2)*300,i=this.w/this.h,n=e*i;return{h:e,w:n}},log:function(t,e){}},e}),define("game/gameinit",["game/oimo","game/v3d"],function(t,e){"use strict";return function(){var i,n,s,r,o,a,h,l=[],c=0,u=0,d=new e.View,p=2,f=8,m=!1,g=(new t.Vec3(0,0,0),[]),v=0;new t.Vec3(0,0,100),new t.Vec3(0,0,-100),new t.Vec3(0,1,0),d.w/2,d.h/2;h=new t.Vec3(0,0,0);document.getElementById("container");return{createWorld:function(e){i=new t.World(e,p,f,m),i.worldscale(100),i.gravity=new t.Vec3(0,0,0)},oimoLoop:function(){if(!u){i.step();for(var t,e,n=g.length;n--;)if(e=g[n],t=l[n],!e.getSleep()){if(t.position.copy(e.getPosition()),t.quaternion.copy(e.getQuaternion()),"shp1"==e.name){h.copy(s.position),s.position.copy(e.getPosition());var r=s.position.x-h.x,a=s.position.y-h.y,c=s.position.z-h.z;d.camera.position.x+=r,d.camera.position.y+=a,d.camera.position.z+=c,d.startRot.rot&&(d.log("rot started cam","oimoLoop"),d.camera.position.x+=d.camrot.x,d.camera.position.y+=d.camrot.y,d.camera.position.z+=d.camrot.z,d.camera.lookAt(s.position)),o.position.x+=r,o.position.y+=a,o.position.z+=c,d.startRot.rot&&(d.log("rot started","proBox"),o.position.x+=d.pbrot.x,o.position.y+=d.pbrot.y,o.position.z+=d.pbrot.z,o.lookAt(s.position))}"sbox"===t.material.name&&(t.material=d.mats.box),"ssph"===t.material.name&&(t.material=d.mats.sph)}}},populate:function(e){var s;n=new t.Performance(i);var r,a,h,u,p,f,m;r=500,h=-1500,a=100,u=.5,p=.5,f=.5;var y=[{size:[7.5,7.5,7.5],pos:[0,1,0],move:"true",name:"shp1",color:"#66ff33",image:"shp1.jpg"},{size:[2,2,2],pos:[0,0,-100],move:"true",name:"sight",color:"#ff00ff"},{size:[2,2,2],pos:[0,1,0],move:"true",name:"containerSphere",color:"#ff0000"},{size:[500,500,500],pos:[500,10,-5e3],move:"true",name:"planet",color:"#0000ff",image:"planet_1.png"}];this.addSphere(y);var x=d.whcam();o={type:"transbox",size:[x.w,x.h,.5],pos:[0,0,-100],move:!0,world:i,name:"proBox"},l[c]=d.add(o),o=l[c];for(var b=0;b<e;b++){var m=2;2===m&&(s={type:"box",size:[u,p,f],pos:[r,a,h],move:!0,world:i,name:"box1"}),3===m&&(s={type:"cylinder",size:[u,p,u,u,p,u,u,p,u,u,p,u],pos:[r,a,h],rot:[0,0,0,0,45,0,0,22.5,0,0,-22.5,0],move:!0,world:i}),g[v]=new t.Body(s),l[c]=d.add(s),v+=1,c+=1,r=this.randMinMax(-5e3,5e3),a=this.randMinMax(-5e3,5e3),h=this.randMinMax(-5e3,5e3)}},addSphere:function(e){var n;for(var o in e){var h={type:"sphere",size:e[o].size,pos:e[o].pos,move:e[o].move,world:i,name:e[o].name,color:e[o].color,image:e[o].image};if("containerSphere"!=h.name&&"sight"!=h.name&&(g[v]=new t.Body(h),l[c]=d.add(h,n,h.color,h.image),"planet"==h.name&&(a=l[c]),v+=1,c+=1,"shoot"==h.name))return g[v-1];"containerSphere"==h.name&&(s=d.add(h,n,h.color)),"sight"==h.name&&(r=d.add(h,n,h.color))}},getObj:function(t){switch(t){case"bodys":return g;case"containerMesh":return s;case"v3d":return d;case"world":return i}},randMinMax:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},isSleeping:function(t){for(var e=0;e<g.length;e++)if(g[e].name==t)return g[e].getSleep()}}}}),define("game/main",["game/gameinit","game/v3d"],function(t,e){"use strict";return function(){var i,n,s=new t,r=document.getElementById("container"),o=1/60,a={LEFT:37,UP:38,RIGHT:39,BOTTOM:40,ECS:27,SPC:32},h=0;return{init:function(){n=s.getObj("v3d"),this.loadEvents(),s.createWorld(o),s.populate(1e3),n.initLight(),i=this.render,this.render(),setInterval(s.oimoLoop,1e3*o)},render:function(){requestAnimationFrame(i),h||n.render()},handleKeyDown:function(t){t.preventDefault(),t.stopPropagation();var e=s.getObj("bodys"),i=s.getObj("containerMesh"),r=s.getObj("world");switch(t.keyCode){case a.UP:n.log("cam but push: ",n.camera.position);var o=n.getPlayerDir("forward",i.position);o.x*=50,o.y*=50,o.z*=50;var l=e[0].body;l.linearVelocity.addTime(o,r.timeStep),console.log("heading x: "+l.linearVelocity.x+" heading y: "+l.linearVelocity.y+"heading z: "+l.linearVelocity.z);break;case a.BOTTOM:var o=n.getPlayerDir("reverse",i.position);o.x*=50,o.y*=50,o.z*=50;var l=e[0].body;l.linearVelocity.addTime(o,r.timeStep);break;case a.LEFT:break;case a.RIGHT:n.applyRot();break;case a.SPC:var o=n.getPlayerDir("forward",i,sightMesh);o.x*=500,o.y*=500,o.z*=500;var c=i.position,u=[{size:[1.5,1.5,1.5],pos:[c.x,c.y,c.z-1],move:"true",name:"shoot",color:"#66ff33"}],d=addSphere(u);d.body.linearVelocity.addTime(o,r.timeStep);break;case a.ECS:h=1===h?0:1}},handleMouseMove:function(t){var i=n.container.children[0],r=i.getBoundingClientRect(),o=t.clientX-r.left,a=t.clientY-r.top;e.msePos.x=o/n.w*2-1,e.msePos.y=2*-(a/n.h)+1;var h=s.isSleeping("shp1"),l=n.w/100*10,c=n.h/100*10,u=n.w-l,d=l,p=n.h-c,f=c;o>u?(n.startRot.axis.set(0,1,0),n.startRot={issleeping:h,rot:1,camAngle:n.camAngle,axis:n.startRot.axis}):o<d?(n.startRot.axis.set(0,1,0),n.startRot={issleeping:h,rot:1,camAngle:n.camAngle*-1,axis:n.startRot.axis}):a>p?(n.startRot.axis.set(1,0,0),n.startRot={issleeping:h,rot:1,camAngle:n.camAngle,axis:n.startRot.axis}):a<f?(n.startRot.axis.set(1,0,0),n.startRot={issleeping:h,rot:1,camAngle:n.camAngle*-1,axis:n.startRot.axis}):n.startRot={issleeping:h,rot:0,camAngle:n.camAngle,axis:n.startRot.axis}},loadEvents:function(){window.addEventListener("keydown",this.handleKeyDown,!1),window.scrollTo(0,document.body.clientHeight),r.addEventListener("mousemove",this.handleMouseMove,!1)}}}}),function(t){"function"==typeof define&&define.amd?define("jqueryUI",["jquery"],t):t(jQuery)}(function(t){function e(e,n){var s,r,o,a=e.nodeName.toLowerCase();return"area"===a?(s=e.parentNode,r=s.name,!(!e.href||!r||"map"!==s.nodeName.toLowerCase())&&(o=t("img[usemap='#"+r+"']")[0],!!o&&i(o))):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||n:n)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}function n(t){for(var e,i;t.length&&t[0]!==document;){if(e=t.css("position"),("absolute"===e||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}function s(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=r(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&t(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",o)}function o(){t.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&t(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&t(this).addClass("ui-datepicker-next-hover"))}function a(e,i){t.extend(e,i);for(var n in i)null==i[n]&&(e[n]=i[n]);return e}function h(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),n="absolute"===i,s=e?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var e=t(this);return(!n||"static"!==e.css("position"))&&s.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&r.length?r:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,n){return!!t.data(e,n[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var n=t.attr(i,"tabindex"),s=isNaN(n);return(s||n>=0)&&e(i,!s)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,i){function n(e,i,n,r){return t.each(s,function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),r&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var s="Width"===i?["Left","Right"]:["Top","Bottom"],r=i.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?o["inner"+i].call(this):this.each(function(){t(this).css(r,n(this,e)+"px")})},t.fn["outer"+i]=function(e,s){return"number"!=typeof e?o["outer"+i].call(this,e):this.each(function(){t(this).css(r,n(this,e,!0,s)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,n,s=t(this[0]);s.length&&s[0]!==document;){if(i=s.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(n=parseInt(s.css("zIndex"),10),!isNaN(n)&&0!==n))return n;s=s.parent()}return 0}}),t.ui.plugin={add:function(e,i,n){var s,r=t.ui[e].prototype;for(s in n)r.plugins[s]=r.plugins[s]||[],r.plugins[s].push([i,n[s]])},call:function(t,e,i,n){var s,r=t.plugins[e];if(r&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(s=0;s<r.length;s++)t.options[r[s][0]]&&r[s][1].apply(t.element,i)}};var l=0,c=Array.prototype.slice;t.cleanData=function(e){return function(i){var n,s,r;for(r=0;null!=(s=i[r]);r++)try{n=t._data(s,"events"),n&&n.remove&&t(s).triggerHandler("remove")}catch(t){}e(i)}}(t.cleanData),t.widget=function(e,i,n){var s,r,o,a,h={},l=e.split(".")[0];return e=e.split(".")[1],s=l+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][s.toLowerCase()]=function(e){return!!t.data(e,s)},t[l]=t[l]||{},r=t[l][e],o=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},t.extend(o,r,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(n,function(e,n){return t.isFunction(n)?void(h[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},s=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,r=this._superApply;return this._super=t,this._superApply=s,e=n.apply(this,arguments),this._super=i,this._superApply=r,e}}()):void(h[e]=n)}),o.prototype=t.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix||e:e},h,{constructor:o,namespace:l,widgetName:e,widgetFullName:s}),r?(t.each(r._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,o,i._proto)}),delete r._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var i,n,s=c.call(arguments,1),r=0,o=s.length;r<o;r++)for(i in s[r])n=s[r][i],s[r].hasOwnProperty(i)&&void 0!==n&&(t.isPlainObject(n)?e[i]=t.isPlainObject(e[i])?t.widget.extend({},e[i],n):t.widget.extend({},n):e[i]=n);return e},t.widget.bridge=function(e,i){var n=i.prototype.widgetFullName||e;t.fn[e]=function(s){var r="string"==typeof s,o=c.call(arguments,1),a=this;return s=!r&&o.length?t.widget.extend.apply(null,[s].concat(o)):s,r?this.each(function(){var i,r=t.data(this,n);return"instance"===s?(a=r,!1):r?t.isFunction(r[s])&&"_"!==s.charAt(0)?(i=r[s].apply(r,o),i!==r&&void 0!==i?(a=i&&i.jquery?a.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+s+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+s+"'")}):this.each(function(){var e=t.data(this,n);e?(e.option(s||{}),e._init&&e._init()):t.data(this,n,new i(s,this))}),a}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var n,s,r,o=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(o={},n=e.split("."),e=n.shift(),n.length){for(s=o[e]=t.widget.extend({},this.options[e]),r=0;r<n.length-1;r++)s[n[r]]=s[n[r]]||{},s=s[n[r]];if(e=n.pop(),1===arguments.length)return void 0===s[e]?null:s[e];s[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=i}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,n){var s,r=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=s=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),t.each(n,function(n,o){function a(){if(e||r.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof o?r[o]:o).apply(r,arguments)}"string"!=typeof o&&(a.guid=o.guid=o.guid||a.guid||t.guid++);var h=n.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+r.eventNamespace,c=h[2];c?s.delegate(c,l,a):i.bind(l,a)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var s,r,o=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],r=i.originalEvent)for(s in r)s in i||(i[s]=r[s]);return this.element.trigger(i,n),!(t.isFunction(o)&&o.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,s,r){
"string"==typeof s&&(s={effect:s});var o,a=s?s===!0||"number"==typeof s?i:s.effect||i:e;s=s||{},"number"==typeof s&&(s={duration:s}),o=!t.isEmptyObject(s),s.complete=r,s.delay&&n.delay(s.delay),o&&t.effects&&t.effects.effect[a]?n[e](s):a!==e&&n[a]?n[a](s.duration,s.easing,r):n.queue(function(i){t(this)[e](),r&&r.call(n[0]),i()})}});var u=(t.widget,!1);t(document).mouseup(function(){u=!1});t.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){if(!0===t.data(i.target,e.widgetName+".preventClickEvent"))return t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!u){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,n=1===e.which,s=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(n&&!s&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),u=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),u=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});!function(){function e(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function n(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var s,r,o=Math.max,a=Math.abs,h=Math.round,l=/left|center|right/,c=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==s)return s;var e,i,n=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=n.children()[0];return t("body").append(n),e=r.offsetWidth,n.css("overflow","scroll"),i=r.offsetWidth,e===i&&(i=n[0].clientWidth),n.remove(),s=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),s="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,r="scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight;return{width:r?t.position.scrollbarWidth():0,height:s?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]),s=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:s,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n||s?i.width():i.outerWidth(),height:n||s?i.height():i.outerHeight()}}},t.fn.position=function(s){if(!s||!s.of)return f.apply(this,arguments);s=t.extend({},s);var p,m,g,v,y,x,b=t(s.of),w=t.position.getWithinInfo(s.within),_=t.position.getScrollInfo(w),S=(s.collision||"flip").split(" "),M={};return x=n(b),b[0].preventDefault&&(s.at="left top"),m=x.width,g=x.height,v=x.offset,y=t.extend({},v),t.each(["my","at"],function(){var t,e,i=(s[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",t=u.exec(i[0]),e=u.exec(i[1]),M[this]=[t?t[0]:0,e?e[0]:0],s[this]=[d.exec(i[0])[0],d.exec(i[1])[0]]}),1===S.length&&(S[1]=S[0]),"right"===s.at[0]?y.left+=m:"center"===s.at[0]&&(y.left+=m/2),"bottom"===s.at[1]?y.top+=g:"center"===s.at[1]&&(y.top+=g/2),p=e(M.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var n,l,c=t(this),u=c.outerWidth(),d=c.outerHeight(),f=i(this,"marginLeft"),x=i(this,"marginTop"),T=u+f+i(this,"marginRight")+_.width,E=d+x+i(this,"marginBottom")+_.height,C=t.extend({},y),A=e(M.my,c.outerWidth(),c.outerHeight());"right"===s.my[0]?C.left-=u:"center"===s.my[0]&&(C.left-=u/2),"bottom"===s.my[1]?C.top-=d:"center"===s.my[1]&&(C.top-=d/2),C.left+=A[0],C.top+=A[1],r||(C.left=h(C.left),C.top=h(C.top)),n={marginLeft:f,marginTop:x},t.each(["left","top"],function(e,i){t.ui.position[S[e]]&&t.ui.position[S[e]][i](C,{targetWidth:m,targetHeight:g,elemWidth:u,elemHeight:d,collisionPosition:n,collisionWidth:T,collisionHeight:E,offset:[p[0]+A[0],p[1]+A[1]],my:s.my,at:s.at,within:w,elem:c})}),s.using&&(l=function(t){var e=v.left-C.left,i=e+m-u,n=v.top-C.top,r=n+g-d,h={target:{element:b,left:v.left,top:v.top,width:m,height:g},element:{element:c,left:C.left,top:C.top,width:u,height:d},horizontal:i<0?"left":e>0?"right":"center",vertical:r<0?"top":n>0?"bottom":"middle"};m<u&&a(e+i)<m&&(h.horizontal="center"),g<d&&a(n+r)<g&&(h.vertical="middle"),o(a(e),a(i))>o(a(n),a(r))?h.important="horizontal":h.important="vertical",s.using.call(this,t,h)}),c.offset(t.extend(C,{using:l}))})},t.ui.position={fit:{left:function(t,e){var i,n=e.within,s=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,a=t.left-e.collisionPosition.marginLeft,h=s-a,l=a+e.collisionWidth-r-s;e.collisionWidth>r?h>0&&l<=0?(i=t.left+h+e.collisionWidth-r-s,t.left+=h-i):l>0&&h<=0?t.left=s:h>l?t.left=s+r-e.collisionWidth:t.left=s:h>0?t.left+=h:l>0?t.left-=l:t.left=o(t.left-a,t.left)},top:function(t,e){var i,n=e.within,s=n.isWindow?n.scrollTop:n.offset.top,r=e.within.height,a=t.top-e.collisionPosition.marginTop,h=s-a,l=a+e.collisionHeight-r-s;e.collisionHeight>r?h>0&&l<=0?(i=t.top+h+e.collisionHeight-r-s,t.top+=h-i):l>0&&h<=0?t.top=s:h>l?t.top=s+r-e.collisionHeight:t.top=s:h>0?t.top+=h:l>0?t.top-=l:t.top=o(t.top-a,t.top)}},flip:{left:function(t,e){var i,n,s=e.within,r=s.offset.left+s.scrollLeft,o=s.width,h=s.isWindow?s.scrollLeft:s.offset.left,l=t.left-e.collisionPosition.marginLeft,c=l-h,u=l+e.collisionWidth-o-h,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];c<0?(i=t.left+d+p+f+e.collisionWidth-o-r,(i<0||i<a(c))&&(t.left+=d+p+f)):u>0&&(n=t.left-e.collisionPosition.marginLeft+d+p+f-h,(n>0||a(n)<u)&&(t.left+=d+p+f))},top:function(t,e){var i,n,s=e.within,r=s.offset.top+s.scrollTop,o=s.height,h=s.isWindow?s.scrollTop:s.offset.top,l=t.top-e.collisionPosition.marginTop,c=l-h,u=l+e.collisionHeight-o-h,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,m=-2*e.offset[1];c<0?(n=t.top+p+f+m+e.collisionHeight-o-r,t.top+p+f+m>c&&(n<0||n<a(c))&&(t.top+=p+f+m)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+m-h,t.top+p+f+m>u&&(i>0||a(i)<u)&&(t.top+=p+f+m))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,n,s,o,a=document.getElementsByTagName("body")[0],h=document.createElement("div");e=document.createElement(a?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in n)e.style[o]=n[o];e.appendChild(h),i=a||document.documentElement,i.insertBefore(e,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",s=t(h).offset().left,r=s>10&&s<11,e.innerHTML="",i.removeChild(e)}()}();t.ui.position,t.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),e.active<0&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void("disabled"===t&&(this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e))))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,n=this.headers.length,s=this.headers.index(e.target),r=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:r=this.headers[(s+1)%n];break;case i.LEFT:case i.UP:r=this.headers[(s-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:r=this.headers[0];break;case i.END:r=this.headers[n-1]}r&&(t(e.target).attr("tabIndex",-1),t(r).attr("tabIndex",0),r.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=t()):e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var e,i=this.options,n=i.heightStyle,s=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var e=t(this),i=e.uniqueId().attr("id"),n=e.next(),s=n.uniqueId().attr("id");e.attr("aria-controls",s),n.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===n?(e=s.height(),this.element.siblings(":visible").each(function(){var i=t(this),n=i.css("position");"absolute"!==n&&"fixed"!==n&&(e-=i.outerHeight(!0))}),this.headers.each(function(){e-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===n&&(e=0,this.headers.next().each(function(){e=Math.max(e,t(this).css("height","").height())}).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,n=this.active,s=t(e.currentTarget),r=s[0]===n[0],o=r&&i.collapsible,a=o?t():s.next(),h=n.next(),l={oldHeader:n,oldPanel:h,newHeader:o?t():s,newPanel:a};e.preventDefault(),r&&!i.collapsible||this._trigger("beforeActivate",e,l)===!1||(i.active=!o&&this.headers.index(s),this.active=r?t():s,this._toggle(l),n.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),r||(s.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),s.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,n=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,e):(n.hide(),i.show(),this._toggleComplete(e)),n.attr({"aria-hidden":"true"}),n.prev().attr("aria-selected","false"),i.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(t,e,i){var n,s,r,o=this,a=0,h=t.length&&(!e.length||t.index()<e.index()),l=this.options.animate||{},c=h&&l.down||l,u=function(){o._toggleComplete(i)};return"number"==typeof c&&(r=c),"string"==typeof c&&(s=c),s=s||c.easing||l.easing,r=r||c.duration||l.duration,e.length?t.length?(n=t.show().outerHeight(),e.animate(this.hideProps,{duration:r,easing:s,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:r,easing:s,complete:u,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?a+=i.now:"content"!==o.options.heightStyle&&(i.now=Math.round(n-e.outerHeight()-a),a=0)}})):e.animate(this.hideProps,r,s,u):t.animate(this.showProps,r,s,u)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&t(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){var i,n,s,r,o=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:o=!1,n=this.previousFilter||"",s=String.fromCharCode(e.keyCode),r=!1,clearTimeout(this.filterTimer),s===n?r=!0:s=n+s,i=this._filterMenuItems(s),i=r&&i.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):i,i.length||(s=String.fromCharCode(e.keyCode),i=this._filterMenuItems(s)),i.length?(this.focus(e,i),this.previousFilter=s,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(t):this.select(t))},refresh:function(){var e,i,n=this,s=this.options.icons.submenu,r=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),i=e.parent(),n=t("<span>").addClass("ui-menu-icon ui-icon "+s).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(n),e.attr("aria-labelledby",i.attr("id"))}),e=r.add(this.element),i=e.find(this.options.items),i.not(".ui-menu-item").each(function(){var e=t(this);n._isDivider(e)&&e.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},focus:function(t,e){var i,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,n,s,r,o,a;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,s=e.offset().top-this.activeMenu.offset().top-i-n,r=this.activeMenu.scrollTop(),o=this.activeMenu.height(),a=e.outerHeight(),s<0?this.activeMenu.scrollTop(r+s):s+a>o&&this.activeMenu.scrollTop(r+s-o+a))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(e),this.activeMenu=n},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[e]()),this.focus(i,n)},nextPage:function(e){var i,n,s;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,s=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-n-s<0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var i,n,s;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,s=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-n+s>0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),n=new RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return n.test(t.trim(t(this).text()))})}});t.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,n,s=this.element[0].nodeName.toLowerCase(),r="textarea"===s,o="input"===s;this.isMultiLine=!!r||!o&&this.element.prop("isContentEditable"),this.valueMethod=this.element[r||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(s){if(this.element.prop("readOnly"))return e=!0,n=!0,void(i=!0);e=!1,n=!1,i=!1;var r=t.ui.keyCode;switch(s.keyCode){case r.PAGE_UP:e=!0,this._move("previousPage",s);break;case r.PAGE_DOWN:e=!0,this._move("nextPage",s);break;case r.UP:e=!0,this._keyEvent("previous",s);break;case r.DOWN:e=!0,this._keyEvent("next",s);break;case r.ENTER:this.menu.active&&(e=!0,s.preventDefault(),this.menu.select(s));break;case r.TAB:this.menu.active&&this.menu.select(s);break;case r.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(s),s.preventDefault());break;default:i=!0,this._searchTimeout(s)}},keypress:function(n){if(e)return e=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||n.preventDefault());if(!i){var s=t.ui.keyCode;switch(n.keyCode){case s.PAGE_UP:this._move("previousPage",n);break;case s.PAGE_DOWN:this._move("nextPage",n);break;case s.UP:this._keyEvent("previous",n);break;case s.DOWN:this._keyEvent("next",n)}}},input:function(t){return n?(n=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(n){n.target===e.element[0]||n.target===i||t.contains(i,n.target)||e.close()})})},menufocus:function(e,i){var n,s;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)})):(s=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:s})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(s.value),n=i.item.attr("aria-label")||s.value,void(n&&t.trim(n).length&&(this.liveRegion.children().hide(),t("<div>").text(n).appendTo(this.liveRegion))))},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,n=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,n){n(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,s){n.xhr&&n.xhr.abort(),n.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){s(t)},error:function(){s([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),n=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;e&&(!e||i||n)||(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){
e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var n=this;t.each(i,function(t,i){n._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").text(i.label).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var n=new RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return n.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}});var d,p=(t.ui.autocomplete,"ui-button ui-widget ui-state-default ui-corner-all"),f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var e=t(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},g=function(e){var i=e.name,n=e.form,s=t([]);return i&&(i=i.replace(/'/g,"\\'"),s=n?t(n).find("[name='"+i+"'][type=radio]"):t("[name='"+i+"'][type=radio]",e.ownerDocument).filter(function(){return!this.form})),s};t.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,i=this.options,n="checkbox"===this.type||"radio"===this.type,s=n?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===d&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||t(this).removeClass(s)}).bind("click"+this.eventNamespace,function(t){i.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),n&&this.element.bind("change"+this.eventNamespace,function(){e.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;t(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var n=e.element[0];g(n).not(n).map(function(){return t(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!i.disabled&&(t(this).addClass("ui-state-active"),d=this,void e.document.one("mouseup",function(){d=null}))}).bind("mouseup"+this.eventNamespace,function(){return!i.disabled&&void t(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return!i.disabled&&void(e.keyCode!==t.ui.keyCode.SPACE&&e.keyCode!==t.ui.keyCode.ENTER||t(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){t(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),void(e&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?g(this.element[0]).each(function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var e=this.buttonElement.removeClass(f),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),n=this.options.icons,s=n.primary&&n.secondary,r=[];n.primary||n.secondary?(this.options.text&&r.push("ui-button-text-icon"+(s?"s":n.primary?"-primary":"-secondary")),n.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+n.primary+"'></span>"),n.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+n.secondary+"'></span>"),this.options.text||(r.push(s?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):r.push("ui-button-text-only"),e.addClass(r.join(" "))}}),t.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),n=i.filter(":ui-button");i.not(":ui-button").button(),n.button("refresh"),this.buttons=i.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}});t.ui.button;t.extend(t.ui,{datepicker:{version:"1.11.2"}});var v;t.extend(s.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return a(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var n,s,r;n=e.nodeName.toLowerCase(),s="div"===n||"span"===n,e.id||(this.uuid+=1,e.id="dp"+this.uuid),r=this._newInst(t(e),s),r.settings=t.extend({},i||{}),"input"===n?this._connectDatepicker(e,r):s&&this._inlineDatepicker(e,r)},_newInst:function(e,i){var n=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?r(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var n=t(e);i.append=t([]),i.trigger=t([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var n,s,r,o=this._get(i,"appendText"),a=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=t("<span class='"+this._appendClass+"'>"+o+"</span>"),e[a?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),n=this._get(i,"showOn"),"focus"!==n&&"both"!==n||e.focus(this._showDatepicker),"button"!==n&&"both"!==n||(s=this._get(i,"buttonText"),r=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:r,alt:s,title:s}):t("<button type='button'></button>").addClass(this._triggerClass).html(r?t("<img/>").attr({src:r,alt:s,title:s}):s)),e[a?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,s,r=new Date(2009,11,20),o=this._get(t,"dateFormat");o.match(/[DM]/)&&(e=function(t){for(i=0,n=0,s=0;s<t.length;s++)t[s].length>i&&(i=t[s].length,n=s);return n},r.setMonth(e(this._get(t,o.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(e(this._get(t,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),t.input.attr("size",this._formatDate(t,r).length)}},_inlineDatepicker:function(e,i){var n=t(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,n,s,r){var o,h,l,c,u,d=this._dialogInst;return d||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},t.data(this._dialogInput[0],"datepicker",d)),a(d.settings,s||{}),i=i&&i.constructor===Date?this._formatDate(d,i):i,this._dialogInput.val(i),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+c,l/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(e){var i,n=t(e),s=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(s.append.remove(),s.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==i&&"span"!==i||n.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var i,n,s=t(e),r=t.data(e,"datepicker");s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,r.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==i&&"span"!==i||(n=s.children("."+this._inlineClass),n.children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,n,s=t(e),r=t.data(e,"datepicker");s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,r.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==i&&"span"!==i||(n=s.children("."+this._inlineClass),n.children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,n){var s,r,o,h,l=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):l?"all"===i?t.extend({},l.settings):this._get(l,i):null:(s=i||{},"string"==typeof i&&(s={},s[i]=n),void(l&&(this._curInst===l&&this._hideDatepicker(),r=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),a(l.settings,s),null!==o&&void 0!==s.dateFormat&&void 0===s.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==s.dateFormat&&void 0===s.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in s&&(s.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),l),this._autoSize(l),this._setDate(l,r),this._updateAlternate(l),this._updateDatepicker(l))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,n,s,r=t.datepicker._getInst(e.target),o=!0,a=r.dpDiv.is(".ui-datepicker-rtl");if(r._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),o=!1;break;case 13:return s=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",r.dpDiv),s[0]&&t.datepicker._selectDay(e.target,r.selectedMonth,r.selectedYear,s[0]),i=t.datepicker._get(r,"onSelect"),i?(n=t.datepicker._formatDate(r),i.apply(r.input?r.input[0]:null,[n,r])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(r,"stepBigMonths"):-t.datepicker._get(r,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(r,"stepBigMonths"):+t.datepicker._get(r,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),o=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),o=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?1:-1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(r,"stepBigMonths"):-t.datepicker._get(r,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),o=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?-1:1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(r,"stepBigMonths"):+t.datepicker._get(r,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),o=e.ctrlKey||e.metaKey;break;default:o=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):o=!1;o&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,n,s=t.datepicker._getInst(e.target);if(t.datepicker._get(s,"constrainInput"))return i=t.datepicker._possibleChars(t.datepicker._get(s,"dateFormat")),n=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||n<" "||!i||i.indexOf(n)>-1},_doKeyUp:function(e){var i,n=t.datepicker._getInst(e.target);if(n.input.val()!==n.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,t.datepicker._getFormatConfig(n)),i&&(t.datepicker._setDateFromField(n),t.datepicker._updateAlternate(n),t.datepicker._updateDatepicker(n))}catch(t){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,s,r,o,h,l,c;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),s=t.datepicker._get(i,"beforeShow"),r=s?s.apply(e,[e,i]):{},r!==!1&&(a(i.settings,r),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),o=!1,t(e).parents().each(function(){return o|="fixed"===t(this).css("position"),!o}),h={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),h=t.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":o?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=t.datepicker._get(i,"showAnim"),c=t.datepicker._get(i,"duration"),i.dpDiv.css("z-index",n(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?i.dpDiv.show(l,t.datepicker._get(i,"showOptions"),c):i.dpDiv[l||"show"](l?c:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,v=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,n=this._getNumberOfMonths(e),s=n[1],r=17,a=e.dpDiv.find("."+this._dayOverClass+" a");a.length>0&&o.apply(a.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&e.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",r*s+"em"),e.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,n){var s=e.dpDiv.outerWidth(),r=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,a=e.input?e.input.outerHeight():0,h=document.documentElement.clientWidth+(n?0:t(document).scrollLeft()),l=document.documentElement.clientHeight+(n?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?s-o:0,i.left-=n&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=n&&i.top===e.input.offset().top+a?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+s>h&&h>s?Math.abs(i.left+s-h):0),i.top-=Math.min(i.top,i.top+r>l&&l>r?Math.abs(r+a):0),i},_findPos:function(e){for(var i,n=this._getInst(e),s=this._get(n,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[s?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,n,s,r,o=this._curInst;!o||e&&o!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),n=this._get(o,"duration"),s=function(){t.datepicker._tidyDialog(o)},t.effects&&(t.effects.effect[i]||t.effects[i])?o.dpDiv.hide(i,t.datepicker._get(o,"showOptions"),n,s):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,s),i||s(),this._datepickerShowing=!1,r=this._get(o,"onClose"),r&&r.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),n=t.datepicker._getInst(i[0]);(i[0].id===t.datepicker._mainDivId||0!==i.parents("#"+t.datepicker._mainDivId).length||i.hasClass(t.datepicker.markerClassName)||i.closest("."+t.datepicker._triggerClass).length||!t.datepicker._datepickerShowing||t.datepicker._inDialog&&t.blockUI)&&(!i.hasClass(t.datepicker.markerClassName)||t.datepicker._curInst===n)||t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,n){var s=t(e),r=this._getInst(s[0]);this._isDisabledDatepicker(s[0])||(this._adjustInstDate(r,i+("M"===n?this._get(r,"showCurrentAtPos"):0),n),this._updateDatepicker(r))},_gotoToday:function(e){var i,n=t(e),s=this._getInst(n[0]);this._get(s,"gotoCurrent")&&s.currentDay?(s.selectedDay=s.currentDay,s.drawMonth=s.selectedMonth=s.currentMonth,s.drawYear=s.selectedYear=s.currentYear):(i=new Date,s.selectedDay=i.getDate(),s.drawMonth=s.selectedMonth=i.getMonth(),s.drawYear=s.selectedYear=i.getFullYear()),this._notifyChange(s),this._adjustDate(n)},_selectMonthYear:function(e,i,n){var s=t(e),r=this._getInst(s[0]);r["selected"+("M"===n?"Month":"Year")]=r["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(r),this._adjustDate(s)},_selectDay:function(e,i,n,s){var r,o=t(e);t(s).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(r=this._getInst(o[0]),r.selectedDay=r.currentDay=t("a",s).html(),r.selectedMonth=r.currentMonth=i,r.selectedYear=r.currentYear=n,this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var n,s=t(e),r=this._getInst(s[0]);i=null!=i?i:this._formatDate(r),r.input&&r.input.val(i),this._updateAlternate(r),n=this._get(r,"onSelect"),n?n.apply(r.input?r.input[0]:null,[i,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],"object"!=typeof r.input[0]&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,n,s,r=this._get(e,"altField");r&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),s=this.formatDate(i,n,this._getFormatConfig(e)),t(r).each(function(){t(this).val(s)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&e<6,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,n){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var s,r,o,a,h=0,l=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),u=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,d=(n?n.dayNames:null)||this._defaults.dayNames,p=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,x=!1,b=function(t){var i=s+1<e.length&&e.charAt(s+1)===t;return i&&s++,i},w=function(t){var e=b(t),n="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,s="y"===t?n:1,r=new RegExp("^\\d{"+s+","+n+"}"),o=i.substring(h).match(r);if(!o)throw"Missing number at position "+h;return h+=o[0].length,parseInt(o[0],10)},_=function(e,n,s){var r=-1,o=t.map(b(e)?s:n,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(o,function(t,e){var n=e[1];if(i.substr(h,n.length).toLowerCase()===n.toLowerCase())return r=e[0],h+=n.length,!1}),r!==-1)return r+1;throw"Unknown name at position "+h},S=function(){if(i.charAt(h)!==e.charAt(s))throw"Unexpected literal at position "+h;h++};for(s=0;s<e.length;s++)if(x)"'"!==e.charAt(s)||b("'")?S():x=!1;else switch(e.charAt(s)){case"d":v=w("d");break;case"D":_("D",u,d);break;case"o":y=w("o");break;case"m":g=w("m");break;case"M":g=_("M",p,f);break;case"y":m=w("y");break;case"@":a=new Date(w("@")),m=a.getFullYear(),g=a.getMonth()+1,v=a.getDate();break;case"!":a=new Date((w("!")-this._ticksTo1970)/1e4),m=a.getFullYear(),g=a.getMonth()+1,v=a.getDate();break;case"'":b("'")?S():x=!0;break;default:S()}if(h<i.length&&(o=i.substr(h),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(m===-1?m=(new Date).getFullYear():m<100&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(m<=c?0:-100)),y>-1)for(g=1,v=y;;){if(r=this._getDaysInMonth(m,g-1),v<=r)break;g++,v-=r}if(a=this._daylightSavingAdjust(new Date(m,g-1,v)),a.getFullYear()!==m||a.getMonth()+1!==g||a.getDate()!==v)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(t,e,i){if(!e)return"";var n,s=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,r=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,h=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},l=function(t,e,i){var n=""+e;if(h(t))for(;n.length<i;)n="0"+n;return n},c=function(t,e,i,n){return h(t)?n[e]:i[e]},u="",d=!1;if(e)for(n=0;n<t.length;n++)if(d)"'"!==t.charAt(n)||h("'")?u+=t.charAt(n):d=!1;else switch(t.charAt(n)){case"d":u+=l("d",e.getDate(),2);break;case"D":u+=c("D",e.getDay(),s,r);break;case"o":u+=l("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=l("m",e.getMonth()+1,2);break;case"M":u+=c("M",e.getMonth(),o,a);break;case"y":u+=h("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":h("'")?u+="'":d=!0;break;default:u+=t.charAt(n)}return u},_possibleChars:function(t){var e,i="",n=!1,s=function(i){var n=e+1<t.length&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;e<t.length;e++)if(n)"'"!==t.charAt(e)||s("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":s("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,s=this._getDefaultDate(t),r=s,o=this._getFormatConfig(t);try{r=this.parseDate(i,n,o)||s}catch(t){n=e?"":n}t.selectedDay=r.getDate(),t.drawMonth=t.selectedMonth=r.getMonth(),t.drawYear=t.selectedYear=r.getFullYear(),t.currentDay=n?r.getDate():0,t.currentMonth=n?r.getMonth():0,t.currentYear=n?r.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,n){var s=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},r=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(t){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,s=n.getFullYear(),r=n.getMonth(),o=n.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,h=a.exec(i);h;){switch(h[2]||"d"){case"d":case"D":o+=parseInt(h[1],10);break;case"w":case"W":o+=7*parseInt(h[1],10);break;case"m":case"M":r+=parseInt(h[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(s,r));break;case"y":case"Y":s+=parseInt(h[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(s,r))}h=a.exec(i)}return new Date(s,r,o)},o=null==i||""===i?n:"string"==typeof i?r(i):"number"==typeof i?isNaN(i)?n:s(i):new Date(i.getTime());return o=o&&"Invalid Date"===o.toString()?n:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,s=t.selectedMonth,r=t.selectedYear,o=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=o.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=o.getMonth(),t.drawYear=t.selectedYear=t.currentYear=o.getFullYear(),s===t.selectedMonth&&r===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){
var i=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(n,-i,"M")},next:function(){t.datepicker._adjustDate(n,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(n)},selectDay:function(){return t.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(n,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,s,r,o,a,h,l,c,u,d,p,f,m,g,v,y,x,b,w,_,S,M,T,E,C,A,N,L,P,k,I,D,z,R,O,B,F,U=new Date,V=this._daylightSavingAdjust(new Date(U.getFullYear(),U.getMonth(),U.getDate())),H=this._get(t,"isRTL"),W=this._get(t,"showButtonPanel"),j=this._get(t,"hideIfNoPrevNext"),G=this._get(t,"navigationAsDateFormat"),X=this._getNumberOfMonths(t),Y=this._get(t,"showCurrentAtPos"),q=this._get(t,"stepMonths"),$=1!==X[0]||1!==X[1],Z=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),J=this._getMinMaxDate(t,"min"),K=this._getMinMaxDate(t,"max"),Q=t.drawMonth-Y,tt=t.drawYear;if(Q<0&&(Q+=12,tt--),K)for(e=this._daylightSavingAdjust(new Date(K.getFullYear(),K.getMonth()-X[0]*X[1]+1,K.getDate())),e=J&&e<J?J:e;this._daylightSavingAdjust(new Date(tt,Q,1))>e;)Q--,Q<0&&(Q=11,tt--);for(t.drawMonth=Q,t.drawYear=tt,i=this._get(t,"prevText"),i=G?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,Q-q,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+i+"</span></a>":j?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+i+"</span></a>",s=this._get(t,"nextText"),s=G?this.formatDate(s,this._daylightSavingAdjust(new Date(tt,Q+q,1)),this._getFormatConfig(t)):s,r=this._canAdjustMonth(t,1,tt,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+s+"</span></a>":j?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+s+"</span></a>",o=this._get(t,"currentText"),a=this._get(t,"gotoCurrent")&&t.currentDay?Z:V,o=G?this.formatDate(o,a,this._getFormatConfig(t)):o,h=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",l=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(H?h:"")+(this._isInRange(t,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(H?"":h)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),y=this._get(t,"selectOtherMonths"),x=this._getDefaultDate(t),b="",_=0;_<X[0];_++){for(S="",this.maxRows=4,M=0;M<X[1];M++){if(T=this._daylightSavingAdjust(new Date(tt,Q,t.selectedDay)),E=" ui-corner-all",C="",$){if(C+="<div class='ui-datepicker-group",X[1]>1)switch(M){case 0:C+=" ui-datepicker-group-first",E=" ui-corner-"+(H?"right":"left");break;case X[1]-1:C+=" ui-datepicker-group-last",E=" ui-corner-"+(H?"left":"right");break;default:C+=" ui-datepicker-group-middle",E=""}C+="'>"}for(C+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+E+"'>"+(/all|left/.test(E)&&0===_?H?r:n:"")+(/all|right/.test(E)&&0===_?H?n:r:"")+this._generateMonthYearHeader(t,Q,tt,J,K,_>0||M>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",A=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;w<7;w++)N=(w+c)%7,A+="<th scope='col'"+((w+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+d[N]+"'>"+p[N]+"</span></th>";for(C+=A+"</tr></thead><tbody>",L=this._getDaysInMonth(tt,Q),tt===t.selectedYear&&Q===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,L)),P=(this._getFirstDayOfMonth(tt,Q)-c+7)%7,k=Math.ceil((P+L)/7),I=$&&this.maxRows>k?this.maxRows:k,this.maxRows=I,D=this._daylightSavingAdjust(new Date(tt,Q,1-P)),z=0;z<I;z++){for(C+="<tr>",R=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(D)+"</td>":"",w=0;w<7;w++)O=g?g.apply(t.input?t.input[0]:null,[D]):[!0,""],B=D.getMonth()!==Q,F=B&&!y||!O[0]||J&&D<J||K&&D>K,R+="<td class='"+((w+c+6)%7>=5?" ui-datepicker-week-end":"")+(B?" ui-datepicker-other-month":"")+(D.getTime()===T.getTime()&&Q===t.selectedMonth&&t._keyEvent||x.getTime()===D.getTime()&&x.getTime()===T.getTime()?" "+this._dayOverClass:"")+(F?" "+this._unselectableClass+" ui-state-disabled":"")+(B&&!v?"":" "+O[1]+(D.getTime()===Z.getTime()?" "+this._currentClass:"")+(D.getTime()===V.getTime()?" ui-datepicker-today":""))+"'"+(B&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(F?"":" data-handler='selectDay' data-event='click' data-month='"+D.getMonth()+"' data-year='"+D.getFullYear()+"'")+">"+(B&&!v?"&#xa0;":F?"<span class='ui-state-default'>"+D.getDate()+"</span>":"<a class='ui-state-default"+(D.getTime()===V.getTime()?" ui-state-highlight":"")+(D.getTime()===Z.getTime()?" ui-state-active":"")+(B?" ui-priority-secondary":"")+"' href='#'>"+D.getDate()+"</a>")+"</td>",D.setDate(D.getDate()+1),D=this._daylightSavingAdjust(D);C+=R+"</tr>"}Q++,Q>11&&(Q=0,tt++),C+="</tbody></table>"+($?"</div>"+(X[0]>0&&M===X[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),S+=C}b+=S}return b+=l,t._keyEvent=!1,b},_generateMonthYearHeader:function(t,e,i,n,s,r,o,a){var h,l,c,u,d,p,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),y=this._get(t,"showMonthAfterYear"),x="<div class='ui-datepicker-title'>",b="";if(r||!g)b+="<span class='ui-datepicker-month'>"+o[e]+"</span>";else{for(h=n&&n.getFullYear()===i,l=s&&s.getFullYear()===i,b+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;c<12;c++)(!h||c>=n.getMonth())&&(!l||c<=s.getMonth())&&(b+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+a[c]+"</option>");b+="</select>"}if(y||(x+=b+(!r&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",r||!v)x+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(u[0]),m=Math.max(f,p(u[1]||"")),f=n?Math.max(f,n.getFullYear()):f,m=s?Math.min(m,s.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";f<=m;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",x+=t.yearshtml,t.yearshtml=null}return x+=this._get(t,"yearSuffix"),y&&(x+=(!r&&g&&v?"":"&#xa0;")+b),x+="</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),s=t.drawMonth+("M"===i?e:0),r=Math.min(t.selectedDay,this._getDaysInMonth(n,s))+("D"===i?e:0),o=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,s,r)));t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),"M"!==i&&"Y"!==i||this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),s=i&&e<i?i:e;return n&&s>n?n:s},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var s=this._getNumberOfMonths(t),r=this._daylightSavingAdjust(new Date(i,n+(e<0?e:s[0]*s[1]),1));return e<0&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(t,r)},_isInRange:function(t,e){var i,n,s=this._getMinMaxDate(t,"min"),r=this._getMinMaxDate(t,"max"),o=null,a=null,h=this._get(t,"yearRange");return h&&(i=h.split(":"),n=(new Date).getFullYear(),o=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=n),i[1].match(/[+\-].*/)&&(a+=n)),(!s||e.getTime()>=s.getTime())&&(!r||e.getTime()<=r.getTime())&&(!o||e.getFullYear()>=o)&&(!a||e.getFullYear()<=a)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var s=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),s,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new s,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.11.2";t.datepicker;t.widget("ui.draggable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),!(this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(t){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",e,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper),s=n?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n&&s[0]===this.element[0]&&this._setPositionRelative(),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,s=this.options,r=this.document[0];return this.relativeContainer=null,s.containment?"window"===s.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===s.containment?void(this.containment=[0,0,t(r).width()-this.helperProportions.width-this.margins.left,(t(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):s.containment.constructor===Array?void(this.containment=s.containment):("parent"===s.containment&&(s.containment=this.helper[0].parentNode),i=t(s.containment),n=i[0],void(n&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,n,s,r,o=this.options,a=this._isRootNode(this.scrollParent[0]),h=t.pageX,l=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(s=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?s-this.offset.click.top>=i[1]||s-this.offset.click.top>i[3]?s:s-this.offset.click.top>=i[1]?s-o.grid[1]:s+o.grid[1]:s,r=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?r-this.offset.click.left>=i[0]||r-this.offset.click.left>i[2]?r:r-this.offset.click.left>=i[0]?r-o.grid[0]:r+o.grid[0]:r),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,n){var s=t.extend({},i,{item:n.element});n.sortables=[],t(n.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,s))})},stop:function(e,i,n){var s=t.extend({},i,{item:n.element});n.cancelHelperRemoval=!1,t.each(n.sortables,function(){var t=this;t.isOver?(t.isOver=0,n.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,s))})},drag:function(e,i,n){t.each(n.sortables,function(){var s=!1,r=this;r.positionAbs=n.positionAbs,r.helperProportions=n.helperProportions,r.offset.click=n.offset.click,r._intersectsWith(r.containerCache)&&(s=!0,t.each(n.sortables,function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==r&&this._intersectsWith(this.containerCache)&&t.contains(r.element[0],this.element[0])&&(s=!1),s})),s?(r.isOver||(r.isOver=1,r.currentItem=i.helper.appendTo(r.element).data("ui-sortable-item",!0),r.options._helper=r.options.helper,r.options.helper=function(){return i.helper[0]},e.target=r.currentItem[0],r._mouseCapture(e,!0),r._mouseStart(e,!0,!0),r.offset.click.top=n.offset.click.top,r.offset.click.left=n.offset.click.left,r.offset.parent.left-=n.offset.parent.left-r.offset.parent.left,r.offset.parent.top-=n.offset.parent.top-r.offset.parent.top,n._trigger("toSortable",e),n.dropped=r.element,t.each(n.sortables,function(){this.refreshPositions()}),n.currentItem=n.element,r.fromOutside=n),r.currentItem&&(r._mouseDrag(e),i.position=r.position)):r.isOver&&(r.isOver=0,r.cancelHelperRemoval=!0,r.options._revert=r.options.revert,r.options.revert=!1,r._trigger("out",e,r._uiHash(r)),r._mouseStop(e,!0),r.options.revert=r.options._revert,r.options.helper=r.options._helper,r.placeholder&&r.placeholder.remove(),n._refreshOffsets(e),i.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,t.each(n.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,n){var s=t("body"),r=n.options;s.css("cursor")&&(r._cursor=s.css("cursor")),s.css("cursor",r.cursor)},stop:function(e,i,n){var s=n.options;s._cursor&&t("body").css("cursor",s._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,n){var s=t(i.helper),r=n.options;s.css("opacity")&&(r._opacity=s.css("opacity")),s.css("opacity",r.opacity)},stop:function(e,i,n){var s=n.options;s._opacity&&t(i.helper).css("opacity",s._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,n){var s=n.options,r=!1,o=n.scrollParentNotHidden[0],a=n.document[0];o!==a&&"HTML"!==o.tagName?(s.axis&&"x"===s.axis||(n.overflowOffset.top+o.offsetHeight-e.pageY<s.scrollSensitivity?o.scrollTop=r=o.scrollTop+s.scrollSpeed:e.pageY-n.overflowOffset.top<s.scrollSensitivity&&(o.scrollTop=r=o.scrollTop-s.scrollSpeed)),s.axis&&"y"===s.axis||(n.overflowOffset.left+o.offsetWidth-e.pageX<s.scrollSensitivity?o.scrollLeft=r=o.scrollLeft+s.scrollSpeed:e.pageX-n.overflowOffset.left<s.scrollSensitivity&&(o.scrollLeft=r=o.scrollLeft-s.scrollSpeed))):(s.axis&&"x"===s.axis||(e.pageY-t(a).scrollTop()<s.scrollSensitivity?r=t(a).scrollTop(t(a).scrollTop()-s.scrollSpeed):t(window).height()-(e.pageY-t(a).scrollTop())<s.scrollSensitivity&&(r=t(a).scrollTop(t(a).scrollTop()+s.scrollSpeed))),s.axis&&"y"===s.axis||(e.pageX-t(a).scrollLeft()<s.scrollSensitivity?r=t(a).scrollLeft(t(a).scrollLeft()-s.scrollSpeed):t(window).width()-(e.pageX-t(a).scrollLeft())<s.scrollSensitivity&&(r=t(a).scrollLeft(t(a).scrollLeft()+s.scrollSpeed)))),r!==!1&&t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(n,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,n){var s=n.options;n.snapElements=[],t(s.snap.constructor!==String?s.snap.items||":data(ui-draggable)":s.snap).each(function(){var e=t(this),i=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,n){var s,r,o,a,h,l,c,u,d,p,f=n.options,m=f.snapTolerance,g=i.offset.left,v=g+n.helperProportions.width,y=i.offset.top,x=y+n.helperProportions.height;for(d=n.snapElements.length-1;d>=0;d--)h=n.snapElements[d].left-n.margins.left,l=h+n.snapElements[d].width,c=n.snapElements[d].top-n.margins.top,u=c+n.snapElements[d].height,v<h-m||g>l+m||x<c-m||y>u+m||!t.contains(n.snapElements[d].item.ownerDocument,n.snapElements[d].item)?(n.snapElements[d].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[d].item})),n.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(s=Math.abs(c-x)<=m,r=Math.abs(u-y)<=m,o=Math.abs(h-v)<=m,a=Math.abs(l-g)<=m,s&&(i.position.top=n._convertPositionTo("relative",{top:c-n.helperProportions.height,left:0}).top),r&&(i.position.top=n._convertPositionTo("relative",{top:u,left:0}).top),o&&(i.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left)),p=s||r||o||a,"outer"!==f.snapMode&&(s=Math.abs(c-y)<=m,r=Math.abs(u-x)<=m,o=Math.abs(h-g)<=m,a=Math.abs(l-v)<=m,s&&(i.position.top=n._convertPositionTo("relative",{top:c,left:0}).top),r&&(i.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top),o&&(i.position.left=n._convertPositionTo("relative",{top:0,left:h}).left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left)),!n.snapElements[d].snapping&&(s||r||o||a||p)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[d].item})),n.snapElements[d].snapping=s||r||o||a||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,n){var s,r=n.options,o=t.makeArray(t(r.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});o.length&&(s=parseInt(t(o[0]).css("zIndex"),10)||0,t(o).each(function(e){t(this).css("zIndex",s+e)}),this.css("zIndex",s+o.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,n){var s=t(i.helper),r=n.options;s.css("zIndex")&&(r._zIndex=s.css("zIndex")),s.css("zIndex",r.zIndex)},stop:function(e,i,n){var s=n.options;s._zIndex&&t(i.helper).css("zIndex",s._zIndex)}});t.ui.draggable;t.widget("ui.resizable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseInt(t,10)||0},_isNumber:function(t){return!isNaN(parseInt(t,10))},_hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",s=!1;return e[n]>0||(e[n]=1,s=e[n]>0,e[n]=0,s)},_create:function(){var e,i,n,s,r,o=this,a=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},i=0;i<e.length;i++)n=t.trim(e[i]),r="ui-resizable-"+n,s=t("<div class='ui-resizable-handle "+r+"'></div>"),s.css({zIndex:a.zIndex}),"se"===n&&s.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(s);this._renderAxis=function(e){var i,n,s,r;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=t(this.handles[i],this.element),
r=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),s=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(s,r),this._proportionallyResize()),t(this.handles[i]).length},this._renderAxis(this.element),this._handles=t(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(s=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=s&&s[1]?s[1]:"se")}),a.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(t(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){a.disabled||o.resizing||(t(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,n,s=!1;for(i in this.handles)n=t(this.handles[i])[0],(n===e.target||t.contains(n,e.target))&&(s=!0);return!this.options.disabled&&s},_mouseStart:function(e){var i,n,s,r=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),r.containment&&(i+=t(r.containment).scrollLeft()||0,n+=t(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:n},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof r.aspectRatio?r.aspectRatio:this.originalSize.width/this.originalSize.height||1,s=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===s?this.axis+"-resize":s),o.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,n,s=this.originalMousePosition,r=this.axis,o=e.pageX-s.left||0,a=e.pageY-s.top||0,h=this._change[r];return this._updatePrevProperties(),!!h&&(i=h.apply(this,[e,o,a]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1)},_mouseStop:function(e){this.resizing=!1;var i,n,s,r,o,a,h,l=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),s=n&&this._hasScroll(i[0],"left")?0:c.sizeDiff.height,r=n?0:c.sizeDiff.width,o={width:c.helper.width()-r,height:c.helper.height()-s},a=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,h=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,l.animate||this.element.css(t.extend(o,{top:h,left:a})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!l.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,n,s,r,o=this.options;r={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(e=r.minHeight*this.aspectRatio,n=r.minWidth/this.aspectRatio,i=r.maxHeight*this.aspectRatio,s=r.maxWidth/this.aspectRatio,e>r.minWidth&&(r.minWidth=e),n>r.minHeight&&(r.minHeight=n),i<r.maxWidth&&(r.maxWidth=i),s<r.maxHeight&&(r.maxHeight=s)),this._vBoundaries=r},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,n=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===n&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===n&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,n=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,s=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,r=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,o=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return r&&(t.width=e.minWidth),o&&(t.height=e.minHeight),n&&(t.width=e.maxWidth),s&&(t.height=e.maxHeight),r&&l&&(t.left=a-e.minWidth),n&&l&&(t.left=a-e.maxWidth),o&&c&&(t.top=h-e.minHeight),s&&c&&(t.top=h-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],n=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],s=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];e<4;e++)i[e]=parseInt(n[e],10)||0,i[e]+=parseInt(s[e],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;e<this._proportionallyResizeElements.length;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,n=this.originalPosition;return{left:n.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize,s=this.originalPosition;return{top:s.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},sw:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,n]))},ne:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},nw:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,n]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).resizable("instance"),n=i.options,s=i._proportionallyResizeElements,r=s.length&&/textarea/i.test(s[0].nodeName),o=r&&i._hasScroll(s[0],"left")?0:i.sizeDiff.height,a=r?0:i.sizeDiff.width,h={width:i.size.width-a,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(h,c&&l?{top:c,left:l}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};s&&s.length&&t(s[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,i,n,s,r,o,a,h=t(this).resizable("instance"),l=h.options,c=h.element,u=l.containment,d=u instanceof t?u.get(0):/parent/.test(u)?c.parent().get(0):u;d&&(h.containerElement=t(d),/document/.test(u)||u===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),i=[],t(["Top","Right","Left","Bottom"]).each(function(t,n){i[t]=h._num(e.css("padding"+n))}),h.containerOffset=e.offset(),h.containerPosition=e.position(),h.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},n=h.containerOffset,s=h.containerSize.height,r=h.containerSize.width,o=h._hasScroll(d,"left")?d.scrollWidth:r,a=h._hasScroll(d)?d.scrollHeight:s,h.parentData={element:d,left:n.left,top:n.top,width:o,height:a}))},resize:function(e){var i,n,s,r,o=t(this).resizable("instance"),a=o.options,h=o.containerOffset,l=o.position,c=o._aspectRatio||e.shiftKey,u={top:0,left:0},d=o.containerElement,p=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-u.left),c&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=a.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),c&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),s=o.containerElement.get(0)===o.element.parent().get(0),r=/relative|absolute/.test(o.containerElement.css("position")),s&&r?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-u.left:o.offset.left-h.left)),n=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-u.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,c&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),n+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-n,c&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),i=e.options,n=e.containerOffset,s=e.containerPosition,r=e.containerElement,o=t(e.helper),a=o.offset(),h=o.outerWidth()-e.sizeDiff.width,l=o.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(r.css("position"))&&t(this).css({left:a.left-s.left-n.left,width:h,height:l}),e._helper&&!i.animate&&/static/.test(r.css("position"))&&t(this).css({left:a.left-s.left-n.left,width:h,height:l})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance"),i=e.options,n=function(e){t(e).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):t.each(i.alsoResize,function(t){n(t)})},resize:function(e,i){var n=t(this).resizable("instance"),s=n.options,r=n.originalSize,o=n.originalPosition,a={height:n.size.height-r.height||0,width:n.size.width-r.width||0,top:n.position.top-o.top||0,left:n.position.left-o.left||0},h=function(e,n){t(e).each(function(){var e=t(this),s=t(this).data("ui-resizable-alsoresize"),r={},o=n&&n.length?n:e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,function(t,e){var i=(s[e]||0)+(a[e]||0);i&&i>=0&&(r[e]=i||null)}),e.css(r)})};"object"!=typeof s.alsoResize||s.alsoResize.nodeType?h(s.alsoResize):t.each(s.alsoResize,function(t,e){h(t,e)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),i=e.options,n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,i=t(this).resizable("instance"),n=i.options,s=i.size,r=i.originalSize,o=i.originalPosition,a=i.axis,h="number"==typeof n.grid?[n.grid,n.grid]:n.grid,l=h[0]||1,c=h[1]||1,u=Math.round((s.width-r.width)/l)*l,d=Math.round((s.height-r.height)/c)*c,p=r.width+u,f=r.height+d,m=n.maxWidth&&n.maxWidth<p,g=n.maxHeight&&n.maxHeight<f,v=n.minWidth&&n.minWidth>p,y=n.minHeight&&n.minHeight>f;n.grid=h,v&&(p+=l),y&&(f+=c),m&&(p-=l),g&&(f-=c),/^(se|s|e)$/.test(a)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(a)?(i.size.width=p,i.size.height=f,i.position.top=o.top-d):/^(sw)$/.test(a)?(i.size.width=p,i.size.height=f,i.position.left=o.left-u):((f-c<=0||p-l<=0)&&(e=i._getPaddingPlusBorderDimensions(this)),f-c>0?(i.size.height=f,i.position.top=o.top-d):(f=c-e.height,i.size.height=f,i.position.top=o.top+r.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-u):(p=c-e.height,i.size.width=p,i.position.left=o.left+r.width-p))}});t.ui.resizable,t.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;i<0&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i,n=this;if(this._isOpen&&this._trigger("beforeClose",e)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&t(i).blur()}catch(t){}this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",e)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var n=!1,s=this.uiDialog.siblings(".ui-front:visible").map(function(){return+t(this).css("z-index")}).get(),r=Math.max.apply(null,s);return r>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",r+1),n=!0),n&&!i&&this._trigger("focus",e),n},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement,i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),s=i.filter(":last");e.target!==s[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==n[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){s.focus()}),e.preventDefault()):(this._delay(function(){n.focus()}),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(t.each(i,function(i,n){var s,r;n=t.isFunction(n)?{click:n,text:i}:n,n=t.extend({type:"button"},n),s=n.click,n.click=function(){s.apply(e.element[0],arguments)},r={icons:n.icons,text:n.showText},delete n.icons,delete n.showText,t("<button></button>",n).button(r).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,s){t(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,e(s))},drag:function(t,n){i._trigger("drag",t,e(n))},stop:function(s,r){var o=r.offset.left-i.document.scrollLeft(),a=r.offset.top-i.document.scrollTop();n.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" top"+(a>=0?"+":"")+a,of:i.window},t(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",s,e(r))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,n=this.options,s=n.resizable,r=this.uiDialog.css("position"),o="string"==typeof s?s:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:o,start:function(n,s){t(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,e(s))},resize:function(t,n){i._trigger("resize",t,e(n))},stop:function(s,r){var o=i.uiDialog.offset(),a=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();n.height=i.uiDialog.height(),n.width=i.uiDialog.width(),n.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" top"+(h>=0?"+":"")+h,of:i.window},t(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",s,e(r))}}).css("position",r)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);i!==-1&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,n=!1,s={};t.each(e,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(n=!0),t in i.resizableRelatedOptions&&(s[t]=e)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(t,e){var i,n,s=this.uiDialog;"dialogClass"===t&&s.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&(i=s.is(":data(ui-draggable)"),i&&!e&&s.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&(n=s.is(":data(ui-resizable)"),n&&!e&&s.resizable("destroy"),n&&"string"==typeof e&&s.resizable("option","handles",e),n||e===!1||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!t(e.target).closest(".ui-dialog").length||!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}});t.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(n)?n:function(t){return t.is(n)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var n=t.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var n=i||t.ui.ddmanager.current,s=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");if(i.options.greedy&&!i.options.disabled&&i.options.scope===n.options.scope&&i.accept.call(i.element[0],n.currentItem||n.element)&&t.ui.intersect(n,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e))return s=!0,!1}),!s&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(){function t(t,e,i){return t>=e&&t<e+i}return function(e,i,n,s){if(!i.offset)return!1;var r=(e.positionAbs||e.position.absolute).left+e.margins.left,o=(e.positionAbs||e.position.absolute).top+e.margins.top,a=r+e.helperProportions.width,h=o+e.helperProportions.height,l=i.offset.left,c=i.offset.top,u=l+i.proportions().width,d=c+i.proportions().height;switch(n){case"fit":return l<=r&&a<=u&&c<=o&&h<=d;case"intersect":return l<r+e.helperProportions.width/2&&a-e.helperProportions.width/2<u&&c<o+e.helperProportions.height/2&&h-e.helperProportions.height/2<d;case"pointer":return t(s.pageY,c,i.proportions().height)&&t(s.pageX,l,i.proportions().width);case"touch":return(o>=c&&o<=d||h>=c&&h<=d||o<c&&h>d)&&(r>=l&&r<=u||a>=l&&a<=u||r<l&&a>u);default:return!1}}}(),t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,i){var n,s,r=t.ui.ddmanager.droppables[e.options.scope]||[],o=i?i.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(n=0;n<r.length;n++)if(!(r[n].options.disabled||e&&!r[n].accept.call(r[n].element[0],e.currentItem||e.element))){for(s=0;s<a.length;s++)if(a[s]===r[n].element[0]){r[n].proportions().height=0;continue t}r[n].visible="none"!==r[n].element.css("display"),r[n].visible&&("mousedown"===o&&r[n]._activate.call(r[n],i),r[n].offset=r[n].element.offset(),r[n].proportions({width:r[n].element[0].offsetWidth,height:r[n].element[0].offsetHeight}))}},drop:function(e,i){var n=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){
if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,s,r,o=t.ui.intersect(e,this,this.options.tolerance,i),a=!o&&this.isover?"isout":o&&!this.isover?"isover":null;a&&(this.options.greedy&&(s=this.options.scope,r=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===s}),r.length&&(n=t(r[0]).droppable("instance"),n.greedyChild="isover"===a)),n&&"isover"===a&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,i),n&&"isout"===a&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}};var y=(t.ui.droppable,"ui-effects-"),x=t;t.effects={effect:{}},function(t,e){function i(t,e,i){var n=u[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:n.max<t?n.max:t)}function n(e){var i=l(),n=i._rgba=[];return e=e.toLowerCase(),f(h,function(t,s){var r,o=s.re.exec(e),a=o&&s.parse(o),h=s.space||"rgba";if(a)return r=i[h](a),i[c[h].cache]=r[c[h].cache],n=i._rgba=r._rgba,!1}),n.length?("0,0,0,0"===n.join()&&t.extend(n,r.transparent),i):r[e]}function s(t,e,i){return i=(i+1)%1,6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}var r,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,n,s){return new t.Color.fn.parse(e,i,n,s)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=l.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(s,o,a,h){if(s===e)return this._rgba=[null,null,null,null],this;(s.jquery||s.nodeType)&&(s=t(s).css(o),o=e);var u=this,d=t.type(s),p=this._rgba=[];return o!==e&&(s=[s,o,a,h],d="array"),"string"===d?this.parse(n(s)||r._default):"array"===d?(f(c.rgba.props,function(t,e){p[e.idx]=i(s[e.idx],e)}),this):"object"===d?(s instanceof l?f(c,function(t,e){s[e.cache]&&(u[e.cache]=s[e.cache].slice())}):f(c,function(e,n){var r=n.cache;f(n.props,function(t,e){if(!u[r]&&n.to){if("alpha"===t||null==s[t])return;u[r]=n.to(u._rgba)}u[r][e.idx]=i(s[t],e,!0)}),u[r]&&t.inArray(null,u[r].slice(0,3))<0&&(u[r][3]=1,n.from&&(u._rgba=n.from(u[r])))}),this):void 0},is:function(t){var e=l(t),i=!0,n=this;return f(c,function(t,s){var r,o=e[s.cache];return o&&(r=n[s.cache]||s.to&&s.to(n._rgba)||[],f(s.props,function(t,e){if(null!=o[e.idx])return i=o[e.idx]===r[e.idx]})),i}),i},_space:function(){var t=[],e=this;return f(c,function(i,n){e[n.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var n=l(t),s=n._space(),r=c[s],o=0===this.alpha()?l("transparent"):this,a=o[r.cache]||r.to(o._rgba),h=a.slice();return n=n[r.cache],f(r.props,function(t,s){var r=s.idx,o=a[r],l=n[r],c=u[s.type]||{};null!==l&&(null===o?h[r]=l:(c.mod&&(l-o>c.mod/2?o+=c.mod:o-l>c.mod/2&&(o-=c.mod)),h[r]=i((l-o)*e+o,s)))}),this[s](h)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),s=l(e)._rgba;return l(t.map(i,function(t,e){return(1-n)*s[e]+n*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&e<3&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),n=i.pop();return e&&i.push(~~(255*n)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,n=t[0]/255,s=t[1]/255,r=t[2]/255,o=t[3],a=Math.max(n,s,r),h=Math.min(n,s,r),l=a-h,c=a+h,u=.5*c;return e=h===a?0:n===a?60*(s-r)/l+360:s===a?60*(r-n)/l+120:60*(n-s)/l+240,i=0===l?0:u<=.5?l/c:l/(2-c),[Math.round(e)%360,i,u,null==o?1:o]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],r=t[3],o=n<=.5?n*(1+i):n+i-n*i,a=2*n-o;return[Math.round(255*s(a,o,e+1/3)),Math.round(255*s(a,o,e)),Math.round(255*s(a,o,e-1/3)),r]},f(c,function(n,s){var r=s.props,o=s.cache,h=s.to,c=s.from;l.fn[n]=function(n){if(h&&!this[o]&&(this[o]=h(this._rgba)),n===e)return this[o].slice();var s,a=t.type(n),u="array"===a||"object"===a?n:arguments,d=this[o].slice();return f(r,function(t,e){var n=u["object"===a?t:e.idx];null==n&&(n=d[e.idx]),d[e.idx]=i(n,e)}),c?(s=l(c(d)),s[o]=d,s):l(d)},f(r,function(e,i){l.fn[e]||(l.fn[e]=function(s){var r,o=t.type(s),h="alpha"===e?this._hsla?"hsla":"rgba":n,l=this[h](),c=l[i.idx];return"undefined"===o?c:("function"===o&&(s=s.call(this,c),o=t.type(s)),null==s&&i.empty?this:("string"===o&&(r=a.exec(s),r&&(s=c+parseFloat(r[2])*("+"===r[1]?1:-1))),l[i.idx]=s,this[h](l)))})})}),l.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,s){var r,o,a="";if("transparent"!==s&&("string"!==t.type(s)||(r=n(s)))){if(s=l(r||s),!d.rgba&&1!==s._rgba[3]){for(o="backgroundColor"===i?e.parentNode:e;(""===a||"transparent"===a)&&o&&o.style;)try{a=t.css(o,"backgroundColor"),o=o.parentNode}catch(t){}s=s.blend(a&&"transparent"!==a?a:"_default")}s=s.toRgbaString()}try{e.style[i]=s}catch(t){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook(o),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,n){e["border"+n+"Color"]=t}),e}},r=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(x),function(){function e(e){var i,n,s=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,r={};if(s&&s.length&&s[0]&&s[s[0]])for(n=s.length;n--;)i=s[n],"string"==typeof s[i]&&(r[t.camelCase(i)]=s[i]);else for(i in s)"string"==typeof s[i]&&(r[i]=s[i]);return r}function i(e,i){var n,r,o={};for(n in i)r=i[n],e[n]!==r&&(s[n]||!t.fx.step[n]&&isNaN(parseFloat(r))||(o[n]=r));return o}var n=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(x.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(s,r,o,a){var h=t.speed(r,o,a);return this.queue(function(){var r,o=t(this),a=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var i=t(this);return{el:i,start:e(this)}}),r=function(){t.each(n,function(t,e){s[e]&&o[e+"Class"](s[e])})},r(),l=l.map(function(){return this.end=e(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",a),l=l.map(function(){var e=this,i=t.Deferred(),n=t.extend({},h,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,n),i.promise()}),t.when.apply(t,l.get()).done(function(){r(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),h.complete.call(o[0])})})},t.fn.extend({addClass:function(e){return function(i,n,s,r){return n?t.effects.animateClass.call(this,{add:i},n,s,r):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,n,s,r){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},n,s,r):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(i,n,s,r,o){return"boolean"==typeof n||void 0===n?s?t.effects.animateClass.call(this,n?{add:i}:{remove:i},s,r,o):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},n,s,r)}}(t.fn.toggleClass),switchClass:function(e,i,n,s,r){return t.effects.animateClass.call(this,{add:i,remove:e},n,s,r)}})}(),function(){function e(e,i,n,s){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(s=i,n=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(s=n,n=i,i={}),t.isFunction(n)&&(s=n,n=null),i&&t.extend(e,i),n=n||i.duration,e.duration=t.fx.off?0:"number"==typeof n?n:n in t.fx.speeds?t.fx.speeds[n]:t.fx.speeds._default,e.complete=s||i.complete,e}function i(e){return!(e&&"number"!=typeof e&&!t.fx.speeds[e])||("string"==typeof e&&!t.effects.effect[e]||(!!t.isFunction(e)||"object"==typeof e&&!e.effect))}t.extend(t.effects,{version:"1.11.2",save:function(t,e){for(var i=0;i<e.length;i++)null!==e[i]&&t.data(y+e[i],t[0].style[e[i]])},restore:function(t,e){var i,n;for(n=0;n<e.length;n++)null!==e[n]&&(i=t.data(y+e[n]),void 0===i&&(i=""),t.css(e[n],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},n=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),s={width:e.width(),height:e.height()},r=document.activeElement;try{r.id}catch(t){r=document.body}return e.wrap(n),(e[0]===r||t.contains(e[0],r))&&t(r).focus(),n=e.parent(),"static"===e.css("position")?(n.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,n){i[n]=e.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(s),n.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,n,s){return s=s||{},t.each(i,function(t,i){var r=e.cssUnit(i);r[0]>0&&(s[i]=r[0]*n+r[1])}),s}}),t.fn.extend({effect:function(){function i(e){function i(){t.isFunction(r)&&r.call(s[0]),t.isFunction(e)&&e()}var s=t(this),r=n.complete,a=n.mode;(s.is(":hidden")?"hide"===a:"show"===a)?(s[a](),i()):o.call(s[0],n,i)}var n=e.apply(this,arguments),s=n.mode,r=n.queue,o=t.effects.effect[n.effect];return t.fx.off||!o?s?this[s](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):r===!1?this.each(i):this.queue(r||"fx",i)},show:function(t){return function(n){if(i(n))return t.apply(this,arguments);var s=e.apply(this,arguments);return s.mode="show",this.effect.call(this,s)}}(t.fn.show),hide:function(t){return function(n){if(i(n))return t.apply(this,arguments);var s=e.apply(this,arguments);return s.mode="hide",this.effect.call(this,s)}}(t.fn.hide),toggle:function(t){return function(n){if(i(n)||"boolean"==typeof n)return t.apply(this,arguments);var s=e.apply(this,arguments);return s.mode="toggle",this.effect.call(this,s)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(n=[parseFloat(i),e])}),n}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return t<.5?i(2*t)/2:1-i(t*-2+2)/2}})}();t.effects,t.effects.effect.blind=function(e,i){var n,s,r,o=t(this),a=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=["position","top","bottom","left","right","height","width"],c=t.effects.setMode(o,e.mode||"hide"),u=e.direction||"up",d=a.test(u),p=d?"height":"width",f=d?"top":"left",m=h.test(u),g={},v="show"===c;o.parent().is(".ui-effects-wrapper")?t.effects.save(o.parent(),l):t.effects.save(o,l),o.show(),n=t.effects.createWrapper(o).css({overflow:"hidden"}),s=n[p](),r=parseFloat(n.css(f))||0,g[p]=v?s:0,m||(o.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),g[f]=v?r:s+r),v&&(n.css(p,0),m||n.css(f,r+s)),n.animate(g,{duration:e.duration,easing:e.easing,queue:!1,complete:function(){"hide"===c&&o.hide(),t.effects.restore(o,l),t.effects.removeWrapper(o),i()}})},t.effects.effect.bounce=function(e,i){var n,s,r,o=t(this),a=["position","top","bottom","left","right","height","width"],h=t.effects.setMode(o,e.mode||"effect"),l="hide"===h,c="show"===h,u=e.direction||"up",d=e.distance,p=e.times||5,f=2*p+(c||l?1:0),m=e.duration/f,g=e.easing,v="up"===u||"down"===u?"top":"left",y="up"===u||"left"===u,x=o.queue(),b=x.length;for((c||l)&&a.push("opacity"),t.effects.save(o,a),o.show(),t.effects.createWrapper(o),d||(d=o["top"===v?"outerHeight":"outerWidth"]()/3),c&&(r={opacity:1},r[v]=0,o.css("opacity",0).css(v,y?2*-d:2*d).animate(r,m,g)),l&&(d/=Math.pow(2,p-1)),r={},r[v]=0,n=0;n<p;n++)s={},s[v]=(y?"-=":"+=")+d,o.animate(s,m,g).animate(r,m,g),d=l?2*d:d/2;l&&(s={opacity:0},s[v]=(y?"-=":"+=")+d,o.animate(s,m,g)),o.queue(function(){l&&o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()}),b>1&&x.splice.apply(x,[1,0].concat(x.splice(b,f+1))),o.dequeue()},t.effects.effect.clip=function(e,i){var n,s,r,o=t(this),a=["position","top","bottom","left","right","height","width"],h=t.effects.setMode(o,e.mode||"hide"),l="show"===h,c=e.direction||"vertical",u="vertical"===c,d=u?"height":"width",p=u?"top":"left",f={};t.effects.save(o,a),o.show(),n=t.effects.createWrapper(o).css({overflow:"hidden"}),s="IMG"===o[0].tagName?n:o,r=s[d](),l&&(s.css(d,0),s.css(p,r/2)),f[d]=l?r:0,f[p]=l?0:r/2,s.animate(f,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){l||o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()}})},t.effects.effect.drop=function(e,i){var n,s=t(this),r=["position","top","bottom","left","right","opacity","height","width"],o=t.effects.setMode(s,e.mode||"hide"),a="show"===o,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h?"pos":"neg",u={opacity:a?1:0};t.effects.save(s,r),s.show(),t.effects.createWrapper(s),n=e.distance||s["top"===l?"outerHeight":"outerWidth"](!0)/2,a&&s.css("opacity",0).css(l,"pos"===c?-n:n),u[l]=(a?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+n,s.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&s.hide(),t.effects.restore(s,r),t.effects.removeWrapper(s),i()}})},t.effects.effect.explode=function(e,i){function n(){x.push(this),x.length===u*d&&s()}function s(){p.css({visibility:"visible"}),t(x).remove(),m||p.hide(),i()}var r,o,a,h,l,c,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=u,p=t(this),f=t.effects.setMode(p,e.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),y=Math.ceil(p.outerHeight()/u),x=[];for(r=0;r<u;r++)for(h=g.top+r*y,c=r-(u-1)/2,o=0;o<d;o++)a=g.left+o*v,l=o-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-r*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:a+(m?l*v:0),top:h+(m?c*y:0),opacity:m?0:1}).animate({left:a+(m?0:l*v),top:h+(m?0:c*y),opacity:m?1:0},e.duration||500,e.easing,n)},t.effects.effect.fade=function(e,i){var n=t(this),s=t.effects.setMode(n,e.mode||"toggle");n.animate({opacity:s},{queue:!1,duration:e.duration,easing:e.easing,complete:i})},t.effects.effect.fold=function(e,i){var n,s,r=t(this),o=["position","top","bottom","left","right","height","width"],a=t.effects.setMode(r,e.mode||"hide"),h="show"===a,l="hide"===a,c=e.size||15,u=/([0-9]+)%/.exec(c),d=!!e.horizFirst,p=h!==d,f=p?["width","height"]:["height","width"],m=e.duration/2,g={},v={};t.effects.save(r,o),r.show(),n=t.effects.createWrapper(r).css({overflow:"hidden"}),s=p?[n.width(),n.height()]:[n.height(),n.width()],u&&(c=parseInt(u[1],10)/100*s[l?0:1]),h&&n.css(d?{height:0,width:c}:{height:c,width:0}),g[f[0]]=h?s[0]:c,v[f[1]]=h?s[1]:0,n.animate(g,m,e.easing).animate(v,m,e.easing,function(){l&&r.hide(),t.effects.restore(r,o),t.effects.removeWrapper(r),i()})},t.effects.effect.highlight=function(e,i){var n=t(this),s=["backgroundImage","backgroundColor","opacity"],r=t.effects.setMode(n,e.mode||"show"),o={backgroundColor:n.css("backgroundColor")};"hide"===r&&(o.opacity=0),t.effects.save(n,s),n.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(o,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===r&&n.hide(),t.effects.restore(n,s),i()}})},t.effects.effect.size=function(e,i){var n,s,r,o=t(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],c=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=t.effects.setMode(o,e.mode||"effect"),f=e.restore||"effect"!==p,m=e.scale||"both",g=e.origin||["middle","center"],v=o.css("position"),y=f?a:h,x={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),n={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===e.mode&&"show"===p?(o.from=e.to||x,o.to=e.from||n):(o.from=e.from||("show"===p?x:n),o.to=e.to||("hide"===p?x:n)),r={from:{y:o.from.height/n.height,x:o.from.width/n.width},to:{y:o.to.height/n.height,x:o.to.width/n.width}},"box"!==m&&"both"!==m||(r.from.y!==r.to.y&&(y=y.concat(u),o.from=t.effects.setTransition(o,u,r.from.y,o.from),o.to=t.effects.setTransition(o,u,r.to.y,o.to)),r.from.x!==r.to.x&&(y=y.concat(d),o.from=t.effects.setTransition(o,d,r.from.x,o.from),o.to=t.effects.setTransition(o,d,r.to.x,o.to))),"content"!==m&&"both"!==m||r.from.y!==r.to.y&&(y=y.concat(c).concat(l),o.from=t.effects.setTransition(o,c,r.from.y,o.from),o.to=t.effects.setTransition(o,c,r.to.y,o.to)),t.effects.save(o,y),o.show(),t.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(s=t.effects.getBaseline(g,n),o.from.top=(n.outerHeight-o.outerHeight())*s.y,o.from.left=(n.outerWidth-o.outerWidth())*s.x,o.to.top=(n.outerHeight-o.to.outerHeight)*s.y,o.to.left=(n.outerWidth-o.to.outerWidth)*s.x),o.css(o.from),"content"!==m&&"both"!==m||(u=u.concat(["marginTop","marginBottom"]).concat(c),d=d.concat(["marginLeft","marginRight"]),l=a.concat(u).concat(d),o.find("*[width]").each(function(){var i=t(this),n={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&t.effects.save(i,l),i.from={height:n.height*r.from.y,width:n.width*r.from.x,outerHeight:n.outerHeight*r.from.y,outerWidth:n.outerWidth*r.from.x},i.to={height:n.height*r.to.y,width:n.width*r.to.x,outerHeight:n.height*r.to.y,outerWidth:n.width*r.to.x},r.from.y!==r.to.y&&(i.from=t.effects.setTransition(i,u,r.from.y,i.from),i.to=t.effects.setTransition(i,u,r.to.y,i.to)),r.from.x!==r.to.x&&(i.from=t.effects.setTransition(i,d,r.from.x,i.from),i.to=t.effects.setTransition(i,d,r.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,function(){f&&t.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),t.effects.restore(o,y),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):t.each(["top","left"],function(t,e){o.css(e,function(e,i){var n=parseInt(i,10),s=t?o.to.left:o.to.top;return"auto"===i?s+"px":n+s+"px"})})),t.effects.removeWrapper(o),i()}})},t.effects.effect.scale=function(e,i){var n=t(this),s=t.extend(!0,{},e),r=t.effects.setMode(n,e.mode||"effect"),o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===r?0:100),a=e.direction||"both",h=e.origin,l={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()},c={y:"horizontal"!==a?o/100:1,x:"vertical"!==a?o/100:1};s.effect="size",s.queue=!1,s.complete=i,"effect"!==r&&(s.origin=h||["middle","center"],s.restore=!0),s.from=e.from||("show"===r?{height:0,width:0,outerHeight:0,outerWidth:0}:l),s.to={height:l.height*c.y,width:l.width*c.x,outerHeight:l.outerHeight*c.y,outerWidth:l.outerWidth*c.x},s.fade&&("show"===r&&(s.from.opacity=0,s.to.opacity=1),"hide"===r&&(s.from.opacity=1,s.to.opacity=0)),n.effect(s)},t.effects.effect.puff=function(e,i){var n=t(this),s=t.effects.setMode(n,e.mode||"hide"),r="hide"===s,o=parseInt(e.percent,10)||150,a=o/100,h={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:s,complete:i,percent:r?o:100,from:r?h:{height:h.height*a,width:h.width*a,outerHeight:h.outerHeight*a,outerWidth:h.outerWidth*a}}),n.effect(e)},t.effects.effect.pulsate=function(e,i){var n,s=t(this),r=t.effects.setMode(s,e.mode||"show"),o="show"===r,a="hide"===r,h=o||"hide"===r,l=2*(e.times||5)+(h?1:0),c=e.duration/l,u=0,d=s.queue(),p=d.length;for(!o&&s.is(":visible")||(s.css("opacity",0).show(),u=1),n=1;n<l;n++)s.animate({opacity:u},c,e.easing),u=1-u;s.animate({opacity:u},c,e.easing),s.queue(function(){a&&s.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,l+1))),s.dequeue()},t.effects.effect.shake=function(e,i){var n,s=t(this),r=["position","top","bottom","left","right","height","width"],o=t.effects.setMode(s,e.mode||"effect"),a=e.direction||"left",h=e.distance||20,l=e.times||3,c=2*l+1,u=Math.round(e.duration/c),d="up"===a||"down"===a?"top":"left",p="up"===a||"left"===a,f={},m={},g={},v=s.queue(),y=v.length;for(t.effects.save(s,r),s.show(),t.effects.createWrapper(s),f[d]=(p?"-=":"+=")+h,m[d]=(p?"+=":"-=")+2*h,g[d]=(p?"-=":"+=")+2*h,s.animate(f,u,e.easing),n=1;n<l;n++)s.animate(m,u,e.easing).animate(g,u,e.easing);s.animate(m,u,e.easing).animate(f,u/2,e.easing).queue(function(){"hide"===o&&s.hide(),t.effects.restore(s,r),t.effects.removeWrapper(s),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,c+1))),s.dequeue()},t.effects.effect.slide=function(e,i){var n,s=t(this),r=["position","top","bottom","left","right","width","height"],o=t.effects.setMode(s,e.mode||"show"),a="show"===o,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h,u={};t.effects.save(s,r),s.show(),n=e.distance||s["top"===l?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(s).css({overflow:"hidden"}),a&&s.css(l,c?isNaN(n)?"-"+n:-n:n),u[l]=(a?c?"+=":"-=":c?"-=":"+=")+n,s.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&s.hide(),t.effects.restore(s,r),t.effects.removeWrapper(s),i()}})},t.effects.effect.transfer=function(e,i){var n=t(this),s=t(e.to),r="fixed"===s.css("position"),o=t("body"),a=r?o.scrollTop():0,h=r?o.scrollLeft():0,l=s.offset(),c={top:l.top-a,left:l.left-h,height:s.innerHeight(),width:s.innerWidth()},u=n.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:u.top-a,left:u.left-h,height:n.innerHeight(),width:n.innerWidth(),position:r?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),i()})},t.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),void this._refreshValue())},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectable",t.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(n.filter,this.element[0]),this._trigger("start",e),t(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))}),t(e.target).parents().addBack().each(function(){var n,s=t.data(this,"selectable-item");if(s)return n=!e.metaKey&&!e.ctrlKey||!s.$element.hasClass("ui-selected"),s.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),s.unselecting=!n,s.selecting=n,s.selected=n,n?i._trigger("selecting",e,{selecting:s.element}):i._trigger("unselecting",e,{unselecting:s.element}),!1}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,s=this.options,r=this.opos[0],o=this.opos[1],a=e.pageX,h=e.pageY;return r>a&&(i=a,a=r,r=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:r,top:o,width:a-r,height:h-o}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),l=!1;i&&i.element!==n.element[0]&&("touch"===s.tolerance?l=!(i.left>a||i.right<r||i.top>h||i.bottom<o):"fit"===s.tolerance&&(l=i.left>r&&i.right<a&&i.top>o&&i.bottom<h),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})}),t(".ui-selecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var e=this,i=this.element.attr("tabindex");this.label=t("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{class:"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",
tabindex:i||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),t("<span>",{class:"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=t("<span>",{class:"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e.menuItems||e._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>",{class:"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var n=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&n.index!==e.focusIndex&&(e._trigger("focus",t,{item:n}),e.isOpen||e._select(n,t)),e.focusIndex=n.index,e.button.attr("aria-activedescendant",e.menuItems.eq(n.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var t,e=this.element.find("option");e.length&&(this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(e,i){var n=this,s="";t.each(i,function(i,r){r.optgroup!==s&&(t("<li>",{class:"ui-selectmenu-optgroup ui-menu-divider"+(r.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:r.optgroup}).appendTo(e),s=r.optgroup),n._renderItemData(e,r)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var n=t("<li>");return i.disabled&&n.addClass("ui-state-disabled"),this._setText(n,i.label),n.appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,n,s=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),s+=":not(.ui-state-disabled)"),n="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](s).eq(-1):i[t+"All"](s).eq(0),n.length&&this.menuInstance.focus(e,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?(t=window.getSelection(),t.removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection(),t.rangeCount&&(this.range=t.getRangeAt(0))):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex);e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this._setText(this.buttonText,t.label),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){"icons"===t&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(e.button),this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"disabled"===t&&(this.menuInstance.option("disabled",e),this.button.toggleClass("ui-state-disabled",e).attr("aria-disabled",e),this.element.prop("disabled",e),e?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===t&&this._resizeButton()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;t||(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(e){var i=[];e.each(function(e,n){var s=t(n),r=s.parent("optgroup");i.push({element:s,index:e,value:s.attr("value"),label:s.text(),optgroup:r.attr("label")||"",disabled:r.prop("disabled")||s.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),t.widget("ui.slider",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,n=this.options,s=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",o=[];for(i=n.values&&n.values.length||1,s.length>i&&(s.slice(i).remove(),s=s.slice(0,i)),e=s.length;e<i;e++)o.push(r);this.handles=s.add(t(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,i="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,n,s,r,o,a,h,l,c=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),s=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(n-c.values(e));(s>i||s===i&&(e===c._lastChangedValue||c.values(e)===u.min))&&(s=i,r=t(this),o=e)}),a=this._start(e,o),a!==!1&&(this._mouseSliding=!0,this._handleIndex=o,r.addClass("ui-state-active").focus(),h=r.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-r.width()/2,top:e.pageY-h.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,s,r;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/e,n>1&&(n=1),n<0&&(n=0),"vertical"===this.orientation&&(n=1-n),s=this._valueMax()-this._valueMin(),r=this._valueMin()+n*s,this._trimAlignValue(r)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,s,r;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>n||1===e&&i<n)&&(i=n),i!==this.values(e)&&(s=this.values(),s[e]=i,r=this._trigger("slide",t,{handle:this.handles[e],value:i,values:s}),n=this.values(e?0:1),r!==!1&&this.values(e,i))):i!==this.value()&&(r=this._trigger("slide",t,{handle:this.handles[e],value:i}),r!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var n,s,r;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(n=this.options.values,s=arguments[0],r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(s[r]),this._change(null,r);this._refreshValue()},_setOption:function(e,i){var n,s=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(s=this.options.values.length),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!i),this._super(e,i),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;n<s;n+=1)this._change(null,n);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_calculateNewMax:function(){var t=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-t},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var e,i,n,s,r,o=this.options.range,a=this.options,h=this,l=!this._animateOff&&a.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=(h.values(n)-h._valueMin())/(h._valueMax()-h._valueMin())*100,c["horizontal"===h.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[l?"animate":"css"](c,a.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===n&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},a.animate),1===n&&h.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:a.animate})):(0===n&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&h.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:a.animate}))),e=i}):(n=this.value(),s=this._valueMin(),r=this._valueMax(),i=r!==s?(n-s)/(r-s)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](c,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(e){var i,n,s,r,o=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(e.target).addClass("ui-state-active"),i=this._start(e,o),i===!1))return}switch(r=this.options.step,n=s=this.options.values&&this.options.values.length?this.values(o):this.value(),e.keyCode){case t.ui.keyCode.HOME:s=this._valueMin();break;case t.ui.keyCode.END:s=this._valueMax();break;case t.ui.keyCode.PAGE_UP:s=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(n===this._valueMax())return;s=this._trimAlignValue(n+r);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(n===this._valueMin())return;s=this._trimAlignValue(n-r)}this._slide(e,o,s)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&t<e+i},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===t.axis||this._isFloating(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var n=null,s=!1,r=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each(function(){if(t.data(this,r.widgetName+"-item")===r)return n=t(this),!1}),t.data(e.target,r.widgetName+"-item")===r&&(n=t(e.target)),!!n&&(!(this.options.handle&&!i&&(t(this.options.handle,n).find("*").addBack().each(function(){this===e.target&&(s=!0)}),!s))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,i,n){var s,r,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",o.cursor),this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(r)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,n,s,r,o=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-t(document).scrollTop()<o.scrollSensitivity?a=t(document).scrollTop(t(document).scrollTop()-o.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<o.scrollSensitivity&&(a=t(document).scrollTop(t(document).scrollTop()+o.scrollSpeed)),e.pageX-t(document).scrollLeft()<o.scrollSensitivity?a=t(document).scrollLeft(t(document).scrollLeft()-o.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<o.scrollSensitivity&&(a=t(document).scrollLeft(t(document).scrollLeft()+o.scrollSpeed))),a!==!1&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],s=n.item[0],r=this._intersectsWithPointer(n),r&&n.instance===this.currentContainer&&!(s===this.currentItem[0]||this.placeholder[1===r?"next":"prev"]()[0]===s||t.contains(this.placeholder[0],s)||"semi-dynamic"===this.options.type&&t.contains(this.element[0],s))){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,s=this.placeholder.offset(),r=this.options.axis,o={};r&&"x"!==r||(o.left=s.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(o.top=s.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){n._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each(function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,s=n+this.helperProportions.height,r=t.left,o=r+t.width,a=t.top,h=a+t.height,l=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||n+l>a&&n+l<h,d="y"===this.options.axis||e+c>r&&e+c<o,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:r<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<o&&a<n+this.helperProportions.height/2&&s-this.helperProportions.height/2<h},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=e&&i,s=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return!!n&&(this.floating?r&&"right"===r||"down"===s?2:1:s&&("down"===s?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&i||"left"===s&&!i:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){a.push(this)}var n,s,r,o,a=[],h=[],l=this._connectWith();if(l&&e)for(n=l.length-1;n>=0;n--)for(r=t(l[n]),s=r.length-1;s>=0;s--)o=t.data(r[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=h.length-1;n>=0;n--)h[n][0].each(i);return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,s,r,o,a,h,l,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(s=t(d[i]),n=s.length-1;n>=0;n--)r=t.data(s[n],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(u.push([t.isFunction(r.options.items)?r.options.items.call(r.element[0],e,{item:this.currentItem}):t(r.options.items,r.element),r]),this.containers.push(r));for(i=u.length-1;i>=0;i--)for(o=u[i][1],a=u[i][0],n=0,l=a.length;n<l;n++)h=t(a[n]),h.data(this.widgetName+"-item",o),c.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,s,r;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(s=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=s.outerWidth(),n.height=s.outerHeight()),r=s.offset(),n.left=r.left,n.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)r=this.containers[i].element.offset(),this.containers[i].containerCache.left=r.left,this.containers[i].containerCache.top=r.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,n=e.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),s=t("<"+n+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(s)}):"img"===n&&s.attr("src",e.currentItem.attr("src")),i||s.css("visibility","hidden"),s},update:function(t,s){i&&!n.forcePlaceholderSize||(s.height()||s.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),s.width()||s.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var i,n,s,r,o,a,h,l,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),
this.containers[p].containerCache.over=1);else{for(s=1e4,r=null,c=d.floating||this._isFloating(this.currentItem),o=c?"left":"top",a=c?"width":"height",u=c?"clientX":"clientY",n=this.items.length-1;n>=0;n--)t.contains(this.containers[p].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(h=this.items[n].item.offset()[o],l=!1,e[u]-h>this.items[n][a]/2&&(l=!0),Math.abs(e[u]-h)<s&&(s=Math.abs(e[u]-h),r=this.items[n],this.direction=l?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));r?this._rearrange(e,r,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),n[0].style.width&&!i.forceHelperSize||n.width(this.currentItem.width()),n[0].style.height&&!i.forceHelperSize||n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,s=this.options;"parent"===s.containment&&(s.containment=this.helper[0].parentNode),"document"!==s.containment&&"window"!==s.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===s.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===s.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(s.containment)||(e=t(s.containment)[0],i=t(s.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(s[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:s.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:s.scrollLeft())*n}},_generatePosition:function(e){var i,n,s=this.options,r=e.pageX,o=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),s.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/s.grid[1])*s.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-s.grid[1]:i+s.grid[1]:i,n=this.originalPageX+Math.round((r-this.originalPageX)/s.grid[0])*s.grid[0],r=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-s.grid[0]:n+s.grid[0]:n)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:a.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var s=this.counter;this._delay(function(){s===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){function i(t,e,i){return function(n){i._trigger(t,n,e._uiHash(e))}}this.reverting=!1;var n,s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||s.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(s.push(function(t){this._trigger("remove",t,this._uiHash())}),s.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),s.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)e||s.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(s.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(n=0;n<s.length;n++)s[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,n){var s=i.attr(n);void 0!==s&&s.length&&(e[n]=s)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){if(t(e.currentTarget).hasClass("ui-state-active"))return this._start(e)!==!1&&void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,n=t.ui.keyCode;switch(e.keyCode){case n.UP:return this._repeat(null,1,e),!0;case n.DOWN:return this._repeat(null,-1,e),!0;case n.PAGE_UP:return this._repeat(null,i.page,e),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return!(!this.spinning&&this._trigger("start",t)===!1)&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),i=e.indexOf(".");return i===-1?0:e.length-i-1},_adjustValue:function(t){var e,i,n=this.options;return e=null!==n.min?n.min:0,i=t-e,i=Math.round(i/n.step)*n.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&t<n.min?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}"max"!==t&&"min"!==t&&"step"!==t||"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),this.buttons.button(e?"disable":"enable"))},_setOptions:h(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:h(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:h(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:h(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?void h(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),t.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,n;e=e.cloneNode(!1),i=e.href.replace(t,""),n=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(t){}try{n=decodeURIComponent(n)}catch(t){}return e.hash.length>1&&i===n}}(),_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(i.active):this.active=t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===e&&(n&&this.tabs.each(function(i,s){if(t(s).attr("aria-controls")===n)return e=i,!1}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==e&&e!==-1||(e=!!this.tabs.length&&0)),e!==!1&&(e=this.tabs.index(this.tabs.eq(e)),e===-1&&(e=!i&&0)),!i&&e===!1&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),s=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:s=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}e.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,s),e.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){function n(){return e>s&&(e=0),e<0&&(e=s),e}for(var s=this.tabs.length-1;t.inArray(n(),this.options.disabled)!==-1;)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,i=this.tabs,n=this.anchors,s=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,n){var s,r,o,a=t(n).uniqueId().attr("id"),h=t(n).closest("li"),l=h.attr("aria-controls");e._isLocal(n)?(s=n.hash,o=s.substring(1),r=e.element.find(e._sanitizeSelector(s))):(o=h.attr("aria-controls")||t({}).uniqueId()[0].id,s="#"+o,r=e.element.find(s),r.length||(r=e._createPanel(o),r.insertAfter(e.panels[i-1]||e.tablist)),r.attr("aria-live","polite")),r.length&&(e.panels=e.panels.add(r)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":o,"aria-labelledby":a}),r.attr("aria-labelledby",a)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(n.not(this.anchors)),this._off(s.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,n=0;i=this.tabs[n];n++)e===!0||t.inArray(n,e)!==-1?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,n=this.element.parent();"fill"===e?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),n=e.css("position");"absolute"!==n&&"fixed"!==n&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,n=this.active,s=t(e.currentTarget),r=s.closest("li"),o=r[0]===n[0],a=o&&i.collapsible,h=a?t():this._getPanelForTab(r),l=n.length?this._getPanelForTab(n):t(),c={oldTab:n,oldPanel:l,newTab:a?t():r,newPanel:h};e.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",e,c)===!1||(i.active=!a&&this.tabs.index(r),this.active=o?t():r,this.xhr&&this.xhr.abort(),l.length||h.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(r),e),this._toggle(e,c))},_toggle:function(e,i){function n(){r.running=!1,r._trigger("activate",e,i)}function s(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&r.options.show?r._show(o,r.options.show,n):(o.show(),n())}var r=this,o=i.newPanel,a=i.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),s()),a.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&a.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var i,n=this._findActive(e);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;i!==!1&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,function(t){return t!==e?t:null}):t.map(this.tabs,function(t,i){return i!==e?i:null})),this._setupDisabled(i))},disable:function(e){var i=this.options.disabled;if(i!==!0){if(void 0===e)i=!0;else{if(e=this._getIndex(e),t.inArray(e,i)!==-1)return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setupDisabled(i)}},load:function(e,i){e=this._getIndex(e);var n=this,s=this.tabs.eq(e),r=s.find(".ui-tabs-anchor"),o=this._getPanelForTab(s),a={tab:s,panel:o};this._isLocal(r[0])||(this.xhr=t.ajax(this._ajaxSettings(r,i,a)),this.xhr&&"canceled"!==this.xhr.statusText&&(s.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){o.html(t),n._trigger("load",i,a)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&n.panels.stop(!1,!0),s.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(e,i,n){var s=this;return{url:e.attr("href"),beforeSend:function(e,r){return s._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:r},n))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),t.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var n=(e.attr("aria-describedby")||"").split(/\s+/);n.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(n.join(" ")))},_removeDescribedBy:function(e){var i=e.data("ui-tooltip-id"),n=(e.attr("aria-describedby")||"").split(/\s+/),s=t.inArray(i,n);s!==-1&&n.splice(s,1),e.removeData("ui-tooltip-id"),n=t.trim(n.join(" ")),n?e.attr("aria-describedby",n):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(e,i){var n=this;return"disabled"===e?(this[i?"_disable":"_enable"](),void(this.options[e]=i)):(this._super(e,i),void("content"===e&&t.each(this.tooltips,function(t,e){n._updateContent(e.element)})))},_disable:function(){var e=this;t.each(this.tooltips,function(i,n){var s=t.Event("blur");s.target=s.currentTarget=n.element[0],e.close(s,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,n=t(e?e.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&n.parents().each(function(){var e,n=t(this);n.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))}),this._updateContent(n,e))},_updateContent:function(t,e){var i,n=this.options.content,s=this,r=e?e.type:null;return"string"==typeof n?this._open(e,t,n):(i=n.call(t[0],function(i){t.data("ui-tooltip-open")&&s._delay(function(){e&&(e.type=r),this._open(e,t,i)})}),void(i&&this._open(e,t,i)))},_open:function(e,i,n){function s(t){c.of=t,o.is(":hidden")||o.position(c)}var r,o,a,h,l,c=t.extend({},this.options.position);if(n){if(r=this._find(i))return void r.tooltip.find(".ui-tooltip-content").html(n);i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),r=this._tooltip(i),o=r.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.liveRegion.children().hide(),n.clone?(l=n.clone(),l.removeAttr("id").find("[id]").removeAttr("id")):l=n,t("<div>").html(l).appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:s}),s(e)):o.position(t.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){o.is(":visible")&&(s(c.of),clearInterval(h))},t.fx.interval)),this._trigger("open",e,{tooltip:o}),a={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var n=t.Event(e);n.currentTarget=i[0],this.close(n,!0)}}},i[0]!==this.element[0]&&(a.remove=function(){this._removeTooltip(o)}),e&&"mouseover"!==e.type||(a.mouseleave="close"),e&&"focusin"!==e.type||(a.focusout="close"),this._on(!0,i,a)}},close:function(e){var i,n=this,s=t(e?e.currentTarget:this.element),r=this._find(s);r&&(i=r.tooltip,r.closing||(clearInterval(this.delayedShow),s.data("ui-tooltip-title")&&!s.attr("title")&&s.attr("title",s.data("ui-tooltip-title")),this._removeDescribedBy(s),r.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){
n._removeTooltip(t(this))}),s.removeData("ui-tooltip-open"),this._off(s,"mouseleave focusout keyup"),s[0]!==this.element[0]&&this._off(s,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete n.parents[e]}),r.closing=!0,this._trigger("close",e,{tooltip:i}),r.hiding||(r.closing=!1)))},_tooltip:function(e){var i=t("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),n=i.uniqueId().attr("id");return t("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[n]={element:e,tooltip:i}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,n){var s=t.Event("blur"),r=n.element;s.target=s.currentTarget=r[0],e.close(s,!0),t("#"+i).remove(),r.data("ui-tooltip-title")&&(r.attr("title")||r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})}),define("ddUtil/createDragDropElement",["jquery","jqueryUI"],function(t,e){"use strict";return function(){var t;return{init:function(t,e,i,n,s,r,o){t?this.id=t:this.id=i,this.e_id=t,this.labelName=e.labelName,this.label_id=i,this.e_cont_id=n,this.isNew=s,this.labelReplacedBy=r,this.setReset=!1,this.elXYpos={x:e.x,y:e.y},this.labelXYpos={x:e.e_x,y:e.e_y},this.makeDraggable(),this.setDragEl(o)},makeDraggable:function(){var e=this;$("#"+this.id).draggable({cursor:"default",drag:function(t,i){var n=$(i.helper).attr("id"),s=n.split("_");s=s[1];var r=document.getElementById("label_"+s);r&&e.drawLine(s,"",!0),$(".rightClickMenu").css("display","none")},stop:function(i,n){var s=e.getDragEl(),r=$(n.helper).attr("id");$(n.target).removeClass("dragDropLabelHover");for(var o=0;o<s.length;o++)s[o].e_id==r&&(t=s[o].getDroppedBool(),t||s[o].resetLabel())}})},setDroppedBool:function(t){this.droppedBool=t},getDroppedBool:function(){return this.droppedBool},resetLabel:function(){$("#"+this.label_id).remove();var t=this.e_id.split("_");t=t[1],$("#lineDiv"+t).remove(),$("#"+this.e_id).remove(),this.isNew?$("#"+this.e_cont_id).append('<div id="'+this.e_id+'" class="dragDropLabelRed">'+this.labelName+"</div>"):$("#"+this.e_cont_id).append('<div id="'+this.e_id+'" class="dragDropLabelBlack"><div>'+this.labelName+'</div><div class="labelReplacedBy">'+this.labelReplacedBy+"</div></div>"),this.makeDraggable(),this.setDroppedBool(!1),this.resetPostions()},setPositions:function(t,e){this.elXYpos=t,this.labelXYpos=e},resetPostions:function(){this.elXYpos.x=-1,this.elXYpos.y=-1,this.labelXYpos.x=-1,this.labelXYpos.y=-1},drawLine:function(t,e,i){if(!i)if(e)var n="lineStyleRed";else var n="lineStyleBlack";var s=1,r=$("#e_"+t).position(),o=$("#label_"+t).position(),a=r.left,h=r.top,l=o.left,c=o.top,u=Math.sqrt((l-a)*(l-a)+(c-h)*(c-h)),d=(a+l)/2-u/2,p=(h+c)/2-s/2,f=Math.atan2(h-c,a-l)*(180/Math.PI);if(i)$("#lineDiv"+t).css({left:d+"px",top:p+"px",width:u+"px",transform:"rotate("+f+"deg)"});else{var m='<div id="lineDiv'+t+'" class="'+n+'" style="left:'+d+"px; top:"+p+"px; width:"+u+"px; -moz-transform:rotate("+f+"deg); -webkit-transform:rotate("+f+"deg); -o-transform:rotate("+f+"deg); -ms-transform:rotate("+f+"deg); transform:rotate("+f+'deg);" />';$("#dropWrapper").append(m)}},setDragEl:function(t){this.dragElements=t},getDragEl:function(t){return this.dragElements}}}}),define("ddUtil/dragDrop",["ddUtil/createDragDropElement","jquery"],function(t,e){function i(e){var i=document.getElementById(e).value;i=JSON.parse(i);for(var s,o=0;o<i.length;o++){s=i[o].mapID;var a="e_"+s,h="container_"+s,l="label_"+s,c=i[o].isNew,u=i[o].labelReplacedBy;if(i[o].x!==-1&&i[o].y!==-1&&i[o].e_x!==-1&&i[o].e_y!==-1){var d=i[o].x,p=i[o].y;$("#dragDropList").append('<div id="'+h+'" class="e_container"></div>'),c?($("#dragDropList").append('<div id="'+h+'" class="e_container"></div>'),$("#dropWrapper").append('<div id="'+a+'" class="dragDropLabelRed">'+i[o].labelName+"</div>")):($("#dragDropList").append('<div id="'+h+'" class="e_container"></div>'),$("#dropWrapper").append('<div id="'+a+'" class="dragDropLabelBlack">'+i[o].labelName+"</div>")),$("#"+a).css({left:d,top:p,position:"absolute"})}else c?$("#dragDropList").append('<div id="'+h+'" class="e_container"><div id="'+a+'" class="dragDropLabelRed">'+i[o].labelName+"</div></div>"):$("#dragDropList").append('<div id="'+h+'" class="e_container"><div id="'+a+'" class="dragDropLabelBlack"><div>'+i[o].labelName+'</div><div class="labelReplacedBy">'+u+"</div></div>");r[o]=new t,r[o].init(a,i[o],l,h,c,u,r);var f=$(".dragDropLabel").width(),m=$(".dragDropLabel").height();if(i[o].x!==-1&&i[o].y!==-1&&i[o].e_x!==-1&&i[o].e_y!==-1){var g="<div>"+i[o].labelName+'</div><div class="labelReplacedBy">'+u+"</div>";n(r[o],s,g,i[o].x,i[o].y,i[o].e_x,i[o].e_y,f,m)}r[o].setDragEl=r}var v=(document.getElementById("dropWrapper"),document.getElementsByClassName("dragDropLabel"),document.getElementById("resetItem"));document.addEventListener("click",function(t){$(".rightClickMenu").css("display","none");for(var e=0;e<r.length;e++)r[e].setReset&&(r[e].setReset=!1)},!1),v.addEventListener("click",function(t){for(var e=0;e<r.length;e++)r[e].setReset&&r[e].resetLabel()},!1)}function n(e,i,n,o,a,h,l,c,u){e.setDroppedBool(!0);var d=($("#dropWrapper").offset(),"label_"+i);e.isNew?($("#e_"+i).removeClass("dragDropLabelRed").addClass("dragDropDotRed").text(""),$("#dropWrapper").append('<div id="'+d+'" class="dragDropLabelRed">'+n+"</div>")):($("#e_"+i).removeClass("dragDropLabelBlack").addClass("dragDropDotBlack").text(""),$("#dropWrapper").append('<div id="'+d+'" class="dragDropLabelBlack">'+n+"</div>"));var p=new t;p.init("","",d,""),$("#"+d).css({left:h,top:l,position:"absolute"}),document.getElementById(d).addEventListener("contextmenu",function(t){t.preventDefault(),$(".rightClickMenu").css({display:"block",left:t.clientX,top:t.clientY});var e=this.id.split("_");e=e[1],e="e_"+e;for(var i=0;i<r.length;i++)r[i].e_id==e?r[i].setReset=!0:r[i].setReset=!1},!1),s(i,e.isNew,!1),$("#label_"+i).draggable("option","containment","#dropWrapper"),$("#e_"+i).draggable("option","containment","#dropWrapper"),p.setDragEl(r)}function s(t,e,i){if(!i)if(e)var n="lineStyleRed";else var n="lineStyleBlack";var s=1,r=$("#e_"+t).position(),o=$("#label_"+t).position(),a=r.left,h=r.top,l=o.left,c=o.top,u=Math.sqrt((l-a)*(l-a)+(c-h)*(c-h)),d=(a+l)/2-u/2,p=(h+c)/2-s/2,f=Math.atan2(h-c,a-l)*(180/Math.PI);if(i)$("#lineDiv"+t).css({left:d+"px",top:p+"px",width:u+"px",transform:"rotate("+f+"deg)"});else{var m='<div id="lineDiv'+t+'" class="'+n+'" style="left:'+d+"px; top:"+p+"px; width:"+u+"px; -moz-transform:rotate("+f+"deg); -webkit-transform:rotate("+f+"deg); -o-transform:rotate("+f+"deg); -ms-transform:rotate("+f+"deg); transform:rotate("+f+'deg);" />';$("#dropWrapper").append(m)}}var r=[];i("jsonInput"),$("#dropWrapper").droppable({tolerance:"fit",drop:function(t,e){var i=$("#dropWrapper"),s=$(e.draggable).width(),o=$(e.draggable).height(),a=i.offset(),h=$(e.draggable).html(),l=$(e.draggable).attr("id"),c=l.split("_");c=c[1];for(var u="e_"+c,d=document.getElementById("label_"+c),p=0;p<r.length;p++)if(r[p].e_id==u)var f=r[p];if("dropWrapper"!=$("#"+u).parent().attr("id")&&($("#"+u).remove(),$("#dropWrapper").append('<div id="'+u+'"></div>'),$("#"+u).css({left:t.clientX-a.left,top:t.clientY-a.top}),f.makeDraggable(r)),t.clientX>i.width()+a.left-s)var m=!0;if(t.clientY<a.top+o)var g=!0;if(t.clientY>i.height()+a.top-80)var v=!0;if(m&&g)var y=t.clientX-a.left-45,x=t.clientY-a.top+40;else if(m&&!g)var y=t.clientX-a.left-45,x=t.clientY-a.top+40;else if(!m&&g)var y=t.clientX-a.left+20,x=t.clientY-a.top+40;else var y=t.clientX-a.left+20,x=t.clientY-a.top+40;if(v)var x=t.clientY-a.top-80;d||n(f,c,h,"","",y,x,s,o);var b=$("#"+u).offset(),w=$("#label_"+c).offset(),_=$("#dropWrapper").offset(),S={x:b.left-_.left,y:b.top-_.top},M={x:w.left-_.left,y:w.top-_.top};f.setPositions(S,M);for(var p=0;p<r.length;p++)(r[p].elXYpos.x>-1||r[p].elXYpos.y>-1)&&(document.getElementById("el"+p).innerHTML=Math.round(r[p].elXYpos.x)+"x , "+Math.round(r[p].elXYpos.y)+"y")}}),document.getElementById("submitJson").addEventListener("click",function(){console.log("json sent")})}),define("jqueryTP",["jquery"],function(t){!function(t){function e(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var i=t.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n)}}if(t.support.touch="ontouchend"in document,t.support.touch){var i,n=t.ui.mouse.prototype,s=n._mouseInit,r=n._mouseDestroy;n._touchStart=function(t){var n=this;!i&&n._mouseCapture(t.originalEvent.changedTouches[0])&&(i=!0,n._touchMoved=!1,e(t,"mouseover"),e(t,"mousemove"),e(t,"mousedown"))},n._touchMove=function(t){i&&(this._touchMoved=!0,e(t,"mousemove"))},n._touchEnd=function(t){i&&(e(t,"mouseup"),e(t,"mouseout"),this._touchMoved||e(t,"click"),i=!1)},n._mouseInit=function(){var e=this;e.element.bind({touchstart:t.proxy(e,"_touchStart"),touchmove:t.proxy(e,"_touchMove"),touchend:t.proxy(e,"_touchEnd")}),s.call(e)},n._mouseDestroy=function(){var e=this;e.element.unbind({touchstart:t.proxy(e,"_touchStart"),touchmove:t.proxy(e,"_touchMove"),touchend:t.proxy(e,"_touchEnd")}),r.call(e)}}}(t)}),function(t,e){"use strict";function i(){return e}"function"==typeof define&&define.amd?define("tinysort",i):t.tinysort=e}(this,function(){"use strict";function t(t){function r(){0===arguments.length?l({}):n(arguments,function(t){l(i(t)?{selector:t}:t)}),g=A.length}function l(t){var e=!!t.selector,i=e&&":"===t.selector[0],n=s(t||{},x);A.push(s({bFind:e,bAttr:!(n.attr===h||""===n.attr),bData:n.data!==h,bFilter:i,mFilter:h,fnSort:n.sortFunction,iAsc:"asc"===n.order?1:-1},n))}function d(){n(t,function(t,e){S?S!==t.parentNode&&(N=!1):S=t.parentNode;var i=A[0],n=i.bFilter,s=i.selector,r=!s||n&&t.matchesSelector(s)||s&&t.querySelector(s),o=r?E:C,a={elm:t,pos:e,posn:o.length};T.push(a),o.push(a)}),_=E.slice(0)}function y(){E.sort(b)}function b(t,s){var r=0;for(0!==v&&(v=0);0===r&&v<g;){var h=A[v],l=h.ignoreDashes?f:p;if(n(m,function(t){var e=t.prepare;e&&e(h)}),h.sortFunction)r=h.sortFunction(t,s);else if("rand"==h.order)r=Math.random()<.5?1:-1;else{var c=a,d=e(t,h),y=e(s,h);if(!h.forceStrings){var x=i(d)?d&&d.match(l):a,b=i(y)?y&&y.match(l):a;if(x&&b){var w=d.substr(0,d.length-x[0].length),_=y.substr(0,y.length-b[0].length);w==_&&(c=!a,d=u(x[0]),y=u(b[0]))}}r=d===o||y===o?0:h.iAsc*(d<y?-1:d>y?1:0)}n(m,function(t){var e=t.sort;e&&(r=e(h,c,d,y,r))}),0===r&&v++}return 0===r&&(r=t.pos>s.pos?1:-1),r}function w(){var t=E.length===T.length;N&&t?(E.forEach(function(t){M.appendChild(t.elm)}),S.appendChild(M)):(E.forEach(function(t){var e=t.elm,i=c.createElement("div");t.ghost=i,e.parentNode.insertBefore(i,e)}),E.forEach(function(t,e){var i=_[e].ghost;i.parentNode.insertBefore(t.elm,i),i.parentNode.removeChild(i)}))}i(t)&&(t=c.querySelectorAll(t)),0===t.length&&console.warn("No elements to sort");var _,S,M=c.createDocumentFragment(),T=[],E=[],C=[],A=[],N=!0;return r.apply(h,Array.prototype.slice.call(arguments,1)),d(),y(),w(),E.map(function(t){return t.elm})}function e(t,e){var n,s=t.elm;return e.selector&&(e.bFilter?s.matchesSelector(e.selector)||(s=h):s=s.querySelector(e.selector)),e.bAttr?n=s.getAttribute(e.attr):e.useVal?n=s.value:e.bData?n=s.getAttribute("data-"+e.data):s&&(n=s.textContent),i(n)&&(e.cases||(n=n.toLowerCase()),n=n.replace(/\s+/g," ")),n}function i(t){return"string"==typeof t}function n(t,e){for(var i,n=t.length,s=n;s--;)i=n-s-1,e(t[i],i)}function s(t,e,i){for(var n in e)(i||t[n]===o)&&(t[n]=e[n]);return t}function r(t,e,i){m.push({prepare:t,sort:e,sortBy:i})}var o,a=!1,h=null,l=window,c=l.document,u=parseFloat,d=Array.prototype.indexOf,p=/(-?\d+\.?\d*)$/g,f=/(\d+\.?\d*)$/g,m=[],g=0,v=0,y="2.1.0",x={selector:h,order:"asc",attr:h,data:h,useVal:a,place:"start",returns:a,cases:a,forceStrings:a,ignoreDashes:a,sortFunction:h};return l.Element&&function(t){t.matchesSelector=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector||function(t){for(var e=this,i=(e.parentNode||e.document).querySelectorAll(t),n=-1;i[++n]&&i[n]!=e;);return!!i[n]}}(Element.prototype),s(r,{indexOf:d,loop:n}),s(t,{plugin:r,version:y,defaults:x})}()),function(){"use strict";var t=this,e=t.Chart,i=function(t){return this.canvas=t.canvas,this.ctx=t,this.width=t.canvas.width,this.height=t.canvas.height,this.aspectRatio=this.width/this.height,n.retinaScale(this),this};i.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,customTooltips:!1,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}},i.types={};var n=i.helpers={},s=n.each=function(t,e,i){var n=Array.prototype.slice.call(arguments,3);if(t)if(t.length===+t.length){var s;for(s=0;s<t.length;s++)e.apply(i,[t[s],s].concat(n))}else for(var r in t)e.apply(i,[t[r],r].concat(n))},r=n.clone=function(t){var e={};return s(t,function(i,n){t.hasOwnProperty(n)&&(e[n]=i)}),e},o=n.extend=function(t){return s(Array.prototype.slice.call(arguments,1),function(e){s(e,function(i,n){e.hasOwnProperty(n)&&(t[n]=i)})}),t},a=n.merge=function(){var t=Array.prototype.slice.call(arguments,0);return t.unshift({}),o.apply(null,t)},h=n.indexOf=function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},l=(n.where=function(t,e){var i=[];return n.each(t,function(t){e(t)&&i.push(t)}),i},n.findNextWhere=function(t,e,i){i||(i=-1);for(var n=i+1;n<t.length;n++){var s=t[n];if(e(s))return s}},n.findPreviousWhere=function(t,e,i){i||(i=t.length);for(var n=i-1;n>=0;n--){var s=t[n];if(e(s))return s}},n.inherits=function(t){var e=this,i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=e.prototype,i.prototype=new n,i.extend=l,t&&o(i.prototype,t),i.__super__=e.prototype,i}),c=n.noop=function(){},u=n.uid=function(){var t=0;return function(){return"chart-"+t++}}(),d=n.warn=function(t){window.console&&"function"==typeof window.console.warn&&console.warn(t)},p=n.amd="function"==typeof define&&define.amd,f=n.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},m=n.max=function(t){return Math.max.apply(Math,t)},g=n.min=function(t){return Math.min.apply(Math,t)},v=(n.cap=function(t,e,i){if(f(e)){if(t>e)return e}else if(f(i)&&i>t)return i;return t},n.getDecimalPlaces=function(t){return t%1!==0&&f(t)?t.toString().split(".")[1].length:0}),y=n.radians=function(t){return t*(Math.PI/180)},x=(n.getAngleFromPoint=function(t,e){var i=e.x-t.x,n=e.y-t.y,s=Math.sqrt(i*i+n*n),r=2*Math.PI+Math.atan2(n,i);return 0>i&&0>n&&(r+=2*Math.PI),{angle:r,distance:s}},n.aliasPixel=function(t){return t%2===0?0:.5}),b=(n.splineCurve=function(t,e,i,n){var s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)),o=n*s/(s+r),a=n*r/(s+r);return{inner:{x:e.x-o*(i.x-t.x),y:e.y-o*(i.y-t.y)},outer:{x:e.x+a*(i.x-t.x),y:e.y+a*(i.y-t.y)}}},n.calculateOrderOfMagnitude=function(t){return Math.floor(Math.log(t)/Math.LN10)}),w=(n.calculateScaleRange=function(t,e,i,n,s){var r=2,o=Math.floor(e/(1.5*i)),a=r>=o,h=m(t),l=g(t);h===l&&(h+=.5,l>=.5&&!n?l-=.5:h+=.5);for(var c=Math.abs(h-l),u=b(c),d=Math.ceil(h/(1*Math.pow(10,u)))*Math.pow(10,u),p=n?0:Math.floor(l/(1*Math.pow(10,u)))*Math.pow(10,u),f=d-p,v=Math.pow(10,u),y=Math.round(f/v);(y>o||o>2*y)&&!a;)if(y>o)v*=2,y=Math.round(f/v),y%1!==0&&(a=!0);else if(s&&u>=0){if(v/2%1!==0)break;v/=2,y=Math.round(f/v)}else v/=2,y=Math.round(f/v);return a&&(y=r,v=f/y),{steps:y,stepValue:v,min:p,max:p+y*v}},n.template=function(t,e){function i(t,e){var i=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):n[t]=n[t];return e?i(e):i}if(t instanceof Function)return t(e);var n={};return i(t,e)}),_=(n.generateLabels=function(t,e,i,n){var r=new Array(e);return labelTemplateString&&s(r,function(e,s){r[s]=w(t,{value:i+n*(s+1)})}),r},n.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1==(t/=1)?1:(i||(i=.3),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i)))},easeOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1==(t/=1)?1:(i||(i=.3),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(1*t-e)*Math.PI/i)+1)},easeInOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2==(t/=.5)?1:(i||(i=.3*1.5),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i)*.5+1)},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:function(t){return 1-_.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*_.easeInBounce(2*t):.5*_.easeOutBounce(2*t-1)+.5}}),S=n.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),M=(n.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),n.animationLoop=function(t,e,i,n,s,r){var o=0,a=_[i]||_.linear,h=function(){o++;var i=o/e,l=a(i);t.call(r,l,i,o),n.call(r,l,i),e>o?r.animationFrame=S(h):s.apply(r)};S(h)},n.getRelativePosition=function(t){var e,i,n=t.originalEvent||t,s=t.currentTarget||t.srcElement,r=s.getBoundingClientRect();return n.touches?(e=n.touches[0].clientX-r.left,i=n.touches[0].clientY-r.top):(e=n.clientX-r.left,i=n.clientY-r.top),{x:e,y:i}},n.addEvent=function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i}),T=n.removeEvent=function(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=c},E=(n.bindEvents=function(t,e,i){t.events||(t.events={}),s(e,function(e){t.events[e]=function(){i.apply(t,arguments)},M(t.chart.canvas,e,t.events[e])})},n.unbindEvents=function(t,e){s(e,function(e,i){T(t.chart.canvas,i,e)})}),C=n.getMaximumWidth=function(t){var e=t.parentNode;return e.clientWidth},A=n.getMaximumHeight=function(t){var e=t.parentNode;return e.clientHeight},N=(n.getMaximumSize=n.getMaximumWidth,n.retinaScale=function(t){var e=t.ctx,i=t.canvas.width,n=t.canvas.height;window.devicePixelRatio&&(e.canvas.style.width=i+"px",e.canvas.style.height=n+"px",e.canvas.height=n*window.devicePixelRatio,e.canvas.width=i*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio))}),L=n.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},P=n.fontString=function(t,e,i){return e+" "+t+"px "+i},k=n.longestText=function(t,e,i){t.font=e;var n=0;return s(i,function(e){var i=t.measureText(e).width;n=i>n?i:n}),n},I=n.drawRoundedRectangle=function(t,e,i,n,s,r){t.beginPath(),t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.quadraticCurveTo(e+n,i,e+n,i+r),t.lineTo(e+n,i+s-r),t.quadraticCurveTo(e+n,i+s,e+n-r,i+s),t.lineTo(e+r,i+s),t.quadraticCurveTo(e,i+s,e,i+s-r),t.lineTo(e,i+r),t.quadraticCurveTo(e,i,e+r,i),t.closePath()};i.instances={},i.Type=function(t,e,n){this.options=e,this.chart=n,this.id=u(),i.instances[this.id]=this,e.responsive&&this.resize(),this.initialize.call(this,t)},o(i.Type.prototype,{initialize:function(){return this},clear:function(){return L(this.chart),this},stop:function(){return n.cancelAnimFrame.call(t,this.animationFrame),this},resize:function(t){this.stop();var e=this.chart.canvas,i=C(this.chart.canvas),n=this.options.maintainAspectRatio?i/this.chart.aspectRatio:A(this.chart.canvas);return e.width=this.chart.width=i,e.height=this.chart.height=n,N(this.chart),"function"==typeof t&&t.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:c,render:function(t){return t&&this.reflow(),this.options.animation&&!t?n.animationLoop(this.draw,this.options.animationSteps,this.options.animationEasing,this.options.onAnimationProgress,this.options.onAnimationComplete,this):(this.draw(),this.options.onAnimationComplete.call(this)),this},generateLegend:function(){return w(this.options.legendTemplate,this)},destroy:function(){this.clear(),E(this,this.events);var t=this.chart.canvas;t.width=this.chart.width,t.height=this.chart.height,t.style.removeProperty?(t.style.removeProperty("width"),t.style.removeProperty("height")):(t.style.removeAttribute("width"),t.style.removeAttribute("height")),delete i.instances[this.id]},showTooltip:function(t,e){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var r=function(t){var e=!1;return t.length!==this.activeElements.length?e=!0:(s(t,function(t,i){t!==this.activeElements[i]&&(e=!0)},this),e)}.call(this,t);if(r||e){if(this.activeElements=t,this.draw(),this.options.customTooltips&&this.options.customTooltips(!1),t.length>0)if(this.datasets&&this.datasets.length>1){for(var o,a,l=this.datasets.length-1;l>=0&&(o=this.datasets[l].points||this.datasets[l].bars||this.datasets[l].segments,a=h(o,t[0]),-1===a);l--);var c=[],u=[],d=function(){var t,e,i,s,r,o=[],h=[],l=[];return n.each(this.datasets,function(e){t=e.points||e.bars||e.segments,t[a]&&t[a].hasValue()&&o.push(t[a])}),n.each(o,function(t){h.push(t.x),l.push(t.y),c.push(n.template(this.options.multiTooltipTemplate,t)),u.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),r=g(l),i=m(l),s=g(h),e=m(h),{x:s>this.chart.width/2?s:e,y:(r+i)/2}}.call(this,a);new i.MultiTooltip({x:d.x,y:d.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:c,legendColors:u,legendColorBackground:this.options.multiTooltipKeyBackground,title:t[0].label,chart:this.chart,ctx:this.chart.ctx,custom:this.options.customTooltips}).draw()}else s(t,function(t){var e=t.tooltipPosition();new i.Tooltip({x:Math.round(e.x),y:Math.round(e.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:w(this.options.tooltipTemplate,t),chart:this.chart,custom:this.options.customTooltips}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),i.Type.extend=function(t){var e=this,n=function(){return e.apply(this,arguments)};if(n.prototype=r(e.prototype),o(n.prototype,t),n.extend=i.Type.extend,t.name||e.prototype.name){var s=t.name||e.prototype.name,h=i.defaults[e.prototype.name]?r(i.defaults[e.prototype.name]):{};i.defaults[s]=o(h,t.defaults),i.types[s]=n,i.prototype[s]=function(t,e){var r=a(i.defaults.global,i.defaults[s],e||{});return new n(t,r,this)}}else d("Name not provided for this chart, so it hasn't been registered");return e},i.Element=function(t){o(this,t),this.initialize.apply(this,arguments),this.save()},o(i.Element.prototype,{initialize:function(){},restore:function(t){return t?s(t,function(t){this[t]=this._saved[t]},this):o(this,this._saved),this},save:function(){return this._saved=r(this),delete this._saved._saved,this},update:function(t){return s(t,function(t,e){this._saved[e]=this[e],this[e]=t},this),this},transition:function(t,e){return s(t,function(t,i){this[i]=(t-this._saved[i])*e+this._saved[i]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return f(this.value)}}),i.Element.extend=l,i.Point=i.Element.extend({display:!0,inRange:function(t,e){var i=this.hitDetectionRadius+this.radius;return Math.pow(t-this.x,2)+Math.pow(e-this.y,2)<Math.pow(i,2)},draw:function(){if(this.display){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.stroke()}}}),i.Arc=i.Element.extend({inRange:function(t,e){var i=n.getAngleFromPoint(this,{x:t,y:e}),s=i.angle>=this.startAngle&&i.angle<=this.endAngle,r=i.distance>=this.innerRadius&&i.distance<=this.outerRadius;return s&&r},tooltipPosition:function(){var t=this.startAngle+(this.endAngle-this.startAngle)/2,e=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(t)*e,y:this.y+Math.sin(t)*e}},draw:function(t){var e=this.ctx;e.beginPath(),e.arc(this.x,this.y,this.outerRadius,this.startAngle,this.endAngle),e.arc(this.x,this.y,this.innerRadius,this.endAngle,this.startAngle,!0),e.closePath(),e.strokeStyle=this.strokeColor,e.lineWidth=this.strokeWidth,e.fillStyle=this.fillColor,e.fill(),e.lineJoin="bevel",this.showStroke&&e.stroke()}}),i.Rectangle=i.Element.extend({draw:function(){var t=this.ctx,e=this.width/2,i=this.x-e,n=this.x+e,s=this.base-(this.base-this.y),r=this.strokeWidth/2;this.showStroke&&(i+=r,n-=r,s+=r),t.beginPath(),t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.moveTo(i,this.base),t.lineTo(i,s),t.lineTo(n,s),t.lineTo(n,this.base),t.fill(),this.showStroke&&t.stroke()},height:function(){return this.base-this.y},inRange:function(t,e){return t>=this.x-this.width/2&&t<=this.x+this.width/2&&e>=this.y&&e<=this.base}}),i.Tooltip=i.Element.extend({draw:function(){var t=this.chart.ctx;t.font=P(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var e=this.caretPadding=2,i=t.measureText(this.text).width+2*this.xPadding,n=this.fontSize+2*this.yPadding,s=n+this.caretHeight+e;this.x+i/2>this.chart.width?this.xAlign="left":this.x-i/2<0&&(this.xAlign="right"),this.y-s<0&&(this.yAlign="below");var r=this.x-i/2,o=this.y-s;if(t.fillStyle=this.fillColor,this.custom)this.custom(this);else{switch(this.yAlign){case"above":t.beginPath(),t.moveTo(this.x,this.y-e),t.lineTo(this.x+this.caretHeight,this.y-(e+this.caretHeight)),t.lineTo(this.x-this.caretHeight,this.y-(e+this.caretHeight)),t.closePath(),t.fill();break;case"below":o=this.y+e+this.caretHeight,t.beginPath(),t.moveTo(this.x,this.y+e),t.lineTo(this.x+this.caretHeight,this.y+e+this.caretHeight),t.lineTo(this.x-this.caretHeight,this.y+e+this.caretHeight),t.closePath(),t.fill()}switch(this.xAlign){case"left":r=this.x-i+(this.cornerRadius+this.caretHeight);break;case"right":r=this.x-(this.cornerRadius+this.caretHeight)}I(t,r,o,i,n,this.cornerRadius),t.fill(),t.fillStyle=this.textColor,t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,r+i/2,o+n/2)}}}),i.MultiTooltip=i.Element.extend({initialize:function(){this.font=P(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=P(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+1.5*this.titleFontSize,this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,e=k(this.ctx,this.font,this.labels)+this.fontSize+3,i=m([e,t]);this.width=i+2*this.xPadding;var n=this.height/2;this.y-n<0?this.y=n:this.y+n>this.chart.height&&(this.y=this.chart.height-n),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(t){var e=this.y-this.height/2+this.yPadding,i=t-1;return 0===t?e+this.titleFontSize/2:e+(1.5*this.fontSize*i+this.fontSize/2)+1.5*this.titleFontSize},draw:function(){if(this.custom)this.custom(this);else{I(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor,t.fill(),t.closePath(),t.textAlign="left",t.textBaseline="middle",t.fillStyle=this.titleTextColor,t.font=this.titleFont,t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),t.font=this.font,n.each(this.labels,function(e,i){t.fillStyle=this.textColor,t.fillText(e,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(i+1)),t.fillStyle=this.legendColorBackground,t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize),t.fillStyle=this.legendColors[i].fill,t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize);
},this)}}}),i.Scale=i.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(w(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?k(this.ctx,this.font,this.yLabels):0},addXLabel:function(t){this.xLabels.push(t),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var t,e=this.endPoint-this.startPoint;for(this.calculateYRange(e),this.buildYLabels(),this.calculateXLabelRotation();e>this.endPoint-this.startPoint;)e=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(e),this.buildYLabels(),t<this.yLabelWidth&&this.calculateXLabelRotation()},calculateXLabelRotation:function(){this.ctx.font=this.font;var t,e,i=this.ctx.measureText(this.xLabels[0]).width,n=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=n/2+3,this.xScalePaddingLeft=i/2>this.yLabelWidth+10?i/2:this.yLabelWidth+10,this.xLabelRotation=0,this.display){var s,r=k(this.ctx,this.font,this.xLabels);this.xLabelWidth=r;for(var o=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>o&&0===this.xLabelRotation||this.xLabelWidth>o&&this.xLabelRotation<=90&&this.xLabelRotation>0;)s=Math.cos(y(this.xLabelRotation)),t=s*i,e=s*n,t+this.fontSize/2>this.yLabelWidth+8&&(this.xScalePaddingLeft=t+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=s*r;this.xLabelRotation>0&&(this.endPoint-=Math.sin(y(this.xLabelRotation))*r+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:c,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(t){var e=this.drawingArea()/(this.min-this.max);return this.endPoint-e*(t-this.min)},calculateX:function(t){var e=(this.xLabelRotation>0,this.width-(this.xScalePaddingLeft+this.xScalePaddingRight)),i=e/(this.valuesCount-(this.offsetGridLines?0:1)),n=i*t+this.xScalePaddingLeft;return this.offsetGridLines&&(n+=i/2),Math.round(n)},update:function(t){n.extend(this,t),this.fit()},draw:function(){var t=this.ctx,e=(this.endPoint-this.startPoint)/this.steps,i=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,s(this.yLabels,function(s,r){var o=this.endPoint-e*r,a=Math.round(o),h=this.showHorizontalLines;t.textAlign="right",t.textBaseline="middle",this.showLabels&&t.fillText(s,i-10,o),0!==r||h||(h=!0),h&&t.beginPath(),r>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),a+=n.aliasPixel(t.lineWidth),h&&(t.moveTo(i,a),t.lineTo(this.width,a),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(i-5,a),t.lineTo(i,a),t.stroke(),t.closePath()},this),s(this.xLabels,function(e,i){var n=this.calculateX(i)+x(this.lineWidth),s=this.calculateX(i-(this.offsetGridLines?.5:0))+x(this.lineWidth),r=this.xLabelRotation>0,o=this.showVerticalLines;0!==i||o||(o=!0),o&&t.beginPath(),i>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),o&&(t.moveTo(s,this.endPoint),t.lineTo(s,this.startPoint-3),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(s,this.endPoint),t.lineTo(s,this.endPoint+5),t.stroke(),t.closePath(),t.save(),t.translate(n,r?this.endPoint+12:this.endPoint+8),t.rotate(-1*y(this.xLabelRotation)),t.font=this.font,t.textAlign=r?"right":"center",t.textBaseline=r?"middle":"top",t.fillText(e,0,0),t.restore()},this))}}),i.RadialScale=i.Element.extend({initialize:function(){this.size=g([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(t){var e=this.drawingArea/(this.max-this.min);return(t-this.min)*e},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(w(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var t,e,i,n,s,r,o,a,h,l,c,u,d=g([this.height/2-this.pointLabelFontSize-5,this.width/2]),p=this.width,m=0;for(this.ctx.font=P(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),e=0;e<this.valuesCount;e++)t=this.getPointPosition(e,d),i=this.ctx.measureText(w(this.templateString,{value:this.labels[e]})).width+5,0===e||e===this.valuesCount/2?(n=i/2,t.x+n>p&&(p=t.x+n,s=e),t.x-n<m&&(m=t.x-n,o=e)):e<this.valuesCount/2?t.x+i>p&&(p=t.x+i,s=e):e>this.valuesCount/2&&t.x-i<m&&(m=t.x-i,o=e);h=m,l=Math.ceil(p-this.width),r=this.getIndexAngle(s),a=this.getIndexAngle(o),c=l/Math.sin(r+Math.PI/2),u=h/Math.sin(a+Math.PI/2),c=f(c)?c:0,u=f(u)?u:0,this.drawingArea=d-(u+c)/2,this.setCenterPoint(u,c)},setCenterPoint:function(t,e){var i=this.width-e-this.drawingArea,n=t+this.drawingArea;this.xCenter=(n+i)/2,this.yCenter=this.height/2},getIndexAngle:function(t){var e=2*Math.PI/this.valuesCount;return t*e-Math.PI/2},getPointPosition:function(t,e){var i=this.getIndexAngle(t);return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},draw:function(){if(this.display){var t=this.ctx;if(s(this.yLabels,function(e,i){if(i>0){var n,s=i*(this.drawingArea/this.steps),r=this.yCenter-s;if(this.lineWidth>0)if(t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,this.lineArc)t.beginPath(),t.arc(this.xCenter,this.yCenter,s,0,2*Math.PI),t.closePath(),t.stroke();else{t.beginPath();for(var o=0;o<this.valuesCount;o++)n=this.getPointPosition(o,this.calculateCenterOffset(this.min+i*this.stepValue)),0===o?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y);t.closePath(),t.stroke()}if(this.showLabels){if(t.font=P(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var a=t.measureText(e).width;t.fillStyle=this.backdropColor,t.fillRect(this.xCenter-a/2-this.backdropPaddingX,r-this.fontSize/2-this.backdropPaddingY,a+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.fontColor,t.fillText(e,this.xCenter,r)}}},this),!this.lineArc){t.lineWidth=this.angleLineWidth,t.strokeStyle=this.angleLineColor;for(var e=this.valuesCount-1;e>=0;e--){if(this.angleLineWidth>0){var i=this.getPointPosition(e,this.calculateCenterOffset(this.max));t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(i.x,i.y),t.stroke(),t.closePath()}var n=this.getPointPosition(e,this.calculateCenterOffset(this.max)+5);t.font=P(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),t.fillStyle=this.pointLabelFontColor;var r=this.labels.length,o=this.labels.length/2,a=o/2,h=a>e||e>r-a,l=e===a||e===r-a;t.textAlign=0===e?"center":e===o?"center":o>e?"left":"right",t.textBaseline=l?"middle":h?"bottom":"top",t.fillText(this.labels[e],n.x,n.y)}}}}}),n.addEvent(window,"resize",function(){var t;return function(){clearTimeout(t),t=setTimeout(function(){s(i.instances,function(t){t.options.responsive&&t.resize(t.render,!0)})},50)}}()),p?define("chartjs",[],function(){return i}):"object"==typeof module&&module.exports&&(module.exports=i),t.Chart=i,i.noConflict=function(){return t.Chart=e,i}}.call(this),function(){"use strict";var t=this,e=t.Chart,i=e.helpers,n={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"Bar",defaults:n,initialize:function(t){var n=this.options;this.ScaleClass=e.Scale.extend({offsetGridLines:!0,calculateBarX:function(t,e,i){var s=this.calculateBaseWidth(),r=this.calculateX(i)-s/2,o=this.calculateBarWidth(t);return r+o*e+e*n.barDatasetSpacing+o/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*n.barValueSpacing},calculateBarWidth:function(t){var e=this.calculateBaseWidth()-(t-1)*n.barDatasetSpacing;return e/t}}),this.datasets=[],this.options.showTooltips&&i.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getBarsAtEvent(t):[];this.eachBars(function(t){t.restore(["fillColor","strokeColor"])}),i.each(e,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(e)}),this.BarClass=e.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx}),i.each(t.datasets,function(e){var n={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,bars:[]};this.datasets.push(n),i.each(e.data,function(i,s){n.bars.push(new this.BarClass({value:i,label:t.labels[s],datasetLabel:e.label,strokeColor:e.strokeColor,fillColor:e.fillColor,highlightFill:e.highlightFill||e.fillColor,highlightStroke:e.highlightStroke||e.strokeColor}))},this)},this),this.buildScale(t.labels),this.BarClass.prototype.base=this.scale.endPoint,this.eachBars(function(t,e,n){i.extend(t,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,n,e),y:this.scale.endPoint}),t.save()},this),this.render()},update:function(){this.scale.update(),i.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachBars(function(t){t.save()}),this.render()},eachBars:function(t){i.each(this.datasets,function(e,n){i.each(e.bars,t,this,n)},this)},getBarsAtEvent:function(t){for(var e,n=[],s=i.getRelativePosition(t),r=function(t){n.push(t.bars[e])},o=0;o<this.datasets.length;o++)for(e=0;e<this.datasets[o].bars.length;e++)if(this.datasets[o].bars[e].inRange(s.x,s.y))return i.each(this.datasets,r),n;return n},buildScale:function(t){var e=this,n=function(){var t=[];return e.eachBars(function(e){t.push(e.value)}),t},s={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var e=i.calculateScaleRange(n(),t,this.fontSize,this.beginAtZero,this.integersOnly);i.extend(this,e)},xLabels:t,font:i.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&i.extend(s,{calculateYRange:i.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new this.ScaleClass(s)},addData:function(t,e){i.each(t,function(t,i){this.datasets[i].bars.push(new this.BarClass({value:t,label:e,x:this.scale.calculateBarX(this.datasets.length,i,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[i].strokeColor,fillColor:this.datasets[i].fillColor}))},this),this.scale.addXLabel(e),this.update()},removeData:function(){this.scale.removeXLabel(),i.each(this.datasets,function(t){t.bars.shift()},this),this.update()},reflow:function(){i.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});var t=i.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var e=t||1;this.clear(),this.chart.ctx,this.scale.draw(e),i.each(this.datasets,function(t,n){i.each(t.bars,function(t,i){t.hasValue()&&(t.base=this.scale.endPoint,t.transition({x:this.scale.calculateBarX(this.datasets.length,n,i),y:this.scale.calculateY(t.value),width:this.scale.calculateBarWidth(this.datasets.length)},e).draw())},this)},this)}})}.call(this),function(){"use strict";var t=this,e=t.Chart,i=e.helpers,n={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"Doughnut",defaults:n,initialize:function(t){this.segments=[],this.outerRadius=(i.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=e.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&i.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];i.each(this.segments,function(t){t.restore(["fillColor"])}),i.each(e,function(t){t.fillColor=t.highlightColor}),this.showTooltip(e)}),this.calculateTotal(t),i.each(t,function(t,e){this.addData(t,e,!0)},this),this.render()},getSegmentsAtEvent:function(t){var e=[],n=i.getRelativePosition(t);return i.each(this.segments,function(t){t.inRange(n.x,n.y)&&e.push(t)},this),e},addData:function(t,e,i){var n=e||this.segments.length;this.segments.splice(n,0,new this.SegmentArc({value:t.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:t.color,highlightColor:t.highlight||t.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(t.value),label:t.label})),i||(this.reflow(),this.update())},calculateCircumference:function(t){return 2*Math.PI*(t/this.total)},calculateTotal:function(t){this.total=0,i.each(t,function(t){this.total+=t.value},this)},update:function(){this.calculateTotal(this.segments),i.each(this.activeElements,function(t){t.restore(["fillColor"])}),i.each(this.segments,function(t){t.save()}),this.render()},removeData:function(t){var e=i.isNumber(t)?t:this.segments.length-1;this.segments.splice(e,1),this.reflow(),this.update()},reflow:function(){i.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(i.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,i.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var e=t?t:1;this.clear(),i.each(this.segments,function(t,i){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},e),t.endAngle=t.startAngle+t.circumference,t.draw(),0===i&&(t.startAngle=1.5*Math.PI),i<this.segments.length-1&&(this.segments[i+1].startAngle=t.endAngle)},this)}}),e.types.Doughnut.extend({name:"Pie",defaults:i.merge(n,{percentageInnerCutout:0})})}.call(this),function(){"use strict";var t=this,e=t.Chart,i=e.helpers,n={scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"Line",defaults:n,initialize:function(t){this.PointClass=e.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(t){return Math.pow(t-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}}),this.datasets=[],this.options.showTooltips&&i.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),i.each(e,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(e)}),i.each(t.datasets,function(e){var n={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,pointColor:e.pointColor,pointStrokeColor:e.pointStrokeColor,points:[]};this.datasets.push(n),i.each(e.data,function(i,s){n.points.push(new this.PointClass({value:i,label:t.labels[s],datasetLabel:e.label,strokeColor:e.pointStrokeColor,fillColor:e.pointColor,highlightFill:e.pointHighlightFill||e.pointColor,highlightStroke:e.pointHighlightStroke||e.pointStrokeColor}))},this),this.buildScale(t.labels),this.eachPoints(function(t,e){i.extend(t,{x:this.scale.calculateX(e),y:this.scale.endPoint}),t.save()},this)},this),this.render()},update:function(){this.scale.update(),i.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachPoints(function(t){t.save()}),this.render()},eachPoints:function(t){i.each(this.datasets,function(e){i.each(e.points,t,this)},this)},getPointsAtEvent:function(t){var e=[],n=i.getRelativePosition(t);return i.each(this.datasets,function(t){i.each(t.points,function(t){t.inRange(n.x,n.y)&&e.push(t)})},this),e},buildScale:function(t){var n=this,s=function(){var t=[];return n.eachPoints(function(e){t.push(e.value)}),t},r={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var e=i.calculateScaleRange(s(),t,this.fontSize,this.beginAtZero,this.integersOnly);i.extend(this,e)},xLabels:t,font:i.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&i.extend(r,{calculateYRange:i.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new e.Scale(r)},addData:function(t,e){i.each(t,function(t,i){this.datasets[i].points.push(new this.PointClass({value:t,label:e,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[i].pointStrokeColor,fillColor:this.datasets[i].pointColor}))},this),this.scale.addXLabel(e),this.update()},removeData:function(){this.scale.removeXLabel(),i.each(this.datasets,function(t){t.points.shift()},this),this.update()},reflow:function(){var t=i.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var e=t||1;this.clear();var n=this.chart.ctx,s=function(t){return null!==t.value},r=function(t,e,n){return i.findNextWhere(e,s,n)||t},o=function(t,e,n){return i.findPreviousWhere(e,s,n)||t};this.scale.draw(e),i.each(this.datasets,function(t){var a=i.where(t.points,s);i.each(t.points,function(t,i){t.hasValue()&&t.transition({y:this.scale.calculateY(t.value),x:this.scale.calculateX(i)},e)},this),this.options.bezierCurve&&i.each(a,function(t,e){var n=e>0&&e<a.length-1?this.options.bezierCurveTension:0;t.controlPoints=i.splineCurve(o(t,a,e),t,r(t,a,e),n),t.controlPoints.outer.y>this.scale.endPoint?t.controlPoints.outer.y=this.scale.endPoint:t.controlPoints.outer.y<this.scale.startPoint&&(t.controlPoints.outer.y=this.scale.startPoint),t.controlPoints.inner.y>this.scale.endPoint?t.controlPoints.inner.y=this.scale.endPoint:t.controlPoints.inner.y<this.scale.startPoint&&(t.controlPoints.inner.y=this.scale.startPoint)},this),n.lineWidth=this.options.datasetStrokeWidth,n.strokeStyle=t.strokeColor,n.beginPath(),i.each(a,function(t,e){if(0===e)n.moveTo(t.x,t.y);else if(this.options.bezierCurve){var i=o(t,a,e);n.bezierCurveTo(i.controlPoints.outer.x,i.controlPoints.outer.y,t.controlPoints.inner.x,t.controlPoints.inner.y,t.x,t.y)}else n.lineTo(t.x,t.y)},this),n.stroke(),this.options.datasetFill&&a.length>0&&(n.lineTo(a[a.length-1].x,this.scale.endPoint),n.lineTo(a[0].x,this.scale.endPoint),n.fillStyle=t.fillColor,n.closePath(),n.fill()),i.each(a,function(t){t.draw()})},this)}})}.call(this),function(){"use strict";var t=this,e=t.Chart,i=e.helpers,n={scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:!0,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:!0,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"PolarArea",defaults:n,initialize:function(t){this.segments=[],this.SegmentArc=e.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2}),this.scale=new e.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:!0,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:t.length}),this.updateScaleRange(t),this.scale.update(),i.each(t,function(t,e){this.addData(t,e,!0)},this),this.options.showTooltips&&i.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];i.each(this.segments,function(t){t.restore(["fillColor"])}),i.each(e,function(t){t.fillColor=t.highlightColor}),this.showTooltip(e)}),this.render()},getSegmentsAtEvent:function(t){var e=[],n=i.getRelativePosition(t);return i.each(this.segments,function(t){t.inRange(n.x,n.y)&&e.push(t)},this),e},addData:function(t,e,i){var n=e||this.segments.length;this.segments.splice(n,0,new this.SegmentArc({fillColor:t.color,highlightColor:t.highlight||t.color,label:t.label,value:t.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(t.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:1.5*Math.PI})),i||(this.reflow(),this.update())},removeData:function(t){var e=i.isNumber(t)?t:this.segments.length-1;this.segments.splice(e,1),this.reflow(),this.update()},calculateTotal:function(t){this.total=0,i.each(t,function(t){this.total+=t.value},this),this.scale.valuesCount=this.segments.length},updateScaleRange:function(t){var e=[];i.each(t,function(t){e.push(t.value)});var n=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:i.calculateScaleRange(e,i.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);i.extend(this.scale,n,{size:i.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments),i.each(this.segments,function(t){t.save()}),this.render()},reflow:function(){i.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.updateScaleRange(this.segments),this.scale.update(),i.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2}),i.each(this.segments,function(t){t.update({outerRadius:this.scale.calculateCenterOffset(t.value)})},this)},draw:function(t){var e=t||1;this.clear(),i.each(this.segments,function(t,i){t.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(t.value)},e),t.endAngle=t.startAngle+t.circumference,0===i&&(t.startAngle=1.5*Math.PI),i<this.segments.length-1&&(this.segments[i+1].startAngle=t.endAngle),t.draw()},this),this.scale.draw()}})}.call(this),function(){"use strict";var t=this,e=t.Chart,i=e.helpers;e.Type.extend({name:"Radar",defaults:{scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},initialize:function(t){this.PointClass=e.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx}),this.datasets=[],this.buildScale(t),this.options.showTooltips&&i.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),i.each(e,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(e)}),i.each(t.datasets,function(e){var n={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,pointColor:e.pointColor,pointStrokeColor:e.pointStrokeColor,points:[]};this.datasets.push(n),i.each(e.data,function(i,s){var r;this.scale.animation||(r=this.scale.getPointPosition(s,this.scale.calculateCenterOffset(i))),n.points.push(new this.PointClass({value:i,label:t.labels[s],datasetLabel:e.label,x:this.options.animation?this.scale.xCenter:r.x,y:this.options.animation?this.scale.yCenter:r.y,strokeColor:e.pointStrokeColor,fillColor:e.pointColor,highlightFill:e.pointHighlightFill||e.pointColor,highlightStroke:e.pointHighlightStroke||e.pointStrokeColor}))},this)},this),this.render()},eachPoints:function(t){i.each(this.datasets,function(e){i.each(e.points,t,this)},this)},getPointsAtEvent:function(t){var e=i.getRelativePosition(t),n=i.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},e),s=2*Math.PI/this.scale.valuesCount,r=Math.round((n.angle-1.5*Math.PI)/s),o=[];return(r>=this.scale.valuesCount||0>r)&&(r=0),n.distance<=this.scale.drawingArea&&i.each(this.datasets,function(t){o.push(t.points[r])}),o},buildScale:function(t){this.scale=new e.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:t.labels,valuesCount:t.datasets[0].data.length}),this.scale.setScaleSize(),this.updateScaleRange(t.datasets),this.scale.buildYLabels()},updateScaleRange:function(t){var e=function(){var e=[];return i.each(t,function(t){t.data?e=e.concat(t.data):i.each(t.points,function(t){e.push(t.value)})}),e}(),n=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:i.calculateScaleRange(e,i.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);i.extend(this.scale,n)},addData:function(t,e){this.scale.valuesCount++,i.each(t,function(t,i){var n=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(t));this.datasets[i].points.push(new this.PointClass({value:t,label:e,x:n.x,y:n.y,strokeColor:this.datasets[i].pointStrokeColor,fillColor:this.datasets[i].pointColor}))},this),this.scale.labels.push(e),this.reflow(),this.update()},removeData:function(){this.scale.valuesCount--,this.scale.labels.shift(),i.each(this.datasets,function(t){t.points.shift()},this),this.reflow(),this.update()},update:function(){this.eachPoints(function(t){t.save()}),this.reflow(),this.render()},reflow:function(){i.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:i.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2}),this.updateScaleRange(this.datasets),this.scale.setScaleSize(),this.scale.buildYLabels()},draw:function(t){var e=t||1,n=this.chart.ctx;this.clear(),this.scale.draw(),i.each(this.datasets,function(t){i.each(t.points,function(t,i){t.hasValue()&&t.transition(this.scale.getPointPosition(i,this.scale.calculateCenterOffset(t.value)),e)},this),n.lineWidth=this.options.datasetStrokeWidth,n.strokeStyle=t.strokeColor,n.beginPath(),i.each(t.points,function(t,e){0===e?n.moveTo(t.x,t.y):n.lineTo(t.x,t.y);
},this),n.closePath(),n.stroke(),n.fillStyle=t.fillColor,n.fill(),i.each(t.points,function(t){t.hasValue()&&t.draw()})},this)}})}.call(this),function(t){var e=!1,i=!1,n=5e3,s=2e3,r=0,o=function(){var t=document.getElementsByTagName("script"),t=t[t.length-1].src.split("?")[0];return 0<t.split("/").length?t.split("/").slice(0,-1).join("/")+"/":""}();Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=0,n=this.length;i<n;++i)t.call(e,this[i],i,this)});var h=window.requestAnimationFrame||!1,l=window.cancelAnimationFrame||!1;["ms","moz","webkit","o"].forEach(function(t){h||(h=window[t+"RequestAnimationFrame"]),l||(l=window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"])});var c=window.MutationObserver||window.WebKitMutationObserver||!1,u={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#888888",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1,bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:400,nativeparentscrolling:!0,enablescrollonselection:!0,overflowx:!0,overflowy:!0,cursordragspeed:.3,rtlmode:!1,cursordragontouch:!1},d=!1,p=function(){if(d)return d;var t=document.createElement("DIV"),e={haspointerlock:"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document};e.isopera="opera"in window,e.isopera12=e.isopera&&"getUserMedia"in navigator,e.isie="all"in document&&"attachEvent"in t&&!e.isopera,e.isieold=e.isie&&!("msInterpolationMode"in t.style),e.isie7=e.isie&&!e.isieold&&(!("documentMode"in document)||7==document.documentMode),e.isie8=e.isie&&"documentMode"in document&&8==document.documentMode,e.isie9=e.isie&&"performance"in window&&9<=document.documentMode,e.isie10=e.isie&&"performance"in window&&10<=document.documentMode,e.isie9mobile=/iemobile.9/i.test(navigator.userAgent),e.isie9mobile&&(e.isie9=!1),e.isie7mobile=!e.isie9mobile&&e.isie7&&/iemobile/i.test(navigator.userAgent),e.ismozilla="MozAppearance"in t.style,e.iswebkit="WebkitAppearance"in t.style,e.ischrome="chrome"in window,e.ischrome22=e.ischrome&&e.haspointerlock,e.ischrome26=e.ischrome&&"transition"in t.style,e.cantouch="ontouchstart"in document.documentElement||"ontouchstart"in window,e.hasmstouch=window.navigator.msPointerEnabled||!1,e.ismac=/^mac$/i.test(navigator.platform),e.isios=e.cantouch&&/iphone|ipad|ipod/i.test(navigator.platform),e.isios4=e.isios&&!("seal"in Object),e.isandroid=/android/i.test(navigator.userAgent),e.trstyle=!1,e.hastransform=!1,e.hastranslate3d=!1,e.transitionstyle=!1,e.hastransition=!1,e.transitionend=!1;for(var i=["transform","msTransform","webkitTransform","MozTransform","OTransform"],n=0;n<i.length;n++)if("undefined"!=typeof t.style[i[n]]){e.trstyle=i[n];break}e.hastransform=0!=e.trstyle,e.hastransform&&(t.style[e.trstyle]="translate3d(1px,2px,3px)",e.hastranslate3d=/translate3d/.test(t.style[e.trstyle])),e.transitionstyle=!1,e.prefixstyle="",e.transitionend=!1;for(var i="transition webkitTransition MozTransition OTransition OTransition msTransition KhtmlTransition".split(" "),s=" -webkit- -moz- -o- -o -ms- -khtml-".split(" "),r="transitionend webkitTransitionEnd transitionend otransitionend oTransitionEnd msTransitionEnd KhtmlTransitionEnd".split(" "),n=0;n<i.length;n++)if(i[n]in t.style){e.transitionstyle=i[n],e.prefixstyle=s[n],e.transitionend=r[n];break}e.ischrome26&&(e.prefixstyle=s[1]),e.hastransition=e.transitionstyle;t:{for(i=["-moz-grab","-webkit-grab","grab"],(e.ischrome&&!e.ischrome22||e.isie)&&(i=[]),n=0;n<i.length;n++)if(s=i[n],t.style.cursor=s,t.style.cursor==s){i=s;break t}i="url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur),n-resize"}return e.cursorgrabvalue=i,e.hasmousecapture="setCapture"in t,e.hasMutationObserver=!1!==c,d=e},f=function(a,d){function f(){var t=x.win;if("zIndex"in t)return t.zIndex();for(;0<t.length&&9!=t[0].nodeType;){var e=t.css("zIndex");if(!isNaN(e)&&0!=e)return parseInt(e);t=t.parent()}return!1}function g(t,e,i){return e=t.css(e),t=parseFloat(e),isNaN(t)?(t=S[e]||0,i=3==t?i?x.win.outerHeight()-x.win.innerHeight():x.win.outerWidth()-x.win.innerWidth():1,x.isie8&&t&&(t+=1),i?t:0):t}function v(t,e,i,n){x._bind(t,e,function(n){n=n?n:window.event;var s={original:n,target:n.target||n.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==n.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){return n.preventDefault?n.preventDefault():n.returnValue=!1,!1},stopImmediatePropagation:function(){n.stopImmediatePropagation?n.stopImmediatePropagation():n.cancelBubble=!0}};return"mousewheel"==e?(s.deltaY=-.025*n.wheelDelta,n.wheelDeltaX&&(s.deltaX=-.025*n.wheelDeltaX)):s.deltaY=n.detail,i.call(t,s)},n)}function y(t,e,i){var n,s;if(0==t.deltaMode?(n=-Math.floor(t.deltaX*(x.opt.mousescrollstep/54)),s=-Math.floor(t.deltaY*(x.opt.mousescrollstep/54))):1==t.deltaMode&&(n=-Math.floor(t.deltaX*x.opt.mousescrollstep),s=-Math.floor(t.deltaY*x.opt.mousescrollstep)),e&&0==n&&s&&(n=s,s=0),n&&(x.scrollmom&&x.scrollmom.stop(),x.lastdeltax+=n,x.debounced("mousewheelx",function(){var t=x.lastdeltax;x.lastdeltax=0,x.rail.drag||x.doScrollLeftBy(t)},120)),s){if(x.opt.nativeparentscrolling&&i&&!x.ispage&&!x.zoomactive)if(0>s){if(x.getScrollTop()>=x.page.maxh)return!0}else if(0>=x.getScrollTop())return!0;x.scrollmom&&x.scrollmom.stop(),x.lastdeltay+=s,x.debounced("mousewheely",function(){var t=x.lastdeltay;x.lastdeltay=0,x.rail.drag||x.doScrollBy(t)},120)}return t.stopImmediatePropagation(),t.preventDefault()}var x=this;if(this.version="3.4.0",this.name="nicescroll",this.me=d,this.opt={doc:t("body"),win:!1},t.extend(this.opt,u),this.opt.snapbackspeed=80,a)for(var b in x.opt)"undefined"!=typeof a[b]&&(x.opt[b]=a[b]);this.iddoc=(this.doc=x.opt.doc)&&this.doc[0]?this.doc[0].id||"":"",this.ispage=/BODY|HTML/.test(x.opt.win?x.opt.win[0].nodeName:this.doc[0].nodeName),this.haswrapper=!1!==x.opt.win,this.win=x.opt.win||(this.ispage?t(window):this.doc),this.docscroll=this.ispage&&!this.haswrapper?t(window):this.win,this.body=t("body"),this.iframe=this.isfixed=this.viewport=!1,this.isiframe="IFRAME"==this.doc[0].nodeName&&"IFRAME"==this.win[0].nodeName,this.istextarea="TEXTAREA"==this.win[0].nodeName,this.forcescreen=!1,this.canshowonmouseevent="scroll"!=x.opt.autohidemode,this.page=this.view=this.onzoomout=this.onzoomin=this.onscrollcancel=this.onscrollend=this.onscrollstart=this.onclick=this.ongesturezoom=this.onkeypress=this.onmousewheel=this.onmousemove=this.onmouseup=this.onmousedown=!1,this.scroll={x:0,y:0},this.scrollratio={x:0,y:0},this.cursorheight=20,this.scrollvaluemax=0,this.observerremover=this.observer=this.scrollmom=this.scrollrunning=this.checkrtlmode=!1;do this.id="ascrail"+s++;while(document.getElementById(this.id));this.hasmousefocus=this.hasfocus=this.zoomactive=this.zoom=this.selectiondrag=this.cursorfreezed=this.cursor=this.rail=!1,this.visibility=!0,this.hidden=this.locked=!1,this.cursoractive=!0,this.overflowx=x.opt.overflowx,this.overflowy=x.opt.overflowy,this.nativescrollingarea=!1,this.checkarea=0,this.events=[],this.saved={},this.delaylist={},this.synclist={},this.lastdeltay=this.lastdeltax=0,this.detected=p();var w=t.extend({},this.detected);if(this.ishwscroll=(this.canhwscroll=w.hastransform&&x.opt.hwacceleration)&&x.haswrapper,this.istouchcapable=!1,w.cantouch&&w.ischrome&&!w.isios&&!w.isandroid&&(this.istouchcapable=!0,w.cantouch=!1),w.cantouch&&w.ismozilla&&!w.isios&&(this.istouchcapable=!0,w.cantouch=!1),x.opt.enablemouselockapi||(w.hasmousecapture=!1,w.haspointerlock=!1),this.delayed=function(t,e,i,n){var s=x.delaylist[t],r=(new Date).getTime();return!(!n&&s&&s.tt)&&(s&&s.tt&&clearTimeout(s.tt),void(s&&s.last+i>r&&!s.tt?x.delaylist[t]={last:r+i,tt:setTimeout(function(){x.delaylist[t].tt=0,e.call()},i)}:s&&s.tt||(x.delaylist[t]={last:r,tt:0},setTimeout(function(){e.call()},0))))},this.debounced=function(t,e,i){var n=x.delaylist[t];(new Date).getTime(),x.delaylist[t]=e,n||setTimeout(function(){var e=x.delaylist[t];x.delaylist[t]=!1,e.call()},i)},this.synched=function(t,e){return x.synclist[t]=e,function(){x.onsync||(h(function(){x.onsync=!1;for(t in x.synclist){var e=x.synclist[t];e&&e.call(x),x.synclist[t]=!1}}),x.onsync=!0)}(),t},this.unsynched=function(t){x.synclist[t]&&(x.synclist[t]=!1)},this.css=function(t,e){for(var i in e)x.saved.css.push([t,i,t.css(i)]),t.css(i,e[i])},this.scrollTop=function(t){return"undefined"==typeof t?x.getScrollTop():x.setScrollTop(t)},this.scrollLeft=function(t){return"undefined"==typeof t?x.getScrollLeft():x.setScrollLeft(t)},BezierClass=function(t,e,i,n,s,r,o){this.st=t,this.ed=e,this.spd=i,this.p1=n||0,this.p2=s||1,this.p3=r||0,this.p4=o||1,this.ts=(new Date).getTime(),this.df=this.ed-this.st},BezierClass.prototype={B2:function(t){return 3*t*t*(1-t)},B3:function(t){return 3*t*(1-t)*(1-t)},B4:function(t){return(1-t)*(1-t)*(1-t)},getNow:function(){var t=1-((new Date).getTime()-this.ts)/this.spd,e=this.B2(t)+this.B3(t)+this.B4(t);return 0>t?this.ed:this.st+Math.round(this.df*e)},update:function(t,e){return this.st=this.getNow(),this.ed=t,this.spd=e,this.ts=(new Date).getTime(),this.df=this.ed-this.st,this}},this.ishwscroll){this.doc.translate={x:0,y:0,tx:"0px",ty:"0px"},w.hastranslate3d&&w.isios&&this.doc.css("-webkit-backface-visibility","hidden");var _=function(){var t=x.doc.css(w.trstyle);return!(!t||"matrix"!=t.substr(0,6))&&t.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/)};this.getScrollTop=function(t){if(!t){if(t=_())return 16==t.length?-t[13]:-t[5];if(x.timerscroll&&x.timerscroll.bz)return x.timerscroll.bz.getNow()}return x.doc.translate.y},this.getScrollLeft=function(t){if(!t){if(t=_())return 16==t.length?-t[12]:-t[4];if(x.timerscroll&&x.timerscroll.bh)return x.timerscroll.bh.getNow()}return x.doc.translate.x},this.notifyScrollEvent=document.createEvent?function(t){var e=document.createEvent("UIEvents");e.initUIEvent("scroll",!1,!0,window,1),t.dispatchEvent(e)}:document.fireEvent?function(t){var e=document.createEventObject();t.fireEvent("onscroll"),e.cancelBubble=!0}:function(t,e){},w.hastranslate3d&&x.opt.enabletranslate3d?(this.setScrollTop=function(t,e){x.doc.translate.y=t,x.doc.translate.ty=-1*t+"px",x.doc.css(w.trstyle,"translate3d("+x.doc.translate.tx+","+x.doc.translate.ty+",0px)"),e||x.notifyScrollEvent(x.win[0])},this.setScrollLeft=function(t,e){x.doc.translate.x=t,x.doc.translate.tx=-1*t+"px",x.doc.css(w.trstyle,"translate3d("+x.doc.translate.tx+","+x.doc.translate.ty+",0px)"),e||x.notifyScrollEvent(x.win[0])}):(this.setScrollTop=function(t,e){x.doc.translate.y=t,x.doc.translate.ty=-1*t+"px",x.doc.css(w.trstyle,"translate("+x.doc.translate.tx+","+x.doc.translate.ty+")"),e||x.notifyScrollEvent(x.win[0])},this.setScrollLeft=function(t,e){x.doc.translate.x=t,x.doc.translate.tx=-1*t+"px",x.doc.css(w.trstyle,"translate("+x.doc.translate.tx+","+x.doc.translate.ty+")"),e||x.notifyScrollEvent(x.win[0])})}else this.getScrollTop=function(){return x.docscroll.scrollTop()},this.setScrollTop=function(t){return x.docscroll.scrollTop(t)},this.getScrollLeft=function(){return x.docscroll.scrollLeft()},this.setScrollLeft=function(t){return x.docscroll.scrollLeft(t)};this.getTarget=function(t){return!!t&&(t.target?t.target:!!t.srcElement&&t.srcElement)},this.hasParent=function(t,e){if(!t)return!1;for(var i=t.target||t.srcElement||t||!1;i&&i.id!=e;)i=i.parentNode||!1;return!1!==i};var S={thin:1,medium:3,thick:5};this.getOffset=function(){if(x.isfixed)return{top:parseFloat(x.win.css("top")),left:parseFloat(x.win.css("left"))};if(!x.viewport)return x.win.offset();var t=x.win.offset(),e=x.viewport.offset();return{top:t.top-e.top+x.viewport.scrollTop(),left:t.left-e.left+x.viewport.scrollLeft()}},this.updateScrollBar=function(t){if(x.ishwscroll)x.rail.css({height:x.win.innerHeight()}),x.railh&&x.railh.css({width:x.win.innerWidth()});else{var e=x.getOffset(),i=e.top,n=e.left,i=i+g(x.win,"border-top-width",!0);x.win.outerWidth(),x.win.innerWidth();var n=n+(x.rail.align?x.win.outerWidth()-g(x.win,"border-right-width")-x.rail.width:g(x.win,"border-left-width")),s=x.opt.railoffset;s&&(s.top&&(i+=s.top),x.rail.align&&s.left&&(n+=s.left)),x.locked||x.rail.css({top:i,left:n,height:t?t.h:x.win.innerHeight()}),x.zoom&&x.zoom.css({top:i+1,left:1==x.rail.align?n-20:n+x.rail.width+4}),x.railh&&!x.locked&&(i=e.top,n=e.left,t=x.railh.align?i+g(x.win,"border-top-width",!0)+x.win.innerHeight()-x.railh.height:i+g(x.win,"border-top-width",!0),n+=g(x.win,"border-left-width"),x.railh.css({top:t,left:n,width:x.railh.width}))}},this.doRailClick=function(t,e,i){var n;x.locked||(x.cancelEvent(t),e?(e=i?x.doScrollLeft:x.doScrollTop,n=i?(t.pageX-x.railh.offset().left-x.cursorwidth/2)*x.scrollratio.x:(t.pageY-x.rail.offset().top-x.cursorheight/2)*x.scrollratio.y,e(n)):(e=i?x.doScrollLeftBy:x.doScrollBy,n=i?x.scroll.x:x.scroll.y,t=i?t.pageX-x.railh.offset().left:t.pageY-x.rail.offset().top,i=i?x.view.w:x.view.h,e(n>=t?i:-i)))},x.hasanimationframe=h,x.hascancelanimationframe=l,x.hasanimationframe?x.hascancelanimationframe||(l=function(){x.cancelAnimationFrame=!0}):(h=function(t){return setTimeout(t,15-Math.floor(+new Date/1e3)%16)},l=clearInterval),this.init=function(){if(x.saved.css=[],w.isie7mobile)return!0;if(w.hasmstouch&&x.css(x.ispage?t("html"):x.win,{"-ms-touch-action":"none"}),x.zindex="auto",x.zindex=x.ispage||"auto"!=x.opt.zindex?x.opt.zindex:f()||"auto",!x.ispage&&"auto"!=x.zindex&&x.zindex>r&&(r=x.zindex),x.isie&&0==x.zindex&&"auto"==x.opt.zindex&&(x.zindex="auto"),!x.ispage||!w.cantouch&&!w.isieold&&!w.isie9mobile){var s=x.docscroll;x.ispage&&(s=x.haswrapper?x.win:x.doc),w.isie9mobile||x.css(s,{"overflow-y":"hidden"}),x.ispage&&w.isie7&&("BODY"==x.doc[0].nodeName?x.css(t("html"),{"overflow-y":"hidden"}):"HTML"==x.doc[0].nodeName&&x.css(t("body"),{"overflow-y":"hidden"})),w.isios&&!x.ispage&&!x.haswrapper&&x.css(t("body"),{"-webkit-overflow-scrolling":"touch"});var a=t(document.createElement("div"));a.css({position:"relative",top:0,float:"right",width:x.opt.cursorwidth,height:"0px","background-color":x.opt.cursorcolor,border:x.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":x.opt.cursorborderradius,"-moz-border-radius":x.opt.cursorborderradius,"border-radius":x.opt.cursorborderradius}),a.hborder=parseFloat(a.outerHeight()-a.innerHeight()),x.cursor=a;var h=t(document.createElement("div"));h.attr("id",x.id),h.addClass("nicescroll-rails");var l,u,d,p=["left","right"];for(d in p)u=p[d],(l=x.opt.railpadding[u])?h.css("padding-"+u,l+"px"):x.opt.railpadding[u]=0;if(h.append(a),h.width=Math.max(parseFloat(x.opt.cursorwidth),a.outerWidth())+x.opt.railpadding.left+x.opt.railpadding.right,h.css({width:h.width+"px",zIndex:x.zindex,background:x.opt.background,cursor:"default"}),h.visibility=!0,h.scrollable=!0,h.align="left"==x.opt.railalign?0:1,x.rail=h,a=x.rail.drag=!1,x.opt.boxzoom&&!x.ispage&&!w.isieold&&(a=document.createElement("div"),x.bind(a,"click",x.doZoom),x.zoom=t(a),x.zoom.css({cursor:"pointer","z-index":x.zindex,backgroundImage:"url("+o+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),x.opt.dblclickzoom&&x.bind(x.win,"dblclick",x.doZoom),w.cantouch&&x.opt.gesturezoom&&(x.ongesturezoom=function(t){return 1.5<t.scale&&x.doZoomIn(t),.8>t.scale&&x.doZoomOut(t),x.cancelEvent(t)},x.bind(x.win,"gestureend",x.ongesturezoom))),x.railh=!1,x.opt.horizrailenabled){x.css(s,{"overflow-x":"hidden"}),a=t(document.createElement("div")),a.css({position:"relative",top:0,height:x.opt.cursorwidth,width:"0px","background-color":x.opt.cursorcolor,border:x.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":x.opt.cursorborderradius,"-moz-border-radius":x.opt.cursorborderradius,"border-radius":x.opt.cursorborderradius}),a.wborder=parseFloat(a.outerWidth()-a.innerWidth()),x.cursorh=a;var g=t(document.createElement("div"));g.attr("id",x.id+"-hr"),g.addClass("nicescroll-rails"),g.height=Math.max(parseFloat(x.opt.cursorwidth),a.outerHeight()),g.css({height:g.height+"px",zIndex:x.zindex,background:x.opt.background}),g.append(a),g.visibility=!0,g.scrollable=!0,g.align="top"==x.opt.railvalign?0:1,x.railh=g,x.railh.drag=!1}if(x.ispage?(h.css({position:"fixed",top:"0px",height:"100%"}),h.align?h.css({right:"0px"}):h.css({left:"0px"}),x.body.append(h),x.railh&&(g.css({position:"fixed",left:"0px",width:"100%"}),g.align?g.css({bottom:"0px"}):g.css({top:"0px"}),x.body.append(g))):(x.ishwscroll?("static"==x.win.css("position")&&x.css(x.win,{position:"relative"}),s="HTML"==x.win[0].nodeName?x.body:x.win,x.zoom&&(x.zoom.css({position:"absolute",top:1,right:0,"margin-right":h.width+4}),s.append(x.zoom)),h.css({position:"absolute",top:0}),h.align?h.css({right:0}):h.css({left:0}),s.append(h),g&&(g.css({position:"absolute",left:0,bottom:0}),g.align?g.css({bottom:0}):g.css({top:0}),s.append(g))):(x.isfixed="fixed"==x.win.css("position"),s=x.isfixed?"fixed":"absolute",x.isfixed||(x.viewport=x.getViewport(x.win[0])),x.viewport&&(x.body=x.viewport,0==/relative|absolute/.test(x.viewport.css("position"))&&x.css(x.viewport,{position:"relative"})),h.css({position:s}),x.zoom&&x.zoom.css({position:s}),x.updateScrollBar(),x.body.append(h),x.zoom&&x.body.append(x.zoom),x.railh&&(g.css({position:s}),x.body.append(g))),w.isios&&x.css(x.win,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"}),w.isie&&x.opt.disableoutline&&x.win.attr("hideFocus","true"),w.iswebkit&&x.opt.disableoutline&&x.win.css({outline:"none"})),!1===x.opt.autohidemode?(x.autohidedom=!1,x.rail.css({opacity:x.opt.cursoropacitymax}),x.railh&&x.railh.css({opacity:x.opt.cursoropacitymax})):!0===x.opt.autohidemode?(x.autohidedom=t().add(x.rail),w.isie8&&(x.autohidedom=x.autohidedom.add(x.cursor)),x.railh&&(x.autohidedom=x.autohidedom.add(x.railh)),x.railh&&w.isie8&&(x.autohidedom=x.autohidedom.add(x.cursorh))):"scroll"==x.opt.autohidemode?(x.autohidedom=t().add(x.rail),x.railh&&(x.autohidedom=x.autohidedom.add(x.railh))):"cursor"==x.opt.autohidemode?(x.autohidedom=t().add(x.cursor),x.railh&&(x.autohidedom=x.autohidedom.add(x.cursorh))):"hidden"==x.opt.autohidemode&&(x.autohidedom=!1,x.hide(),x.locked=!1),w.isie9mobile)x.scrollmom=new m(x),x.onmangotouch=function(t){t=x.getScrollTop();var e=x.getScrollLeft();if(t==x.scrollmom.lastscrolly&&e==x.scrollmom.lastscrollx)return!0;var i=t-x.mangotouch.sy,n=e-x.mangotouch.sx;if(0!=Math.round(Math.sqrt(Math.pow(n,2)+Math.pow(i,2)))){var s=0>i?-1:1,r=0>n?-1:1,o=+new Date;x.mangotouch.lazy&&clearTimeout(x.mangotouch.lazy),80<o-x.mangotouch.tm||x.mangotouch.dry!=s||x.mangotouch.drx!=r?(x.scrollmom.stop(),x.scrollmom.reset(e,t),x.mangotouch.sy=t,x.mangotouch.ly=t,x.mangotouch.sx=e,x.mangotouch.lx=e,x.mangotouch.dry=s,x.mangotouch.drx=r,x.mangotouch.tm=o):(x.scrollmom.stop(),x.scrollmom.update(x.mangotouch.sx-n,x.mangotouch.sy-i),x.mangotouch.tm=o,i=Math.max(Math.abs(x.mangotouch.ly-t),Math.abs(x.mangotouch.lx-e)),x.mangotouch.ly=t,x.mangotouch.lx=e,2<i&&(x.mangotouch.lazy=setTimeout(function(){x.mangotouch.lazy=!1,x.mangotouch.dry=0,x.mangotouch.drx=0,x.mangotouch.tm=0,x.scrollmom.doMomentum(30)},100)))}},h=x.getScrollTop(),g=x.getScrollLeft(),x.mangotouch={sy:h,ly:h,dry:0,sx:g,lx:g,drx:0,lazy:!1,tm:0},x.bind(x.docscroll,"scroll",x.onmangotouch);else{if(w.cantouch||x.istouchcapable||x.opt.touchbehavior||w.hasmstouch){x.scrollmom=new m(x),x.ontouchstart=function(e){if(e.pointerType&&2!=e.pointerType)return!1;if(!x.locked){if(w.hasmstouch)for(var i=!!e.target&&e.target;i;){var n=t(i).getNiceScroll();if(0<n.length&&n[0].me==x.me)break;if(0<n.length)return!1;if("DIV"==i.nodeName&&i.id==x.id)break;i=!!i.parentNode&&i.parentNode}if(x.cancelScroll(),(i=x.getTarget(e))&&/INPUT/i.test(i.nodeName)&&/range/i.test(i.type))return x.stopPropagation(e);if(!("clientX"in e)&&"changedTouches"in e&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),x.forcescreen&&(n=e,e={original:e.original?e.original:e},e.clientX=n.screenX,e.clientY=n.screenY),x.rail.drag={x:e.clientX,y:e.clientY,sx:x.scroll.x,sy:x.scroll.y,st:x.getScrollTop(),sl:x.getScrollLeft(),pt:2,dl:!1},x.ispage||!x.opt.directionlockdeadzone)x.rail.drag.dl="f";else{var n=t(window).width(),s=t(window).height(),r=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),o=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),s=Math.max(0,o-s),n=Math.max(0,r-n);x.rail.drag.ck=!x.rail.scrollable&&x.railh.scrollable?0<s&&"v":!(!x.rail.scrollable||x.railh.scrollable)&&(0<n&&"h"),x.rail.drag.ck||(x.rail.drag.dl="f")}if(x.opt.touchbehavior&&x.isiframe&&w.isie&&(n=x.win.position(),x.rail.drag.x+=n.left,x.rail.drag.y+=n.top),x.hasmoving=!1,x.lastmouseup=!1,x.scrollmom.reset(e.clientX,e.clientY),!w.cantouch&&!this.istouchcapable&&!w.hasmstouch){if(!i||!/INPUT|SELECT|TEXTAREA/i.test(i.nodeName))return!x.ispage&&w.hasmousecapture&&i.setCapture(),x.cancelEvent(e);/SUBMIT|CANCEL|BUTTON/i.test(t(i).attr("type"))&&(pc={tg:i,click:!1},x.preventclick=pc)}}},x.ontouchend=function(t){return(!t.pointerType||2==t.pointerType)&&(x.rail.drag&&2==x.rail.drag.pt&&(x.scrollmom.doMomentum(),x.rail.drag=!1,x.hasmoving&&(x.hasmoving=!1,x.lastmouseup=!0,x.hideCursor(),w.hasmousecapture&&document.releaseCapture(),!w.cantouch))?x.cancelEvent(t):void 0)};var v=x.opt.touchbehavior&&x.isiframe&&!w.hasmousecapture;x.ontouchmove=function(e,i){if(e.pointerType&&2!=e.pointerType)return!1;if(x.rail.drag&&2==x.rail.drag.pt){if(w.cantouch&&"undefined"==typeof e.original)return!0;if(x.hasmoving=!0,x.preventclick&&!x.preventclick.click&&(x.preventclick.click=x.preventclick.tg.onclick||!1,x.preventclick.tg.onclick=x.onpreventclick),e=t.extend({original:e},e),"changedTouches"in e&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),x.forcescreen){var n=e;e={original:e.original?e.original:e},e.clientX=n.screenX,e.clientY=n.screenY}if(n=ofy=0,v&&!i){var s=x.win.position(),n=-s.left;ofy=-s.top}var r=e.clientY+ofy,s=r-x.rail.drag.y,o=e.clientX+n,a=o-x.rail.drag.x,h=x.rail.drag.st-s;if(x.ishwscroll&&x.opt.bouncescroll?0>h?h=Math.round(h/2):h>x.page.maxh&&(h=x.page.maxh+Math.round((h-x.page.maxh)/2)):(0>h&&(r=h=0),h>x.page.maxh&&(h=x.page.maxh,r=0)),x.railh&&x.railh.scrollable){var l=x.rail.drag.sl-a;x.ishwscroll&&x.opt.bouncescroll?0>l?l=Math.round(l/2):l>x.page.maxw&&(l=x.page.maxw+Math.round((l-x.page.maxw)/2)):(0>l&&(o=l=0),l>x.page.maxw&&(l=x.page.maxw,o=0))}if(n=!1,x.rail.drag.dl)n=!0,"v"==x.rail.drag.dl?l=x.rail.drag.sl:"h"==x.rail.drag.dl&&(h=x.rail.drag.st);else{var s=Math.abs(s),a=Math.abs(a),c=x.opt.directionlockdeadzone;if("v"==x.rail.drag.ck){if(s>c&&a<=.3*s)return x.rail.drag=!1,!0;a>c&&(x.rail.drag.dl="f",t("body").scrollTop(t("body").scrollTop()))}else if("h"==x.rail.drag.ck){if(a>c&&s<=.3*az)return x.rail.drag=!1,!0;s>c&&(x.rail.drag.dl="f",t("body").scrollLeft(t("body").scrollLeft()))}}if(x.synched("touchmove",function(){x.rail.drag&&2==x.rail.drag.pt&&(x.prepareTransition&&x.prepareTransition(0),x.rail.scrollable&&x.setScrollTop(h),x.scrollmom.update(o,r),x.railh&&x.railh.scrollable?(x.setScrollLeft(l),x.showCursor(h,l)):x.showCursor(h),w.isie10&&document.selection.clear())}),w.ischrome&&x.istouchcapable&&(n=!1),n)return x.cancelEvent(e)}}}if(x.onmousedown=function(t,e){if(!x.rail.drag||1==x.rail.drag.pt){if(x.locked)return x.cancelEvent(t);x.cancelScroll(),x.rail.drag={x:t.clientX,y:t.clientY,sx:x.scroll.x,sy:x.scroll.y,pt:1,hr:!!e};var i=x.getTarget(t);return!x.ispage&&w.hasmousecapture&&i.setCapture(),x.isiframe&&!w.hasmousecapture&&(x.saved.csspointerevents=x.doc.css("pointer-events"),x.css(x.doc,{"pointer-events":"none"})),x.cancelEvent(t)}},x.onmouseup=function(t){if(x.rail.drag&&(w.hasmousecapture&&document.releaseCapture(),x.isiframe&&!w.hasmousecapture&&x.doc.css("pointer-events",x.saved.csspointerevents),1==x.rail.drag.pt))return x.rail.drag=!1,x.cancelEvent(t)},x.onmousemove=function(t){if(x.rail.drag&&1==x.rail.drag.pt){if(w.ischrome&&0==t.which)return x.onmouseup(t);if(x.cursorfreezed=!0,x.rail.drag.hr){x.scroll.x=x.rail.drag.sx+(t.clientX-x.rail.drag.x),0>x.scroll.x&&(x.scroll.x=0);var e=x.scrollvaluemaxw;x.scroll.x>e&&(x.scroll.x=e)}else x.scroll.y=x.rail.drag.sy+(t.clientY-x.rail.drag.y),0>x.scroll.y&&(x.scroll.y=0),e=x.scrollvaluemax,x.scroll.y>e&&(x.scroll.y=e);return x.synched("mousemove",function(){x.rail.drag&&1==x.rail.drag.pt&&(x.showCursor(),x.rail.drag.hr?x.doScrollLeft(Math.round(x.scroll.x*x.scrollratio.x),x.opt.cursordragspeed):x.doScrollTop(Math.round(x.scroll.y*x.scrollratio.y),x.opt.cursordragspeed))}),x.cancelEvent(t)}},w.cantouch||x.opt.touchbehavior)x.onpreventclick=function(t){if(x.preventclick)return x.preventclick.tg.onclick=x.preventclick.click,x.preventclick=!1,x.cancelEvent(t)},x.bind(x.win,"mousedown",x.ontouchstart),x.onclick=!w.isios&&function(t){return!x.lastmouseup||(x.lastmouseup=!1,x.cancelEvent(t))},x.opt.grabcursorenabled&&w.cursorgrabvalue&&(x.css(x.ispage?x.doc:x.win,{cursor:w.cursorgrabvalue}),x.css(x.rail,{cursor:w.cursorgrabvalue}));else{var y=function(t){if(x.selectiondrag){if(t){var e=x.win.outerHeight();t=t.pageY-x.selectiondrag.top,0<t&&t<e&&(t=0),t>=e&&(t-=e),x.selectiondrag.df=t}0!=x.selectiondrag.df&&(x.doScrollBy(2*-Math.floor(x.selectiondrag.df/6)),x.debounced("doselectionscroll",function(){y()},50))}};x.hasTextSelected="getSelection"in document?function(){return 0<document.getSelection().rangeCount}:"selection"in document?function(){return"None"!=document.selection.type}:function(){return!1},x.onselectionstart=function(t){x.ispage||(x.selectiondrag=x.win.offset())},x.onselectionend=function(t){x.selectiondrag=!1},x.onselectiondrag=function(t){x.selectiondrag&&x.hasTextSelected()&&x.debounced("selectionscroll",function(){y(t)},250)}}w.hasmstouch&&(x.css(x.rail,{"-ms-touch-action":"none"}),x.css(x.cursor,{"-ms-touch-action":"none"}),x.bind(x.win,"MSPointerDown",x.ontouchstart),x.bind(document,"MSPointerUp",x.ontouchend),x.bind(document,"MSPointerMove",x.ontouchmove),x.bind(x.cursor,"MSGestureHold",function(t){t.preventDefault()}),x.bind(x.cursor,"contextmenu",function(t){t.preventDefault()})),this.istouchcapable&&(x.bind(x.win,"touchstart",x.ontouchstart),x.bind(document,"touchend",x.ontouchend),x.bind(document,"touchcancel",x.ontouchend),x.bind(document,"touchmove",x.ontouchmove)),x.bind(x.cursor,"mousedown",x.onmousedown),x.bind(x.cursor,"mouseup",x.onmouseup),x.railh&&(x.bind(x.cursorh,"mousedown",function(t){x.onmousedown(t,!0)}),x.bind(x.cursorh,"mouseup",function(t){if(!x.rail.drag||2!=x.rail.drag.pt)return x.rail.drag=!1,x.hasmoving=!1,x.hideCursor(),w.hasmousecapture&&document.releaseCapture(),x.cancelEvent(t)})),(x.opt.cursordragontouch||!w.cantouch&&!x.opt.touchbehavior)&&(x.rail.css({cursor:"default"}),x.railh&&x.railh.css({cursor:"default"}),x.jqbind(x.rail,"mouseenter",function(){x.canshowonmouseevent&&x.showCursor(),x.rail.active=!0}),x.jqbind(x.rail,"mouseleave",function(){x.rail.active=!1,x.rail.drag||x.hideCursor()}),x.opt.sensitiverail&&(x.bind(x.rail,"click",function(t){x.doRailClick(t,!1,!1)}),x.bind(x.rail,"dblclick",function(t){x.doRailClick(t,!0,!1)}),x.bind(x.cursor,"click",function(t){x.cancelEvent(t)}),x.bind(x.cursor,"dblclick",function(t){x.cancelEvent(t)})),x.railh&&(x.jqbind(x.railh,"mouseenter",function(){x.canshowonmouseevent&&x.showCursor(),x.rail.active=!0}),x.jqbind(x.railh,"mouseleave",function(){x.rail.active=!1,x.rail.drag||x.hideCursor()}),x.opt.sensitiverail&&(x.bind(x.railh,"click",function(t){x.doRailClick(t,!1,!0)}),x.bind(x.railh,"dblclick",function(t){x.doRailClick(t,!0,!0)}),x.bind(x.cursorh,"click",function(t){x.cancelEvent(t)}),x.bind(x.cursorh,"dblclick",function(t){x.cancelEvent(t)})))),w.cantouch||x.opt.touchbehavior?(x.bind(w.hasmousecapture?x.win:document,"mouseup",x.ontouchend),x.bind(document,"mousemove",x.ontouchmove),x.onclick&&x.bind(document,"click",x.onclick),x.opt.cursordragontouch&&(x.bind(x.cursor,"mousedown",x.onmousedown),x.bind(x.cursor,"mousemove",x.onmousemove),x.cursorh&&x.bind(x.cursorh,"mousedown",x.onmousedown),x.cursorh&&x.bind(x.cursorh,"mousemove",x.onmousemove))):(x.bind(w.hasmousecapture?x.win:document,"mouseup",x.onmouseup),x.bind(document,"mousemove",x.onmousemove),x.onclick&&x.bind(document,"click",x.onclick),!x.ispage&&x.opt.enablescrollonselection&&(x.bind(x.win[0],"mousedown",x.onselectionstart),x.bind(document,"mouseup",x.onselectionend),x.bind(x.cursor,"mouseup",x.onselectionend),x.cursorh&&x.bind(x.cursorh,"mouseup",x.onselectionend),x.bind(document,"mousemove",x.onselectiondrag)),x.zoom&&(x.jqbind(x.zoom,"mouseenter",function(){x.canshowonmouseevent&&x.showCursor(),x.rail.active=!0}),x.jqbind(x.zoom,"mouseleave",function(){x.rail.active=!1,x.rail.drag||x.hideCursor()}))),x.opt.enablemousewheel&&(x.isiframe||x.bind(w.isie&&x.ispage?document:x.docscroll,"mousewheel",x.onmousewheel),x.bind(x.rail,"mousewheel",x.onmousewheel),x.railh&&x.bind(x.railh,"mousewheel",x.onmousewheelhr)),!x.ispage&&!w.cantouch&&!/HTML|BODY/.test(x.win[0].nodeName)&&(x.win.attr("tabindex")||x.win.attr({tabindex:n++}),x.jqbind(x.win,"focus",function(t){e=x.getTarget(t).id||!0,x.hasfocus=!0,x.canshowonmouseevent&&x.noticeCursor()}),x.jqbind(x.win,"blur",function(t){e=!1,x.hasfocus=!1}),x.jqbind(x.win,"mouseenter",function(t){i=x.getTarget(t).id||!0,x.hasmousefocus=!0,x.canshowonmouseevent&&x.noticeCursor()}),x.jqbind(x.win,"mouseleave",function(){i=!1,x.hasmousefocus=!1}))}if(x.onkeypress=function(t){if(x.locked&&0==x.page.maxh)return!0;t=t?t:window.e;var n=x.getTarget(t);if(n&&/INPUT|TEXTAREA|SELECT|OPTION/.test(n.nodeName)&&(!n.getAttribute("type")&&!n.type||!/submit|button|cancel/i.tp))return!0;if(x.hasfocus||x.hasmousefocus&&!e||x.ispage&&!e&&!i){if(n=t.keyCode,x.locked&&27!=n)return x.cancelEvent(t);var s=t.ctrlKey||!1,r=t.shiftKey||!1,o=!1;switch(n){case 38:case 63233:x.doScrollBy(72),o=!0;break;case 40:case 63235:x.doScrollBy(-72),o=!0;break;case 37:case 63232:x.railh&&(s?x.doScrollLeft(0):x.doScrollLeftBy(72),o=!0);break;case 39:case 63234:x.railh&&(s?x.doScrollLeft(x.page.maxw):x.doScrollLeftBy(-72),o=!0);break;case 33:case 63276:x.doScrollBy(x.view.h),o=!0;break;case 34:case 63277:x.doScrollBy(-x.view.h),o=!0;break;case 36:case 63273:x.railh&&s?x.doScrollPos(0,0):x.doScrollTo(0),o=!0;break;case 35:case 63275:x.railh&&s?x.doScrollPos(x.page.maxw,x.page.maxh):x.doScrollTo(x.page.maxh),o=!0;break;case 32:x.opt.spacebarenabled&&(r?x.doScrollBy(x.view.h):x.doScrollBy(-x.view.h),o=!0);break;case 27:x.zoomactive&&(x.doZoom(),o=!0)}if(o)return x.cancelEvent(t)}},x.opt.enablekeyboard&&x.bind(document,w.isopera&&!w.isopera12?"keypress":"keydown",x.onkeypress),x.bind(window,"resize",x.lazyResize),x.bind(window,"orientationchange",x.lazyResize),x.bind(window,"load",x.lazyResize),w.ischrome&&!x.ispage&&!x.haswrapper){var b=x.win.attr("style"),h=parseFloat(x.win.css("width"))+1;x.win.css("width",h),x.synched("chromefix",function(){x.win.attr("style",b)})}x.onAttributeChange=function(t){x.lazyResize(250)},!x.ispage&&!x.haswrapper&&(!1!==c?(x.observer=new c(function(t){t.forEach(x.onAttributeChange)}),x.observer.observe(x.win[0],{childList:!0,characterData:!1,attributes:!0,subtree:!1}),x.observerremover=new c(function(t){t.forEach(function(t){if(0<t.removedNodes.length)for(var e in t.removedNodes)if(t.removedNodes[e]==x.win[0])return x.remove()})}),x.observerremover.observe(x.win[0].parentNode,{childList:!0,characterData:!1,attributes:!1,subtree:!1})):(x.bind(x.win,w.isie&&!w.isie9?"propertychange":"DOMAttrModified",x.onAttributeChange),w.isie9&&x.win[0].attachEvent("onpropertychange",x.onAttributeChange),x.bind(x.win,"DOMNodeRemoved",function(t){
t.target==x.win[0]&&x.remove()}))),!x.ispage&&x.opt.boxzoom&&x.bind(window,"resize",x.resizeZoom),x.istextarea&&x.bind(x.win,"mouseup",x.lazyResize),x.checkrtlmode=!0,x.lazyResize(30)}if("IFRAME"==this.doc[0].nodeName){var _=function(e){x.iframexd=!1;try{var i="contentDocument"in this?this.contentDocument:this.contentWindow.document}catch(t){x.iframexd=!0,i=!1}return x.iframexd?("console"in window&&console.log("NiceScroll error: policy restriced iframe"),!0):(x.forcescreen=!0,x.isiframe&&(x.iframe={doc:t(i),html:x.doc.contents().find("html")[0],body:x.doc.contents().find("body")[0]},x.getContentSize=function(){return{w:Math.max(x.iframe.html.scrollWidth,x.iframe.body.scrollWidth),h:Math.max(x.iframe.html.scrollHeight,x.iframe.body.scrollHeight)}},x.docscroll=t(x.iframe.body)),!w.isios&&x.opt.iframeautoresize&&!x.isiframe&&(x.win.scrollTop(0),x.doc.height(""),e=Math.max(i.getElementsByTagName("html")[0].scrollHeight,i.body.scrollHeight),x.doc.height(e)),x.lazyResize(30),w.isie7&&x.css(t(x.iframe.html),{"overflow-y":"hidden"}),x.css(t(x.iframe.body),{"overflow-y":"hidden"}),"contentWindow"in this?x.bind(this.contentWindow,"scroll",x.onscroll):x.bind(i,"scroll",x.onscroll),x.opt.enablemousewheel&&x.bind(i,"mousewheel",x.onmousewheel),x.opt.enablekeyboard&&x.bind(i,w.isopera?"keypress":"keydown",x.onkeypress),(w.cantouch||x.opt.touchbehavior)&&(x.bind(i,"mousedown",x.onmousedown),x.bind(i,"mousemove",function(t){x.onmousemove(t,!0)}),x.opt.grabcursorenabled&&w.cursorgrabvalue&&x.css(t(i.body),{cursor:w.cursorgrabvalue})),x.bind(i,"mouseup",x.onmouseup),void(x.zoom&&(x.opt.dblclickzoom&&x.bind(i,"dblclick",x.doZoom),x.ongesturezoom&&x.bind(i,"gestureend",x.ongesturezoom))))};this.doc[0].readyState&&"complete"==this.doc[0].readyState&&setTimeout(function(){_.call(x.doc[0],!1)},500),x.bind(this.doc,"load",_)}},this.showCursor=function(t,e){x.cursortimeout&&(clearTimeout(x.cursortimeout),x.cursortimeout=0),x.rail&&(x.autohidedom&&(x.autohidedom.stop().css({opacity:x.opt.cursoropacitymax}),x.cursoractive=!0),x.rail.drag&&1==x.rail.drag.pt||("undefined"!=typeof t&&!1!==t&&(x.scroll.y=Math.round(1*t/x.scrollratio.y)),"undefined"!=typeof e&&(x.scroll.x=Math.round(1*e/x.scrollratio.x))),x.cursor.css({height:x.cursorheight,top:x.scroll.y}),x.cursorh&&(!x.rail.align&&x.rail.visibility?x.cursorh.css({width:x.cursorwidth,left:x.scroll.x+x.rail.width}):x.cursorh.css({width:x.cursorwidth,left:x.scroll.x}),x.cursoractive=!0),x.zoom&&x.zoom.stop().css({opacity:x.opt.cursoropacitymax}))},this.hideCursor=function(t){!x.cursortimeout&&x.rail&&x.autohidedom&&(x.cursortimeout=setTimeout(function(){x.rail.active&&x.showonmouseevent||(x.autohidedom.stop().animate({opacity:x.opt.cursoropacitymin}),x.zoom&&x.zoom.stop().animate({opacity:x.opt.cursoropacitymin}),x.cursoractive=!1),x.cursortimeout=0},t||x.opt.hidecursordelay))},this.noticeCursor=function(t,e,i){x.showCursor(e,i),x.rail.active||x.hideCursor(t)},this.getContentSize=x.ispage?function(){return{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}:x.haswrapper?function(){return{w:x.doc.outerWidth()+parseInt(x.win.css("paddingLeft"))+parseInt(x.win.css("paddingRight")),h:x.doc.outerHeight()+parseInt(x.win.css("paddingTop"))+parseInt(x.win.css("paddingBottom"))}}:function(){return{w:x.docscroll[0].scrollWidth,h:x.docscroll[0].scrollHeight}},this.onResize=function(t,e){if(!x.win)return!1;if(!x.haswrapper&&!x.ispage){if("none"==x.win.css("display"))return x.visibility&&x.hideRail().hideRailHr(),!1;!x.hidden&&!x.visibility&&x.showRail().showRailHr()}var i=x.page.maxh,n=x.page.maxw,s=x.view.w;if(x.view={w:x.ispage?x.win.width():parseInt(x.win[0].clientWidth),h:x.ispage?x.win.height():parseInt(x.win[0].clientHeight)},x.page=e?e:x.getContentSize(),x.page.maxh=Math.max(0,x.page.h-x.view.h),x.page.maxw=Math.max(0,x.page.w-x.view.w),x.page.maxh==i&&x.page.maxw==n&&x.view.w==s){if(x.ispage)return x;if(i=x.win.offset(),x.lastposition&&(n=x.lastposition,n.top==i.top&&n.left==i.left))return x;x.lastposition=i}return 0==x.page.maxh?(x.hideRail(),x.scrollvaluemax=0,x.scroll.y=0,x.scrollratio.y=0,x.cursorheight=0,x.setScrollTop(0),x.rail.scrollable=!1):x.rail.scrollable=!0,0==x.page.maxw?(x.hideRailHr(),x.scrollvaluemaxw=0,x.scroll.x=0,x.scrollratio.x=0,x.cursorwidth=0,x.setScrollLeft(0),x.railh.scrollable=!1):x.railh.scrollable=!0,x.locked=0==x.page.maxh&&0==x.page.maxw,x.locked?(x.ispage||x.updateScrollBar(x.view),!1):(x.hidden||x.visibility?!x.hidden&&!x.railh.visibility&&x.showRailHr():x.showRail().showRailHr(),x.istextarea&&x.win.css("resize")&&"none"!=x.win.css("resize")&&(x.view.h-=20),x.cursorheight=Math.min(x.view.h,Math.round(x.view.h*(x.view.h/x.page.h))),x.cursorheight=x.opt.cursorfixedheight?x.opt.cursorfixedheight:Math.max(x.opt.cursorminheight,x.cursorheight),x.cursorwidth=Math.min(x.view.w,Math.round(x.view.w*(x.view.w/x.page.w))),x.cursorwidth=x.opt.cursorfixedheight?x.opt.cursorfixedheight:Math.max(x.opt.cursorminheight,x.cursorwidth),x.scrollvaluemax=x.view.h-x.cursorheight-x.cursor.hborder,x.railh&&(x.railh.width=0<x.page.maxh?x.view.w-x.rail.width:x.view.w,x.scrollvaluemaxw=x.railh.width-x.cursorwidth-x.cursorh.wborder),x.checkrtlmode&&x.railh&&(x.checkrtlmode=!1,x.opt.rtlmode&&0==x.scroll.x&&x.setScrollLeft(x.page.maxw)),x.ispage||x.updateScrollBar(x.view),x.scrollratio={x:x.page.maxw/x.scrollvaluemaxw,y:x.page.maxh/x.scrollvaluemax},x.getScrollTop()>x.page.maxh?x.doScrollTop(x.page.maxh):(x.scroll.y=Math.round(x.getScrollTop()*(1/x.scrollratio.y)),x.scroll.x=Math.round(x.getScrollLeft()*(1/x.scrollratio.x)),x.cursoractive&&x.noticeCursor()),x.scroll.y&&0==x.getScrollTop()&&x.doScrollTo(Math.floor(x.scroll.y*x.scrollratio.y)),x)},this.resize=x.onResize,this.lazyResize=function(t){return t=isNaN(t)?30:t,x.delayed("resize",x.resize,t),x},this._bind=function(t,e,i,n){x.events.push({e:t,n:e,f:i,b:n,q:!1}),t.addEventListener?t.addEventListener(e,i,n||!1):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},this.jqbind=function(e,i,n){x.events.push({e:e,n:i,f:n,q:!0}),t(e).bind(i,n)},this.bind=function(t,e,i,n){var s="jquery"in t?t[0]:t;"mousewheel"==e?"onwheel"in x.win?x._bind(s,"wheel",i,n||!1):(t="undefined"!=typeof document.onmousewheel?"mousewheel":"DOMMouseScroll",v(s,t,i,n||!1),"DOMMouseScroll"==t&&v(s,"MozMousePixelScroll",i,n||!1)):s.addEventListener?(w.cantouch&&/mouseup|mousedown|mousemove/.test(e)&&x._bind(s,"mousedown"==e?"touchstart":"mouseup"==e?"touchend":"touchmove",function(t){if(t.touches){if(2>t.touches.length){var e=t.touches.length?t.touches[0]:t;e.original=t,i.call(this,e)}}else t.changedTouches&&(e=t.changedTouches[0],e.original=t,i.call(this,e))},n||!1),x._bind(s,e,i,n||!1),w.cantouch&&"mouseup"==e&&x._bind(s,"touchcancel",i,n||!1)):x._bind(s,e,function(t){return(t=t||window.event||!1)&&t.srcElement&&(t.target=t.srcElement),"pageY"in t||(t.pageX=t.clientX+document.documentElement.scrollLeft,t.pageY=t.clientY+document.documentElement.scrollTop),!1!==i.call(s,t)&&!1!==n||x.cancelEvent(t)})},this._unbind=function(t,e,i,n){t.removeEventListener?t.removeEventListener(e,i,n):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=!1},this.unbindAll=function(){for(var t=0;t<x.events.length;t++){var e=x.events[t];e.q?e.e.unbind(e.n,e.f):x._unbind(e.e,e.n,e.f,e.b)}},this.cancelEvent=function(t){return!!(t=t.original?t.original:t?t:window.event||!1)&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.preventManipulation&&t.preventManipulation(),t.cancelBubble=!0,t.cancel=!0,t.returnValue=!1)},this.stopPropagation=function(t){return!!(t=t.original?t.original:t?t:window.event||!1)&&(t.stopPropagation?t.stopPropagation():(t.cancelBubble&&(t.cancelBubble=!0),!1))},this.showRail=function(){return 0==x.page.maxh||!x.ispage&&"none"==x.win.css("display")||(x.visibility=!0,x.rail.visibility=!0,x.rail.css("display","block")),x},this.showRailHr=function(){return x.railh?(0==x.page.maxw||!x.ispage&&"none"==x.win.css("display")||(x.railh.visibility=!0,x.railh.css("display","block")),x):x},this.hideRail=function(){return x.visibility=!1,x.rail.visibility=!1,x.rail.css("display","none"),x},this.hideRailHr=function(){return x.railh?(x.railh.visibility=!1,x.railh.css("display","none"),x):x},this.show=function(){return x.hidden=!1,x.locked=!1,x.showRail().showRailHr()},this.hide=function(){return x.hidden=!0,x.locked=!0,x.hideRail().hideRailHr()},this.toggle=function(){return x.hidden?x.show():x.hide()},this.remove=function(){x.stop(),x.cursortimeout&&clearTimeout(x.cursortimeout),x.doZoomOut(),x.unbindAll(),!1!==x.observer&&x.observer.disconnect(),!1!==x.observerremover&&x.observerremover.disconnect(),x.events=[],x.cursor&&(x.cursor.remove(),x.cursor=null),x.cursorh&&(x.cursorh.remove(),x.cursorh=null),x.rail&&(x.rail.remove(),x.rail=null),x.railh&&(x.railh.remove(),x.railh=null),x.zoom&&(x.zoom.remove(),x.zoom=null);for(var t=0;t<x.saved.css.length;t++){var e=x.saved.css[t];e[0].css(e[1],"undefined"==typeof e[2]?"":e[2])}return x.saved=!1,x.me.data("__nicescroll",""),x.me=null,x.doc=null,x.docscroll=null,x.win=null,x},this.scrollstart=function(t){return this.onscrollstart=t,x},this.scrollend=function(t){return this.onscrollend=t,x},this.scrollcancel=function(t){return this.onscrollcancel=t,x},this.zoomin=function(t){return this.onzoomin=t,x},this.zoomout=function(t){return this.onzoomout=t,x},this.isScrollable=function(e){if(e=e.target?e.target:e,"OPTION"==e.nodeName)return!0;for(;e&&1==e.nodeType&&!/BODY|HTML/.test(e.nodeName);){var i=t(e),i=i.css("overflowY")||i.css("overflowX")||i.css("overflow")||"";if(/scroll|auto/.test(i))return e.clientHeight!=e.scrollHeight;e=!!e.parentNode&&e.parentNode}return!1},this.getViewport=function(e){for(e=!(!e||!e.parentNode)&&e.parentNode;e&&1==e.nodeType&&!/BODY|HTML/.test(e.nodeName);){var i=t(e),n=i.css("overflowY")||i.css("overflowX")||i.css("overflow")||"";if(/scroll|auto/.test(n)&&e.clientHeight!=e.scrollHeight||0<i.getNiceScroll().length)return i;e=!!e.parentNode&&e.parentNode}return!1},this.onmousewheel=function(t){if(x.locked)return!0;if(x.rail.drag)return x.cancelEvent(t);if(!x.rail.scrollable)return!x.railh||!x.railh.scrollable||x.onmousewheelhr(t);var e=+new Date,i=!1;return x.opt.preservenativescrolling&&x.checkarea+600<e&&(x.nativescrollingarea=x.isScrollable(t),i=!0),x.checkarea=e,!!x.nativescrollingarea||((t=y(t,!1,i))&&(x.checkarea=0),t)},this.onmousewheelhr=function(t){if(x.locked||!x.railh.scrollable)return!0;if(x.rail.drag)return x.cancelEvent(t);var e=+new Date,i=!1;return x.opt.preservenativescrolling&&x.checkarea+600<e&&(x.nativescrollingarea=x.isScrollable(t),i=!0),x.checkarea=e,!!x.nativescrollingarea||(x.locked?x.cancelEvent(t):y(t,!0,i))},this.stop=function(){return x.cancelScroll(),x.scrollmon&&x.scrollmon.stop(),x.cursorfreezed=!1,x.scroll.y=Math.round(x.getScrollTop()*(1/x.scrollratio.y)),x.noticeCursor(),x},this.getTransitionSpeed=function(t){var e=Math.round(10*x.opt.scrollspeed);return t=Math.min(e,Math.round(t/20*x.opt.scrollspeed)),20<t?t:0},x.opt.smoothscroll?x.ishwscroll&&w.hastransition&&x.opt.usetransition?(this.prepareTransition=function(t,e){var i=e?20<t?t:0:x.getTransitionSpeed(t),n=i?w.prefixstyle+"transform "+i+"ms ease-out":"";return x.lasttransitionstyle&&x.lasttransitionstyle==n||(x.lasttransitionstyle=n,x.doc.css(w.transitionstyle,n)),i},this.doScrollLeft=function(t,e){var i=x.scrollrunning?x.newscrolly:x.getScrollTop();x.doScrollPos(t,i,e)},this.doScrollTop=function(t,e){var i=x.scrollrunning?x.newscrollx:x.getScrollLeft();x.doScrollPos(i,t,e)},this.doScrollPos=function(t,e,i){var n=x.getScrollTop(),s=x.getScrollLeft();return(0>(x.newscrolly-n)*(e-n)||0>(x.newscrollx-s)*(t-s))&&x.cancelScroll(),0==x.opt.bouncescroll&&(0>e?e=0:e>x.page.maxh&&(e=x.page.maxh),0>t?t=0:t>x.page.maxw&&(t=x.page.maxw)),(!x.scrollrunning||t!=x.newscrollx||e!=x.newscrolly)&&(x.newscrolly=e,x.newscrollx=t,x.newscrollspeed=i||!1,!x.timer&&void(x.timer=setTimeout(function(){var i,n,s=x.getScrollTop(),r=x.getScrollLeft();i=t-r,n=e-s,i=Math.round(Math.sqrt(Math.pow(i,2)+Math.pow(n,2))),i=x.newscrollspeed&&1<x.newscrollspeed?x.newscrollspeed:x.getTransitionSpeed(i),x.newscrollspeed&&1>=x.newscrollspeed&&(i*=x.newscrollspeed),x.prepareTransition(i,!0),x.timerscroll&&x.timerscroll.tm&&clearInterval(x.timerscroll.tm),0<i&&(!x.scrollrunning&&x.onscrollstart&&x.onscrollstart.call(x,{type:"scrollstart",current:{x:r,y:s},request:{x:t,y:e},end:{x:x.newscrollx,y:x.newscrolly},speed:i}),w.transitionend?x.scrollendtrapped||(x.scrollendtrapped=!0,x.bind(x.doc,w.transitionend,x.onScrollEnd,!1)):(x.scrollendtrapped&&clearTimeout(x.scrollendtrapped),x.scrollendtrapped=setTimeout(x.onScrollEnd,i)),x.timerscroll={bz:new BezierClass(s,x.newscrolly,i,0,0,.58,1),bh:new BezierClass(r,x.newscrollx,i,0,0,.58,1)},x.cursorfreezed||(x.timerscroll.tm=setInterval(function(){x.showCursor(x.getScrollTop(),x.getScrollLeft())},60))),x.synched("doScroll-set",function(){x.timer=0,x.scrollendtrapped&&(x.scrollrunning=!0),x.setScrollTop(x.newscrolly),x.setScrollLeft(x.newscrollx),x.scrollendtrapped||x.onScrollEnd()})},50)))},this.cancelScroll=function(){if(!x.scrollendtrapped)return!0;var t=x.getScrollTop(),e=x.getScrollLeft();return x.scrollrunning=!1,w.transitionend||clearTimeout(w.transitionend),x.scrollendtrapped=!1,x._unbind(x.doc,w.transitionend,x.onScrollEnd),x.prepareTransition(0),x.setScrollTop(t),x.railh&&x.setScrollLeft(e),x.timerscroll&&x.timerscroll.tm&&clearInterval(x.timerscroll.tm),x.timerscroll=!1,x.cursorfreezed=!1,x.showCursor(t,e),x},this.onScrollEnd=function(){x.scrollendtrapped&&x._unbind(x.doc,w.transitionend,x.onScrollEnd),x.scrollendtrapped=!1,x.prepareTransition(0),x.timerscroll&&x.timerscroll.tm&&clearInterval(x.timerscroll.tm),x.timerscroll=!1;var t=x.getScrollTop(),e=x.getScrollLeft();return x.setScrollTop(t),x.railh&&x.setScrollLeft(e),x.noticeCursor(!1,t,e),x.cursorfreezed=!1,0>t?t=0:t>x.page.maxh&&(t=x.page.maxh),0>e?e=0:e>x.page.maxw&&(e=x.page.maxw),t!=x.newscrolly||e!=x.newscrollx?x.doScrollPos(e,t,x.opt.snapbackspeed):(x.onscrollend&&x.scrollrunning&&x.onscrollend.call(x,{type:"scrollend",current:{x:e,y:t},end:{x:x.newscrollx,y:x.newscrolly}}),void(x.scrollrunning=!1))}):(this.doScrollLeft=function(t,e){var i=x.scrollrunning?x.newscrolly:x.getScrollTop();x.doScrollPos(t,i,e)},this.doScrollTop=function(t,e){var i=x.scrollrunning?x.newscrollx:x.getScrollLeft();x.doScrollPos(i,t,e)},this.doScrollPos=function(t,e,i){function n(){if(x.cancelAnimationFrame)return!0;if(x.scrollrunning=!0,u=1-u)return x.timer=h(n)||1;var t=0,e=sy=x.getScrollTop();if(x.dst.ay){var e=x.bzscroll?x.dst.py+x.bzscroll.getNow()*x.dst.ay:x.newscrolly,i=e-sy;(0>i&&e<x.newscrolly||0<i&&e>x.newscrolly)&&(e=x.newscrolly),x.setScrollTop(e),e==x.newscrolly&&(t=1)}else t=1;var s=sx=x.getScrollLeft();x.dst.ax?(s=x.bzscroll?x.dst.px+x.bzscroll.getNow()*x.dst.ax:x.newscrollx,i=s-sx,(0>i&&s<x.newscrollx||0<i&&s>x.newscrollx)&&(s=x.newscrollx),x.setScrollLeft(s),s==x.newscrollx&&(t+=1)):t+=1,2==t?(x.timer=0,x.cursorfreezed=!1,x.bzscroll=!1,x.scrollrunning=!1,0>e?e=0:e>x.page.maxh&&(e=x.page.maxh),0>s?s=0:s>x.page.maxw&&(s=x.page.maxw),s!=x.newscrollx||e!=x.newscrolly?x.doScrollPos(s,e):x.onscrollend&&x.onscrollend.call(x,{type:"scrollend",current:{x:sx,y:sy},end:{x:x.newscrollx,y:x.newscrolly}})):x.timer=h(n)||1}if(e="undefined"==typeof e||!1===e?x.getScrollTop(!0):e,x.timer&&x.newscrolly==e&&x.newscrollx==t)return!0;x.timer&&l(x.timer),x.timer=0;var s=x.getScrollTop(),r=x.getScrollLeft();(0>(x.newscrolly-s)*(e-s)||0>(x.newscrollx-r)*(t-r))&&x.cancelScroll(),x.newscrolly=e,x.newscrollx=t,x.bouncescroll&&x.rail.visibility||(0>x.newscrolly?x.newscrolly=0:x.newscrolly>x.page.maxh&&(x.newscrolly=x.page.maxh)),x.bouncescroll&&x.railh.visibility||(0>x.newscrollx?x.newscrollx=0:x.newscrollx>x.page.maxw&&(x.newscrollx=x.page.maxw)),x.dst={},x.dst.x=t-r,x.dst.y=e-s,x.dst.px=r,x.dst.py=s;var o=Math.round(Math.sqrt(Math.pow(x.dst.x,2)+Math.pow(x.dst.y,2)));x.dst.ax=x.dst.x/o,x.dst.ay=x.dst.y/o;var a=0,c=o;if(0==x.dst.x?(a=s,c=e,x.dst.ay=1,x.dst.py=0):0==x.dst.y&&(a=r,c=t,x.dst.ax=1,x.dst.px=0),o=x.getTransitionSpeed(o),i&&1>=i&&(o*=i),x.bzscroll=0<o&&(x.bzscroll?x.bzscroll.update(c,o):new BezierClass(a,c,o,0,1,0,1)),!x.timer){(s==x.page.maxh&&e>=x.page.maxh||r==x.page.maxw&&t>=x.page.maxw)&&x.checkContentSize();var u=1;x.cancelAnimationFrame=!1,x.timer=1,x.onscrollstart&&!x.scrollrunning&&x.onscrollstart.call(x,{type:"scrollstart",current:{x:r,y:s},request:{x:t,y:e},end:{x:x.newscrollx,y:x.newscrolly},speed:o}),n(),(s==x.page.maxh&&e>=s||r==x.page.maxw&&t>=r)&&x.checkContentSize(),x.noticeCursor()}},this.cancelScroll=function(){return x.timer&&l(x.timer),x.timer=0,x.bzscroll=!1,x.scrollrunning=!1,x}):(this.doScrollLeft=function(t,e){var i=x.getScrollTop();x.doScrollPos(t,i,e)},this.doScrollTop=function(t,e){var i=x.getScrollLeft();x.doScrollPos(i,t,e)},this.doScrollPos=function(t,e,i){var n=t>x.page.maxw?x.page.maxw:t;0>n&&(n=0);var s=e>x.page.maxh?x.page.maxh:e;0>s&&(s=0),x.synched("scroll",function(){x.setScrollTop(s),x.setScrollLeft(n)})},this.cancelScroll=function(){}),this.doScrollBy=function(t,e){var i=0,i=e?Math.floor((x.scroll.y-t)*x.scrollratio.y):(x.timer?x.newscrolly:x.getScrollTop(!0))-t;if(x.bouncescroll){var n=Math.round(x.view.h/2);i<-n?i=-n:i>x.page.maxh+n&&(i=x.page.maxh+n)}return x.cursorfreezed=!1,py=x.getScrollTop(!0),0>i&&0>=py?x.noticeCursor():i>x.page.maxh&&py>=x.page.maxh?(x.checkContentSize(),x.noticeCursor()):void x.doScrollTop(i)},this.doScrollLeftBy=function(t,e){var i=0,i=e?Math.floor((x.scroll.x-t)*x.scrollratio.x):(x.timer?x.newscrollx:x.getScrollLeft(!0))-t;if(x.bouncescroll){var n=Math.round(x.view.w/2);i<-n?i=-n:i>x.page.maxw+n&&(i=x.page.maxw+n)}return x.cursorfreezed=!1,px=x.getScrollLeft(!0),0>i&&0>=px||i>x.page.maxw&&px>=x.page.maxw?x.noticeCursor():void x.doScrollLeft(i)},this.doScrollTo=function(t,e){e&&Math.round(t*x.scrollratio.y),x.cursorfreezed=!1,x.doScrollTop(t)},this.checkContentSize=function(){var t=x.getContentSize();(t.h!=x.page.h||t.w!=x.page.w)&&x.resize(!1,t)},x.onscroll=function(t){x.rail.drag||x.cursorfreezed||x.synched("scroll",function(){x.scroll.y=Math.round(x.getScrollTop()*(1/x.scrollratio.y)),x.railh&&(x.scroll.x=Math.round(x.getScrollLeft()*(1/x.scrollratio.x))),x.noticeCursor()})},x.bind(x.docscroll,"scroll",x.onscroll),this.doZoomIn=function(e){if(!x.zoomactive){x.zoomactive=!0,x.zoomrestore={style:{}};var i,n="position top left zIndex backgroundColor marginTop marginBottom marginLeft marginRight".split(" "),s=x.win[0].style;for(i in n){var o=n[i];x.zoomrestore.style[o]="undefined"!=typeof s[o]?s[o]:""}return x.zoomrestore.style.width=x.win.css("width"),x.zoomrestore.style.height=x.win.css("height"),x.zoomrestore.padding={w:x.win.outerWidth()-x.win.width(),h:x.win.outerHeight()-x.win.height()},w.isios4&&(x.zoomrestore.scrollTop=t(window).scrollTop(),t(window).scrollTop(0)),x.win.css({position:w.isios4?"absolute":"fixed",top:0,left:0,"z-index":r+100,margin:"0px"}),n=x.win.css("backgroundColor"),(""==n||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(n))&&x.win.css("backgroundColor","#fff"),x.rail.css({"z-index":r+101}),x.zoom.css({"z-index":r+102}),x.zoom.css("backgroundPosition","0px -18px"),x.resizeZoom(),x.onzoomin&&x.onzoomin.call(x),x.cancelEvent(e)}},this.doZoomOut=function(e){if(x.zoomactive)return x.zoomactive=!1,x.win.css("margin",""),x.win.css(x.zoomrestore.style),w.isios4&&t(window).scrollTop(x.zoomrestore.scrollTop),x.rail.css({"z-index":x.zindex}),x.zoom.css({"z-index":x.zindex}),x.zoomrestore=!1,x.zoom.css("backgroundPosition","0px 0px"),x.onResize(),x.onzoomout&&x.onzoomout.call(x),x.cancelEvent(e)},this.doZoom=function(t){return x.zoomactive?x.doZoomOut(t):x.doZoomIn(t)},this.resizeZoom=function(){if(x.zoomactive){var e=x.getScrollTop();x.win.css({width:t(window).width()-x.zoomrestore.padding.w+"px",height:t(window).height()-x.zoomrestore.padding.h+"px"}),x.onResize(),x.setScrollTop(Math.min(x.page.maxh,e))}},this.init(),t.nicescroll.push(this)},m=function(t){var e=this;this.nc=t,this.steptime=this.lasttime=this.speedy=this.speedx=this.lasty=this.lastx=0,this.snapy=this.snapx=!1,this.demuly=this.demulx=0,this.lastscrolly=this.lastscrollx=-1,this.timer=this.chky=this.chkx=0,this.time=function(){return+new Date},this.reset=function(t,i){e.stop();var n=e.time();e.steptime=0,e.lasttime=n,e.speedx=0,e.speedy=0,e.lastx=t,e.lasty=i,e.lastscrollx=-1,e.lastscrolly=-1},this.update=function(t,i){var n=e.time();e.steptime=n-e.lasttime,e.lasttime=n;var n=i-e.lasty,s=t-e.lastx,r=e.nc.getScrollTop(),o=e.nc.getScrollLeft(),r=r+n,o=o+s;e.snapx=0>o||o>e.nc.page.maxw,e.snapy=0>r||r>e.nc.page.maxh,e.speedx=s,e.speedy=n,e.lastx=t,e.lasty=i},this.stop=function(){e.nc.unsynched("domomentum2d"),e.timer&&clearTimeout(e.timer),e.timer=0,e.lastscrollx=-1,e.lastscrolly=-1},this.doSnapy=function(t,i){var n=!1;0>i?(i=0,n=!0):i>e.nc.page.maxh&&(i=e.nc.page.maxh,n=!0),0>t?(t=0,n=!0):t>e.nc.page.maxw&&(t=e.nc.page.maxw,n=!0),n&&e.nc.doScrollPos(t,i,e.nc.opt.snapbackspeed)},this.doMomentum=function(t){var i=e.time(),n=t?i+t:e.lasttime;t=e.nc.getScrollLeft();var s=e.nc.getScrollTop(),r=e.nc.page.maxh,o=e.nc.page.maxw;if(e.speedx=0<o?Math.min(60,e.speedx):0,e.speedy=0<r?Math.min(60,e.speedy):0,n=n&&50>=i-n,(0>s||s>r||0>t||t>o)&&(n=!1),t=!(!e.speedx||!n)&&e.speedx,e.speedy&&n&&e.speedy||t){var a=Math.max(16,e.steptime);50<a&&(t=a/50,e.speedx*=t,e.speedy*=t,a=50),e.demulxy=0,e.lastscrollx=e.nc.getScrollLeft(),e.chkx=e.lastscrollx,e.lastscrolly=e.nc.getScrollTop(),e.chky=e.lastscrolly;var h=e.lastscrollx,l=e.lastscrolly,c=function(){var t=600<e.time()-i?.04:.02;e.speedx&&(h=Math.floor(e.lastscrollx-e.speedx*(1-e.demulxy)),e.lastscrollx=h,0>h||h>o)&&(t=.1),e.speedy&&(l=Math.floor(e.lastscrolly-e.speedy*(1-e.demulxy)),e.lastscrolly=l,0>l||l>r)&&(t=.1),e.demulxy=Math.min(1,e.demulxy+t),e.nc.synched("domomentum2d",function(){e.speedx&&(e.nc.getScrollLeft()!=e.chkx&&e.stop(),e.chkx=h,e.nc.setScrollLeft(h)),e.speedy&&(e.nc.getScrollTop()!=e.chky&&e.stop(),e.chky=l,e.nc.setScrollTop(l)),e.timer||(e.nc.hideCursor(),e.doSnapy(h,l))}),1>e.demulxy?e.timer=setTimeout(c,a):(e.stop(),e.nc.hideCursor(),e.doSnapy(h,l))};c()}else e.doSnapy(e.nc.getScrollLeft(),e.nc.getScrollTop())}},g=t.fn.scrollTop;t.cssHooks.pageYOffset={get:function(e,i,n){return(i=t.data(e,"__nicescroll")||!1)&&i.ishwscroll?i.getScrollTop():g.call(e)},set:function(e,i){var n=t.data(e,"__nicescroll")||!1;return n&&n.ishwscroll?n.setScrollTop(parseInt(i)):g.call(e,i),this}},t.fn.scrollTop=function(e){if("undefined"==typeof e){var i=!!this[0]&&(t.data(this[0],"__nicescroll")||!1);return i&&i.ishwscroll?i.getScrollTop():g.call(this)}return this.each(function(){var i=t.data(this,"__nicescroll")||!1;i&&i.ishwscroll?i.setScrollTop(parseInt(e)):g.call(t(this),e)})};var v=t.fn.scrollLeft;t.cssHooks.pageXOffset={get:function(e,i,n){return(i=t.data(e,"__nicescroll")||!1)&&i.ishwscroll?i.getScrollLeft():v.call(e)},set:function(e,i){var n=t.data(e,"__nicescroll")||!1;return n&&n.ishwscroll?n.setScrollLeft(parseInt(i)):v.call(e,i),this}},t.fn.scrollLeft=function(e){if("undefined"==typeof e){var i=!!this[0]&&(t.data(this[0],"__nicescroll")||!1);return i&&i.ishwscroll?i.getScrollLeft():v.call(this)}return this.each(function(){var i=t.data(this,"__nicescroll")||!1;i&&i.ishwscroll?i.setScrollLeft(parseInt(e)):v.call(t(this),e)})};var y=function(e){var i=this;if(this.length=0,this.name="nicescrollarray",this.each=function(t){for(var e=0;e<i.length;e++)t.call(i[e]);return i},this.push=function(t){i[i.length]=t,i.length++},this.eq=function(t){return i[t]},e)for(a=0;a<e.length;a++){var n=t.data(e[a],"__nicescroll")||!1;n&&(this[this.length]=n,this.length++)}return this};!function(t,e,i){for(var n=0;n<e.length;n++)i(t,e[n])}(y.prototype,"show hide toggle onResize resize remove stop doScrollPos".split(" "),function(t,e){t[e]=function(){var t=arguments;return this.each(function(){this[e].apply(this,t)})}}),t.fn.getNiceScroll=function(e){return"undefined"==typeof e?new y(this):t.data(this[e],"__nicescroll")||!1},t.extend(t.expr[":"],{nicescroll:function(e){return!!t.data(e,"__nicescroll")}}),t.fn.niceScroll=function(e,i){"undefined"==typeof i&&"object"==typeof e&&!("jquery"in e)&&(i=e,e=!1);var n=new y;"undefined"==typeof i&&(i={}),e&&(i.doc=t(e),i.win=t(this));var s=!("doc"in i);return!s&&!("win"in i)&&(i.win=t(this)),this.each(function(){var e=t(this).data("__nicescroll")||!1;e||(i.doc=s?t(this):i.doc,e=new f(i,t(this)),t(this).data("__nicescroll",e)),n.push(e)}),1==n.length?n[0]:n},window.NiceScroll={getjQuery:function(){return t}},t.nicescroll||(t.nicescroll=new y,t.nicescroll.options=u)}(jQuery),define("niceScroll",["jquery"],function(){}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){"use strict";var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",function(){i=!0});var s=function(){i||t(n).trigger(t.support.transition.end)};return setTimeout(s,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),s=i.data("bs.alert");s||i.data("bs.alert",s=new n(this)),"string"==typeof e&&s[e].call(i)})}var i='[data-dismiss="alert"]',n=function(e){t(e).on("click",i,this.close)};n.VERSION="3.3.4",n.TRANSITION_DURATION=150,n.prototype.close=function(e){function i(){o.detach().trigger("closed.bs.alert").remove()}var s=t(this),r=s.attr("data-target");r||(r=s.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var o=t(r);e&&e.preventDefault(),o.length||(o=s.closest(".alert")),o.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i())};var s=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=n,t.fn.alert.noConflict=function(){return t.fn.alert=s,this},t(document).on("click.bs.alert.data-api",i,n.prototype.close)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.button"),r="object"==typeof e&&e;s||n.data("bs.button",s=new i(this,r)),"toggle"==e?s.toggle():e&&s.setState(e)})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.isLoading=!1};i.VERSION="3.3.4",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(e){var i="disabled",n=this.$element,s=n.is("input")?"val":"html",r=n.data();e+="Text",null==r.resetText&&n.data("resetText",n[s]()),setTimeout(t.proxy(function(){n[s](null==r[e]?this.options[e]:r[e]),"loadingText"==e?(this.isLoading=!0,n.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i))},this),0)},i.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));t&&this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=e,t.fn.button.Constructor=i,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var n=t(i.target);n.hasClass("btn")||(n=n.closest(".btn")),e.call(n,"toggle"),i.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.carousel"),r=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e),o="string"==typeof e?e:r.slide;s||n.data("bs.carousel",s=new i(this,r)),"number"==typeof e?s.to(e):o?s[o]():r.interval&&s.pause().cycle()})}var i=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};i.VERSION="3.3.4",i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e),n="prev"==t&&0===i||"next"==t&&i==this.$items.length-1;if(n&&!this.options.wrap)return e;var s="prev"==t?-1:1,r=(i+s)%this.$items.length;return this.$items.eq(r)},i.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){if(!this.sliding)return this.slide("next")},i.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},i.prototype.slide=function(e,n){var s=this.$element.find(".item.active"),r=n||this.getItemForDirection(e,s),o=this.interval,a="next"==e?"left":"right",h=this;if(r.hasClass("active"))return this.sliding=!1;var l=r[0],c=t.Event("slide.bs.carousel",{relatedTarget:l,direction:a});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=t(this.$indicators.children()[this.getItemIndex(r)]);u&&u.addClass("active")}var d=t.Event("slid.bs.carousel",{relatedTarget:l,direction:a});return t.support.transition&&this.$element.hasClass("slide")?(r.addClass(e),r[0].offsetWidth,s.addClass(a),r.addClass(a),s.one("bsTransitionEnd",function(){r.removeClass([e,a].join(" ")).addClass("active"),s.removeClass(["active",a].join(" ")),h.sliding=!1,setTimeout(function(){h.$element.trigger(d)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(s.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger(d)),o&&this.cycle(),this}};var n=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=n,this};var s=function(i){var n,s=t(this),r=t(s.attr("data-target")||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(r.hasClass("carousel")){
var o=t.extend({},r.data(),s.data()),a=s.attr("data-slide-to");a&&(o.interval=!1),e.call(r,o),a&&r.data("bs.carousel").to(a),i.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",s).on("click.bs.carousel.data-api","[data-slide-to]",s),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery),+function(t){"use strict";function e(e){var i,n=e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return t(n)}function i(e){return this.each(function(){var i=t(this),s=i.data("bs.collapse"),r=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e);!s&&r.toggle&&/show|hide/.test(e)&&(r.toggle=!1),s||i.data("bs.collapse",s=new n(this,r)),"string"==typeof e&&s[e]()})}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};n.VERSION="3.3.4",n.TRANSITION_DURATION=350,n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,s=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(s&&s.length&&(e=s.data("bs.collapse"),e&&e.transitioning))){var r=t.Event("show.bs.collapse");if(this.$element.trigger(r),!r.isDefaultPrevented()){s&&s.length&&(i.call(s,"hide"),e||s.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var h=t.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(n.TRANSITION_DURATION)[o](this.$element[0][h])}}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var s=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[i](0).one("bsTransitionEnd",t.proxy(s,this)).emulateTransitionEnd(n.TRANSITION_DURATION):s.call(this)}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},n.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(i,n){var s=t(n);this.addAriaAndCollapsedClass(e(s),s)},this)).end()},n.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var s=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=n,t.fn.collapse.noConflict=function(){return t.fn.collapse=s,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(n){var s=t(this);s.attr("data-target")||n.preventDefault();var r=e(s),o=r.data("bs.collapse"),a=o?"toggle":s.data();i.call(r,a)})}(jQuery),+function(t){"use strict";function e(e){e&&3===e.which||(t(s).remove(),t(r).each(function(){var n=t(this),s=i(n),r={relatedTarget:this};s.hasClass("open")&&(s.trigger(e=t.Event("hide.bs.dropdown",r)),e.isDefaultPrevented()||(n.attr("aria-expanded","false"),s.removeClass("open").trigger("hidden.bs.dropdown",r)))}))}function i(e){var i=e.attr("data-target");i||(i=e.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&t(i);return n&&n.length?n:e.parent()}function n(e){return this.each(function(){var i=t(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new o(this)),"string"==typeof e&&n[e].call(i)})}var s=".dropdown-backdrop",r='[data-toggle="dropdown"]',o=function(e){t(e).on("click.bs.dropdown",this.toggle)};o.VERSION="3.3.4",o.prototype.toggle=function(n){var s=t(this);if(!s.is(".disabled, :disabled")){var r=i(s),o=r.hasClass("open");if(e(),!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e);var a={relatedTarget:this};if(r.trigger(n=t.Event("show.bs.dropdown",a)),n.isDefaultPrevented())return;s.trigger("focus").attr("aria-expanded","true"),r.toggleClass("open").trigger("shown.bs.dropdown",a)}return!1}},o.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var n=t(this);if(e.preventDefault(),e.stopPropagation(),!n.is(".disabled, :disabled")){var s=i(n),o=s.hasClass("open");if(!o&&27!=e.which||o&&27==e.which)return 27==e.which&&s.find(r).trigger("focus"),n.trigger("click");var a=" li:not(.disabled):visible a",h=s.find('[role="menu"]'+a+', [role="listbox"]'+a);if(h.length){var l=h.index(e.target);38==e.which&&l>0&&l--,40==e.which&&l<h.length-1&&l++,~l||(l=0),h.eq(l).trigger("focus")}}}};var a=t.fn.dropdown;t.fn.dropdown=n,t.fn.dropdown.Constructor=o,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",r,o.prototype.toggle).on("keydown.bs.dropdown.data-api",r,o.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',o.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',o.prototype.keydown)}(jQuery),+function(t){"use strict";function e(e,n){return this.each(function(){var s=t(this),r=s.data("bs.modal"),o=t.extend({},i.DEFAULTS,s.data(),"object"==typeof e&&e);r||s.data("bs.modal",r=new i(this,o)),"string"==typeof e?r[e](n):o.show&&r.show(n)})}var i=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.3.4",i.TRANSITION_DURATION=300,i.BACKDROP_TRANSITION_DURATION=150,i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},i.prototype.show=function(e){var n=this,s=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(s),this.isShown||s.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){n.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(n.$element)&&(n.ignoreBackdropClick=!0)})}),this.backdrop(function(){var s=t.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),s&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var r=t.Event("shown.bs.modal",{relatedTarget:e});s?n.$dialog.one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(r)}).emulateTransitionEnd(i.TRANSITION_DURATION):n.$element.trigger("focus").trigger(r)}))},i.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(i.TRANSITION_DURATION):this.hideModal())},i.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},i.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},i.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(e){var n=this,s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=t.support.transition&&s;if(this.$backdrop=t('<div class="modal-backdrop '+s+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;r?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){n.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):o()}else e&&e()},i.prototype.handleUpdate=function(){this.adjustDialog()},i.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},i.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},i.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},i.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},i.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var n=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=i,t.fn.modal.noConflict=function(){return t.fn.modal=n,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var n=t(this),s=n.attr("href"),r=t(n.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),o=r.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(s)&&s},r.data(),n.data());n.is("a")&&i.preventDefault(),r.one("show.bs.modal",function(t){t.isDefaultPrevented()||r.one("hidden.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})}),e.call(r,o,this)})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.tooltip"),r="object"==typeof e&&e;!s&&/destroy|hide/.test(e)||(s||n.data("bs.tooltip",s=new i(this,r)),"string"==typeof e&&s[e]())})}var i=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.init("tooltip",t,e)};i.VERSION="3.3.4",i.TRANSITION_DURATION=150,i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(e,i,n){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&t(this.options.viewport.selector||this.options.viewport),this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var s=this.options.trigger.split(" "),r=s.length;r--;){var o=s[r];if("click"==o)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=o){var a="hover"==o?"mouseenter":"focusin",h="hover"==o?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(h+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},i.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,n){i[t]!=n&&(e[t]=n)}),e},i.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i&&i.$tip&&i.$tip.is(":visible")?void(i.hoverState="in"):(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},i.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},i.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var n=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!n)return;var s=this,r=this.tip(),o=this.getUID(this.type);this.setContent(),r.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&r.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,l=h.test(a);l&&(a=a.replace(h,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);var c=this.getPosition(),u=r[0].offsetWidth,d=r[0].offsetHeight;if(l){var p=a,f=this.options.container?t(this.options.container):this.$element.parent(),m=this.getPosition(f);a="bottom"==a&&c.bottom+d>m.bottom?"top":"top"==a&&c.top-d<m.top?"bottom":"right"==a&&c.right+u>m.width?"left":"left"==a&&c.left-u<m.left?"right":a,r.removeClass(p).addClass(a)}var g=this.getCalculatedOffset(a,c,u,d);this.applyPlacement(g,a);var v=function(){var t=s.hoverState;s.$element.trigger("shown.bs."+s.type),s.hoverState=null,"out"==t&&s.leave(s)};t.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",v).emulateTransitionEnd(i.TRANSITION_DURATION):v()}},i.prototype.applyPlacement=function(e,i){var n=this.tip(),s=n[0].offsetWidth,r=n[0].offsetHeight,o=parseInt(n.css("margin-top"),10),a=parseInt(n.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(a)&&(a=0),e.top=e.top+o,e.left=e.left+a,t.offset.setOffset(n[0],t.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),n.addClass("in");var h=n[0].offsetWidth,l=n[0].offsetHeight;"top"==i&&l!=r&&(e.top=e.top+r-l);var c=this.getViewportAdjustedDelta(i,e,h,l);c.left?e.left+=c.left:e.top+=c.top;var u=/top|bottom/.test(i),d=u?2*c.left-s+h:2*c.top-r+l,p=u?"offsetWidth":"offsetHeight";n.offset(e),this.replaceArrow(d,n[0][p],u)},i.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},i.prototype.hide=function(e){function n(){"in"!=s.hoverState&&r.detach(),s.$element.removeAttr("aria-describedby").trigger("hidden.bs."+s.type),e&&e()}var s=this,r=t(this.$tip),o=t.Event("hide.bs."+this.type);if(this.$element.trigger(o),!o.isDefaultPrevented())return r.removeClass("in"),t.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n(),this.hoverState=null,this},i.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],n="BODY"==i.tagName,s=i.getBoundingClientRect();null==s.width&&(s=t.extend({},s,{width:s.right-s.left,height:s.bottom-s.top}));var r=n?{top:0,left:0}:e.offset(),o={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},a=n?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},s,o,a,r)},i.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},i.prototype.getViewportAdjustedDelta=function(t,e,i,n){var s={top:0,left:0};if(!this.$viewport)return s;var r=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-r-o.scroll,h=e.top+r-o.scroll+n;a<o.top?s.top=o.top-a:h>o.top+o.height&&(s.top=o.top+o.height-h)}else{var l=e.left-r,c=e.left+r+i;l<o.left?s.left=o.left-l:c>o.width&&(s.left=o.left+o.width-c)}return s},i.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},i.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},i.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(e){var i=this;e&&(i=t(e.currentTarget).data("bs."+this.type),i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type)})};var n=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=n,this}}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.popover"),r="object"==typeof e&&e;!s&&/destroy|hide/.test(e)||(s||n.data("bs.popover",s=new i(this,r)),"string"==typeof e&&s[e]())})}var i=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");i.VERSION="3.3.4",i.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof i?"html":"append":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var n=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=i,t.fn.popover.noConflict=function(){return t.fn.popover=n,this}}(jQuery),+function(t){"use strict";function e(i,n){this.$body=t(document.body),this.$scrollElement=t(t(i).is(document.body)?window:i),this.options=t.extend({},e.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function i(i){return this.each(function(){var n=t(this),s=n.data("bs.scrollspy"),r="object"==typeof i&&i;s||n.data("bs.scrollspy",s=new e(this,r)),"string"==typeof i&&s[i]()})}e.VERSION="3.3.4",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,i="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(i="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),s=e.data("target")||e.attr("href"),r=/^#./.test(s)&&t(s);return r&&r.length&&r.is(":visible")&&[[r[i]().top+n,s]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),s=this.offsets,r=this.targets,o=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=n)return o!=(t=r[r.length-1])&&this.activate(t);if(o&&e<s[0])return this.activeTarget=null,this.clear();for(t=s.length;t--;)o!=r[t]&&e>=s[t]&&(void 0===s[t+1]||e<s[t+1])&&this.activate(r[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',n=t(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var n=t.fn.scrollspy;t.fn.scrollspy=i,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=n,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);i.call(e,e.data())})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.tab");s||n.data("bs.tab",s=new i(this)),"string"==typeof e&&s[e]()})}var i=function(e){this.element=t(e)};i.VERSION="3.3.4",i.TRANSITION_DURATION=150,i.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),n=e.data("target");if(n||(n=e.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var s=i.find(".active:last a"),r=t.Event("hide.bs.tab",{relatedTarget:e[0]}),o=t.Event("show.bs.tab",{relatedTarget:s[0]});if(s.trigger(r),e.trigger(o),!o.isDefaultPrevented()&&!r.isDefaultPrevented()){var a=t(n);this.activate(e.closest("li"),i),this.activate(a,a.parent(),function(){s.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:s[0]})})}}},i.prototype.activate=function(e,n,s){function r(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),s&&s()}var o=n.find("> .active"),a=s&&t.support.transition&&(o.length&&o.hasClass("fade")||!!n.find("> .fade").length);o.length&&a?o.one("bsTransitionEnd",r).emulateTransitionEnd(i.TRANSITION_DURATION):r(),o.removeClass("in")};var n=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=i,t.fn.tab.noConflict=function(){return t.fn.tab=n,this};var s=function(i){i.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',s).on("click.bs.tab.data-api",'[data-toggle="pill"]',s)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.affix"),r="object"==typeof e&&e;s||n.data("bs.affix",s=new i(this,r)),"string"==typeof e&&s[e]()})}var i=function(e,n){this.options=t.extend({},i.DEFAULTS,n),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.3.4",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getState=function(t,e,i,n){var s=this.$target.scrollTop(),r=this.$element.offset(),o=this.$target.height();if(null!=i&&"top"==this.affixed)return s<i&&"top";if("bottom"==this.affixed)return null!=i?!(s+this.unpin<=r.top)&&"bottom":!(s+o<=t-n)&&"bottom";var a=null==this.affixed,h=a?s:r.top,l=a?o:e;return null!=i&&s<=i?"top":null!=n&&h+l>=t-n&&"bottom"},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},i.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),n=this.options.offset,s=n.top,r=n.bottom,o=t(document.body).height();"object"!=typeof n&&(r=s=n),"function"==typeof s&&(s=n.top(this.$element)),"function"==typeof r&&(r=n.bottom(this.$element));var a=this.getState(o,e,s,r);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var h="affix"+(a?"-"+a:""),l=t.Event(h+".bs.affix");if(this.$element.trigger(l),l.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(h).trigger(h.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:o-e-r})}};var n=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=i,t.fn.affix.noConflict=function(){return t.fn.affix=n,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var i=t(this),n=i.data();n.offset=n.offset||{},null!=n.offsetBottom&&(n.offset.bottom=n.offsetBottom),null!=n.offsetTop&&(n.offset.top=n.offsetTop),e.call(i,n)})})}(jQuery),define("bstrap",["jquery"],function(){}),+function(t){"use strict";function e(e){var i,n=e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return t(n)}function i(e){return this.each(function(){var i=t(this),s=i.data("bs.collapse"),r=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e);!s&&r.toggle&&/show|hide/.test(e)&&(r.toggle=!1),s||i.data("bs.collapse",s=new n(this,r)),"string"==typeof e&&s[e]()})}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};n.VERSION="3.3.4",n.TRANSITION_DURATION=350,n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,s=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(s&&s.length&&(e=s.data("bs.collapse"),e&&e.transitioning))){var r=t.Event("show.bs.collapse");if(this.$element.trigger(r),!r.isDefaultPrevented()){s&&s.length&&(i.call(s,"hide"),e||s.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var h=t.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(n.TRANSITION_DURATION)[o](this.$element[0][h])}}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var s=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[i](0).one("bsTransitionEnd",t.proxy(s,this)).emulateTransitionEnd(n.TRANSITION_DURATION):s.call(this)}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},n.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(i,n){var s=t(n);this.addAriaAndCollapsedClass(e(s),s)},this)).end()},n.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var s=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=n,t.fn.collapse.noConflict=function(){return t.fn.collapse=s,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(n){var s=t(this);s.attr("data-target")||n.preventDefault();var r=e(s),o=r.data("bs.collapse"),a=o?"toggle":s.data();i.call(r,a)})}(jQuery),define("bstrapCol",["jquery"],function(){}),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={
WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",function(){i=!0});var s=function(){i||t(n).trigger(t.support.transition.end)};return setTimeout(s,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),define("bstrapTran",["jquery"],function(){}),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.carousel"),r=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e),o="string"==typeof e?e:r.slide;s||n.data("bs.carousel",s=new i(this,r)),"number"==typeof e?s.to(e):o?s[o]():r.interval&&s.pause().cycle()})}var i=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};i.VERSION="3.3.4",i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e),n="prev"==t&&0===i||"next"==t&&i==this.$items.length-1;if(n&&!this.options.wrap)return e;var s="prev"==t?-1:1,r=(i+s)%this.$items.length;return this.$items.eq(r)},i.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){if(!this.sliding)return this.slide("next")},i.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},i.prototype.slide=function(e,n){var s=this.$element.find(".item.active"),r=n||this.getItemForDirection(e,s),o=this.interval,a="next"==e?"left":"right",h=this;if(r.hasClass("active"))return this.sliding=!1;var l=r[0],c=t.Event("slide.bs.carousel",{relatedTarget:l,direction:a});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=t(this.$indicators.children()[this.getItemIndex(r)]);u&&u.addClass("active")}var d=t.Event("slid.bs.carousel",{relatedTarget:l,direction:a});return t.support.transition&&this.$element.hasClass("slide")?(r.addClass(e),r[0].offsetWidth,s.addClass(a),r.addClass(a),s.one("bsTransitionEnd",function(){r.removeClass([e,a].join(" ")).addClass("active"),s.removeClass(["active",a].join(" ")),h.sliding=!1,setTimeout(function(){h.$element.trigger(d)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(s.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger(d)),o&&this.cycle(),this}};var n=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=n,this};var s=function(i){var n,s=t(this),r=t(s.attr("data-target")||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(r.hasClass("carousel")){var o=t.extend({},r.data(),s.data()),a=s.attr("data-slide-to");a&&(o.interval=!1),e.call(r,o),a&&r.data("bs.carousel").to(a),i.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",s).on("click.bs.carousel.data-api","[data-slide-to]",s),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery),define("bstrapCaro",["jquery"],function(){}),define("sMods/TemplateModule",["chartjs","jqueryUI"],function(t,e){return function(){return{createButton:function(t,e,i){this.firstSlider=!0,$("#modules").append('<div class="row moduleRow'+t+' smallModule"><div class="col-sm-4 col-md-4 custom-col-md-4 col-lg-4 custom-col-lg-4"><div class= "row"><div class="col-sm-5 col-md-5 col-lg-5"><i class="fa fa-minus fa-lg greyOutClick" id="greyOut'+t+'"></i></div><div class="col-sm-7 col-md-7"></div></div><div class="row factorOverlay factorOverlay'+t+'"><div class="col-sm-12 col-md-12 col-lg-12"></div></div><div class="row factorWrapper"><div class="buttonColumn"><div class="moduleButtonContainer"><div id="moduleButton'+t+'" class="factorIcon"><div class="overlayDiv overlayDiv1"></div></div></div></div><div class="labelColumn"><span id="moduleButtonLabel'+t+'" class="moduleButtonLabel">'+e+'</span></div></div></div><div id="sliderRow'+t+'" class="col-sm-8 col-md-8 custom-col-lg-8-sliderRow custom-col-8-sliderRow sliderRow"><div class="sliderNavButtonUI2 sliderNavLeftUI2"><button class="sliderNavFunction fa fa-chevron-left fa-3x" id="sliderNavLeftUI2"></button></div><div class="elementContainer"><ul class="elementWrapper setTransition" id="elementColumns'+t+'"><li class="sliderRowFiller"></li></ul></div><div class="sliderNavButtonUI2 sliderNavRightUI2"><button class="sliderNavFunction fa fa-chevron-right fa-3x" id="sliderNavRightUI2"></button></div></div></div>');var n=document.getElementById("moduleButton"+t);n.onclick=function(){i.setButtonValue(this.id,i)}},createSlider:function(t,e,i,n,s){$("#elementColumns"+e).append('<li class="sliderContainer sliderStyle'+e+'" id="sliderStyle'+t+'"><div class="sliderLabelMobile">'+i+'</div><div id="slider'+t+'" class="slider"><div id="sliderBackground'+t+'" class="sliderBackground'+e+'"></div></div></li>'),n<=992?$("#slider"+t).slider({max:101,min:1,value:0,animate:"fast",orientation:"horizontal",slide:function(t,e){s.setSliderValue(e,this.id,s)},change:function(t,e){s.setSliderValue(e,this.id,s)},stop:function(t,e){s.updateChartPosition(e,this.id,s)}}):$("#slider"+t).slider({max:101,min:1,value:0,animate:"fast",orientation:"vertical",slide:function(t,e){s.setSliderValue(e,this.id,s)},change:function(t,e){s.setSliderValue(e,this.id,s)},stop:function(t,e){s.updateChartPositions(e,this.id,s)}}),$("#slider"+t).append('<div class="maxMin"><div class="sliderScale"></div><div class="scaleMiddle"></div></div>'),$("#slider"+t).find("span").attr("id",t),"ui2"!=modules.uiType&&$("#"+t).append('<div class="handleBackground"></div><div id="tooltip'+t+'" class="tooltip1"><div class="tooltip1-arrow"></div><div class="tooltip1-inner"><div id="tooltipValue'+t+'" class="tooltipValue">0</div></div></div>')},createScorer:function(t,e,i,n){$("#elementColumns"+e).append('<li class="scorerContainer" id="scorerStyle'+e+'"><div id="scorer'+t+'" class="scorer"><div class="scorerLabelContainer"><div class="scorerLabelText">'+i+'</div></div><div id="scorerValue'+t+'" class="scorerValue"></div></div></li>')},createSliderYN:function(t,e){$("#elementColumns"+t).append('<div class="sliderContainerYN" id="sliderStyle'+t+'"><div id="slider'+t+'" class="sliderUI3 sliderStyle'+t+'" ><div id="sliderBackground1'+t+'" class="sliderBackgroundMiddle"></div><div id="sliderBackground2'+t+'" class="sliderBackground'+t+'"></div><div id="sliderBackground3'+t+'" class="sliderBackground'+t+'"></div><div id="sliderBackground4'+t+'" class="sliderBackgroundMiddle"></div><div class="middleScale"></div><div class="scaleYes">Yes</div><div class="scaleNo">No</div></div></div>'),$("#slider"+t).slider({max:101,min:-99,value:0,animate:"fast",orientation:"horizontal",slide:function(t,i){e.setSliderYNValue(i,this.id)},change:function(t,i){e.setSliderYNValue(i,this.id)},stop:function(t,i){e.updateChartPositions(i,this.id)}}),$("#slider"+t).append('<div class="scaleContainer"><div class="maxMinYN"><div class="centerLine"></div></div></div>');var i="sliderID"+t;$("#slider"+t).find("span").attr("id",i),$("#"+i).append('<div class="handleBackground"></div><div id="tooltip'+t+'" class="tooltip1 top"><div class="tooltip1-arrow"></div><div class="tooltip1-inner"><div id="tooltipValue'+t+'" class="tooltipValue">0</div></div></div>')},createDoughnut:function(t,e,i,n){var s="";s=this.firstSlider?"first":"defaultChartHeader",$(".results").append('<li class="'+s+'" id="canvasContainer'+t+'" totalScore="'+t+'"><div id="chartHeader'+t+'" class="result-header factor"><div id="ordianlPosition'+t+'" class="col-sm-2 col-md-2 col-lg-2 position">'+n+'</div><div class="col-sm-8 col-md-8 col-lg-8 custom-col-md-8 position">'+i+'</div><div class="col-sm-2 col-md-2 col-lg-2 positionWidth"><span id="sliderTotalSmall'+t+'" class="badge">1</span></div></div></li>'),this.firstSlider=!1,$("#canvasContainer"+t).append('<div id="canvas'+t+'" class="canvasBackground"><div class="heightFiller20"></div><div class="row"><div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 chartWidth-sm chartWidth-lg"><div class="chartContainer"><div class="sliderTotal" id="sliderTotal'+t+'"></div><canvas id=chart'+t+' width="400" height="400"></canvas></div></div><div class="col-sm-8 chart-key-col"><div class="row"><div class="col-sm-12 col-md-12 col-lg-12 leftPadding15"><table class="chartKey"><tr class="chartKeyRow"><td><div class="chartKeyDiv1"></div></td><td></td><td class="chartKeyText">Manager</td></tr><tr class="heightFiller5"><td></td><td></td><td></td></tr><tr class="chartKeyRow"><td><div class="chartKeyDiv2"></div></td><td></td><td class="chartKeyText">Goal Keeper</td></tr><tr class="heightFiller5"><td></td><td></td><td></td></tr><tr class="chartKeyRow"><td><div class="chartKeyDiv3"></div></td><td></td><td class="chartKeyText">Midfield</td></tr><tr class="heightFiller5"><td></td><td></td><td></td></tr><tr class="chartKeyRow"><td><div class="chartKeyDiv4"></div></td><td></td><td class="chartKeyText">League Position & Recent Form</td></tr><tr class="heightFiller5"><td></td><td></td><td></td></tr><tr class="chartKeyRow"><td><div class="chartKeyDiv5"></div></td><td></td><td class="chartKeyText">Attack</td></tr></table></div></div></div></div></div></div>'),document.getElementById("sliderTotal"+t).innerHTML="0",document.getElementById("sliderTotalSmall"+t).innerHTML="0";var r=document.getElementById("chart"+t).getContext("2d");return new Chart(r).Doughnut(e,{segmentShowStroke:!1,animationEasing:"easeOutQuart",animateScale:!0,animateRotate:!1,animationSteps:10,responsive:!1,maintainAspectRatio:!0,percentageInnerCutout:40,showTooltips:!1})}}}}),define("sMods/Helper",[],function(){return function(){return{l:function(t){console.log("the output is "+t)},removeClass:function(t,e){var i=document.getElementById(t).className;return i.replace(" "+e,"")},addClass:function(t,e){var i=document.getElementById(t).className;return i+" "+e},updateClassNamesAdd:function(t,e){for(var i=document.getElementsByClassName(t),n=0;n<i.length;n++)i[n].className=i[n].className+e},updateClassNamesRemove:function(t,e){for(var i=document.getElementsByClassName(t),n=0;n<i.length;n++)i[n].className=i[n].className.replace(" "+e,"")},getCSSint:function(t){var e=t.replace("px","");return parseInt(e)}}}}),define("sMods/TooltipModulesto",["sMods/Helper"],function(t){return function(){return{disableTooltip:function(){var t=this.getModules(),e=t.getElementArray();if(e[0][0])for(var i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++)e[i][n].tooltipBool&&(e[i][n].tooltipBool=!1);else for(var i=0;i<e.length;i++)e[i].tooltipBool&&(e[i].tooltipBool=!1);$(".tooltip1").css("display","none")},tooltipActivate:function(t,e){var i,n=this.getModules();if("ui3"==n.uiType)var s=e.match(/[0-9]+/g);else var e=document.getElementById(e).children[1].id,s=e.match(/[0-9]+/g);var r=n.getElementArray();if(s.length>1)for(var o=0;o<r.length;o++)for(var a=0;a<r[o].length;a++)r[o][a].tooltipBool&&r[o][a].sliderID!=s[0]+"_"+s[1]&&(r[o][a].tooltipBool=!1);else{for(var o=0;o<r.length;o++)r[o].tooltipBool&&r[o].sliderID!=s[0]&&(document.getElementById("tooltip"+r[o].sliderID).style.display="none",r[o].tooltipBool=!1);i=r[s[0]]}if("ui3"==n.uiType){var h="tooltip"+s;r[s].tooltipBool||(document.getElementById(h).style.display="block",r[s].tooltipBool=!0)}else{var h="tooltip"+s[0]+"_"+s[1];r[s[0]][s[1]].tooltipBool||(document.getElementById(h).style.display="block",r[s[0]][s[1]].tooltipBool=!0)}},setModules:function(t){this.modules=t},getModules:function(){return this.modules}}}}),define("sMods/HighLight",["sMods/Helper"],function(t){return function(){return{init:function(){this.tablist=["tabTap","tabSlide","tabDecide","tabShare"],this.bodyBindClick=!1,this.currentHighLighted1=null,this.currentHighLighted2=null},addHighLight:function(e){this.helper=new t;this.helper.addClass,this.helper.removeClass;switch(e){case"tabTap":var i=document.getElementById("tabTap").className,n=i.indexOf("selectBackground");if(n===-1){this.removeHighLightOverlay(),this.bodyRemoveHighLight(),document.getElementById("tabTap").className=i+" selectBackground",$(".overlayDiv").addClass("bc");var s=document.getElementById("labelsFirstCol").getBoundingClientRect().width,r=$("#modules").offset(),o=r.left+this.helper.getCSSint($("#labelsFirstCol").css("padding-left"));document.getElementById("sliderNav").style.background="0",this.updateOverlay("highLightOverlay1",0,$(window).width(),"tabTap",!1),this.updateOverlay("highLightOverlay2",o,s,"tabTap",!0),this.currentHighLighted1="tabTap",this.currentHighLighted2="Tap",$(".tab").unbind("click")}else $("#tabTap").removeClass("selectBackground"),$(".buttonColumn").removeClass("selectBackground"),$(".overlayDiv").removeClass("bc"),this.updateOverlay("highLightOverlay1",0,0,0,0,"",!1),this.updateOverlay("highLightOverlay2",0,0,0,0,"",!1),this.currentHighLighted1="null",this.currentHighLighted2="null";break;case"tabSlide":var i=document.getElementById("tabSlide").className,n=i.indexOf("selectBackground");if(n===-1){this.removeHighLightOverlay(),this.bodyRemoveHighLight(),"ui1"==modules.uiType?this.helper.updateClassNamesAdd("slider"," bc"):"ui2"==modules.uiType?this.helper.updateClassNamesAdd("scorer"," bc"):(this.helper.updateClassNamesRemove("tooltip1","right"),this.helper.updateClassNamesAdd("slider"," bc")),document.getElementById("tabSlide").className=i+" selectBackground";var s=document.getElementById("labelsSecondCol").getBoundingClientRect().width,a=$("#tabSlide").offset().left,h=s-this.helper.getCSSint($("#labelsSecondCol").css("padding-left"));document.getElementById("sliderNav").style.background="0",document.getElementById("sliderNavLeft").style.background="0",document.getElementById("sliderNavRight").style.background="0",document.getElementById("labelsBackground").className="",document.getElementById("sliderNavWrapper").className=this.helper.addClass("sliderNavWrapper","selectedCBC"),this.updateOverlay("highLightOverlay1",0,$(window).width(),"tabSlide",!1),this.updateOverlay("highLightOverlay2",a,h,"tabSlide",!0),this.currentHighLighted1="tabSlide",this.currentHighLighted2="Slide",$(".tab").unbind("click")}else $("#tabSlide").removeClass("selectBackground"),$(".slider").removeClass("bc"),document.getElementById("sliderNavLeft").style.background="#fff",document.getElementById("sliderNavRight").style.background="#fff",document.getElementById("labelsBackground").className="labelsBackground",document.getElementById("sliderNavWrapper").className=this.helper.removeClass("sliderNavWrapper","selectedCBC"),"ui2"==modules.uiType?this.helper.updateClassNamesRemove("scorer","bc"):this.helper.updateClassNamesRemove("slider","bc"),this.updateOverlay("highLightOverlay1",0,0,0,0,"",!1),this.updateOverlay("highLightOverlay2",0,0,0,0,"",!1),this.currentHighLighted1="null",this.currentHighLighted2="null";break;case"tabDecide":var i=document.getElementById("tabDecide").className,n=i.indexOf("selectBackground");if(n===-1){this.removeHighLightOverlay(),this.bodyRemoveHighLight(),document.getElementById("tabDecide").className=i+" selectBackground",document.getElementById("results").className=this.helper.addClass("results","selectedCBC"),$(".result-header").addClass("selectedCBC45");var l=!0;$(".results").children("li").each(function(){l?(this.className="firstNoBackground",l=!1):this.className="chartHeaderNoBackground"});document.getElementById("results").getBoundingClientRect().width;this.updateOverlay("highLightOverlay1",0,$(window).width(),"tabDecide",!1),this.currentHighLighted1="tabDecide",this.currentHighLighted2="Decide",$(".tab").unbind("click")}else{$("#tabDecide").removeClass("selectBackground"),this.helper.removeClass("results","selecetedCBC"),document.getElementById("results").className=this.helper.removeClass("results","selectedCBC"),$(".result-header").removeClass("selectedCBC45");var l=!0;$(".results").children("li").each(function(){l?(this.className="first",l=!1):this.className="defaultChartHeader"}),this.updateOverlay("highLightOverlay1",0,0,0,0,"",!1),this.currentHighLighted1="null",this.currentHighLighted2="null"}break;case"tabShare":var i=document.getElementById("results").className,n=i.indexOf("resultsDisplayNone");n===-1?(this.removeHighLightOverlay(),this.bodyRemoveHighLight(),document.getElementById("tabShare").className=this.helper.addClass("tabShare","selectBackground"),document.getElementById("results").className=this.helper.addClass("results","resultsDisplayNone"),document.getElementById("shareDropDown").style.display="block",document.getElementById("shareDropDown").style.borderTop="1px solid #1597a7",this.currentHighLighted1="tabShare",this.currentHighLighted2="Now Share",$(".tab").unbind("click")):(document.getElementById("results").className=this.helper.removeClass("results","resultsDisplayNone"),$("#tabShare").removeClass("selectBackground"),document.getElementById("shareDropDown").style.display="none",document.getElementById("shareDropDown").style.borderTop="none",this.updateOverlay("highLightOverlay1",0,0,0,0,"",!1),this.currentHighLighted1="null",this.currentHighLighted2="null")}},updateOverlay:function(t,e,i,n,s){var r=195,o=$("#game-content").css("padding-top"),a=$("#game-content").height()+parseInt(o.match(/[0-9]+/g)[0]);document.getElementById(t).style.left=e+"px",document.getElementById(t).style.top=r+"px",document.getElementById(t).style.width=i+"px",document.getElementById(t).style.height=a+"px",s&&(document.getElementById(t).style.background="#73c1ca",document.getElementById(t).style.zIndex="-1"),document.getElementById(t).setAttribute(t,n)},removeHighLightOverlay:function(){for(var t=["tabTap","tabSlide","tabDecide","tabShare"],e=0;e<t.length;e++){var i=document.getElementById(t[e]).className,n=i.indexOf("selectBackground");n!==-1&&this.addHighLight(t[e])}},bodyRemoveHighLight:function(){var t=this;$("body").click(function(e){if(t.bodyBindClick){$("body").unbind("click");var i=e.target.id,n=e.target.innerHTML;"tabTap"!=i&&"tabSlide"!=i&&"tabDecide"!=i&&"tabShare"!=i||i==t.currentHighLighted1?"Tap"!=n&&"Slide"!=n&&"Decide"!=n&&"Now Share"!=n||n==t.currentHighLighted2?(t.removeHighLightOverlay(),t.bodyBindClick=!1,$(".tab").click(function(e){var i=e.currentTarget.id;t.addHighLight(i)})):t.addHighLight(e.target.parentElement.id):t.addHighLight(i)}else t.bodyBindClick=!0})}}}}),define("sMods/SliderModule",[],function(){return function(){return{setSliderID:function(t){this.sliderValue=0,this.totalValue=0,this.sliderID=t,this.disabledBool=!1,this.tooltipBool=!1},setValues:function(t,e){if(""!==t){this.sliderValue=t.value-1;$("#"+this.sliderID).offset();$("#tooltipValue"+this.sliderID).text(this.sliderValue),document.getElementById("sliderBackground"+this.sliderID).style.width=this.sliderValue+"%"}this.totalValue=e*this.sliderValue}}}}),define("sMods/ButtonModule",[],function(){"use strict";return function(){return{setButtonID:function(t){this.buttonID=t,this.buttonUpdateID=t,this.disabledBool=!1,this.buttonValue=1},setButtonValue:function(){5===this.buttonValue?this.buttonValue=1:this.buttonValue+=1}}}}),define("sMods/DoughNutModule",[],function(){"use strict";return function(){return{setDoughnutID:function(t,e,i){this.doughnutID=t,this.doughnutObject={},this.chartStatus=!0,this.ordialPosition=e,this.totalScore=0,this.data=i}}}}),define("sMods/ScorerModule",[],function(){return function(){return{setscorerID:function(t,e){this.opValue=0,this.totalValue=0,this.scorerID=t,this.disabledBool=!1,this.tooltipBool=!1,this.overscrollStatus=!1,this.setScorerValue=0,this.timesValue=100/e},setValues:function(t,e){var i=this.setScorerValue*this.timesValue;this.totalValue=e*i}}}}),define("sMods/SliderModuleYN",[],function(){return function(){return{setSliderID:function(t){this.sliderValue=0,this.totalValue=0,this.sliderID=t,this.disabledBool=!1,this.tooltipBool=!1,this.isNegetiveBool=!1},setValues:function(t,e){if(""!==t){t<0?this.isNegetiveBool=!0:this.isNegetiveBool=!1,this.sliderValue=t-1,this.sliderValue=Math.abs(this.sliderValue),$("#tooltipValue"+this.sliderID).text(Math.abs(this.sliderValue));var i=this.sliderValue/2;this.isNegetiveBool?(document.getElementById("sliderBackground1"+this.sliderID).style.width=50-i+"%",document.getElementById("sliderBackground2"+this.sliderID).style.width=i+"%",document.getElementById("sliderBackground3"+this.sliderID).style.width="0%",document.getElementById("sliderBackground4"+this.sliderID).style.width="50%"):(document.getElementById("sliderBackground1"+this.sliderID).style.width="50%",document.getElementById("sliderBackground2"+this.sliderID).style.width="0%",document.getElementById("sliderBackground3"+this.sliderID).style.width=i+"%",document.getElementById("sliderBackground4"+this.sliderID).style.width=50-i+"%")}this.totalValue=e*this.sliderValue}}}}),define("sMods/UIModule",["sMods/TemplateModule","sMods/TooltipModulesto","sMods/HighLight","sMods/SliderModule","sMods/ButtonModule","sMods/DoughNutModule","sMods/ScorerModule","sMods/SliderModuleYN","sMods/Helper","tinysort"],function(t,e,i,n,s,r,o,a,h,l){"use strict";return function(){var c,u=[],d=[],p=[];return{init:function(t,n,s){"ie9"==document.getElementsByTagName("body")[0].getAttribute("browser")&&(document.getElementsByTagName("body")[0].className="cms-bootstrap ie9",this.ie9="ie9");var r=new e;this.setTooltip(r),this.highLight=new i,this.helper=new h,this.currentElement=0,this.elementWidth=105,this.windowWidth=$(window).width(),this.windowResizeBool=!1,this.bodyRemoveHighLight=!1,this.numberOfGreyOuts=n,this.elementLabels=["Arsenal","Chelsea","Liverpool","Portsmouth","Man United","Man City","Leeds","Bournemouth"],this.buttonLabels=["Manager","Goal Keeper & Defence","Midfield","League Position & Recent Form","Attack","Owner"],this.scorerValues=[],this.chartData=document.getElementById("jsonInput").value,this.chartData=JSON.parse(this.chartData),"ui3"==s?this.numberOfElements=n:this.numberOfElements=t,this.numberOfButtons=n,this.numberOfCharts=2,this.uiType=s,"ui1"==this.uiType?(document.getElementById("game-content").className="ui1",this.slider()):"ui2"==this.uiType?(document.getElementById("game-content").className="ui2",this.scorer()):(this.uiType="ui3")&&(document.getElementById("game-content").className="ui3",this.sliderYN()),$(".custom-col-md-4").mouseover(function(){r.disableTooltip()}),$(".custom-col-md-3").mouseover(function(){r.disableTooltip()}),document.getElementById("fixedHeader").addEventListener("mouseover",function(){r.disableTooltip()},!1),$("footer").mouseover(function(t){t.stopPropagation(),r.disableTooltip()}),$(".leftRightButton").on("mouseOver",function(t){t.stopPropagation(),r.disableTooltip()}),$(".sliderContainer").on("mouseover",function(t){t.stopPropagation(),r.tooltipActivate("",this.id)}),$(".sliderContainerYN").on("mouseover",function(t){t.stopPropagation(),r.tooltipActivate("",this.id)}),$("#modules").on("mouseout",function(t){t.stopPropagation(),r.disableTooltip("",this.id)}),this.windowWidth<=1100&&$(".sliderNavContainer1200").css("margin","0"),this.windowWidth>1100&&$(".sliderNavContainer1200").css("margin","0 auto"),this.windowWidth<=1200&&(document.getElementById("sliderLabel4").className=this.helper.addClass("sliderLabel4","hideVisibility"))},setTooltip:function(t){this.tooltip=t},getTooltip:function(){return this.tooltip},slider:function(){for(var e=new t,i=["Arsenal","Chelsea","Liverpool","Portsmouth","Man United","Man City","Leeds","Bournemouth"],o=0;o<this.numberOfElements;o++)$("#sliderNavWrapper").append('<li id="sliderLabel'+o+'" class="sliderLabelContainer">'+i[o]+"</li>");for(var o=0;o<this.numberOfButtons;o++)d[o]=new s,d[o].setButtonID(o),e.createButton(o,this.buttonLabels[o],this);for(var a=0;a<this.numberOfButtons;a++){for(var h=[],o=0;o<this.numberOfElements;o++){h[o]=new n;var l=a+"_"+o;h[o].setSliderID(l),e.createSlider(l,a,i[o],this.windowWidth,this)}u.push(h)}for(var o=0;o<this.numberOfElements;o++){p[o]=new r;var c=this.getOrdinalPosition(o+1);p[o].setDoughnutID(o,c,this.chartData),p[o].doughnutObject=e.createDoughnut(o,this.chartData,i[o],c)}if($("canvas").css({width:"100%",height:"100%"}),this.windowWidth<992)this.helper.updateClassNamesAdd("ui-slider-handle"," fa fa-minus-square fa-lg fa-rotate-90 handleStyle"),this.helper.updateClassNamesAdd("tooltip1"," top"),this.windowResizeBool=!0;else{this.helper.updateClassNamesAdd("ui-slider-handle"," fa fa-minus-square fa-2x handleStyle"),this.helper.updateClassNamesAdd("tooltip1"," right");var f=this.elementWidth*this.numberOfElements+30;$(".elementWrapper").css("width",f),$(".sliderNavWrapper").css("width",f)}this.updateChartPositions()},scorer:function(){for(var e=this,i=new t,n=0;n<this.numberOfElements;n++)$("#sliderNavWrapper").append('<li id="sliderLabel'+n+'" class="sliderLabelContainer">'+this.elementLabels[n]+"</li>");for(var a=[],n=0;n<this.numberOfElements;n++)a[n]=n+1;for(var n=0;n<this.numberOfButtons;n++)d[n]=new s,d[n].setButtonID(n),i.createButton(n,this.buttonLabels[n],this),this.scorerValues.push(a);for(var h=0;h<this.numberOfButtons;h++){for(var l=[],n=0;n<this.numberOfElements;n++){l[n]=new o;var c=h+"_"+n;l[n].setscorerID(c,this.numberOfElements),i.createScorer(c,h,this.elementLabels[n],this.windowWidth)}u.push(l)}for(var n=0;n<this.numberOfElements;n++){p[n]=new r;var f=this.getOrdinalPosition(n+1);p[n].setDoughnutID(n,f,this.chartData),p[n].doughnutObject=i.createDoughnut(n,this.chartData,this.elementLabels[n],f)}$(".scorer").on("click",function(){e.setScorerValue(this.id)}),$("canvas").css({width:"100%",height:"100%"});var m=this.elementWidth*this.numberOfElements+30;$(".elementWrapper").css("width",m),$(".sliderNavWrapper").css("width",m),this.updateChartPositions()},sliderYN:function(){var e=["No","Yes"],i=["Manager","Goal Keeper & Defence","Midfield","League Position & Recent Form","Attack","Owner"],n=new t;this.windowResizeBool=!0;for(var o=0;o<this.numberOfbuttons;o++)$("#sliderNavWrapper").append('<li class="sliderLabelContainer">'+sliderLabels[o]+"</li>");for(var o=0;o<this.numberOfButtons;o++)d[o]=new s,d[o].setButtonID(o),n.createButton(o,i[o],this),u[o]=new a,u[o].setSliderID(o),n.createSliderYN(o,this);for(var o=0;o<this.numberOfCharts;o++){p[o]=new r;var h=this.getOrdinalPosition(o+1);p[o].setDoughnutID(o,h,this.chartData),p[o].doughnutObject=n.createDoughnut(o,this.chartData,e[o],h)}$(".navButtonContainer").css("display","none"),$(".labelsBackground").css("display","none"),$("canvas").css({width:"100%",height:"100%"});for(var o=0;o<this.numberOfButtons;o++)document.getElementById("sliderID"+o).className=this.helper.addClass("sliderID"+o," overlaydiv overlayDiv1 handleStyle");this.windowWidth<992?this.helper.updateClassNamesAdd("ui-slider-handle"," fa fa-minus-square fa-lg fa-rotate-90 handleStyle"):this.helper.updateClassNamesAdd("ui-slider-handle"," fa fa-minus-square fa-2x fa-rotate-90 handleStyle"),this.updateChartPositions()},setButtonValue:function(t,e){var t=t.charAt(t.length-1),i=d[t];i.setButtonValue();for(var n=d[t].buttonValue,s=(this.helper.removeClass,this.helper.addClass,0);s<this.numberOfElements;s++)3==modules.baseURI.charAt(modules.baseURI.length-1)?u[t].setValues("",n):u[t][s].setValues("",n);1===d[t].buttonValue?$("#moduleButton"+t).children().removeClass("overlayDiv5"):$("#moduleButton"+t).children().removeClass("overlayDiv"+(d[t].buttonValue-1)),$("#moduleButton"+t).children().addClass("overlayDiv"+d[t].buttonValue),this.updateButtonValue(t)},setSliderValue:function(t,e,i){var n=e.charAt(e.length-1),s=e.charAt(e.length-3);e=[s,n],u[e[0]][e[1]].setValues(t,d[e[0]].buttonValue),this.updateTotal(e[[1]]);var r=p[e[1]].doughnutObject,o=d[e[0]].buttonUpdateID,a=2*parseInt(o),h=a+1,t=u[e[0]][e[1]].totalValue/10,l=10*d[e[0]].buttonValue-t;r.segments[a].value=l,r.segments[h].value=t,r.update()},updateButtonValue:function(t){if(null!==d[t].buttonUpdateID)for(var e=d[t].buttonUpdateID,i=2*parseInt(e),n=i+1,s=0;s<this.numberOfElements;s++){var r=p[s].doughnutObject;if(3==modules.baseURI.charAt(modules.baseURI.length-1))var o=u[s].totalValue/10;else var o=u[t][s].totalValue/10;var a=10*d[t].buttonValue-o;r.segments[i].value=a,r.segments[n].value=o,r.update()}else for(var s=0;s<this.numberOfElements;s++)var r=p[s].doughnutObject,o=0,a=0;this.updateChartPositions()},updateTotal:function(t){for(var e=0,i=0,n=0;n<this.numberOfButtons;n++)d[n].disabledBool||(e+=3==modules.baseURI.charAt(modules.baseURI.length-1)?u[n].totalValue:u[n][t].totalValue,i+=d[n].buttonValue);var s=Math.round(100*(e/(100*i)));p[t].totalScore=s,document.getElementById("sliderTotal"+t).innerHTML=s,document.getElementById("sliderTotalSmall"+t).innerHTML=s},removeChartSegment:function(t){for(var e=2*d[t].buttonUpdateID,i=0;i<p.length;i++)p[i].doughnutObject.removeData(e),p[i].doughnutObject.removeData(e)},addChartSegment:function(t){t=2*parseInt(t);for(var e=t+1,i=0;i<p.length;i++){var n=p[i].data;p[i].doughnutObject.addData({value:1,color:n[t].color},String(t)),p[i].doughnutObject.addData({value:0,color:n[e].color},e)}for(var i=0;i<p.length;i++)for(var s=p[i],r=0,o=1,a=0;a<this.numberOfButtons;a++){var h=2*a,l=h+1,c=a;d[c].disabledBool||(s.doughnutObject.segments[r].fillColor=s.data[h].color,s.doughnutObject.segments[r].highlightColor=s.data[h].color,s.doughnutObject.segments[o].fillColor=s.data[l].color,s.doughnutObject.segments[o].highlightColor=s.data[l].color,r+=2,o=r+1)}for(var i=0;i<p.length;i++)p[i].doughnutObject.update()},updateChartPositions:function(){c="ui3"==this.uiType?this.numberOfCharts:this.numberOfElements;for(var t=0;t<c;t++)document.getElementById("canvasContainer"+t).setAttribute("totalScore",p[t].totalScore);l("ul.results>li",{attr:"totalScore",order:"desc"}),$(".results").children("li").each(function(){this.className=""});var e=1,i=this;$(".results").children("li").each(function(){var t=i.getOrdinalPosition(e),n=this.id;switch(n=n.match(/[0-9]+/g),$("#ordianlPosition"+n[0]).text(t),document.getElementById("sliderTotalSmall"+n[0]).className="badge",e){case 1:"ui3"!==i.uiType&&$("#canvas"+n[0]).css("display","block"),document.getElementById("sliderTotalSmall"+n[0]).className=i.helper.addClass("sliderTotalSmall"+n[0],"goldBadge"),this.className="first";break;case 2:"ui3"!==i.uiType&&$("#canvas"+n[0]).css("display","none"),document.getElementById("sliderTotalSmall"+n[0]).className=i.helper.addClass("sliderTotalSmall"+n[0],"silverBadge"),
this.className="defaultChartHeader";break;case 3:$("#canvas"+n[0]).css("display","none"),document.getElementById("sliderTotalSmall"+n[0]).className=i.helper.addClass("sliderTotalSmall"+n[0],"bronzeBadge"),this.className="defaultChartHeader";break;default:$("#canvas"+n[0]).css("display","none"),this.className="defaultChartHeader"}e+=1})},getOrdinalPosition:function(t){var e=["th","st","nd","rd"],i=t%100;return t+(e[(i-20)%10]||e[i]||e[0])},getElementArray:function(){return u},getChartArray:function(){return p},getButtonArray:function(){return d},setScorerValue:function(t){var t=t.match(/[0-9]+/g),e=u[t[0]][t[1]].opValue,i=[],n=null,s=this.scorerValues[t[0]][this.scorerValues[t[0]].length-1];if(0==e){for(var r=0;r<this.scorerValues[t[0]].length;r++)0==r?n=this.scorerValues[t[0]][r]:i.push(this.scorerValues[t[0]][r]);this.scorerValues[t[0]]=i,u[t[0]][t[1]].setScorerValue=this.numberOfElements-(n-1),u[t[0]][t[1]].opValue=n}else if(e>s||"undefined"==typeof s){n=0;for(var r=0;r<this.scorerValues[t[0]].length;r++)i.push(this.scorerValues[t[0]][r]);i.push(e),this.scorerValues[t[0]]=i,0!=n?u[t[0]][t[1]].setScorerValue=this.numberOfElements-(n-1):u[t[0]][t[1]].setScorerValue=0,u[t[0]][t[1]].opValue=n}else{for(var r=0;r<this.scorerValues[t[0]].length;r++)e<this.scorerValues[t[0]][r]&&null===n?(n=this.scorerValues[t[0]][r],i.push(e)):i.push(this.scorerValues[t[0]][r]);u[t[0]][t[1]].setScorerValue=this.numberOfElements-(n-1),u[t[0]][t[1]].opValue=n,this.scorerValues[t[0]]=i}u[t[0]][t[1]].setValues(f,d[t[0]].buttonValue);var o=this.getOrdinalPosition(n);0!==u[t[0]][t[1]].opValue?document.getElementById("scorerValue"+t[0]+"_"+t[1]).innerHTML=o:document.getElementById("scorerValue"+t[0]+"_"+t[1]).innerHTML="",this.updateTotalScorer(t[[1]]);var a=p[t[1]].doughnutObject,h=d[t[0]].buttonUpdateID,l=2*parseInt(h),c=l+1,f=u[t[0]][t[1]].totalValue/10,m=10*d[t[0]].buttonValue-f;a.segments[l].value=m,a.segments[c].value=f,a.update(),this.updateChartPositions()},updateTotalScorer:function(t){for(var e=0,i=0,n=0;n<this.numberOfButtons;n++)d[n].disabledBool||(e+=u[n][t].totalValue,i+=d[n].buttonValue);var s=Math.round(100*(e/(100*i)));p[t].totalScore=s,document.getElementById("sliderTotal"+t).innerHTML=s,document.getElementById("sliderTotalSmall"+t).innerHTML=s},setSliderYNValue:function(t,e){var i,n,e=e.charAt(e.length-1);u[e].setValues(t.value,d[e].buttonValue),u[e].isNegetiveBool?u[e].isNegetiveBool&&(i=0,n=1):(i=1,n=0);var s=p[i].doughnutObject,r=d[e[0]].buttonUpdateID,o=2*parseInt(r),a=o+1,t=u[e].totalValue/10,h=10*d[e].buttonValue-t;s.segments[o].value=h,s.segments[a].value=t,s.update();var l=p[n].doughnutObject,c=0,f=10*d[e].buttonValue-c;l.segments[o].value=f,l.segments[a].value=c,l.update(),this.updateTotalYN()},setButtonValueYN:function(t){var e=d[t];e.setButtonValue();for(var i=d[t].buttonValue,n=0;n<this.numberOfElements;n++)u[t].setValues("",i);1===d[t].buttonValue?$("#moduleButton"+t).children().this.helper.removeClass("overlayDiv5"):$("#moduleButton"+t).children().this.helper.removeClass("overlayDiv"+(d[t].buttonValue-1)),$("#moduleButton"+t).children().this.helper.addClass("overlayDiv"+d[t].buttonValue),this.updateButtonValueYN(t)},updateButtonValueYN:function(t){for(var e,i,n=t,i=0;i<this.numberOfCharts;i++){if(e=0,null!==d[t].buttonUpdateID){var s=d[t].buttonUpdateID,r=2*parseInt(s),o=r+1,a=p[i].doughnutObject;u[n].isNegetiveBool&&0==i&&(e=u[n].totalValue/10),u[n].isNegetiveBool||1!=i||(e=u[n].totalValue/10);var h=10*d[t].buttonValue-e;a.segments[r].value=h,a.segments[o].value=e,a.update(),this.updateTotalYN()}else this.updateTotalYN();this.updateChartPositions()}},updateTotalYN:function(){for(var t,e=0,i=0,t=0;t<this.numberOfCharts;t++){e=0,i=0;for(var n=0;n<this.numberOfButtons;n++)d[n].disabledBool||(u[n].isNegetiveBool&&0==t&&(e+=u[n].totalValue),u[n].isNegetiveBool||1!=t||(e+=u[n].totalValue),i+=d[n].buttonValue);var s=Math.round(100*(e/(100*i)));p[t].totalScore=s,document.getElementById("sliderTotal"+t).innerHTML=s,document.getElementById("sliderTotalSmall"+t).innerHTML=s}}}}}),define("sMods/Main",["sMods/UIModule"],function(t){"use strict";return function(){var e;return{init:function(i){if("4"===i&&(i="1"),i)e=new t,3==i?e.init(6,6,"ui"+i):e.init(8,6,"ui"+i),i=parseInt(i)+1;else{e=new t,e.init(8,6,"ui1");var i=1}this.getTooltip(),this.loadJquery(this)},setButtonValue:function(t){var i=t.match(/[0-9]+/g);"ui3"==e.uiType?e.setButtonValueYN(i):e.setButtonValue(i)},setSliderValue:function(t,i){var n=i.match(/[0-9]+/g);"ui1"==e.uiType?e.setSliderValue(t.value,n):e.setSliderYNValue(t.value,n)},getTooltip:function(){var t=e.getTooltip();t.setModules(e)},updateChartPosition:function(t,i){e.updateChartPositions(i)},changeSlider:function(){$("body").trigger("click");var t=$(window).width();if(t<=992&&!e.windowResizeBool){if("ui1"==e.uiType){$(".slider").slider("option","orientation");$(".slider").slider("option","orientation","horizontal"),$(".handleStyle").this.helper.addClass("fa-rotate-90 fa-lg"),$(".handleStyle").this.helper.removeClass("fa-2x"),$(".elementWrapper").this.helper.addClass("elementWrapperWidth"),this.helper.updateClassNamesRemove("tooltip1","right"),this.helper.updateClassNamesAdd("tooltip1"," top")}"ui3"==e.uiType&&($(".handleStyle").this.helper.addClass("fa-lg"),$(".handleStyle").this.helper.removeClass("fa-2x"),$(".elementWrapper").this.helper.addClass("elementWrapperWidth"));for(var i=e.getButtonArray(),n=0;n<i.length;n++)i[n].disabledBool&&(setGreyOut(!1,n),setGreyOut(!0,n));$(".elementWrapper").this.helper.removeClass("setTransition"),document.getElementById("tabDecide").disabled=!0,document.getElementById("tabSlide").disabled=!0,document.getElementById("tabTap").disabled=!0,e.windowResizeBool=!0}if(t>992){if(e.windowResizeBool){if("ui1"==e.uiType){$(".slider").slider("option","orientation");$(".slider").slider("option","orientation","vertical"),$(".handleStyle").this.helper.removeClass("fa-rotate-90 fa-lg"),$(".handleStyle").this.helper.addClass("fa-2x"),$(".elementWrapper").this.helper.removeClass("elementWrapperWidth"),this.helper.updateClassNamesRemove("tooltip1","top"),this.helper.updateClassNamesAdd("tooltip1"," right")}if("ui3"==e.uiType&&($(".handleStyle").this.helper.removeClass("fa-lg"),$(".handleStyle").this.helper.addClass("fa-2x"),$(".elementWrapper").this.helper.removeClass("elementWrapperWidth")),setTimeout(function(){$(".elementWrapper").this.helper.addClass("setTransition")},500),"ui3"!==e.uiType){var s=e.elementWidth*e.numberOfElements+30;$(".elementWrapper").css("width",s),$(".sliderNavWrapper").css("width",s)}document.getElementById("navbarCollapse").className="",document.getElementById("navbarCollapse").className="navbar-collapse collapse",e.windowResizeBool=!1}for(var i=e.getButtonArray(),n=0;n<i.length;n++)i[n].disabledBool&&(setGreyOut(!1,n),setGreyOut(!0,n));if(t<=1200){var r=($("#chartHeader0").outerWidth(),e.currentElement+4),o=e.currentElement-1,a=document.getElementById("sliderLabel"+r).className,h=a.indexOf("hideVisibility");h===-1&&(document.getElementById("sliderLabel"+r).className=this.helper.addClass("sliderLabel"+r,"hideVisibility"),o!==-1&&(document.getElementById("sliderLabel"+o).className=this.helper.addClass("sliderLabel"+o,"hideVisibility"))),t<=1100&&$(".sliderNavContainer1200").css("margin","0"),t>1100&&$(".sliderNavContainer1200").css("margin","0 auto")}if(t>1200){var l=e.currentElement+4,c=e.currentElement-1,a=document.getElementById("sliderLabel"+l).className,h=a.indexOf("hideVisibility");h!==-1&&(document.getElementById("sliderLabel"+l).className=this.helper.removeClass("sliderLabel"+l,"hideVisibility"),c!==-1&&(document.getElementById("sliderLabel"+c).className=this.helper.removeClass("sliderLabel"+c,"hideVisibility")))}document.getElementById("tabDecide").disabled=!1,document.getElementById("tabSlide").disabled=!1,document.getElementById("tabTap").disabled=!1,window.scrollTo(0,0)}},setGreyOut:function(t,e){var i=this;if(t){var n=$(".moduleRow"+e).outerWidth(),s=$(".moduleRow"+e).outerHeight(),r=$(".moduleRow"+e).offset();document.getElementById("greyOut"+e).setAttribute("class","fa fa-plus fa-lg greyOutClick"),$("body").append('<div class="greyOut" id="greyOutOverlay'+e+'" style="width:'+n+"px;height:"+s+"px;top:"+r.top+"px;left:"+r.left+'px;"><div class="greyOutPlus" id="greyOutPlus'+e+'"></div></div>'),$("#greyOutPlus"+e).on("click",function(){i.turnOffGrey(e)})}else{var o=document.getElementById("greyOutOverlay"+e);o.parentNode.removeChild(o)}},turnOffGrey:function(t){var i="greyOut"+t,n=e.getButtonArray(),s=0;this.setGreyOut(!1,t),document.getElementById(i).setAttribute("class","fa fa-minus fa-lg greyOutClick"),n[t].disabledBool=!1;for(var r=0;r<e.numberOfButtons;r++)n[r].disabledBool?n[r].buttonUpdateID=null:(n[r].buttonUpdateID=s,s+=1);e.addChartSegment(t);for(var r=0;r<e.numberOfButtons;r++)"ui3"==e.uiType?e.updateButtonValueYN(r):e.updateButtonValue(r);e.numberOfGreyOuts+=1},loadJquery:function(t){$(".greyOutClick").click(function(){if(e.numberOfGreyOuts>1){var i=this.id.match(/[0-9]+/g),n=e.getButtonArray(),s=0;t.setGreyOut(!0,i);e.getElementArray();e.removeChartSegment(i),n[i].disabledBool=!0;for(var r=0;r<e.numberOfButtons;r++)n[r].disabledBool?n[r].buttonUpdateID=null:(n[r].buttonUpdateID=s,s+=1);"ui3"==e.uiType?e.updateButtonValueYN(i):e.updateButtonValue(i),e.numberOfGreyOuts-=1}}),$(".sliderNavFunction").click(function(t){var i=$(".elementWrapper").css("right"),n=$(window).width();if(i=i.match(/[0-9]+/g),t.target.id.match("Right")&&e.currentElement+5<e.numberOfElements){document.getElementById(t.target.id).disabled=!0;var s=parseInt(i[0])+e.elementWidth+"px";if(n<=1200&&n>=1050){var r=e.currentElement+4,o=e.currentElement+5,a=e.currentElement;document.getElementById("sliderLabel"+r).className=this.helper.removeClass("sliderLabel"+r,"hideVisibility"),document.getElementById("sliderLabel"+o).className=this.helper.addClass("sliderLabel"+o,"hideVisibility")}setTimeout(function(){n<=1200&&n>=1050&&(document.getElementById("sliderLabel"+a).className=this.helper.addClass("sliderLabel"+a,"hideVisibility")),document.getElementById(t.target.id).disabled=!1,e.currentElement+=1},1e3)}else if(t.target.id.match("Left")&&e.currentElement>0){document.getElementById(t.target.id).disabled=!0;var s=parseInt(i[0])-e.elementWidth+"px";if(n<=1200&&n>=1050){var h=e.currentElement-1,o=e.currentElement+3,l=e.currentElement+4;document.getElementById("sliderLabel"+h).className=this.helper.removeClass("sliderLabel"+h,"hideVisibility")}setTimeout(function(){n<=1200&&n>=1050&&(document.getElementById("sliderLabel"+o).className=this.helper.addClass("sliderLabel"+o,"hideVisibility"),document.getElementById("sliderLabel"+l).className=this.helper.removeClass("sliderLabel"+l,"hideVisibility")),document.getElementById(t.target.id).disabled=!1,e.currentElement-=1},1e3)}$(".sliderNavWrapper").css({right:s}),$(".elementWrapper").css({right:s})}),$(".tab").click(function(t){var i=t.currentTarget.id;e.highLight.addHighLight(i)}),$(document).bind("mobileinit",function(){$.mobile.loader.prototype.options.text="",$.mobile.loader.prototype.options.textVisible=!1,$.mobile.loader.prototype.options.theme="a",$.mobile.loader.prototype.options.html="",$.mobile.hidePageLoadingMsg()}),$(window).resize(function(){t.changeSlider()})}}}}),define("sMods/SetUI",["sMods/Main"],function(t){"use strict";var e=window.location.search.substring(1);e=e?e.charAt(e.length-1):1;var i=new t;i.init(e)});var pageTitle=document.title;"siolsite.com"==pageTitle&&requirejs(["wpFunc/functions"],function(t){}),"3d Game"==pageTitle&&requirejs(["game/oimo","game/three","game/v3d","game/gameinit","game/main","wpFunc/functions"],function(t,e,i,n,s,r){var o=new s;o.init()}),"Drag And Drop Utility"==pageTitle&&requirejs(["ddUtil/createDragDropElement","ddUtil/dragDrop","wpFunc/functions","jquery","jqueryUI"],function(t,e,i,n,s){}),"SOMYMU"==pageTitle&&requirejs(["jquery","jqueryUI","jqueryTP","tinysort","chartjs","niceScroll","bstrap","bstrapCol","bstrapTran","bstrapCaro","sMods/SetUI","sMods/TemplateModule","sMods/UIModule","sMods/TooltipModulesto","sMods/ButtonModule","sMods/DoughNutModule","sMods/HighLight","sMods/Main","sMods/ScorerModule","sMods/SliderModule","sMods/SliderModuleYN","sMods/Helper","wpFunc/functions"],function(t,e,i,n,s,r,o,a,h,l,c,u,d,p,f,m,g,v,y,x,b,w,_){}),define("config",function(){});